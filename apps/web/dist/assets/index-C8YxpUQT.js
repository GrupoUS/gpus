const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/student-enrollments-tab-oVxkB0sl.js","assets/vendor-C0IzTJ68.js","assets/ui-eQKuYNMj.js","assets/auth-CS6YH2iJ.js","assets/animation-oFsG5JPT.js","assets/forms-CH1lNzbM.js","assets/charts-CKNPyqfB.js","assets/student-payments-tab-Cg6B6HrT.js","assets/student-conversations-tab-D7oFgikg.js","assets/leads-over-time-chart-1m4TaCR2.js","assets/messages-over-time-chart-0yAuZuPG.js","assets/churn-alerts-DZ--RuMV.js","assets/funnel-chart-BA0QYxCY.js","assets/leads-by-product-C8Iv48CZ.js","assets/leads-vs-conversions-BW7vPy7p.js","assets/recent-leads-Dd_kyXoX.js","assets/response-time-uVhdl-cl.js","assets/team-performance-zwS6KPLH.js","assets/lead-detail-oXUcdKcG.js","assets/command-CoeuBcqE.js","assets/pipeline-kanban-Bk8HDh5w.js","assets/lead-import-dialog-eHveCG7k.js","assets/admin-user-selector-96Z04T6f.js"])))=>i.map(i=>d[i]);
import{e as tC,f as aC,s as yn,b as C,c as rC,u as sC,h as nC,k as iC,l as lC,m as cC,n as oC,o as uC,p as dC,q as fC,t as hC,j as t,v as mC,x as xC,L as Br,y as pC,O as Yc,z as gC,A as v2,B as jt,C as Gu,R as Xe,D as vC,g as yC,E as hi,F as jC,d as bC,G as NC}from"./vendor-C0IzTJ68.js";import{u as j0,U as y2,a as j2,S as b2,b as N2,A as w2,c as wC}from"./auth-CS6YH2iJ.js";import{T as SC,c as S2,t as _C,S as vp,a as _2,M as E2,b as EC,X as ga,L as T2,U as TC,G as Xi,d as CC,e as AC,f as yp,C as Al,g as kC,u as C2,h as jp,i as DC,P as qu,j as bp,k as OC,l as Wu,m as RC,R as A2,B as lu,n as li,o as Nn,H as MC,p as Ie,q as Sn,r as ya,s as tn,D as $i,v as FC,w as IC,Z as k2,x as D2,I as LC,F as PC,y as BC,z as rr,A as Yu,E as UC,J as O2,K as zC,N as Xu,O as R2,Q as M2,V as VC,W as Il,Y as F2,_ as $u,$ as I2,a0 as HC,a1 as L2,a2 as GC,a3 as P2,a4 as B2,a5 as qC,a6 as WC,a7 as U2,a8 as YC,a9 as XC,aa as Np,ab as pt,ac as _n,ad as z2,ae as $C,af as Eu,ag as zc,ah as KC,ai as ax,aj as Ko,ak as Qo,al as QC,am as V2,an as bn,ao as Ll,ap as Ku,aq as wp,ar as Qu,as as b0,at as Zu,au as Ju,av as Sp,aw as H2,ax as G2,ay as ZC,az as JC,aA as q2,aB as eA,aC as W2,aD as Y2,aE as X2,aF as tA,aG as an,aH as ed,aI as aA,aJ as Bx,aK as Ms,aL as rA,aM as $2,aN as sA,aO as nA,aP as iA,aQ as xs,aR as K2,aS as Q2,aT as lA,aU as Z2,aV as N0,aW as _p,aX as w0,aY as ci,aZ as el,a_ as td,a$ as J2,b0 as rn,b1 as Zo,b2 as Jn,b3 as cA,b4 as oA,b5 as uA,b6 as dA,b7 as eN,b8 as tN,b9 as fA,ba as hA,bb as mA,bc as xA,bd as pA,be as gA,bf as aN,bg as vA,bh as yA,bi as rN,bj as jA,bk as bA,bl as NA,bm as wA,bn as SA,bo as _A,bp as EA,bq as TA,br as CA,bs as AA,bt as kA,bu as DA,bv as Ux,bw as OA,bx as RA,by as tl,bz as MA,bA as FA,bB as sN,bC as IA,bD as LA,bE as nN,bF as PA,bG as Xc,bH as Tu,bI as iN,bJ as lN,bK as S0,bL as cN,bM as oN,bN as BA,bO as jj,bP as uN,bQ as UA,bR as zA,bS as VA,bT as HA,bU as dN,bV as fN,bW as hN,bX as mN,bY as xN,bZ as pN,b_ as gN,b$ as vN,c0 as yN,c1 as Ep,c2 as al,c3 as jN,c4 as bN,c5 as NN,c6 as Tp,c7 as $c,c8 as GA,c9 as qA,ca as WA,cb as YA,cc as wN,cd as XA,ce as Fc,cf as Cu,cg as SN,ch as $A,ci as KA,cj as mi,ck as Cp,cl as _N,cm as EN,cn as TN,co as t0,cp as _0,cq as QA,cr as ZA,cs as JA,ct as ek,cu as tk,cv as CN,cw as ak,cx as rk,cy as sk,cz as nk,cA as ik,cB as lk,cC as bj,cD as ck}from"./ui-eQKuYNMj.js";import{u as ok,a as Rr,b as Vi,m as at,A as AN,c as uk,d as E0,e as dk,f as fk}from"./animation-oFsG5JPT.js";import{u as hk,F as mk,C as xk,o as Pa,n as Ap,s as Ke,b as oi,_ as ui,a as Zr,c as Jr,d as kN}from"./forms-CH1lNzbM.js";import{R as a0,L as kp,C as r0,X as s0,Y as n0,T as i0,a as Ic,B as pk,b as gk,c as vk}from"./charts-CKNPyqfB.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function a(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=a(i);fetch(i.href,o)}})();var rx={exports:{}},Jo={},sx={exports:{}},nx={};var Nj;function yk(){return Nj||(Nj=1,(function(e){function r(W,ee){var je=W.length;W.push(ee);e:for(;0<je;){var Z=je-1>>>1,De=W[Z];if(0<i(De,ee))W[Z]=ee,W[je]=De,je=Z;else break e}}function a(W){return W.length===0?null:W[0]}function n(W){if(W.length===0)return null;var ee=W[0],je=W.pop();if(je!==ee){W[0]=je;e:for(var Z=0,De=W.length,he=De>>>1;Z<he;){var P=2*(Z+1)-1,q=W[P],J=P+1,K=W[J];if(0>i(q,je))J<De&&0>i(K,q)?(W[Z]=K,W[J]=je,Z=J):(W[Z]=q,W[P]=je,Z=P);else if(J<De&&0>i(K,je))W[Z]=K,W[J]=je,Z=J;else break e}}return ee}function i(W,ee){var je=W.sortIndex-ee.sortIndex;return je!==0?je:W.id-ee.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var u=Date,d=u.now();e.unstable_now=function(){return u.now()-d}}var h=[],m=[],p=1,v=null,y=3,N=!1,j=!1,b=!1,w=!1,T=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;function R(W){for(var ee=a(m);ee!==null;){if(ee.callback===null)n(m);else if(ee.startTime<=W)n(m),ee.sortIndex=ee.expirationTime,r(h,ee);else break;ee=a(m)}}function z(W){if(b=!1,R(W),!j)if(a(h)!==null)j=!0,O||(O=!0,I());else{var ee=a(m);ee!==null&&ge(z,ee.startTime-W)}}var O=!1,A=-1,k=5,E=-1;function L(){return w?!0:!(e.unstable_now()-E<k)}function H(){if(w=!1,O){var W=e.unstable_now();E=W;var ee=!0;try{e:{j=!1,b&&(b=!1,D(A),A=-1),N=!0;var je=y;try{t:{for(R(W),v=a(h);v!==null&&!(v.expirationTime>W&&L());){var Z=v.callback;if(typeof Z=="function"){v.callback=null,y=v.priorityLevel;var De=Z(v.expirationTime<=W);if(W=e.unstable_now(),typeof De=="function"){v.callback=De,R(W),ee=!0;break t}v===a(h)&&n(h),R(W)}else n(h);v=a(h)}if(v!==null)ee=!0;else{var he=a(m);he!==null&&ge(z,he.startTime-W),ee=!1}}break e}finally{v=null,y=je,N=!1}ee=void 0}}finally{ee?I():O=!1}}}var I;if(typeof _=="function")I=function(){_(H)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,ne=re.port2;re.port1.onmessage=H,I=function(){ne.postMessage(null)}}else I=function(){T(H,0)};function ge(W,ee){A=T(function(){W(e.unstable_now())},ee)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_next=function(W){switch(y){case 1:case 2:case 3:var ee=3;break;default:ee=y}var je=y;y=ee;try{return W()}finally{y=je}},e.unstable_requestPaint=function(){w=!0},e.unstable_runWithPriority=function(W,ee){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var je=y;y=W;try{return ee()}finally{y=je}},e.unstable_scheduleCallback=function(W,ee,je){var Z=e.unstable_now();switch(typeof je=="object"&&je!==null?(je=je.delay,je=typeof je=="number"&&0<je?Z+je:Z):je=Z,W){case 1:var De=-1;break;case 2:De=250;break;case 5:De=1073741823;break;case 4:De=1e4;break;default:De=5e3}return De=je+De,W={id:p++,callback:ee,priorityLevel:W,startTime:je,expirationTime:De,sortIndex:-1},je>Z?(W.sortIndex=je,r(m,W),a(h)===null&&W===a(m)&&(b?(D(A),A=-1):b=!0,ge(z,je-Z))):(W.sortIndex=De,r(h,W),j||N||(j=!0,O||(O=!0,I()))),W},e.unstable_shouldYield=L,e.unstable_wrapCallback=function(W){var ee=y;return function(){var je=y;y=ee;try{return W.apply(this,arguments)}finally{y=je}}}})(nx)),nx}var wj;function jk(){return wj||(wj=1,sx.exports=yk()),sx.exports}var Sj;function bk(){if(Sj)return Jo;Sj=1;var e=jk(),r=tC(),a=aC();function n(s){var l="https://react.dev/errors/"+s;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)l+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function o(s){var l=s,c=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(c=l.return),s=l.return;while(s)}return l.tag===3?c:null}function u(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function d(s){if(s.tag===31){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function h(s){if(o(s)!==s)throw Error(n(188))}function m(s){var l=s.alternate;if(!l){if(l=o(s),l===null)throw Error(n(188));return l!==s?null:s}for(var c=s,f=l;;){var x=c.return;if(x===null)break;var g=x.alternate;if(g===null){if(f=x.return,f!==null){c=f;continue}break}if(x.child===g.child){for(g=x.child;g;){if(g===c)return h(x),s;if(g===f)return h(x),l;g=g.sibling}throw Error(n(188))}if(c.return!==f.return)c=x,f=g;else{for(var S=!1,F=x.child;F;){if(F===c){S=!0,c=x,f=g;break}if(F===f){S=!0,f=x,c=g;break}F=F.sibling}if(!S){for(F=g.child;F;){if(F===c){S=!0,c=g,f=x;break}if(F===f){S=!0,f=g,c=x;break}F=F.sibling}if(!S)throw Error(n(189))}}if(c.alternate!==f)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?s:l}function p(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s;for(s=s.child;s!==null;){if(l=p(s),l!==null)return l;s=s.sibling}return null}var v=Object.assign,y=Symbol.for("react.element"),N=Symbol.for("react.transitional.element"),j=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),D=Symbol.for("react.consumer"),_=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),z=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),E=Symbol.for("react.activity"),L=Symbol.for("react.memo_cache_sentinel"),H=Symbol.iterator;function I(s){return s===null||typeof s!="object"?null:(s=H&&s[H]||s["@@iterator"],typeof s=="function"?s:null)}var re=Symbol.for("react.client.reference");function ne(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===re?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case b:return"Fragment";case T:return"Profiler";case w:return"StrictMode";case z:return"Suspense";case O:return"SuspenseList";case E:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case j:return"Portal";case _:return s.displayName||"Context";case D:return(s._context.displayName||"Context")+".Consumer";case R:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case A:return l=s.displayName||null,l!==null?l:ne(s.type)||"Memo";case k:l=s._payload,s=s._init;try{return ne(s(l))}catch{}}return null}var ge=Array.isArray,W=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,je={pending:!1,data:null,method:null,action:null},Z=[],De=-1;function he(s){return{current:s}}function P(s){0>De||(s.current=Z[De],Z[De]=null,De--)}function q(s,l){De++,Z[De]=s.current,s.current=l}var J=he(null),K=he(null),xe=he(null),Fe=he(null);function Ae(s,l){switch(q(xe,l),q(K,s),q(J,null),l.nodeType){case 9:case 11:s=(s=l.documentElement)&&(s=s.namespaceURI)?Hy(s):0;break;default:if(s=l.tagName,l=l.namespaceURI)l=Hy(l),s=Gy(l,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}P(J),q(J,s)}function Ee(){P(J),P(K),P(xe)}function we(s){s.memoizedState!==null&&q(Fe,s);var l=J.current,c=Gy(l,s.type);l!==c&&(q(K,s),q(J,c))}function Ge(s){K.current===s&&(P(J),P(K)),Fe.current===s&&(P(Fe),Wo._currentValue=je)}var X,ht;function Ye(s){if(X===void 0)try{throw Error()}catch(c){var l=c.stack.trim().match(/\n( *(at )?)/);X=l&&l[1]||"",ht=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+X+s+ht}var Je=!1;function qe(s,l){if(!s||Je)return"";Je=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(l){var Re=function(){throw Error()};if(Object.defineProperty(Re.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Re,[])}catch(be){var ve=be}Reflect.construct(s,[],Re)}else{try{Re.call()}catch(be){ve=be}s.call(Re.prototype)}}else{try{throw Error()}catch(be){ve=be}(Re=s())&&typeof Re.catch=="function"&&Re.catch(function(){})}}catch(be){if(be&&ve&&typeof be.stack=="string")return[be.stack,ve.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=f.DetermineComponentFrameRoot(),S=g[0],F=g[1];if(S&&F){var te=S.split(`
`),fe=F.split(`
`);for(x=f=0;f<te.length&&!te[f].includes("DetermineComponentFrameRoot");)f++;for(;x<fe.length&&!fe[x].includes("DetermineComponentFrameRoot");)x++;if(f===te.length||x===fe.length)for(f=te.length-1,x=fe.length-1;1<=f&&0<=x&&te[f]!==fe[x];)x--;for(;1<=f&&0<=x;f--,x--)if(te[f]!==fe[x]){if(f!==1||x!==1)do if(f--,x--,0>x||te[f]!==fe[x]){var _e=`
`+te[f].replace(" at new "," at ");return s.displayName&&_e.includes("<anonymous>")&&(_e=_e.replace("<anonymous>",s.displayName)),_e}while(1<=f&&0<=x);break}}}finally{Je=!1,Error.prepareStackTrace=c}return(c=s?s.displayName||s.name:"")?Ye(c):""}function Be(s,l){switch(s.tag){case 26:case 27:case 5:return Ye(s.type);case 16:return Ye("Lazy");case 13:return s.child!==l&&l!==null?Ye("Suspense Fallback"):Ye("Suspense");case 19:return Ye("SuspenseList");case 0:case 15:return qe(s.type,!1);case 11:return qe(s.type.render,!1);case 1:return qe(s.type,!0);case 31:return Ye("Activity");default:return""}}function $e(s){try{var l="",c=null;do l+=Be(s,c),c=s,s=s.return;while(s);return l}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var St=Object.prototype.hasOwnProperty,Jt=e.unstable_scheduleCallback,fa=e.unstable_cancelCallback,ze=e.unstable_shouldYield,vt=e.unstable_requestPaint,tt=e.unstable_now,Qe=e.unstable_getCurrentPriorityLevel,ot=e.unstable_ImmediatePriority,bt=e.unstable_UserBlockingPriority,Ut=e.unstable_NormalPriority,Ma=e.unstable_LowPriority,wt=e.unstable_IdlePriority,qt=e.log,oa=e.unstable_setDisableYieldValue,zt=null,ia=null;function Ca(s){if(typeof qt=="function"&&oa(s),ia&&typeof ia.setStrictMode=="function")try{ia.setStrictMode(zt,s)}catch{}}var _a=Math.clz32?Math.clz32:_t,nn=Math.log,ln=Math.LN2;function _t(s){return s>>>=0,s===0?32:31-(nn(s)/ln|0)|0}var Dt=256,ut=262144,Bt=4194304;function aa(s){var l=s&42;if(l!==0)return l;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Ot(s,l,c){var f=s.pendingLanes;if(f===0)return 0;var x=0,g=s.suspendedLanes,S=s.pingedLanes;s=s.warmLanes;var F=f&134217727;return F!==0?(f=F&~g,f!==0?x=aa(f):(S&=F,S!==0?x=aa(S):c||(c=F&~s,c!==0&&(x=aa(c))))):(F=f&~g,F!==0?x=aa(F):S!==0?x=aa(S):c||(c=f&~s,c!==0&&(x=aa(c)))),x===0?0:l!==0&&l!==x&&(l&g)===0&&(g=x&-x,c=l&-l,g>=c||g===32&&(c&4194048)!==0)?l:x}function Bs(s,l){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&l)===0}function ja(s,l){switch(s){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function as(){var s=Bt;return Bt<<=1,(Bt&62914560)===0&&(Bt=4194304),s}function Us(s){for(var l=[],c=0;31>c;c++)l.push(s);return l}function Hr(s,l){s.pendingLanes|=l,l!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function nl(s,l,c,f,x,g){var S=s.pendingLanes;s.pendingLanes=c,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=c,s.entangledLanes&=c,s.errorRecoveryDisabledLanes&=c,s.shellSuspendCounter=0;var F=s.entanglements,te=s.expirationTimes,fe=s.hiddenUpdates;for(c=S&~c;0<c;){var _e=31-_a(c),Re=1<<_e;F[_e]=0,te[_e]=-1;var ve=fe[_e];if(ve!==null)for(fe[_e]=null,_e=0;_e<ve.length;_e++){var be=ve[_e];be!==null&&(be.lane&=-536870913)}c&=~Re}f!==0&&il(s,f,0),g!==0&&x===0&&s.tag!==0&&(s.suspendedLanes|=g&~(S&~l))}function il(s,l,c){s.pendingLanes|=l,s.suspendedLanes&=~l;var f=31-_a(l);s.entangledLanes|=l,s.entanglements[f]=s.entanglements[f]|1073741824|c&261930}function Rn(s,l){var c=s.entangledLanes|=l;for(s=s.entanglements;c;){var f=31-_a(c),x=1<<f;x&l|s[f]&l&&(s[f]|=l),c&=~x}}function Yl(s,l){var c=l&-l;return c=(c&42)!==0?1:xr(c),(c&(s.suspendedLanes|l))!==0?0:c}function xr(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function rs(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function M(){var s=ee.p;return s!==0?s:(s=window.event,s===void 0?32:hj(s.type))}function Y(s,l){var c=ee.p;try{return ee.p=s,l()}finally{ee.p=c}}var B=Math.random().toString(36).slice(2),U="__reactFiber$"+B,G="__reactProps$"+B,Q="__reactContainer$"+B,ue="__reactEvents$"+B,Se="__reactListeners$"+B,de="__reactHandles$"+B,pe="__reactResources$"+B,ae="__reactMarker$"+B;function V(s){delete s[U],delete s[G],delete s[ue],delete s[Se],delete s[de]}function le(s){var l=s[U];if(l)return l;for(var c=s.parentNode;c;){if(l=c[Q]||c[U]){if(c=l.alternate,l.child!==null||c!==null&&c.child!==null)for(s=Qy(s);s!==null;){if(c=s[U])return c;s=Qy(s)}return l}s=c,c=s.parentNode}return null}function Ne(s){if(s=s[U]||s[Q]){var l=s.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return s}return null}function Oe(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s.stateNode;throw Error(n(33))}function Ue(s){var l=s[pe];return l||(l=s[pe]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function We(s){s[ae]=!0}var Lt=new Set,Wt={};function la(s,l){pr(s,l),pr(s+"Capture",l)}function pr(s,l){for(Wt[s]=l,s=0;s<l.length;s++)Lt.add(l[s])}var ba=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),zs={},ss={};function lo(s){return St.call(ss,s)?!0:St.call(zs,s)?!1:ba.test(s)?ss[s]=!0:(zs[s]=!0,!1)}function Gr(s,l,c){if(lo(l))if(c===null)s.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":s.removeAttribute(l);return;case"boolean":var f=l.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){s.removeAttribute(l);return}}s.setAttribute(l,""+c)}}function gd(s,l,c){if(c===null)s.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttribute(l,""+c)}}function Mn(s,l,c,f){if(f===null)s.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttributeNS(l,c,""+f)}}function js(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Fg(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function XE(s,l,c){var f=Object.getOwnPropertyDescriptor(s.constructor.prototype,l);if(!s.hasOwnProperty(l)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var x=f.get,g=f.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return x.call(this)},set:function(S){c=""+S,g.call(this,S)}}),Object.defineProperty(s,l,{enumerable:f.enumerable}),{getValue:function(){return c},setValue:function(S){c=""+S},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function $0(s){if(!s._valueTracker){var l=Fg(s)?"checked":"value";s._valueTracker=XE(s,l,""+s[l])}}function Ig(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var c=l.getValue(),f="";return s&&(f=Fg(s)?s.checked?"true":"false":s.value),s=f,s!==c?(l.setValue(s),!0):!1}function vd(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var $E=/[\n"\\]/g;function bs(s){return s.replace($E,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function K0(s,l,c,f,x,g,S,F){s.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?s.type=S:s.removeAttribute("type"),l!=null?S==="number"?(l===0&&s.value===""||s.value!=l)&&(s.value=""+js(l)):s.value!==""+js(l)&&(s.value=""+js(l)):S!=="submit"&&S!=="reset"||s.removeAttribute("value"),l!=null?Q0(s,S,js(l)):c!=null?Q0(s,S,js(c)):f!=null&&s.removeAttribute("value"),x==null&&g!=null&&(s.defaultChecked=!!g),x!=null&&(s.checked=x&&typeof x!="function"&&typeof x!="symbol"),F!=null&&typeof F!="function"&&typeof F!="symbol"&&typeof F!="boolean"?s.name=""+js(F):s.removeAttribute("name")}function Lg(s,l,c,f,x,g,S,F){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(s.type=g),l!=null||c!=null){if(!(g!=="submit"&&g!=="reset"||l!=null)){$0(s);return}c=c!=null?""+js(c):"",l=l!=null?""+js(l):c,F||l===s.value||(s.value=l),s.defaultValue=l}f=f??x,f=typeof f!="function"&&typeof f!="symbol"&&!!f,s.checked=F?s.checked:!!f,s.defaultChecked=!!f,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(s.name=S),$0(s)}function Q0(s,l,c){l==="number"&&vd(s.ownerDocument)===s||s.defaultValue===""+c||(s.defaultValue=""+c)}function Xl(s,l,c,f){if(s=s.options,l){l={};for(var x=0;x<c.length;x++)l["$"+c[x]]=!0;for(c=0;c<s.length;c++)x=l.hasOwnProperty("$"+s[c].value),s[c].selected!==x&&(s[c].selected=x),x&&f&&(s[c].defaultSelected=!0)}else{for(c=""+js(c),l=null,x=0;x<s.length;x++){if(s[x].value===c){s[x].selected=!0,f&&(s[x].defaultSelected=!0);return}l!==null||s[x].disabled||(l=s[x])}l!==null&&(l.selected=!0)}}function Pg(s,l,c){if(l!=null&&(l=""+js(l),l!==s.value&&(s.value=l),c==null)){s.defaultValue!==l&&(s.defaultValue=l);return}s.defaultValue=c!=null?""+js(c):""}function Bg(s,l,c,f){if(l==null){if(f!=null){if(c!=null)throw Error(n(92));if(ge(f)){if(1<f.length)throw Error(n(93));f=f[0]}c=f}c==null&&(c=""),l=c}c=js(l),s.defaultValue=c,f=s.textContent,f===c&&f!==""&&f!==null&&(s.value=f),$0(s)}function $l(s,l){if(l){var c=s.firstChild;if(c&&c===s.lastChild&&c.nodeType===3){c.nodeValue=l;return}}s.textContent=l}var KE=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ug(s,l,c){var f=l.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?f?s.setProperty(l,""):l==="float"?s.cssFloat="":s[l]="":f?s.setProperty(l,c):typeof c!="number"||c===0||KE.has(l)?l==="float"?s.cssFloat=c:s[l]=(""+c).trim():s[l]=c+"px"}function zg(s,l,c){if(l!=null&&typeof l!="object")throw Error(n(62));if(s=s.style,c!=null){for(var f in c)!c.hasOwnProperty(f)||l!=null&&l.hasOwnProperty(f)||(f.indexOf("--")===0?s.setProperty(f,""):f==="float"?s.cssFloat="":s[f]="");for(var x in l)f=l[x],l.hasOwnProperty(x)&&c[x]!==f&&Ug(s,x,f)}else for(var g in l)l.hasOwnProperty(g)&&Ug(s,g,l[g])}function Z0(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var QE=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ZE=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function yd(s){return ZE.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Fn(){}var J0=null;function eh(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Kl=null,Ql=null;function Vg(s){var l=Ne(s);if(l&&(s=l.stateNode)){var c=s[G]||null;e:switch(s=l.stateNode,l.type){case"input":if(K0(s,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),l=c.name,c.type==="radio"&&l!=null){for(c=s;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+bs(""+l)+'"][type="radio"]'),l=0;l<c.length;l++){var f=c[l];if(f!==s&&f.form===s.form){var x=f[G]||null;if(!x)throw Error(n(90));K0(f,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(l=0;l<c.length;l++)f=c[l],f.form===s.form&&Ig(f)}break e;case"textarea":Pg(s,c.value,c.defaultValue);break e;case"select":l=c.value,l!=null&&Xl(s,!!c.multiple,l,!1)}}}var th=!1;function Hg(s,l,c){if(th)return s(l,c);th=!0;try{var f=s(l);return f}finally{if(th=!1,(Kl!==null||Ql!==null)&&(lf(),Kl&&(l=Kl,s=Ql,Ql=Kl=null,Vg(l),s)))for(l=0;l<s.length;l++)Vg(s[l])}}function co(s,l){var c=s.stateNode;if(c===null)return null;var f=c[G]||null;if(f===null)return null;c=f[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(s=s.type,f=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!f;break e;default:s=!1}if(s)return null;if(c&&typeof c!="function")throw Error(n(231,l,typeof c));return c}var In=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ah=!1;if(In)try{var oo={};Object.defineProperty(oo,"passive",{get:function(){ah=!0}}),window.addEventListener("test",oo,oo),window.removeEventListener("test",oo,oo)}catch{ah=!1}var vi=null,rh=null,jd=null;function Gg(){if(jd)return jd;var s,l=rh,c=l.length,f,x="value"in vi?vi.value:vi.textContent,g=x.length;for(s=0;s<c&&l[s]===x[s];s++);var S=c-s;for(f=1;f<=S&&l[c-f]===x[g-f];f++);return jd=x.slice(s,1<f?1-f:void 0)}function bd(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function Nd(){return!0}function qg(){return!1}function qr(s){function l(c,f,x,g,S){this._reactName=c,this._targetInst=x,this.type=f,this.nativeEvent=g,this.target=S,this.currentTarget=null;for(var F in s)s.hasOwnProperty(F)&&(c=s[F],this[F]=c?c(g):g[F]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?Nd:qg,this.isPropagationStopped=qg,this}return v(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Nd)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Nd)},persist:function(){},isPersistent:Nd}),l}var ll={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wd=qr(ll),uo=v({},ll,{view:0,detail:0}),JE=qr(uo),sh,nh,fo,Sd=v({},uo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lh,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==fo&&(fo&&s.type==="mousemove"?(sh=s.screenX-fo.screenX,nh=s.screenY-fo.screenY):nh=sh=0,fo=s),sh)},movementY:function(s){return"movementY"in s?s.movementY:nh}}),Wg=qr(Sd),eT=v({},Sd,{dataTransfer:0}),tT=qr(eT),aT=v({},uo,{relatedTarget:0}),ih=qr(aT),rT=v({},ll,{animationName:0,elapsedTime:0,pseudoElement:0}),sT=qr(rT),nT=v({},ll,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),iT=qr(nT),lT=v({},ll,{data:0}),Yg=qr(lT),cT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},oT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},uT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dT(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=uT[s])?!!l[s]:!1}function lh(){return dT}var fT=v({},uo,{key:function(s){if(s.key){var l=cT[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=bd(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?oT[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lh,charCode:function(s){return s.type==="keypress"?bd(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?bd(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),hT=qr(fT),mT=v({},Sd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xg=qr(mT),xT=v({},uo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lh}),pT=qr(xT),gT=v({},ll,{propertyName:0,elapsedTime:0,pseudoElement:0}),vT=qr(gT),yT=v({},Sd,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),jT=qr(yT),bT=v({},ll,{newState:0,oldState:0}),NT=qr(bT),wT=[9,13,27,32],ch=In&&"CompositionEvent"in window,ho=null;In&&"documentMode"in document&&(ho=document.documentMode);var ST=In&&"TextEvent"in window&&!ho,$g=In&&(!ch||ho&&8<ho&&11>=ho),Kg=" ",Qg=!1;function Zg(s,l){switch(s){case"keyup":return wT.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Jg(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Zl=!1;function _T(s,l){switch(s){case"compositionend":return Jg(l);case"keypress":return l.which!==32?null:(Qg=!0,Kg);case"textInput":return s=l.data,s===Kg&&Qg?null:s;default:return null}}function ET(s,l){if(Zl)return s==="compositionend"||!ch&&Zg(s,l)?(s=Gg(),jd=rh=vi=null,Zl=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return $g&&l.locale!=="ko"?null:l.data;default:return null}}var TT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ev(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!TT[s.type]:l==="textarea"}function tv(s,l,c,f){Kl?Ql?Ql.push(f):Ql=[f]:Kl=f,l=mf(l,"onChange"),0<l.length&&(c=new wd("onChange","change",null,c,f),s.push({event:c,listeners:l}))}var mo=null,xo=null;function CT(s){Ly(s,0)}function _d(s){var l=Oe(s);if(Ig(l))return s}function av(s,l){if(s==="change")return l}var rv=!1;if(In){var oh;if(In){var uh="oninput"in document;if(!uh){var sv=document.createElement("div");sv.setAttribute("oninput","return;"),uh=typeof sv.oninput=="function"}oh=uh}else oh=!1;rv=oh&&(!document.documentMode||9<document.documentMode)}function nv(){mo&&(mo.detachEvent("onpropertychange",iv),xo=mo=null)}function iv(s){if(s.propertyName==="value"&&_d(xo)){var l=[];tv(l,xo,s,eh(s)),Hg(CT,l)}}function AT(s,l,c){s==="focusin"?(nv(),mo=l,xo=c,mo.attachEvent("onpropertychange",iv)):s==="focusout"&&nv()}function kT(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return _d(xo)}function DT(s,l){if(s==="click")return _d(l)}function OT(s,l){if(s==="input"||s==="change")return _d(l)}function RT(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var ns=typeof Object.is=="function"?Object.is:RT;function po(s,l){if(ns(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var c=Object.keys(s),f=Object.keys(l);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var x=c[f];if(!St.call(l,x)||!ns(s[x],l[x]))return!1}return!0}function lv(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function cv(s,l){var c=lv(s);s=0;for(var f;c;){if(c.nodeType===3){if(f=s+c.textContent.length,s<=l&&f>=l)return{node:c,offset:l-s};s=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=lv(c)}}function ov(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?ov(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function uv(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var l=vd(s.document);l instanceof s.HTMLIFrameElement;){try{var c=typeof l.contentWindow.location.href=="string"}catch{c=!1}if(c)s=l.contentWindow;else break;l=vd(s.document)}return l}function dh(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}var MT=In&&"documentMode"in document&&11>=document.documentMode,Jl=null,fh=null,go=null,hh=!1;function dv(s,l,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;hh||Jl==null||Jl!==vd(f)||(f=Jl,"selectionStart"in f&&dh(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),go&&po(go,f)||(go=f,f=mf(fh,"onSelect"),0<f.length&&(l=new wd("onSelect","select",null,l,c),s.push({event:l,listeners:f}),l.target=Jl)))}function cl(s,l){var c={};return c[s.toLowerCase()]=l.toLowerCase(),c["Webkit"+s]="webkit"+l,c["Moz"+s]="moz"+l,c}var ec={animationend:cl("Animation","AnimationEnd"),animationiteration:cl("Animation","AnimationIteration"),animationstart:cl("Animation","AnimationStart"),transitionrun:cl("Transition","TransitionRun"),transitionstart:cl("Transition","TransitionStart"),transitioncancel:cl("Transition","TransitionCancel"),transitionend:cl("Transition","TransitionEnd")},mh={},fv={};In&&(fv=document.createElement("div").style,"AnimationEvent"in window||(delete ec.animationend.animation,delete ec.animationiteration.animation,delete ec.animationstart.animation),"TransitionEvent"in window||delete ec.transitionend.transition);function ol(s){if(mh[s])return mh[s];if(!ec[s])return s;var l=ec[s],c;for(c in l)if(l.hasOwnProperty(c)&&c in fv)return mh[s]=l[c];return s}var hv=ol("animationend"),mv=ol("animationiteration"),xv=ol("animationstart"),FT=ol("transitionrun"),IT=ol("transitionstart"),LT=ol("transitioncancel"),pv=ol("transitionend"),gv=new Map,xh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");xh.push("scrollEnd");function Vs(s,l){gv.set(s,l),la(l,[s])}var Ed=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Ns=[],tc=0,ph=0;function Td(){for(var s=tc,l=ph=tc=0;l<s;){var c=Ns[l];Ns[l++]=null;var f=Ns[l];Ns[l++]=null;var x=Ns[l];Ns[l++]=null;var g=Ns[l];if(Ns[l++]=null,f!==null&&x!==null){var S=f.pending;S===null?x.next=x:(x.next=S.next,S.next=x),f.pending=x}g!==0&&vv(c,x,g)}}function Cd(s,l,c,f){Ns[tc++]=s,Ns[tc++]=l,Ns[tc++]=c,Ns[tc++]=f,ph|=f,s.lanes|=f,s=s.alternate,s!==null&&(s.lanes|=f)}function gh(s,l,c,f){return Cd(s,l,c,f),Ad(s)}function ul(s,l){return Cd(s,null,null,l),Ad(s)}function vv(s,l,c){s.lanes|=c;var f=s.alternate;f!==null&&(f.lanes|=c);for(var x=!1,g=s.return;g!==null;)g.childLanes|=c,f=g.alternate,f!==null&&(f.childLanes|=c),g.tag===22&&(s=g.stateNode,s===null||s._visibility&1||(x=!0)),s=g,g=g.return;return s.tag===3?(g=s.stateNode,x&&l!==null&&(x=31-_a(c),s=g.hiddenUpdates,f=s[x],f===null?s[x]=[l]:f.push(l),l.lane=c|536870912),g):null}function Ad(s){if(50<Bo)throw Bo=0,Em=null,Error(n(185));for(var l=s.return;l!==null;)s=l,l=s.return;return s.tag===3?s.stateNode:null}var ac={};function PT(s,l,c,f){this.tag=s,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function is(s,l,c,f){return new PT(s,l,c,f)}function vh(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Ln(s,l){var c=s.alternate;return c===null?(c=is(s.tag,l,s.key,s.mode),c.elementType=s.elementType,c.type=s.type,c.stateNode=s.stateNode,c.alternate=s,s.alternate=c):(c.pendingProps=l,c.type=s.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=s.flags&65011712,c.childLanes=s.childLanes,c.lanes=s.lanes,c.child=s.child,c.memoizedProps=s.memoizedProps,c.memoizedState=s.memoizedState,c.updateQueue=s.updateQueue,l=s.dependencies,c.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},c.sibling=s.sibling,c.index=s.index,c.ref=s.ref,c.refCleanup=s.refCleanup,c}function yv(s,l){s.flags&=65011714;var c=s.alternate;return c===null?(s.childLanes=0,s.lanes=l,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,l=c.dependencies,s.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),s}function kd(s,l,c,f,x,g){var S=0;if(f=s,typeof s=="function")vh(s)&&(S=1);else if(typeof s=="string")S=H4(s,c,J.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case E:return s=is(31,c,l,x),s.elementType=E,s.lanes=g,s;case b:return dl(c.children,x,g,l);case w:S=8,x|=24;break;case T:return s=is(12,c,l,x|2),s.elementType=T,s.lanes=g,s;case z:return s=is(13,c,l,x),s.elementType=z,s.lanes=g,s;case O:return s=is(19,c,l,x),s.elementType=O,s.lanes=g,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case _:S=10;break e;case D:S=9;break e;case R:S=11;break e;case A:S=14;break e;case k:S=16,f=null;break e}S=29,c=Error(n(130,s===null?"null":typeof s,"")),f=null}return l=is(S,c,l,x),l.elementType=s,l.type=f,l.lanes=g,l}function dl(s,l,c,f){return s=is(7,s,f,l),s.lanes=c,s}function yh(s,l,c){return s=is(6,s,null,l),s.lanes=c,s}function jv(s){var l=is(18,null,null,0);return l.stateNode=s,l}function jh(s,l,c){return l=is(4,s.children!==null?s.children:[],s.key,l),l.lanes=c,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}var bv=new WeakMap;function ws(s,l){if(typeof s=="object"&&s!==null){var c=bv.get(s);return c!==void 0?c:(l={value:s,source:l,stack:$e(l)},bv.set(s,l),l)}return{value:s,source:l,stack:$e(l)}}var rc=[],sc=0,Dd=null,vo=0,Ss=[],_s=0,yi=null,cn=1,on="";function Pn(s,l){rc[sc++]=vo,rc[sc++]=Dd,Dd=s,vo=l}function Nv(s,l,c){Ss[_s++]=cn,Ss[_s++]=on,Ss[_s++]=yi,yi=s;var f=cn;s=on;var x=32-_a(f)-1;f&=~(1<<x),c+=1;var g=32-_a(l)+x;if(30<g){var S=x-x%5;g=(f&(1<<S)-1).toString(32),f>>=S,x-=S,cn=1<<32-_a(l)+x|c<<x|f,on=g+s}else cn=1<<g|c<<x|f,on=s}function bh(s){s.return!==null&&(Pn(s,1),Nv(s,1,0))}function Nh(s){for(;s===Dd;)Dd=rc[--sc],rc[sc]=null,vo=rc[--sc],rc[sc]=null;for(;s===yi;)yi=Ss[--_s],Ss[_s]=null,on=Ss[--_s],Ss[_s]=null,cn=Ss[--_s],Ss[_s]=null}function wv(s,l){Ss[_s++]=cn,Ss[_s++]=on,Ss[_s++]=yi,cn=l.id,on=l.overflow,yi=s}var sr=null,Na=null,$t=!1,ji=null,Es=!1,wh=Error(n(519));function bi(s){var l=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw yo(ws(l,s)),wh}function Sv(s){var l=s.stateNode,c=s.type,f=s.memoizedProps;switch(l[U]=s,l[G]=f,c){case"dialog":Gt("cancel",l),Gt("close",l);break;case"iframe":case"object":case"embed":Gt("load",l);break;case"video":case"audio":for(c=0;c<zo.length;c++)Gt(zo[c],l);break;case"source":Gt("error",l);break;case"img":case"image":case"link":Gt("error",l),Gt("load",l);break;case"details":Gt("toggle",l);break;case"input":Gt("invalid",l),Lg(l,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":Gt("invalid",l);break;case"textarea":Gt("invalid",l),Bg(l,f.value,f.defaultValue,f.children)}c=f.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||l.textContent===""+c||f.suppressHydrationWarning===!0||zy(l.textContent,c)?(f.popover!=null&&(Gt("beforetoggle",l),Gt("toggle",l)),f.onScroll!=null&&Gt("scroll",l),f.onScrollEnd!=null&&Gt("scrollend",l),f.onClick!=null&&(l.onclick=Fn),l=!0):l=!1,l||bi(s,!0)}function _v(s){for(sr=s.return;sr;)switch(sr.tag){case 5:case 31:case 13:Es=!1;return;case 27:case 3:Es=!0;return;default:sr=sr.return}}function nc(s){if(s!==sr)return!1;if(!$t)return _v(s),$t=!0,!1;var l=s.tag,c;if((c=l!==3&&l!==27)&&((c=l===5)&&(c=s.type,c=!(c!=="form"&&c!=="button")||zm(s.type,s.memoizedProps)),c=!c),c&&Na&&bi(s),_v(s),l===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));Na=Ky(s)}else if(l===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));Na=Ky(s)}else l===27?(l=Na,Fi(s.type)?(s=Wm,Wm=null,Na=s):Na=l):Na=sr?Cs(s.stateNode.nextSibling):null;return!0}function fl(){Na=sr=null,$t=!1}function Sh(){var s=ji;return s!==null&&($r===null?$r=s:$r.push.apply($r,s),ji=null),s}function yo(s){ji===null?ji=[s]:ji.push(s)}var _h=he(null),hl=null,Bn=null;function Ni(s,l,c){q(_h,l._currentValue),l._currentValue=c}function Un(s){s._currentValue=_h.current,P(_h)}function Eh(s,l,c){for(;s!==null;){var f=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,f!==null&&(f.childLanes|=l)):f!==null&&(f.childLanes&l)!==l&&(f.childLanes|=l),s===c)break;s=s.return}}function Th(s,l,c,f){var x=s.child;for(x!==null&&(x.return=s);x!==null;){var g=x.dependencies;if(g!==null){var S=x.child;g=g.firstContext;e:for(;g!==null;){var F=g;g=x;for(var te=0;te<l.length;te++)if(F.context===l[te]){g.lanes|=c,F=g.alternate,F!==null&&(F.lanes|=c),Eh(g.return,c,s),f||(S=null);break e}g=F.next}}else if(x.tag===18){if(S=x.return,S===null)throw Error(n(341));S.lanes|=c,g=S.alternate,g!==null&&(g.lanes|=c),Eh(S,c,s),S=null}else S=x.child;if(S!==null)S.return=x;else for(S=x;S!==null;){if(S===s){S=null;break}if(x=S.sibling,x!==null){x.return=S.return,S=x;break}S=S.return}x=S}}function ic(s,l,c,f){s=null;for(var x=l,g=!1;x!==null;){if(!g){if((x.flags&524288)!==0)g=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var S=x.alternate;if(S===null)throw Error(n(387));if(S=S.memoizedProps,S!==null){var F=x.type;ns(x.pendingProps.value,S.value)||(s!==null?s.push(F):s=[F])}}else if(x===Fe.current){if(S=x.alternate,S===null)throw Error(n(387));S.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(s!==null?s.push(Wo):s=[Wo])}x=x.return}s!==null&&Th(l,s,c,f),l.flags|=262144}function Od(s){for(s=s.firstContext;s!==null;){if(!ns(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function ml(s){hl=s,Bn=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function nr(s){return Ev(hl,s)}function Rd(s,l){return hl===null&&ml(s),Ev(s,l)}function Ev(s,l){var c=l._currentValue;if(l={context:l,memoizedValue:c,next:null},Bn===null){if(s===null)throw Error(n(308));Bn=l,s.dependencies={lanes:0,firstContext:l},s.flags|=524288}else Bn=Bn.next=l;return c}var BT=typeof AbortController<"u"?AbortController:function(){var s=[],l=this.signal={aborted:!1,addEventListener:function(c,f){s.push(f)}};this.abort=function(){l.aborted=!0,s.forEach(function(c){return c()})}},UT=e.unstable_scheduleCallback,zT=e.unstable_NormalPriority,Ua={$$typeof:_,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ch(){return{controller:new BT,data:new Map,refCount:0}}function jo(s){s.refCount--,s.refCount===0&&UT(zT,function(){s.controller.abort()})}var bo=null,Ah=0,lc=0,cc=null;function VT(s,l){if(bo===null){var c=bo=[];Ah=0,lc=Om(),cc={status:"pending",value:void 0,then:function(f){c.push(f)}}}return Ah++,l.then(Tv,Tv),l}function Tv(){if(--Ah===0&&bo!==null){cc!==null&&(cc.status="fulfilled");var s=bo;bo=null,lc=0,cc=null;for(var l=0;l<s.length;l++)(0,s[l])()}}function HT(s,l){var c=[],f={status:"pending",value:null,reason:null,then:function(x){c.push(x)}};return s.then(function(){f.status="fulfilled",f.value=l;for(var x=0;x<c.length;x++)(0,c[x])(l)},function(x){for(f.status="rejected",f.reason=x,x=0;x<c.length;x++)(0,c[x])(void 0)}),f}var Cv=W.S;W.S=function(s,l){dy=tt(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&VT(s,l),Cv!==null&&Cv(s,l)};var xl=he(null);function kh(){var s=xl.current;return s!==null?s:pa.pooledCache}function Md(s,l){l===null?q(xl,xl.current):q(xl,l.pool)}function Av(){var s=kh();return s===null?null:{parent:Ua._currentValue,pool:s}}var oc=Error(n(460)),Dh=Error(n(474)),Fd=Error(n(542)),Id={then:function(){}};function kv(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Dv(s,l,c){switch(c=s[c],c===void 0?s.push(l):c!==l&&(l.then(Fn,Fn),l=c),l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,Rv(s),s;default:if(typeof l.status=="string")l.then(Fn,Fn);else{if(s=pa,s!==null&&100<s.shellSuspendCounter)throw Error(n(482));s=l,s.status="pending",s.then(function(f){if(l.status==="pending"){var x=l;x.status="fulfilled",x.value=f}},function(f){if(l.status==="pending"){var x=l;x.status="rejected",x.reason=f}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,Rv(s),s}throw gl=l,oc}}function pl(s){try{var l=s._init;return l(s._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(gl=c,oc):c}}var gl=null;function Ov(){if(gl===null)throw Error(n(459));var s=gl;return gl=null,s}function Rv(s){if(s===oc||s===Fd)throw Error(n(483))}var uc=null,No=0;function Ld(s){var l=No;return No+=1,uc===null&&(uc=[]),Dv(uc,s,l)}function wo(s,l){l=l.props.ref,s.ref=l!==void 0?l:null}function Pd(s,l){throw l.$$typeof===y?Error(n(525)):(s=Object.prototype.toString.call(l),Error(n(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s)))}function Mv(s){function l(ie,se){if(s){var ce=ie.deletions;ce===null?(ie.deletions=[se],ie.flags|=16):ce.push(se)}}function c(ie,se){if(!s)return null;for(;se!==null;)l(ie,se),se=se.sibling;return null}function f(ie){for(var se=new Map;ie!==null;)ie.key!==null?se.set(ie.key,ie):se.set(ie.index,ie),ie=ie.sibling;return se}function x(ie,se){return ie=Ln(ie,se),ie.index=0,ie.sibling=null,ie}function g(ie,se,ce){return ie.index=ce,s?(ce=ie.alternate,ce!==null?(ce=ce.index,ce<se?(ie.flags|=67108866,se):ce):(ie.flags|=67108866,se)):(ie.flags|=1048576,se)}function S(ie){return s&&ie.alternate===null&&(ie.flags|=67108866),ie}function F(ie,se,ce,ke){return se===null||se.tag!==6?(se=yh(ce,ie.mode,ke),se.return=ie,se):(se=x(se,ce),se.return=ie,se)}function te(ie,se,ce,ke){var mt=ce.type;return mt===b?_e(ie,se,ce.props.children,ke,ce.key):se!==null&&(se.elementType===mt||typeof mt=="object"&&mt!==null&&mt.$$typeof===k&&pl(mt)===se.type)?(se=x(se,ce.props),wo(se,ce),se.return=ie,se):(se=kd(ce.type,ce.key,ce.props,null,ie.mode,ke),wo(se,ce),se.return=ie,se)}function fe(ie,se,ce,ke){return se===null||se.tag!==4||se.stateNode.containerInfo!==ce.containerInfo||se.stateNode.implementation!==ce.implementation?(se=jh(ce,ie.mode,ke),se.return=ie,se):(se=x(se,ce.children||[]),se.return=ie,se)}function _e(ie,se,ce,ke,mt){return se===null||se.tag!==7?(se=dl(ce,ie.mode,ke,mt),se.return=ie,se):(se=x(se,ce),se.return=ie,se)}function Re(ie,se,ce){if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return se=yh(""+se,ie.mode,ce),se.return=ie,se;if(typeof se=="object"&&se!==null){switch(se.$$typeof){case N:return ce=kd(se.type,se.key,se.props,null,ie.mode,ce),wo(ce,se),ce.return=ie,ce;case j:return se=jh(se,ie.mode,ce),se.return=ie,se;case k:return se=pl(se),Re(ie,se,ce)}if(ge(se)||I(se))return se=dl(se,ie.mode,ce,null),se.return=ie,se;if(typeof se.then=="function")return Re(ie,Ld(se),ce);if(se.$$typeof===_)return Re(ie,Rd(ie,se),ce);Pd(ie,se)}return null}function ve(ie,se,ce,ke){var mt=se!==null?se.key:null;if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return mt!==null?null:F(ie,se,""+ce,ke);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case N:return ce.key===mt?te(ie,se,ce,ke):null;case j:return ce.key===mt?fe(ie,se,ce,ke):null;case k:return ce=pl(ce),ve(ie,se,ce,ke)}if(ge(ce)||I(ce))return mt!==null?null:_e(ie,se,ce,ke,null);if(typeof ce.then=="function")return ve(ie,se,Ld(ce),ke);if(ce.$$typeof===_)return ve(ie,se,Rd(ie,ce),ke);Pd(ie,ce)}return null}function be(ie,se,ce,ke,mt){if(typeof ke=="string"&&ke!==""||typeof ke=="number"||typeof ke=="bigint")return ie=ie.get(ce)||null,F(se,ie,""+ke,mt);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case N:return ie=ie.get(ke.key===null?ce:ke.key)||null,te(se,ie,ke,mt);case j:return ie=ie.get(ke.key===null?ce:ke.key)||null,fe(se,ie,ke,mt);case k:return ke=pl(ke),be(ie,se,ce,ke,mt)}if(ge(ke)||I(ke))return ie=ie.get(ce)||null,_e(se,ie,ke,mt,null);if(typeof ke.then=="function")return be(ie,se,ce,Ld(ke),mt);if(ke.$$typeof===_)return be(ie,se,ce,Rd(se,ke),mt);Pd(se,ke)}return null}function rt(ie,se,ce,ke){for(var mt=null,ra=null,lt=se,Pt=se=0,Xt=null;lt!==null&&Pt<ce.length;Pt++){lt.index>Pt?(Xt=lt,lt=null):Xt=lt.sibling;var sa=ve(ie,lt,ce[Pt],ke);if(sa===null){lt===null&&(lt=Xt);break}s&&lt&&sa.alternate===null&&l(ie,lt),se=g(sa,se,Pt),ra===null?mt=sa:ra.sibling=sa,ra=sa,lt=Xt}if(Pt===ce.length)return c(ie,lt),$t&&Pn(ie,Pt),mt;if(lt===null){for(;Pt<ce.length;Pt++)lt=Re(ie,ce[Pt],ke),lt!==null&&(se=g(lt,se,Pt),ra===null?mt=lt:ra.sibling=lt,ra=lt);return $t&&Pn(ie,Pt),mt}for(lt=f(lt);Pt<ce.length;Pt++)Xt=be(lt,ie,Pt,ce[Pt],ke),Xt!==null&&(s&&Xt.alternate!==null&&lt.delete(Xt.key===null?Pt:Xt.key),se=g(Xt,se,Pt),ra===null?mt=Xt:ra.sibling=Xt,ra=Xt);return s&&lt.forEach(function(Ui){return l(ie,Ui)}),$t&&Pn(ie,Pt),mt}function Nt(ie,se,ce,ke){if(ce==null)throw Error(n(151));for(var mt=null,ra=null,lt=se,Pt=se=0,Xt=null,sa=ce.next();lt!==null&&!sa.done;Pt++,sa=ce.next()){lt.index>Pt?(Xt=lt,lt=null):Xt=lt.sibling;var Ui=ve(ie,lt,sa.value,ke);if(Ui===null){lt===null&&(lt=Xt);break}s&&lt&&Ui.alternate===null&&l(ie,lt),se=g(Ui,se,Pt),ra===null?mt=Ui:ra.sibling=Ui,ra=Ui,lt=Xt}if(sa.done)return c(ie,lt),$t&&Pn(ie,Pt),mt;if(lt===null){for(;!sa.done;Pt++,sa=ce.next())sa=Re(ie,sa.value,ke),sa!==null&&(se=g(sa,se,Pt),ra===null?mt=sa:ra.sibling=sa,ra=sa);return $t&&Pn(ie,Pt),mt}for(lt=f(lt);!sa.done;Pt++,sa=ce.next())sa=be(lt,ie,Pt,sa.value,ke),sa!==null&&(s&&sa.alternate!==null&&lt.delete(sa.key===null?Pt:sa.key),se=g(sa,se,Pt),ra===null?mt=sa:ra.sibling=sa,ra=sa);return s&&lt.forEach(function(eC){return l(ie,eC)}),$t&&Pn(ie,Pt),mt}function xa(ie,se,ce,ke){if(typeof ce=="object"&&ce!==null&&ce.type===b&&ce.key===null&&(ce=ce.props.children),typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case N:e:{for(var mt=ce.key;se!==null;){if(se.key===mt){if(mt=ce.type,mt===b){if(se.tag===7){c(ie,se.sibling),ke=x(se,ce.props.children),ke.return=ie,ie=ke;break e}}else if(se.elementType===mt||typeof mt=="object"&&mt!==null&&mt.$$typeof===k&&pl(mt)===se.type){c(ie,se.sibling),ke=x(se,ce.props),wo(ke,ce),ke.return=ie,ie=ke;break e}c(ie,se);break}else l(ie,se);se=se.sibling}ce.type===b?(ke=dl(ce.props.children,ie.mode,ke,ce.key),ke.return=ie,ie=ke):(ke=kd(ce.type,ce.key,ce.props,null,ie.mode,ke),wo(ke,ce),ke.return=ie,ie=ke)}return S(ie);case j:e:{for(mt=ce.key;se!==null;){if(se.key===mt)if(se.tag===4&&se.stateNode.containerInfo===ce.containerInfo&&se.stateNode.implementation===ce.implementation){c(ie,se.sibling),ke=x(se,ce.children||[]),ke.return=ie,ie=ke;break e}else{c(ie,se);break}else l(ie,se);se=se.sibling}ke=jh(ce,ie.mode,ke),ke.return=ie,ie=ke}return S(ie);case k:return ce=pl(ce),xa(ie,se,ce,ke)}if(ge(ce))return rt(ie,se,ce,ke);if(I(ce)){if(mt=I(ce),typeof mt!="function")throw Error(n(150));return ce=mt.call(ce),Nt(ie,se,ce,ke)}if(typeof ce.then=="function")return xa(ie,se,Ld(ce),ke);if(ce.$$typeof===_)return xa(ie,se,Rd(ie,ce),ke);Pd(ie,ce)}return typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint"?(ce=""+ce,se!==null&&se.tag===6?(c(ie,se.sibling),ke=x(se,ce),ke.return=ie,ie=ke):(c(ie,se),ke=yh(ce,ie.mode,ke),ke.return=ie,ie=ke),S(ie)):c(ie,se)}return function(ie,se,ce,ke){try{No=0;var mt=xa(ie,se,ce,ke);return uc=null,mt}catch(lt){if(lt===oc||lt===Fd)throw lt;var ra=is(29,lt,null,ie.mode);return ra.lanes=ke,ra.return=ie,ra}}}var vl=Mv(!0),Fv=Mv(!1),wi=!1;function Oh(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Rh(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Si(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function _i(s,l,c){var f=s.updateQueue;if(f===null)return null;if(f=f.shared,(ca&2)!==0){var x=f.pending;return x===null?l.next=l:(l.next=x.next,x.next=l),f.pending=l,l=Ad(s),vv(s,null,c),l}return Cd(s,f,l,c),Ad(s)}function So(s,l,c){if(l=l.updateQueue,l!==null&&(l=l.shared,(c&4194048)!==0)){var f=l.lanes;f&=s.pendingLanes,c|=f,l.lanes=c,Rn(s,c)}}function Mh(s,l){var c=s.updateQueue,f=s.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var x=null,g=null;if(c=c.firstBaseUpdate,c!==null){do{var S={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};g===null?x=g=S:g=g.next=S,c=c.next}while(c!==null);g===null?x=g=l:g=g.next=l}else x=g=l;c={baseState:f.baseState,firstBaseUpdate:x,lastBaseUpdate:g,shared:f.shared,callbacks:f.callbacks},s.updateQueue=c;return}s=c.lastBaseUpdate,s===null?c.firstBaseUpdate=l:s.next=l,c.lastBaseUpdate=l}var Fh=!1;function _o(){if(Fh){var s=cc;if(s!==null)throw s}}function Eo(s,l,c,f){Fh=!1;var x=s.updateQueue;wi=!1;var g=x.firstBaseUpdate,S=x.lastBaseUpdate,F=x.shared.pending;if(F!==null){x.shared.pending=null;var te=F,fe=te.next;te.next=null,S===null?g=fe:S.next=fe,S=te;var _e=s.alternate;_e!==null&&(_e=_e.updateQueue,F=_e.lastBaseUpdate,F!==S&&(F===null?_e.firstBaseUpdate=fe:F.next=fe,_e.lastBaseUpdate=te))}if(g!==null){var Re=x.baseState;S=0,_e=fe=te=null,F=g;do{var ve=F.lane&-536870913,be=ve!==F.lane;if(be?(Yt&ve)===ve:(f&ve)===ve){ve!==0&&ve===lc&&(Fh=!0),_e!==null&&(_e=_e.next={lane:0,tag:F.tag,payload:F.payload,callback:null,next:null});e:{var rt=s,Nt=F;ve=l;var xa=c;switch(Nt.tag){case 1:if(rt=Nt.payload,typeof rt=="function"){Re=rt.call(xa,Re,ve);break e}Re=rt;break e;case 3:rt.flags=rt.flags&-65537|128;case 0:if(rt=Nt.payload,ve=typeof rt=="function"?rt.call(xa,Re,ve):rt,ve==null)break e;Re=v({},Re,ve);break e;case 2:wi=!0}}ve=F.callback,ve!==null&&(s.flags|=64,be&&(s.flags|=8192),be=x.callbacks,be===null?x.callbacks=[ve]:be.push(ve))}else be={lane:ve,tag:F.tag,payload:F.payload,callback:F.callback,next:null},_e===null?(fe=_e=be,te=Re):_e=_e.next=be,S|=ve;if(F=F.next,F===null){if(F=x.shared.pending,F===null)break;be=F,F=be.next,be.next=null,x.lastBaseUpdate=be,x.shared.pending=null}}while(!0);_e===null&&(te=Re),x.baseState=te,x.firstBaseUpdate=fe,x.lastBaseUpdate=_e,g===null&&(x.shared.lanes=0),ki|=S,s.lanes=S,s.memoizedState=Re}}function Iv(s,l){if(typeof s!="function")throw Error(n(191,s));s.call(l)}function Lv(s,l){var c=s.callbacks;if(c!==null)for(s.callbacks=null,s=0;s<c.length;s++)Iv(c[s],l)}var dc=he(null),Bd=he(0);function Pv(s,l){s=$n,q(Bd,s),q(dc,l),$n=s|l.baseLanes}function Ih(){q(Bd,$n),q(dc,dc.current)}function Lh(){$n=Bd.current,P(dc),P(Bd)}var ls=he(null),Ts=null;function Ei(s){var l=s.alternate;q(Fa,Fa.current&1),q(ls,s),Ts===null&&(l===null||dc.current!==null||l.memoizedState!==null)&&(Ts=s)}function Ph(s){q(Fa,Fa.current),q(ls,s),Ts===null&&(Ts=s)}function Bv(s){s.tag===22?(q(Fa,Fa.current),q(ls,s),Ts===null&&(Ts=s)):Ti()}function Ti(){q(Fa,Fa.current),q(ls,ls.current)}function cs(s){P(ls),Ts===s&&(Ts=null),P(Fa)}var Fa=he(0);function Ud(s){for(var l=s;l!==null;){if(l.tag===13){var c=l.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||Gm(c)||qm(c)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var zn=0,Ft=null,ha=null,za=null,zd=!1,fc=!1,yl=!1,Vd=0,To=0,hc=null,GT=0;function ka(){throw Error(n(321))}function Bh(s,l){if(l===null)return!1;for(var c=0;c<l.length&&c<s.length;c++)if(!ns(s[c],l[c]))return!1;return!0}function Uh(s,l,c,f,x,g){return zn=g,Ft=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,W.H=s===null||s.memoizedState===null?N1:tm,yl=!1,g=c(f,x),yl=!1,fc&&(g=zv(l,c,f,x)),Uv(s),g}function Uv(s){W.H=ko;var l=ha!==null&&ha.next!==null;if(zn=0,za=ha=Ft=null,zd=!1,To=0,hc=null,l)throw Error(n(300));s===null||Va||(s=s.dependencies,s!==null&&Od(s)&&(Va=!0))}function zv(s,l,c,f){Ft=s;var x=0;do{if(fc&&(hc=null),To=0,fc=!1,25<=x)throw Error(n(301));if(x+=1,za=ha=null,s.updateQueue!=null){var g=s.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}W.H=w1,g=l(c,f)}while(fc);return g}function qT(){var s=W.H,l=s.useState()[0];return l=typeof l.then=="function"?Co(l):l,s=s.useState()[0],(ha!==null?ha.memoizedState:null)!==s&&(Ft.flags|=1024),l}function zh(){var s=Vd!==0;return Vd=0,s}function Vh(s,l,c){l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~c}function Hh(s){if(zd){for(s=s.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}zd=!1}zn=0,za=ha=Ft=null,fc=!1,To=Vd=0,hc=null}function Ar(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return za===null?Ft.memoizedState=za=s:za=za.next=s,za}function Ia(){if(ha===null){var s=Ft.alternate;s=s!==null?s.memoizedState:null}else s=ha.next;var l=za===null?Ft.memoizedState:za.next;if(l!==null)za=l,ha=s;else{if(s===null)throw Ft.alternate===null?Error(n(467)):Error(n(310));ha=s,s={memoizedState:ha.memoizedState,baseState:ha.baseState,baseQueue:ha.baseQueue,queue:ha.queue,next:null},za===null?Ft.memoizedState=za=s:za=za.next=s}return za}function Hd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Co(s){var l=To;return To+=1,hc===null&&(hc=[]),s=Dv(hc,s,l),l=Ft,(za===null?l.memoizedState:za.next)===null&&(l=l.alternate,W.H=l===null||l.memoizedState===null?N1:tm),s}function Gd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Co(s);if(s.$$typeof===_)return nr(s)}throw Error(n(438,String(s)))}function Gh(s){var l=null,c=Ft.updateQueue;if(c!==null&&(l=c.memoCache),l==null){var f=Ft.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(l={data:f.data.map(function(x){return x.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),c===null&&(c=Hd(),Ft.updateQueue=c),c.memoCache=l,c=l.data[l.index],c===void 0)for(c=l.data[l.index]=Array(s),f=0;f<s;f++)c[f]=L;return l.index++,c}function Vn(s,l){return typeof l=="function"?l(s):l}function qd(s){var l=Ia();return qh(l,ha,s)}function qh(s,l,c){var f=s.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=c;var x=s.baseQueue,g=f.pending;if(g!==null){if(x!==null){var S=x.next;x.next=g.next,g.next=S}l.baseQueue=x=g,f.pending=null}if(g=s.baseState,x===null)s.memoizedState=g;else{l=x.next;var F=S=null,te=null,fe=l,_e=!1;do{var Re=fe.lane&-536870913;if(Re!==fe.lane?(Yt&Re)===Re:(zn&Re)===Re){var ve=fe.revertLane;if(ve===0)te!==null&&(te=te.next={lane:0,revertLane:0,gesture:null,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null}),Re===lc&&(_e=!0);else if((zn&ve)===ve){fe=fe.next,ve===lc&&(_e=!0);continue}else Re={lane:0,revertLane:fe.revertLane,gesture:null,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null},te===null?(F=te=Re,S=g):te=te.next=Re,Ft.lanes|=ve,ki|=ve;Re=fe.action,yl&&c(g,Re),g=fe.hasEagerState?fe.eagerState:c(g,Re)}else ve={lane:Re,revertLane:fe.revertLane,gesture:fe.gesture,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null},te===null?(F=te=ve,S=g):te=te.next=ve,Ft.lanes|=Re,ki|=Re;fe=fe.next}while(fe!==null&&fe!==l);if(te===null?S=g:te.next=F,!ns(g,s.memoizedState)&&(Va=!0,_e&&(c=cc,c!==null)))throw c;s.memoizedState=g,s.baseState=S,s.baseQueue=te,f.lastRenderedState=g}return x===null&&(f.lanes=0),[s.memoizedState,f.dispatch]}function Wh(s){var l=Ia(),c=l.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=s;var f=c.dispatch,x=c.pending,g=l.memoizedState;if(x!==null){c.pending=null;var S=x=x.next;do g=s(g,S.action),S=S.next;while(S!==x);ns(g,l.memoizedState)||(Va=!0),l.memoizedState=g,l.baseQueue===null&&(l.baseState=g),c.lastRenderedState=g}return[g,f]}function Vv(s,l,c){var f=Ft,x=Ia(),g=$t;if(g){if(c===void 0)throw Error(n(407));c=c()}else c=l();var S=!ns((ha||x).memoizedState,c);if(S&&(x.memoizedState=c,Va=!0),x=x.queue,$h(qv.bind(null,f,x,s),[s]),x.getSnapshot!==l||S||za!==null&&za.memoizedState.tag&1){if(f.flags|=2048,mc(9,{destroy:void 0},Gv.bind(null,f,x,c,l),null),pa===null)throw Error(n(349));g||(zn&127)!==0||Hv(f,l,c)}return c}function Hv(s,l,c){s.flags|=16384,s={getSnapshot:l,value:c},l=Ft.updateQueue,l===null?(l=Hd(),Ft.updateQueue=l,l.stores=[s]):(c=l.stores,c===null?l.stores=[s]:c.push(s))}function Gv(s,l,c,f){l.value=c,l.getSnapshot=f,Wv(l)&&Yv(s)}function qv(s,l,c){return c(function(){Wv(l)&&Yv(s)})}function Wv(s){var l=s.getSnapshot;s=s.value;try{var c=l();return!ns(s,c)}catch{return!0}}function Yv(s){var l=ul(s,2);l!==null&&Kr(l,s,2)}function Yh(s){var l=Ar();if(typeof s=="function"){var c=s;if(s=c(),yl){Ca(!0);try{c()}finally{Ca(!1)}}}return l.memoizedState=l.baseState=s,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vn,lastRenderedState:s},l}function Xv(s,l,c,f){return s.baseState=c,qh(s,ha,typeof f=="function"?f:Vn)}function WT(s,l,c,f,x){if(Xd(s))throw Error(n(485));if(s=l.action,s!==null){var g={payload:x,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){g.listeners.push(S)}};W.T!==null?c(!0):g.isTransition=!1,f(g),c=l.pending,c===null?(g.next=l.pending=g,$v(l,g)):(g.next=c.next,l.pending=c.next=g)}}function $v(s,l){var c=l.action,f=l.payload,x=s.state;if(l.isTransition){var g=W.T,S={};W.T=S;try{var F=c(x,f),te=W.S;te!==null&&te(S,F),Kv(s,l,F)}catch(fe){Xh(s,l,fe)}finally{g!==null&&S.types!==null&&(g.types=S.types),W.T=g}}else try{g=c(x,f),Kv(s,l,g)}catch(fe){Xh(s,l,fe)}}function Kv(s,l,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(f){Qv(s,l,f)},function(f){return Xh(s,l,f)}):Qv(s,l,c)}function Qv(s,l,c){l.status="fulfilled",l.value=c,Zv(l),s.state=c,l=s.pending,l!==null&&(c=l.next,c===l?s.pending=null:(c=c.next,l.next=c,$v(s,c)))}function Xh(s,l,c){var f=s.pending;if(s.pending=null,f!==null){f=f.next;do l.status="rejected",l.reason=c,Zv(l),l=l.next;while(l!==f)}s.action=null}function Zv(s){s=s.listeners;for(var l=0;l<s.length;l++)(0,s[l])()}function Jv(s,l){return l}function e1(s,l){if($t){var c=pa.formState;if(c!==null){e:{var f=Ft;if($t){if(Na){t:{for(var x=Na,g=Es;x.nodeType!==8;){if(!g){x=null;break t}if(x=Cs(x.nextSibling),x===null){x=null;break t}}g=x.data,x=g==="F!"||g==="F"?x:null}if(x){Na=Cs(x.nextSibling),f=x.data==="F!";break e}}bi(f)}f=!1}f&&(l=c[0])}}return c=Ar(),c.memoizedState=c.baseState=l,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jv,lastRenderedState:l},c.queue=f,c=y1.bind(null,Ft,f),f.dispatch=c,f=Yh(!1),g=em.bind(null,Ft,!1,f.queue),f=Ar(),x={state:l,dispatch:null,action:s,pending:null},f.queue=x,c=WT.bind(null,Ft,x,g,c),x.dispatch=c,f.memoizedState=s,[l,c,!1]}function t1(s){var l=Ia();return a1(l,ha,s)}function a1(s,l,c){if(l=qh(s,l,Jv)[0],s=qd(Vn)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var f=Co(l)}catch(S){throw S===oc?Fd:S}else f=l;l=Ia();var x=l.queue,g=x.dispatch;return c!==l.memoizedState&&(Ft.flags|=2048,mc(9,{destroy:void 0},YT.bind(null,x,c),null)),[f,g,s]}function YT(s,l){s.action=l}function r1(s){var l=Ia(),c=ha;if(c!==null)return a1(l,c,s);Ia(),l=l.memoizedState,c=Ia();var f=c.queue.dispatch;return c.memoizedState=s,[l,f,!1]}function mc(s,l,c,f){return s={tag:s,create:c,deps:f,inst:l,next:null},l=Ft.updateQueue,l===null&&(l=Hd(),Ft.updateQueue=l),c=l.lastEffect,c===null?l.lastEffect=s.next=s:(f=c.next,c.next=s,s.next=f,l.lastEffect=s),s}function s1(){return Ia().memoizedState}function Wd(s,l,c,f){var x=Ar();Ft.flags|=s,x.memoizedState=mc(1|l,{destroy:void 0},c,f===void 0?null:f)}function Yd(s,l,c,f){var x=Ia();f=f===void 0?null:f;var g=x.memoizedState.inst;ha!==null&&f!==null&&Bh(f,ha.memoizedState.deps)?x.memoizedState=mc(l,g,c,f):(Ft.flags|=s,x.memoizedState=mc(1|l,g,c,f))}function n1(s,l){Wd(8390656,8,s,l)}function $h(s,l){Yd(2048,8,s,l)}function XT(s){Ft.flags|=4;var l=Ft.updateQueue;if(l===null)l=Hd(),Ft.updateQueue=l,l.events=[s];else{var c=l.events;c===null?l.events=[s]:c.push(s)}}function i1(s){var l=Ia().memoizedState;return XT({ref:l,nextImpl:s}),function(){if((ca&2)!==0)throw Error(n(440));return l.impl.apply(void 0,arguments)}}function l1(s,l){return Yd(4,2,s,l)}function c1(s,l){return Yd(4,4,s,l)}function o1(s,l){if(typeof l=="function"){s=s();var c=l(s);return function(){typeof c=="function"?c():l(null)}}if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function u1(s,l,c){c=c!=null?c.concat([s]):null,Yd(4,4,o1.bind(null,l,s),c)}function Kh(){}function d1(s,l){var c=Ia();l=l===void 0?null:l;var f=c.memoizedState;return l!==null&&Bh(l,f[1])?f[0]:(c.memoizedState=[s,l],s)}function f1(s,l){var c=Ia();l=l===void 0?null:l;var f=c.memoizedState;if(l!==null&&Bh(l,f[1]))return f[0];if(f=s(),yl){Ca(!0);try{s()}finally{Ca(!1)}}return c.memoizedState=[f,l],f}function Qh(s,l,c){return c===void 0||(zn&1073741824)!==0&&(Yt&261930)===0?s.memoizedState=l:(s.memoizedState=c,s=hy(),Ft.lanes|=s,ki|=s,c)}function h1(s,l,c,f){return ns(c,l)?c:dc.current!==null?(s=Qh(s,c,f),ns(s,l)||(Va=!0),s):(zn&42)===0||(zn&1073741824)!==0&&(Yt&261930)===0?(Va=!0,s.memoizedState=c):(s=hy(),Ft.lanes|=s,ki|=s,l)}function m1(s,l,c,f,x){var g=ee.p;ee.p=g!==0&&8>g?g:8;var S=W.T,F={};W.T=F,em(s,!1,l,c);try{var te=x(),fe=W.S;if(fe!==null&&fe(F,te),te!==null&&typeof te=="object"&&typeof te.then=="function"){var _e=HT(te,f);Ao(s,l,_e,ds(s))}else Ao(s,l,f,ds(s))}catch(Re){Ao(s,l,{then:function(){},status:"rejected",reason:Re},ds())}finally{ee.p=g,S!==null&&F.types!==null&&(S.types=F.types),W.T=S}}function $T(){}function Zh(s,l,c,f){if(s.tag!==5)throw Error(n(476));var x=x1(s).queue;m1(s,x,l,je,c===null?$T:function(){return p1(s),c(f)})}function x1(s){var l=s.memoizedState;if(l!==null)return l;l={memoizedState:je,baseState:je,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vn,lastRenderedState:je},next:null};var c={};return l.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vn,lastRenderedState:c},next:null},s.memoizedState=l,s=s.alternate,s!==null&&(s.memoizedState=l),l}function p1(s){var l=x1(s);l.next===null&&(l=s.alternate.memoizedState),Ao(s,l.next.queue,{},ds())}function Jh(){return nr(Wo)}function g1(){return Ia().memoizedState}function v1(){return Ia().memoizedState}function KT(s){for(var l=s.return;l!==null;){switch(l.tag){case 24:case 3:var c=ds();s=Si(c);var f=_i(l,s,c);f!==null&&(Kr(f,l,c),So(f,l,c)),l={cache:Ch()},s.payload=l;return}l=l.return}}function QT(s,l,c){var f=ds();c={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Xd(s)?j1(l,c):(c=gh(s,l,c,f),c!==null&&(Kr(c,s,f),b1(c,l,f)))}function y1(s,l,c){var f=ds();Ao(s,l,c,f)}function Ao(s,l,c,f){var x={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Xd(s))j1(l,x);else{var g=s.alternate;if(s.lanes===0&&(g===null||g.lanes===0)&&(g=l.lastRenderedReducer,g!==null))try{var S=l.lastRenderedState,F=g(S,c);if(x.hasEagerState=!0,x.eagerState=F,ns(F,S))return Cd(s,l,x,0),pa===null&&Td(),!1}catch{}if(c=gh(s,l,x,f),c!==null)return Kr(c,s,f),b1(c,l,f),!0}return!1}function em(s,l,c,f){if(f={lane:2,revertLane:Om(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Xd(s)){if(l)throw Error(n(479))}else l=gh(s,c,f,2),l!==null&&Kr(l,s,2)}function Xd(s){var l=s.alternate;return s===Ft||l!==null&&l===Ft}function j1(s,l){fc=zd=!0;var c=s.pending;c===null?l.next=l:(l.next=c.next,c.next=l),s.pending=l}function b1(s,l,c){if((c&4194048)!==0){var f=l.lanes;f&=s.pendingLanes,c|=f,l.lanes=c,Rn(s,c)}}var ko={readContext:nr,use:Gd,useCallback:ka,useContext:ka,useEffect:ka,useImperativeHandle:ka,useLayoutEffect:ka,useInsertionEffect:ka,useMemo:ka,useReducer:ka,useRef:ka,useState:ka,useDebugValue:ka,useDeferredValue:ka,useTransition:ka,useSyncExternalStore:ka,useId:ka,useHostTransitionStatus:ka,useFormState:ka,useActionState:ka,useOptimistic:ka,useMemoCache:ka,useCacheRefresh:ka};ko.useEffectEvent=ka;var N1={readContext:nr,use:Gd,useCallback:function(s,l){return Ar().memoizedState=[s,l===void 0?null:l],s},useContext:nr,useEffect:n1,useImperativeHandle:function(s,l,c){c=c!=null?c.concat([s]):null,Wd(4194308,4,o1.bind(null,l,s),c)},useLayoutEffect:function(s,l){return Wd(4194308,4,s,l)},useInsertionEffect:function(s,l){Wd(4,2,s,l)},useMemo:function(s,l){var c=Ar();l=l===void 0?null:l;var f=s();if(yl){Ca(!0);try{s()}finally{Ca(!1)}}return c.memoizedState=[f,l],f},useReducer:function(s,l,c){var f=Ar();if(c!==void 0){var x=c(l);if(yl){Ca(!0);try{c(l)}finally{Ca(!1)}}}else x=l;return f.memoizedState=f.baseState=x,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:x},f.queue=s,s=s.dispatch=QT.bind(null,Ft,s),[f.memoizedState,s]},useRef:function(s){var l=Ar();return s={current:s},l.memoizedState=s},useState:function(s){s=Yh(s);var l=s.queue,c=y1.bind(null,Ft,l);return l.dispatch=c,[s.memoizedState,c]},useDebugValue:Kh,useDeferredValue:function(s,l){var c=Ar();return Qh(c,s,l)},useTransition:function(){var s=Yh(!1);return s=m1.bind(null,Ft,s.queue,!0,!1),Ar().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,l,c){var f=Ft,x=Ar();if($t){if(c===void 0)throw Error(n(407));c=c()}else{if(c=l(),pa===null)throw Error(n(349));(Yt&127)!==0||Hv(f,l,c)}x.memoizedState=c;var g={value:c,getSnapshot:l};return x.queue=g,n1(qv.bind(null,f,g,s),[s]),f.flags|=2048,mc(9,{destroy:void 0},Gv.bind(null,f,g,c,l),null),c},useId:function(){var s=Ar(),l=pa.identifierPrefix;if($t){var c=on,f=cn;c=(f&~(1<<32-_a(f)-1)).toString(32)+c,l="_"+l+"R_"+c,c=Vd++,0<c&&(l+="H"+c.toString(32)),l+="_"}else c=GT++,l="_"+l+"r_"+c.toString(32)+"_";return s.memoizedState=l},useHostTransitionStatus:Jh,useFormState:e1,useActionState:e1,useOptimistic:function(s){var l=Ar();l.memoizedState=l.baseState=s;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=c,l=em.bind(null,Ft,!0,c),c.dispatch=l,[s,l]},useMemoCache:Gh,useCacheRefresh:function(){return Ar().memoizedState=KT.bind(null,Ft)},useEffectEvent:function(s){var l=Ar(),c={impl:s};return l.memoizedState=c,function(){if((ca&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}},tm={readContext:nr,use:Gd,useCallback:d1,useContext:nr,useEffect:$h,useImperativeHandle:u1,useInsertionEffect:l1,useLayoutEffect:c1,useMemo:f1,useReducer:qd,useRef:s1,useState:function(){return qd(Vn)},useDebugValue:Kh,useDeferredValue:function(s,l){var c=Ia();return h1(c,ha.memoizedState,s,l)},useTransition:function(){var s=qd(Vn)[0],l=Ia().memoizedState;return[typeof s=="boolean"?s:Co(s),l]},useSyncExternalStore:Vv,useId:g1,useHostTransitionStatus:Jh,useFormState:t1,useActionState:t1,useOptimistic:function(s,l){var c=Ia();return Xv(c,ha,s,l)},useMemoCache:Gh,useCacheRefresh:v1};tm.useEffectEvent=i1;var w1={readContext:nr,use:Gd,useCallback:d1,useContext:nr,useEffect:$h,useImperativeHandle:u1,useInsertionEffect:l1,useLayoutEffect:c1,useMemo:f1,useReducer:Wh,useRef:s1,useState:function(){return Wh(Vn)},useDebugValue:Kh,useDeferredValue:function(s,l){var c=Ia();return ha===null?Qh(c,s,l):h1(c,ha.memoizedState,s,l)},useTransition:function(){var s=Wh(Vn)[0],l=Ia().memoizedState;return[typeof s=="boolean"?s:Co(s),l]},useSyncExternalStore:Vv,useId:g1,useHostTransitionStatus:Jh,useFormState:r1,useActionState:r1,useOptimistic:function(s,l){var c=Ia();return ha!==null?Xv(c,ha,s,l):(c.baseState=s,[s,c.queue.dispatch])},useMemoCache:Gh,useCacheRefresh:v1};w1.useEffectEvent=i1;function am(s,l,c,f){l=s.memoizedState,c=c(f,l),c=c==null?l:v({},l,c),s.memoizedState=c,s.lanes===0&&(s.updateQueue.baseState=c)}var rm={enqueueSetState:function(s,l,c){s=s._reactInternals;var f=ds(),x=Si(f);x.payload=l,c!=null&&(x.callback=c),l=_i(s,x,f),l!==null&&(Kr(l,s,f),So(l,s,f))},enqueueReplaceState:function(s,l,c){s=s._reactInternals;var f=ds(),x=Si(f);x.tag=1,x.payload=l,c!=null&&(x.callback=c),l=_i(s,x,f),l!==null&&(Kr(l,s,f),So(l,s,f))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var c=ds(),f=Si(c);f.tag=2,l!=null&&(f.callback=l),l=_i(s,f,c),l!==null&&(Kr(l,s,c),So(l,s,c))}};function S1(s,l,c,f,x,g,S){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(f,g,S):l.prototype&&l.prototype.isPureReactComponent?!po(c,f)||!po(x,g):!0}function _1(s,l,c,f){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(c,f),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(c,f),l.state!==s&&rm.enqueueReplaceState(l,l.state,null)}function jl(s,l){var c=l;if("ref"in l){c={};for(var f in l)f!=="ref"&&(c[f]=l[f])}if(s=s.defaultProps){c===l&&(c=v({},c));for(var x in s)c[x]===void 0&&(c[x]=s[x])}return c}function E1(s){Ed(s)}function T1(s){console.error(s)}function C1(s){Ed(s)}function $d(s,l){try{var c=s.onUncaughtError;c(l.value,{componentStack:l.stack})}catch(f){setTimeout(function(){throw f})}}function A1(s,l,c){try{var f=s.onCaughtError;f(c.value,{componentStack:c.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function sm(s,l,c){return c=Si(c),c.tag=3,c.payload={element:null},c.callback=function(){$d(s,l)},c}function k1(s){return s=Si(s),s.tag=3,s}function D1(s,l,c,f){var x=c.type.getDerivedStateFromError;if(typeof x=="function"){var g=f.value;s.payload=function(){return x(g)},s.callback=function(){A1(l,c,f)}}var S=c.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(s.callback=function(){A1(l,c,f),typeof x!="function"&&(Di===null?Di=new Set([this]):Di.add(this));var F=f.stack;this.componentDidCatch(f.value,{componentStack:F!==null?F:""})})}function ZT(s,l,c,f,x){if(c.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(l=c.alternate,l!==null&&ic(l,c,x,!0),c=ls.current,c!==null){switch(c.tag){case 31:case 13:return Ts===null?cf():c.alternate===null&&Da===0&&(Da=3),c.flags&=-257,c.flags|=65536,c.lanes=x,f===Id?c.flags|=16384:(l=c.updateQueue,l===null?c.updateQueue=new Set([f]):l.add(f),Am(s,f,x)),!1;case 22:return c.flags|=65536,f===Id?c.flags|=16384:(l=c.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([f])},c.updateQueue=l):(c=l.retryQueue,c===null?l.retryQueue=new Set([f]):c.add(f)),Am(s,f,x)),!1}throw Error(n(435,c.tag))}return Am(s,f,x),cf(),!1}if($t)return l=ls.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=x,f!==wh&&(s=Error(n(422),{cause:f}),yo(ws(s,c)))):(f!==wh&&(l=Error(n(423),{cause:f}),yo(ws(l,c))),s=s.current.alternate,s.flags|=65536,x&=-x,s.lanes|=x,f=ws(f,c),x=sm(s.stateNode,f,x),Mh(s,x),Da!==4&&(Da=2)),!1;var g=Error(n(520),{cause:f});if(g=ws(g,c),Po===null?Po=[g]:Po.push(g),Da!==4&&(Da=2),l===null)return!0;f=ws(f,c),c=l;do{switch(c.tag){case 3:return c.flags|=65536,s=x&-x,c.lanes|=s,s=sm(c.stateNode,f,s),Mh(c,s),!1;case 1:if(l=c.type,g=c.stateNode,(c.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Di===null||!Di.has(g))))return c.flags|=65536,x&=-x,c.lanes|=x,x=k1(x),D1(x,s,c,f),Mh(c,x),!1}c=c.return}while(c!==null);return!1}var nm=Error(n(461)),Va=!1;function ir(s,l,c,f){l.child=s===null?Fv(l,null,c,f):vl(l,s.child,c,f)}function O1(s,l,c,f,x){c=c.render;var g=l.ref;if("ref"in f){var S={};for(var F in f)F!=="ref"&&(S[F]=f[F])}else S=f;return ml(l),f=Uh(s,l,c,S,g,x),F=zh(),s!==null&&!Va?(Vh(s,l,x),Hn(s,l,x)):($t&&F&&bh(l),l.flags|=1,ir(s,l,f,x),l.child)}function R1(s,l,c,f,x){if(s===null){var g=c.type;return typeof g=="function"&&!vh(g)&&g.defaultProps===void 0&&c.compare===null?(l.tag=15,l.type=g,M1(s,l,g,f,x)):(s=kd(c.type,null,f,l,l.mode,x),s.ref=l.ref,s.return=l,l.child=s)}if(g=s.child,!hm(s,x)){var S=g.memoizedProps;if(c=c.compare,c=c!==null?c:po,c(S,f)&&s.ref===l.ref)return Hn(s,l,x)}return l.flags|=1,s=Ln(g,f),s.ref=l.ref,s.return=l,l.child=s}function M1(s,l,c,f,x){if(s!==null){var g=s.memoizedProps;if(po(g,f)&&s.ref===l.ref)if(Va=!1,l.pendingProps=f=g,hm(s,x))(s.flags&131072)!==0&&(Va=!0);else return l.lanes=s.lanes,Hn(s,l,x)}return im(s,l,c,f,x)}function F1(s,l,c,f){var x=f.children,g=s!==null?s.memoizedState:null;if(s===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((l.flags&128)!==0){if(g=g!==null?g.baseLanes|c:c,s!==null){for(f=l.child=s.child,x=0;f!==null;)x=x|f.lanes|f.childLanes,f=f.sibling;f=x&~g}else f=0,l.child=null;return I1(s,l,g,c,f)}if((c&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},s!==null&&Md(l,g!==null?g.cachePool:null),g!==null?Pv(l,g):Ih(),Bv(l);else return f=l.lanes=536870912,I1(s,l,g!==null?g.baseLanes|c:c,c,f)}else g!==null?(Md(l,g.cachePool),Pv(l,g),Ti(),l.memoizedState=null):(s!==null&&Md(l,null),Ih(),Ti());return ir(s,l,x,c),l.child}function Do(s,l){return s!==null&&s.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function I1(s,l,c,f,x){var g=kh();return g=g===null?null:{parent:Ua._currentValue,pool:g},l.memoizedState={baseLanes:c,cachePool:g},s!==null&&Md(l,null),Ih(),Bv(l),s!==null&&ic(s,l,f,!0),l.childLanes=x,null}function Kd(s,l){return l=Zd({mode:l.mode,children:l.children},s.mode),l.ref=s.ref,s.child=l,l.return=s,l}function L1(s,l,c){return vl(l,s.child,null,c),s=Kd(l,l.pendingProps),s.flags|=2,cs(l),l.memoizedState=null,s}function JT(s,l,c){var f=l.pendingProps,x=(l.flags&128)!==0;if(l.flags&=-129,s===null){if($t){if(f.mode==="hidden")return s=Kd(l,f),l.lanes=536870912,Do(null,s);if(Ph(l),(s=Na)?(s=$y(s,Es),s=s!==null&&s.data==="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:yi!==null?{id:cn,overflow:on}:null,retryLane:536870912,hydrationErrors:null},c=jv(s),c.return=l,l.child=c,sr=l,Na=null)):s=null,s===null)throw bi(l);return l.lanes=536870912,null}return Kd(l,f)}var g=s.memoizedState;if(g!==null){var S=g.dehydrated;if(Ph(l),x)if(l.flags&256)l.flags&=-257,l=L1(s,l,c);else if(l.memoizedState!==null)l.child=s.child,l.flags|=128,l=null;else throw Error(n(558));else if(Va||ic(s,l,c,!1),x=(c&s.childLanes)!==0,Va||x){if(f=pa,f!==null&&(S=Yl(f,c),S!==0&&S!==g.retryLane))throw g.retryLane=S,ul(s,S),Kr(f,s,S),nm;cf(),l=L1(s,l,c)}else s=g.treeContext,Na=Cs(S.nextSibling),sr=l,$t=!0,ji=null,Es=!1,s!==null&&wv(l,s),l=Kd(l,f),l.flags|=4096;return l}return s=Ln(s.child,{mode:f.mode,children:f.children}),s.ref=l.ref,l.child=s,s.return=l,s}function Qd(s,l){var c=l.ref;if(c===null)s!==null&&s.ref!==null&&(l.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(s===null||s.ref!==c)&&(l.flags|=4194816)}}function im(s,l,c,f,x){return ml(l),c=Uh(s,l,c,f,void 0,x),f=zh(),s!==null&&!Va?(Vh(s,l,x),Hn(s,l,x)):($t&&f&&bh(l),l.flags|=1,ir(s,l,c,x),l.child)}function P1(s,l,c,f,x,g){return ml(l),l.updateQueue=null,c=zv(l,f,c,x),Uv(s),f=zh(),s!==null&&!Va?(Vh(s,l,g),Hn(s,l,g)):($t&&f&&bh(l),l.flags|=1,ir(s,l,c,g),l.child)}function B1(s,l,c,f,x){if(ml(l),l.stateNode===null){var g=ac,S=c.contextType;typeof S=="object"&&S!==null&&(g=nr(S)),g=new c(f,g),l.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=rm,l.stateNode=g,g._reactInternals=l,g=l.stateNode,g.props=f,g.state=l.memoizedState,g.refs={},Oh(l),S=c.contextType,g.context=typeof S=="object"&&S!==null?nr(S):ac,g.state=l.memoizedState,S=c.getDerivedStateFromProps,typeof S=="function"&&(am(l,c,S,f),g.state=l.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(S=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),S!==g.state&&rm.enqueueReplaceState(g,g.state,null),Eo(l,f,g,x),_o(),g.state=l.memoizedState),typeof g.componentDidMount=="function"&&(l.flags|=4194308),f=!0}else if(s===null){g=l.stateNode;var F=l.memoizedProps,te=jl(c,F);g.props=te;var fe=g.context,_e=c.contextType;S=ac,typeof _e=="object"&&_e!==null&&(S=nr(_e));var Re=c.getDerivedStateFromProps;_e=typeof Re=="function"||typeof g.getSnapshotBeforeUpdate=="function",F=l.pendingProps!==F,_e||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(F||fe!==S)&&_1(l,g,f,S),wi=!1;var ve=l.memoizedState;g.state=ve,Eo(l,f,g,x),_o(),fe=l.memoizedState,F||ve!==fe||wi?(typeof Re=="function"&&(am(l,c,Re,f),fe=l.memoizedState),(te=wi||S1(l,c,te,f,ve,fe,S))?(_e||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(l.flags|=4194308)):(typeof g.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=f,l.memoizedState=fe),g.props=f,g.state=fe,g.context=S,f=te):(typeof g.componentDidMount=="function"&&(l.flags|=4194308),f=!1)}else{g=l.stateNode,Rh(s,l),S=l.memoizedProps,_e=jl(c,S),g.props=_e,Re=l.pendingProps,ve=g.context,fe=c.contextType,te=ac,typeof fe=="object"&&fe!==null&&(te=nr(fe)),F=c.getDerivedStateFromProps,(fe=typeof F=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(S!==Re||ve!==te)&&_1(l,g,f,te),wi=!1,ve=l.memoizedState,g.state=ve,Eo(l,f,g,x),_o();var be=l.memoizedState;S!==Re||ve!==be||wi||s!==null&&s.dependencies!==null&&Od(s.dependencies)?(typeof F=="function"&&(am(l,c,F,f),be=l.memoizedState),(_e=wi||S1(l,c,_e,f,ve,be,te)||s!==null&&s.dependencies!==null&&Od(s.dependencies))?(fe||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(f,be,te),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(f,be,te)),typeof g.componentDidUpdate=="function"&&(l.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof g.componentDidUpdate!="function"||S===s.memoizedProps&&ve===s.memoizedState||(l.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||S===s.memoizedProps&&ve===s.memoizedState||(l.flags|=1024),l.memoizedProps=f,l.memoizedState=be),g.props=f,g.state=be,g.context=te,f=_e):(typeof g.componentDidUpdate!="function"||S===s.memoizedProps&&ve===s.memoizedState||(l.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||S===s.memoizedProps&&ve===s.memoizedState||(l.flags|=1024),f=!1)}return g=f,Qd(s,l),f=(l.flags&128)!==0,g||f?(g=l.stateNode,c=f&&typeof c.getDerivedStateFromError!="function"?null:g.render(),l.flags|=1,s!==null&&f?(l.child=vl(l,s.child,null,x),l.child=vl(l,null,c,x)):ir(s,l,c,x),l.memoizedState=g.state,s=l.child):s=Hn(s,l,x),s}function U1(s,l,c,f){return fl(),l.flags|=256,ir(s,l,c,f),l.child}var lm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function cm(s){return{baseLanes:s,cachePool:Av()}}function om(s,l,c){return s=s!==null?s.childLanes&~c:0,l&&(s|=us),s}function z1(s,l,c){var f=l.pendingProps,x=!1,g=(l.flags&128)!==0,S;if((S=g)||(S=s!==null&&s.memoizedState===null?!1:(Fa.current&2)!==0),S&&(x=!0,l.flags&=-129),S=(l.flags&32)!==0,l.flags&=-33,s===null){if($t){if(x?Ei(l):Ti(),(s=Na)?(s=$y(s,Es),s=s!==null&&s.data!=="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:yi!==null?{id:cn,overflow:on}:null,retryLane:536870912,hydrationErrors:null},c=jv(s),c.return=l,l.child=c,sr=l,Na=null)):s=null,s===null)throw bi(l);return qm(s)?l.lanes=32:l.lanes=536870912,null}var F=f.children;return f=f.fallback,x?(Ti(),x=l.mode,F=Zd({mode:"hidden",children:F},x),f=dl(f,x,c,null),F.return=l,f.return=l,F.sibling=f,l.child=F,f=l.child,f.memoizedState=cm(c),f.childLanes=om(s,S,c),l.memoizedState=lm,Do(null,f)):(Ei(l),um(l,F))}var te=s.memoizedState;if(te!==null&&(F=te.dehydrated,F!==null)){if(g)l.flags&256?(Ei(l),l.flags&=-257,l=dm(s,l,c)):l.memoizedState!==null?(Ti(),l.child=s.child,l.flags|=128,l=null):(Ti(),F=f.fallback,x=l.mode,f=Zd({mode:"visible",children:f.children},x),F=dl(F,x,c,null),F.flags|=2,f.return=l,F.return=l,f.sibling=F,l.child=f,vl(l,s.child,null,c),f=l.child,f.memoizedState=cm(c),f.childLanes=om(s,S,c),l.memoizedState=lm,l=Do(null,f));else if(Ei(l),qm(F)){if(S=F.nextSibling&&F.nextSibling.dataset,S)var fe=S.dgst;S=fe,f=Error(n(419)),f.stack="",f.digest=S,yo({value:f,source:null,stack:null}),l=dm(s,l,c)}else if(Va||ic(s,l,c,!1),S=(c&s.childLanes)!==0,Va||S){if(S=pa,S!==null&&(f=Yl(S,c),f!==0&&f!==te.retryLane))throw te.retryLane=f,ul(s,f),Kr(S,s,f),nm;Gm(F)||cf(),l=dm(s,l,c)}else Gm(F)?(l.flags|=192,l.child=s.child,l=null):(s=te.treeContext,Na=Cs(F.nextSibling),sr=l,$t=!0,ji=null,Es=!1,s!==null&&wv(l,s),l=um(l,f.children),l.flags|=4096);return l}return x?(Ti(),F=f.fallback,x=l.mode,te=s.child,fe=te.sibling,f=Ln(te,{mode:"hidden",children:f.children}),f.subtreeFlags=te.subtreeFlags&65011712,fe!==null?F=Ln(fe,F):(F=dl(F,x,c,null),F.flags|=2),F.return=l,f.return=l,f.sibling=F,l.child=f,Do(null,f),f=l.child,F=s.child.memoizedState,F===null?F=cm(c):(x=F.cachePool,x!==null?(te=Ua._currentValue,x=x.parent!==te?{parent:te,pool:te}:x):x=Av(),F={baseLanes:F.baseLanes|c,cachePool:x}),f.memoizedState=F,f.childLanes=om(s,S,c),l.memoizedState=lm,Do(s.child,f)):(Ei(l),c=s.child,s=c.sibling,c=Ln(c,{mode:"visible",children:f.children}),c.return=l,c.sibling=null,s!==null&&(S=l.deletions,S===null?(l.deletions=[s],l.flags|=16):S.push(s)),l.child=c,l.memoizedState=null,c)}function um(s,l){return l=Zd({mode:"visible",children:l},s.mode),l.return=s,s.child=l}function Zd(s,l){return s=is(22,s,null,l),s.lanes=0,s}function dm(s,l,c){return vl(l,s.child,null,c),s=um(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function V1(s,l,c){s.lanes|=l;var f=s.alternate;f!==null&&(f.lanes|=l),Eh(s.return,l,c)}function fm(s,l,c,f,x,g){var S=s.memoizedState;S===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:x,treeForkCount:g}:(S.isBackwards=l,S.rendering=null,S.renderingStartTime=0,S.last=f,S.tail=c,S.tailMode=x,S.treeForkCount=g)}function H1(s,l,c){var f=l.pendingProps,x=f.revealOrder,g=f.tail;f=f.children;var S=Fa.current,F=(S&2)!==0;if(F?(S=S&1|2,l.flags|=128):S&=1,q(Fa,S),ir(s,l,f,c),f=$t?vo:0,!F&&s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&V1(s,c,l);else if(s.tag===19)V1(s,c,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(x){case"forwards":for(c=l.child,x=null;c!==null;)s=c.alternate,s!==null&&Ud(s)===null&&(x=c),c=c.sibling;c=x,c===null?(x=l.child,l.child=null):(x=c.sibling,c.sibling=null),fm(l,!1,x,c,g,f);break;case"backwards":case"unstable_legacy-backwards":for(c=null,x=l.child,l.child=null;x!==null;){if(s=x.alternate,s!==null&&Ud(s)===null){l.child=x;break}s=x.sibling,x.sibling=c,c=x,x=s}fm(l,!0,c,null,g,f);break;case"together":fm(l,!1,null,null,void 0,f);break;default:l.memoizedState=null}return l.child}function Hn(s,l,c){if(s!==null&&(l.dependencies=s.dependencies),ki|=l.lanes,(c&l.childLanes)===0)if(s!==null){if(ic(s,l,c,!1),(c&l.childLanes)===0)return null}else return null;if(s!==null&&l.child!==s.child)throw Error(n(153));if(l.child!==null){for(s=l.child,c=Ln(s,s.pendingProps),l.child=c,c.return=l;s.sibling!==null;)s=s.sibling,c=c.sibling=Ln(s,s.pendingProps),c.return=l;c.sibling=null}return l.child}function hm(s,l){return(s.lanes&l)!==0?!0:(s=s.dependencies,!!(s!==null&&Od(s)))}function e4(s,l,c){switch(l.tag){case 3:Ae(l,l.stateNode.containerInfo),Ni(l,Ua,s.memoizedState.cache),fl();break;case 27:case 5:we(l);break;case 4:Ae(l,l.stateNode.containerInfo);break;case 10:Ni(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,Ph(l),null;break;case 13:var f=l.memoizedState;if(f!==null)return f.dehydrated!==null?(Ei(l),l.flags|=128,null):(c&l.child.childLanes)!==0?z1(s,l,c):(Ei(l),s=Hn(s,l,c),s!==null?s.sibling:null);Ei(l);break;case 19:var x=(s.flags&128)!==0;if(f=(c&l.childLanes)!==0,f||(ic(s,l,c,!1),f=(c&l.childLanes)!==0),x){if(f)return H1(s,l,c);l.flags|=128}if(x=l.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),q(Fa,Fa.current),f)break;return null;case 22:return l.lanes=0,F1(s,l,c,l.pendingProps);case 24:Ni(l,Ua,s.memoizedState.cache)}return Hn(s,l,c)}function G1(s,l,c){if(s!==null)if(s.memoizedProps!==l.pendingProps)Va=!0;else{if(!hm(s,c)&&(l.flags&128)===0)return Va=!1,e4(s,l,c);Va=(s.flags&131072)!==0}else Va=!1,$t&&(l.flags&1048576)!==0&&Nv(l,vo,l.index);switch(l.lanes=0,l.tag){case 16:e:{var f=l.pendingProps;if(s=pl(l.elementType),l.type=s,typeof s=="function")vh(s)?(f=jl(s,f),l.tag=1,l=B1(null,l,s,f,c)):(l.tag=0,l=im(null,l,s,f,c));else{if(s!=null){var x=s.$$typeof;if(x===R){l.tag=11,l=O1(null,l,s,f,c);break e}else if(x===A){l.tag=14,l=R1(null,l,s,f,c);break e}}throw l=ne(s)||s,Error(n(306,l,""))}}return l;case 0:return im(s,l,l.type,l.pendingProps,c);case 1:return f=l.type,x=jl(f,l.pendingProps),B1(s,l,f,x,c);case 3:e:{if(Ae(l,l.stateNode.containerInfo),s===null)throw Error(n(387));f=l.pendingProps;var g=l.memoizedState;x=g.element,Rh(s,l),Eo(l,f,null,c);var S=l.memoizedState;if(f=S.cache,Ni(l,Ua,f),f!==g.cache&&Th(l,[Ua],c,!0),_o(),f=S.element,g.isDehydrated)if(g={element:f,isDehydrated:!1,cache:S.cache},l.updateQueue.baseState=g,l.memoizedState=g,l.flags&256){l=U1(s,l,f,c);break e}else if(f!==x){x=ws(Error(n(424)),l),yo(x),l=U1(s,l,f,c);break e}else{switch(s=l.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Na=Cs(s.firstChild),sr=l,$t=!0,ji=null,Es=!0,c=Fv(l,null,f,c),l.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(fl(),f===x){l=Hn(s,l,c);break e}ir(s,l,f,c)}l=l.child}return l;case 26:return Qd(s,l),s===null?(c=tj(l.type,null,l.pendingProps,null))?l.memoizedState=c:$t||(c=l.type,s=l.pendingProps,f=xf(xe.current).createElement(c),f[U]=l,f[G]=s,lr(f,c,s),We(f),l.stateNode=f):l.memoizedState=tj(l.type,s.memoizedProps,l.pendingProps,s.memoizedState),null;case 27:return we(l),s===null&&$t&&(f=l.stateNode=Zy(l.type,l.pendingProps,xe.current),sr=l,Es=!0,x=Na,Fi(l.type)?(Wm=x,Na=Cs(f.firstChild)):Na=x),ir(s,l,l.pendingProps.children,c),Qd(s,l),s===null&&(l.flags|=4194304),l.child;case 5:return s===null&&$t&&((x=f=Na)&&(f=k4(f,l.type,l.pendingProps,Es),f!==null?(l.stateNode=f,sr=l,Na=Cs(f.firstChild),Es=!1,x=!0):x=!1),x||bi(l)),we(l),x=l.type,g=l.pendingProps,S=s!==null?s.memoizedProps:null,f=g.children,zm(x,g)?f=null:S!==null&&zm(x,S)&&(l.flags|=32),l.memoizedState!==null&&(x=Uh(s,l,qT,null,null,c),Wo._currentValue=x),Qd(s,l),ir(s,l,f,c),l.child;case 6:return s===null&&$t&&((s=c=Na)&&(c=D4(c,l.pendingProps,Es),c!==null?(l.stateNode=c,sr=l,Na=null,s=!0):s=!1),s||bi(l)),null;case 13:return z1(s,l,c);case 4:return Ae(l,l.stateNode.containerInfo),f=l.pendingProps,s===null?l.child=vl(l,null,f,c):ir(s,l,f,c),l.child;case 11:return O1(s,l,l.type,l.pendingProps,c);case 7:return ir(s,l,l.pendingProps,c),l.child;case 8:return ir(s,l,l.pendingProps.children,c),l.child;case 12:return ir(s,l,l.pendingProps.children,c),l.child;case 10:return f=l.pendingProps,Ni(l,l.type,f.value),ir(s,l,f.children,c),l.child;case 9:return x=l.type._context,f=l.pendingProps.children,ml(l),x=nr(x),f=f(x),l.flags|=1,ir(s,l,f,c),l.child;case 14:return R1(s,l,l.type,l.pendingProps,c);case 15:return M1(s,l,l.type,l.pendingProps,c);case 19:return H1(s,l,c);case 31:return JT(s,l,c);case 22:return F1(s,l,c,l.pendingProps);case 24:return ml(l),f=nr(Ua),s===null?(x=kh(),x===null&&(x=pa,g=Ch(),x.pooledCache=g,g.refCount++,g!==null&&(x.pooledCacheLanes|=c),x=g),l.memoizedState={parent:f,cache:x},Oh(l),Ni(l,Ua,x)):((s.lanes&c)!==0&&(Rh(s,l),Eo(l,null,null,c),_o()),x=s.memoizedState,g=l.memoizedState,x.parent!==f?(x={parent:f,cache:f},l.memoizedState=x,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=x),Ni(l,Ua,f)):(f=g.cache,Ni(l,Ua,f),f!==x.cache&&Th(l,[Ua],c,!0))),ir(s,l,l.pendingProps.children,c),l.child;case 29:throw l.pendingProps}throw Error(n(156,l.tag))}function Gn(s){s.flags|=4}function mm(s,l,c,f,x){if((l=(s.mode&32)!==0)&&(l=!1),l){if(s.flags|=16777216,(x&335544128)===x)if(s.stateNode.complete)s.flags|=8192;else if(gy())s.flags|=8192;else throw gl=Id,Dh}else s.flags&=-16777217}function q1(s,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!ij(l))if(gy())s.flags|=8192;else throw gl=Id,Dh}function Jd(s,l){l!==null&&(s.flags|=4),s.flags&16384&&(l=s.tag!==22?as():536870912,s.lanes|=l,vc|=l)}function Oo(s,l){if(!$t)switch(s.tailMode){case"hidden":l=s.tail;for(var c=null;l!==null;)l.alternate!==null&&(c=l),l=l.sibling;c===null?s.tail=null:c.sibling=null;break;case"collapsed":c=s.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:f.sibling=null}}function wa(s){var l=s.alternate!==null&&s.alternate.child===s.child,c=0,f=0;if(l)for(var x=s.child;x!==null;)c|=x.lanes|x.childLanes,f|=x.subtreeFlags&65011712,f|=x.flags&65011712,x.return=s,x=x.sibling;else for(x=s.child;x!==null;)c|=x.lanes|x.childLanes,f|=x.subtreeFlags,f|=x.flags,x.return=s,x=x.sibling;return s.subtreeFlags|=f,s.childLanes=c,l}function t4(s,l,c){var f=l.pendingProps;switch(Nh(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wa(l),null;case 1:return wa(l),null;case 3:return c=l.stateNode,f=null,s!==null&&(f=s.memoizedState.cache),l.memoizedState.cache!==f&&(l.flags|=2048),Un(Ua),Ee(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(s===null||s.child===null)&&(nc(l)?Gn(l):s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Sh())),wa(l),null;case 26:var x=l.type,g=l.memoizedState;return s===null?(Gn(l),g!==null?(wa(l),q1(l,g)):(wa(l),mm(l,x,null,f,c))):g?g!==s.memoizedState?(Gn(l),wa(l),q1(l,g)):(wa(l),l.flags&=-16777217):(s=s.memoizedProps,s!==f&&Gn(l),wa(l),mm(l,x,s,f,c)),null;case 27:if(Ge(l),c=xe.current,x=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==f&&Gn(l);else{if(!f){if(l.stateNode===null)throw Error(n(166));return wa(l),null}s=J.current,nc(l)?Sv(l):(s=Zy(x,f,c),l.stateNode=s,Gn(l))}return wa(l),null;case 5:if(Ge(l),x=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==f&&Gn(l);else{if(!f){if(l.stateNode===null)throw Error(n(166));return wa(l),null}if(g=J.current,nc(l))Sv(l);else{var S=xf(xe.current);switch(g){case 1:g=S.createElementNS("http://www.w3.org/2000/svg",x);break;case 2:g=S.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;default:switch(x){case"svg":g=S.createElementNS("http://www.w3.org/2000/svg",x);break;case"math":g=S.createElementNS("http://www.w3.org/1998/Math/MathML",x);break;case"script":g=S.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof f.is=="string"?S.createElement("select",{is:f.is}):S.createElement("select"),f.multiple?g.multiple=!0:f.size&&(g.size=f.size);break;default:g=typeof f.is=="string"?S.createElement(x,{is:f.is}):S.createElement(x)}}g[U]=l,g[G]=f;e:for(S=l.child;S!==null;){if(S.tag===5||S.tag===6)g.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===l)break e;for(;S.sibling===null;){if(S.return===null||S.return===l)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}l.stateNode=g;e:switch(lr(g,x,f),x){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&Gn(l)}}return wa(l),mm(l,l.type,s===null?null:s.memoizedProps,l.pendingProps,c),null;case 6:if(s&&l.stateNode!=null)s.memoizedProps!==f&&Gn(l);else{if(typeof f!="string"&&l.stateNode===null)throw Error(n(166));if(s=xe.current,nc(l)){if(s=l.stateNode,c=l.memoizedProps,f=null,x=sr,x!==null)switch(x.tag){case 27:case 5:f=x.memoizedProps}s[U]=l,s=!!(s.nodeValue===c||f!==null&&f.suppressHydrationWarning===!0||zy(s.nodeValue,c)),s||bi(l,!0)}else s=xf(s).createTextNode(f),s[U]=l,l.stateNode=s}return wa(l),null;case 31:if(c=l.memoizedState,s===null||s.memoizedState!==null){if(f=nc(l),c!==null){if(s===null){if(!f)throw Error(n(318));if(s=l.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(557));s[U]=l}else fl(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;wa(l),s=!1}else c=Sh(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=c),s=!0;if(!s)return l.flags&256?(cs(l),l):(cs(l),null);if((l.flags&128)!==0)throw Error(n(558))}return wa(l),null;case 13:if(f=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(x=nc(l),f!==null&&f.dehydrated!==null){if(s===null){if(!x)throw Error(n(318));if(x=l.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(n(317));x[U]=l}else fl(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;wa(l),x=!1}else x=Sh(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=x),x=!0;if(!x)return l.flags&256?(cs(l),l):(cs(l),null)}return cs(l),(l.flags&128)!==0?(l.lanes=c,l):(c=f!==null,s=s!==null&&s.memoizedState!==null,c&&(f=l.child,x=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(x=f.alternate.memoizedState.cachePool.pool),g=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(g=f.memoizedState.cachePool.pool),g!==x&&(f.flags|=2048)),c!==s&&c&&(l.child.flags|=8192),Jd(l,l.updateQueue),wa(l),null);case 4:return Ee(),s===null&&Im(l.stateNode.containerInfo),wa(l),null;case 10:return Un(l.type),wa(l),null;case 19:if(P(Fa),f=l.memoizedState,f===null)return wa(l),null;if(x=(l.flags&128)!==0,g=f.rendering,g===null)if(x)Oo(f,!1);else{if(Da!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if(g=Ud(s),g!==null){for(l.flags|=128,Oo(f,!1),s=g.updateQueue,l.updateQueue=s,Jd(l,s),l.subtreeFlags=0,s=c,c=l.child;c!==null;)yv(c,s),c=c.sibling;return q(Fa,Fa.current&1|2),$t&&Pn(l,f.treeForkCount),l.child}s=s.sibling}f.tail!==null&&tt()>sf&&(l.flags|=128,x=!0,Oo(f,!1),l.lanes=4194304)}else{if(!x)if(s=Ud(g),s!==null){if(l.flags|=128,x=!0,s=s.updateQueue,l.updateQueue=s,Jd(l,s),Oo(f,!0),f.tail===null&&f.tailMode==="hidden"&&!g.alternate&&!$t)return wa(l),null}else 2*tt()-f.renderingStartTime>sf&&c!==536870912&&(l.flags|=128,x=!0,Oo(f,!1),l.lanes=4194304);f.isBackwards?(g.sibling=l.child,l.child=g):(s=f.last,s!==null?s.sibling=g:l.child=g,f.last=g)}return f.tail!==null?(s=f.tail,f.rendering=s,f.tail=s.sibling,f.renderingStartTime=tt(),s.sibling=null,c=Fa.current,q(Fa,x?c&1|2:c&1),$t&&Pn(l,f.treeForkCount),s):(wa(l),null);case 22:case 23:return cs(l),Lh(),f=l.memoizedState!==null,s!==null?s.memoizedState!==null!==f&&(l.flags|=8192):f&&(l.flags|=8192),f?(c&536870912)!==0&&(l.flags&128)===0&&(wa(l),l.subtreeFlags&6&&(l.flags|=8192)):wa(l),c=l.updateQueue,c!==null&&Jd(l,c.retryQueue),c=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),f=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(f=l.memoizedState.cachePool.pool),f!==c&&(l.flags|=2048),s!==null&&P(xl),null;case 24:return c=null,s!==null&&(c=s.memoizedState.cache),l.memoizedState.cache!==c&&(l.flags|=2048),Un(Ua),wa(l),null;case 25:return null;case 30:return null}throw Error(n(156,l.tag))}function a4(s,l){switch(Nh(l),l.tag){case 1:return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return Un(Ua),Ee(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 26:case 27:case 5:return Ge(l),null;case 31:if(l.memoizedState!==null){if(cs(l),l.alternate===null)throw Error(n(340));fl()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 13:if(cs(l),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(n(340));fl()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return P(Fa),null;case 4:return Ee(),null;case 10:return Un(l.type),null;case 22:case 23:return cs(l),Lh(),s!==null&&P(xl),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 24:return Un(Ua),null;case 25:return null;default:return null}}function W1(s,l){switch(Nh(l),l.tag){case 3:Un(Ua),Ee();break;case 26:case 27:case 5:Ge(l);break;case 4:Ee();break;case 31:l.memoizedState!==null&&cs(l);break;case 13:cs(l);break;case 19:P(Fa);break;case 10:Un(l.type);break;case 22:case 23:cs(l),Lh(),s!==null&&P(xl);break;case 24:Un(Ua)}}function Ro(s,l){try{var c=l.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var x=f.next;c=x;do{if((c.tag&s)===s){f=void 0;var g=c.create,S=c.inst;f=g(),S.destroy=f}c=c.next}while(c!==x)}}catch(F){da(l,l.return,F)}}function Ci(s,l,c){try{var f=l.updateQueue,x=f!==null?f.lastEffect:null;if(x!==null){var g=x.next;f=g;do{if((f.tag&s)===s){var S=f.inst,F=S.destroy;if(F!==void 0){S.destroy=void 0,x=l;var te=c,fe=F;try{fe()}catch(_e){da(x,te,_e)}}}f=f.next}while(f!==g)}}catch(_e){da(l,l.return,_e)}}function Y1(s){var l=s.updateQueue;if(l!==null){var c=s.stateNode;try{Lv(l,c)}catch(f){da(s,s.return,f)}}}function X1(s,l,c){c.props=jl(s.type,s.memoizedProps),c.state=s.memoizedState;try{c.componentWillUnmount()}catch(f){da(s,l,f)}}function Mo(s,l){try{var c=s.ref;if(c!==null){switch(s.tag){case 26:case 27:case 5:var f=s.stateNode;break;case 30:f=s.stateNode;break;default:f=s.stateNode}typeof c=="function"?s.refCleanup=c(f):c.current=f}}catch(x){da(s,l,x)}}function un(s,l){var c=s.ref,f=s.refCleanup;if(c!==null)if(typeof f=="function")try{f()}catch(x){da(s,l,x)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(x){da(s,l,x)}else c.current=null}function $1(s){var l=s.type,c=s.memoizedProps,f=s.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":c.autoFocus&&f.focus();break e;case"img":c.src?f.src=c.src:c.srcSet&&(f.srcset=c.srcSet)}}catch(x){da(s,s.return,x)}}function xm(s,l,c){try{var f=s.stateNode;S4(f,s.type,c,l),f[G]=l}catch(x){da(s,s.return,x)}}function K1(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Fi(s.type)||s.tag===4}function pm(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||K1(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Fi(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function gm(s,l,c){var f=s.tag;if(f===5||f===6)s=s.stateNode,l?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(s,l):(l=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,l.appendChild(s),c=c._reactRootContainer,c!=null||l.onclick!==null||(l.onclick=Fn));else if(f!==4&&(f===27&&Fi(s.type)&&(c=s.stateNode,l=null),s=s.child,s!==null))for(gm(s,l,c),s=s.sibling;s!==null;)gm(s,l,c),s=s.sibling}function ef(s,l,c){var f=s.tag;if(f===5||f===6)s=s.stateNode,l?c.insertBefore(s,l):c.appendChild(s);else if(f!==4&&(f===27&&Fi(s.type)&&(c=s.stateNode),s=s.child,s!==null))for(ef(s,l,c),s=s.sibling;s!==null;)ef(s,l,c),s=s.sibling}function Q1(s){var l=s.stateNode,c=s.memoizedProps;try{for(var f=s.type,x=l.attributes;x.length;)l.removeAttributeNode(x[0]);lr(l,f,c),l[U]=s,l[G]=c}catch(g){da(s,s.return,g)}}var qn=!1,Ha=!1,vm=!1,Z1=typeof WeakSet=="function"?WeakSet:Set,er=null;function r4(s,l){if(s=s.containerInfo,Bm=Nf,s=uv(s),dh(s)){if("selectionStart"in s)var c={start:s.selectionStart,end:s.selectionEnd};else e:{c=(c=s.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var x=f.anchorOffset,g=f.focusNode;f=f.focusOffset;try{c.nodeType,g.nodeType}catch{c=null;break e}var S=0,F=-1,te=-1,fe=0,_e=0,Re=s,ve=null;t:for(;;){for(var be;Re!==c||x!==0&&Re.nodeType!==3||(F=S+x),Re!==g||f!==0&&Re.nodeType!==3||(te=S+f),Re.nodeType===3&&(S+=Re.nodeValue.length),(be=Re.firstChild)!==null;)ve=Re,Re=be;for(;;){if(Re===s)break t;if(ve===c&&++fe===x&&(F=S),ve===g&&++_e===f&&(te=S),(be=Re.nextSibling)!==null)break;Re=ve,ve=Re.parentNode}Re=be}c=F===-1||te===-1?null:{start:F,end:te}}else c=null}c=c||{start:0,end:0}}else c=null;for(Um={focusedElem:s,selectionRange:c},Nf=!1,er=l;er!==null;)if(l=er,s=l.child,(l.subtreeFlags&1028)!==0&&s!==null)s.return=l,er=s;else for(;er!==null;){switch(l=er,g=l.alternate,s=l.flags,l.tag){case 0:if((s&4)!==0&&(s=l.updateQueue,s=s!==null?s.events:null,s!==null))for(c=0;c<s.length;c++)x=s[c],x.ref.impl=x.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&g!==null){s=void 0,c=l,x=g.memoizedProps,g=g.memoizedState,f=c.stateNode;try{var rt=jl(c.type,x);s=f.getSnapshotBeforeUpdate(rt,g),f.__reactInternalSnapshotBeforeUpdate=s}catch(Nt){da(c,c.return,Nt)}}break;case 3:if((s&1024)!==0){if(s=l.stateNode.containerInfo,c=s.nodeType,c===9)Hm(s);else if(c===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Hm(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(n(163))}if(s=l.sibling,s!==null){s.return=l.return,er=s;break}er=l.return}}function J1(s,l,c){var f=c.flags;switch(c.tag){case 0:case 11:case 15:Yn(s,c),f&4&&Ro(5,c);break;case 1:if(Yn(s,c),f&4)if(s=c.stateNode,l===null)try{s.componentDidMount()}catch(S){da(c,c.return,S)}else{var x=jl(c.type,l.memoizedProps);l=l.memoizedState;try{s.componentDidUpdate(x,l,s.__reactInternalSnapshotBeforeUpdate)}catch(S){da(c,c.return,S)}}f&64&&Y1(c),f&512&&Mo(c,c.return);break;case 3:if(Yn(s,c),f&64&&(s=c.updateQueue,s!==null)){if(l=null,c.child!==null)switch(c.child.tag){case 27:case 5:l=c.child.stateNode;break;case 1:l=c.child.stateNode}try{Lv(s,l)}catch(S){da(c,c.return,S)}}break;case 27:l===null&&f&4&&Q1(c);case 26:case 5:Yn(s,c),l===null&&f&4&&$1(c),f&512&&Mo(c,c.return);break;case 12:Yn(s,c);break;case 31:Yn(s,c),f&4&&ay(s,c);break;case 13:Yn(s,c),f&4&&ry(s,c),f&64&&(s=c.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(c=f4.bind(null,c),O4(s,c))));break;case 22:if(f=c.memoizedState!==null||qn,!f){l=l!==null&&l.memoizedState!==null||Ha,x=qn;var g=Ha;qn=f,(Ha=l)&&!g?Xn(s,c,(c.subtreeFlags&8772)!==0):Yn(s,c),qn=x,Ha=g}break;case 30:break;default:Yn(s,c)}}function ey(s){var l=s.alternate;l!==null&&(s.alternate=null,ey(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&V(l)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Ea=null,Wr=!1;function Wn(s,l,c){for(c=c.child;c!==null;)ty(s,l,c),c=c.sibling}function ty(s,l,c){if(ia&&typeof ia.onCommitFiberUnmount=="function")try{ia.onCommitFiberUnmount(zt,c)}catch{}switch(c.tag){case 26:Ha||un(c,l),Wn(s,l,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Ha||un(c,l);var f=Ea,x=Wr;Fi(c.type)&&(Ea=c.stateNode,Wr=!1),Wn(s,l,c),Ho(c.stateNode),Ea=f,Wr=x;break;case 5:Ha||un(c,l);case 6:if(f=Ea,x=Wr,Ea=null,Wn(s,l,c),Ea=f,Wr=x,Ea!==null)if(Wr)try{(Ea.nodeType===9?Ea.body:Ea.nodeName==="HTML"?Ea.ownerDocument.body:Ea).removeChild(c.stateNode)}catch(g){da(c,l,g)}else try{Ea.removeChild(c.stateNode)}catch(g){da(c,l,g)}break;case 18:Ea!==null&&(Wr?(s=Ea,Yy(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,c.stateNode),Ec(s)):Yy(Ea,c.stateNode));break;case 4:f=Ea,x=Wr,Ea=c.stateNode.containerInfo,Wr=!0,Wn(s,l,c),Ea=f,Wr=x;break;case 0:case 11:case 14:case 15:Ci(2,c,l),Ha||Ci(4,c,l),Wn(s,l,c);break;case 1:Ha||(un(c,l),f=c.stateNode,typeof f.componentWillUnmount=="function"&&X1(c,l,f)),Wn(s,l,c);break;case 21:Wn(s,l,c);break;case 22:Ha=(f=Ha)||c.memoizedState!==null,Wn(s,l,c),Ha=f;break;default:Wn(s,l,c)}}function ay(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Ec(s)}catch(c){da(l,l.return,c)}}}function ry(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Ec(s)}catch(c){da(l,l.return,c)}}function s4(s){switch(s.tag){case 31:case 13:case 19:var l=s.stateNode;return l===null&&(l=s.stateNode=new Z1),l;case 22:return s=s.stateNode,l=s._retryCache,l===null&&(l=s._retryCache=new Z1),l;default:throw Error(n(435,s.tag))}}function tf(s,l){var c=s4(s);l.forEach(function(f){if(!c.has(f)){c.add(f);var x=h4.bind(null,s,f);f.then(x,x)}})}function Yr(s,l){var c=l.deletions;if(c!==null)for(var f=0;f<c.length;f++){var x=c[f],g=s,S=l,F=S;e:for(;F!==null;){switch(F.tag){case 27:if(Fi(F.type)){Ea=F.stateNode,Wr=!1;break e}break;case 5:Ea=F.stateNode,Wr=!1;break e;case 3:case 4:Ea=F.stateNode.containerInfo,Wr=!0;break e}F=F.return}if(Ea===null)throw Error(n(160));ty(g,S,x),Ea=null,Wr=!1,g=x.alternate,g!==null&&(g.return=null),x.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)sy(l,s),l=l.sibling}var Hs=null;function sy(s,l){var c=s.alternate,f=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Yr(l,s),Xr(s),f&4&&(Ci(3,s,s.return),Ro(3,s),Ci(5,s,s.return));break;case 1:Yr(l,s),Xr(s),f&512&&(Ha||c===null||un(c,c.return)),f&64&&qn&&(s=s.updateQueue,s!==null&&(f=s.callbacks,f!==null&&(c=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=c===null?f:c.concat(f))));break;case 26:var x=Hs;if(Yr(l,s),Xr(s),f&512&&(Ha||c===null||un(c,c.return)),f&4){var g=c!==null?c.memoizedState:null;if(f=s.memoizedState,c===null)if(f===null)if(s.stateNode===null){e:{f=s.type,c=s.memoizedProps,x=x.ownerDocument||x;t:switch(f){case"title":g=x.getElementsByTagName("title")[0],(!g||g[ae]||g[U]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=x.createElement(f),x.head.insertBefore(g,x.querySelector("head > title"))),lr(g,f,c),g[U]=s,We(g),f=g;break e;case"link":var S=sj("link","href",x).get(f+(c.href||""));if(S){for(var F=0;F<S.length;F++)if(g=S[F],g.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&g.getAttribute("rel")===(c.rel==null?null:c.rel)&&g.getAttribute("title")===(c.title==null?null:c.title)&&g.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){S.splice(F,1);break t}}g=x.createElement(f),lr(g,f,c),x.head.appendChild(g);break;case"meta":if(S=sj("meta","content",x).get(f+(c.content||""))){for(F=0;F<S.length;F++)if(g=S[F],g.getAttribute("content")===(c.content==null?null:""+c.content)&&g.getAttribute("name")===(c.name==null?null:c.name)&&g.getAttribute("property")===(c.property==null?null:c.property)&&g.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&g.getAttribute("charset")===(c.charSet==null?null:c.charSet)){S.splice(F,1);break t}}g=x.createElement(f),lr(g,f,c),x.head.appendChild(g);break;default:throw Error(n(468,f))}g[U]=s,We(g),f=g}s.stateNode=f}else nj(x,s.type,s.stateNode);else s.stateNode=rj(x,f,s.memoizedProps);else g!==f?(g===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):g.count--,f===null?nj(x,s.type,s.stateNode):rj(x,f,s.memoizedProps)):f===null&&s.stateNode!==null&&xm(s,s.memoizedProps,c.memoizedProps)}break;case 27:Yr(l,s),Xr(s),f&512&&(Ha||c===null||un(c,c.return)),c!==null&&f&4&&xm(s,s.memoizedProps,c.memoizedProps);break;case 5:if(Yr(l,s),Xr(s),f&512&&(Ha||c===null||un(c,c.return)),s.flags&32){x=s.stateNode;try{$l(x,"")}catch(rt){da(s,s.return,rt)}}f&4&&s.stateNode!=null&&(x=s.memoizedProps,xm(s,x,c!==null?c.memoizedProps:x)),f&1024&&(vm=!0);break;case 6:if(Yr(l,s),Xr(s),f&4){if(s.stateNode===null)throw Error(n(162));f=s.memoizedProps,c=s.stateNode;try{c.nodeValue=f}catch(rt){da(s,s.return,rt)}}break;case 3:if(vf=null,x=Hs,Hs=pf(l.containerInfo),Yr(l,s),Hs=x,Xr(s),f&4&&c!==null&&c.memoizedState.isDehydrated)try{Ec(l.containerInfo)}catch(rt){da(s,s.return,rt)}vm&&(vm=!1,ny(s));break;case 4:f=Hs,Hs=pf(s.stateNode.containerInfo),Yr(l,s),Xr(s),Hs=f;break;case 12:Yr(l,s),Xr(s);break;case 31:Yr(l,s),Xr(s),f&4&&(f=s.updateQueue,f!==null&&(s.updateQueue=null,tf(s,f)));break;case 13:Yr(l,s),Xr(s),s.child.flags&8192&&s.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(rf=tt()),f&4&&(f=s.updateQueue,f!==null&&(s.updateQueue=null,tf(s,f)));break;case 22:x=s.memoizedState!==null;var te=c!==null&&c.memoizedState!==null,fe=qn,_e=Ha;if(qn=fe||x,Ha=_e||te,Yr(l,s),Ha=_e,qn=fe,Xr(s),f&8192)e:for(l=s.stateNode,l._visibility=x?l._visibility&-2:l._visibility|1,x&&(c===null||te||qn||Ha||bl(s)),c=null,l=s;;){if(l.tag===5||l.tag===26){if(c===null){te=c=l;try{if(g=te.stateNode,x)S=g.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{F=te.stateNode;var Re=te.memoizedProps.style,ve=Re!=null&&Re.hasOwnProperty("display")?Re.display:null;F.style.display=ve==null||typeof ve=="boolean"?"":(""+ve).trim()}}catch(rt){da(te,te.return,rt)}}}else if(l.tag===6){if(c===null){te=l;try{te.stateNode.nodeValue=x?"":te.memoizedProps}catch(rt){da(te,te.return,rt)}}}else if(l.tag===18){if(c===null){te=l;try{var be=te.stateNode;x?Xy(be,!0):Xy(te.stateNode,!1)}catch(rt){da(te,te.return,rt)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===s)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break e;for(;l.sibling===null;){if(l.return===null||l.return===s)break e;c===l&&(c=null),l=l.return}c===l&&(c=null),l.sibling.return=l.return,l=l.sibling}f&4&&(f=s.updateQueue,f!==null&&(c=f.retryQueue,c!==null&&(f.retryQueue=null,tf(s,c))));break;case 19:Yr(l,s),Xr(s),f&4&&(f=s.updateQueue,f!==null&&(s.updateQueue=null,tf(s,f)));break;case 30:break;case 21:break;default:Yr(l,s),Xr(s)}}function Xr(s){var l=s.flags;if(l&2){try{for(var c,f=s.return;f!==null;){if(K1(f)){c=f;break}f=f.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var x=c.stateNode,g=pm(s);ef(s,g,x);break;case 5:var S=c.stateNode;c.flags&32&&($l(S,""),c.flags&=-33);var F=pm(s);ef(s,F,S);break;case 3:case 4:var te=c.stateNode.containerInfo,fe=pm(s);gm(s,fe,te);break;default:throw Error(n(161))}}catch(_e){da(s,s.return,_e)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function ny(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var l=s;ny(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),s=s.sibling}}function Yn(s,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)J1(s,l.alternate,l),l=l.sibling}function bl(s){for(s=s.child;s!==null;){var l=s;switch(l.tag){case 0:case 11:case 14:case 15:Ci(4,l,l.return),bl(l);break;case 1:un(l,l.return);var c=l.stateNode;typeof c.componentWillUnmount=="function"&&X1(l,l.return,c),bl(l);break;case 27:Ho(l.stateNode);case 26:case 5:un(l,l.return),bl(l);break;case 22:l.memoizedState===null&&bl(l);break;case 30:bl(l);break;default:bl(l)}s=s.sibling}}function Xn(s,l,c){for(c=c&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var f=l.alternate,x=s,g=l,S=g.flags;switch(g.tag){case 0:case 11:case 15:Xn(x,g,c),Ro(4,g);break;case 1:if(Xn(x,g,c),f=g,x=f.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(fe){da(f,f.return,fe)}if(f=g,x=f.updateQueue,x!==null){var F=f.stateNode;try{var te=x.shared.hiddenCallbacks;if(te!==null)for(x.shared.hiddenCallbacks=null,x=0;x<te.length;x++)Iv(te[x],F)}catch(fe){da(f,f.return,fe)}}c&&S&64&&Y1(g),Mo(g,g.return);break;case 27:Q1(g);case 26:case 5:Xn(x,g,c),c&&f===null&&S&4&&$1(g),Mo(g,g.return);break;case 12:Xn(x,g,c);break;case 31:Xn(x,g,c),c&&S&4&&ay(x,g);break;case 13:Xn(x,g,c),c&&S&4&&ry(x,g);break;case 22:g.memoizedState===null&&Xn(x,g,c),Mo(g,g.return);break;case 30:break;default:Xn(x,g,c)}l=l.sibling}}function ym(s,l){var c=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),s=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(s=l.memoizedState.cachePool.pool),s!==c&&(s!=null&&s.refCount++,c!=null&&jo(c))}function jm(s,l){s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&jo(s))}function Gs(s,l,c,f){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)iy(s,l,c,f),l=l.sibling}function iy(s,l,c,f){var x=l.flags;switch(l.tag){case 0:case 11:case 15:Gs(s,l,c,f),x&2048&&Ro(9,l);break;case 1:Gs(s,l,c,f);break;case 3:Gs(s,l,c,f),x&2048&&(s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&jo(s)));break;case 12:if(x&2048){Gs(s,l,c,f),s=l.stateNode;try{var g=l.memoizedProps,S=g.id,F=g.onPostCommit;typeof F=="function"&&F(S,l.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(te){da(l,l.return,te)}}else Gs(s,l,c,f);break;case 31:Gs(s,l,c,f);break;case 13:Gs(s,l,c,f);break;case 23:break;case 22:g=l.stateNode,S=l.alternate,l.memoizedState!==null?g._visibility&2?Gs(s,l,c,f):Fo(s,l):g._visibility&2?Gs(s,l,c,f):(g._visibility|=2,xc(s,l,c,f,(l.subtreeFlags&10256)!==0||!1)),x&2048&&ym(S,l);break;case 24:Gs(s,l,c,f),x&2048&&jm(l.alternate,l);break;default:Gs(s,l,c,f)}}function xc(s,l,c,f,x){for(x=x&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var g=s,S=l,F=c,te=f,fe=S.flags;switch(S.tag){case 0:case 11:case 15:xc(g,S,F,te,x),Ro(8,S);break;case 23:break;case 22:var _e=S.stateNode;S.memoizedState!==null?_e._visibility&2?xc(g,S,F,te,x):Fo(g,S):(_e._visibility|=2,xc(g,S,F,te,x)),x&&fe&2048&&ym(S.alternate,S);break;case 24:xc(g,S,F,te,x),x&&fe&2048&&jm(S.alternate,S);break;default:xc(g,S,F,te,x)}l=l.sibling}}function Fo(s,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var c=s,f=l,x=f.flags;switch(f.tag){case 22:Fo(c,f),x&2048&&ym(f.alternate,f);break;case 24:Fo(c,f),x&2048&&jm(f.alternate,f);break;default:Fo(c,f)}l=l.sibling}}var Io=8192;function pc(s,l,c){if(s.subtreeFlags&Io)for(s=s.child;s!==null;)ly(s,l,c),s=s.sibling}function ly(s,l,c){switch(s.tag){case 26:pc(s,l,c),s.flags&Io&&s.memoizedState!==null&&G4(c,Hs,s.memoizedState,s.memoizedProps);break;case 5:pc(s,l,c);break;case 3:case 4:var f=Hs;Hs=pf(s.stateNode.containerInfo),pc(s,l,c),Hs=f;break;case 22:s.memoizedState===null&&(f=s.alternate,f!==null&&f.memoizedState!==null?(f=Io,Io=16777216,pc(s,l,c),Io=f):pc(s,l,c));break;default:pc(s,l,c)}}function cy(s){var l=s.alternate;if(l!==null&&(s=l.child,s!==null)){l.child=null;do l=s.sibling,s.sibling=null,s=l;while(s!==null)}}function Lo(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var c=0;c<l.length;c++){var f=l[c];er=f,uy(f,s)}cy(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)oy(s),s=s.sibling}function oy(s){switch(s.tag){case 0:case 11:case 15:Lo(s),s.flags&2048&&Ci(9,s,s.return);break;case 3:Lo(s);break;case 12:Lo(s);break;case 22:var l=s.stateNode;s.memoizedState!==null&&l._visibility&2&&(s.return===null||s.return.tag!==13)?(l._visibility&=-3,af(s)):Lo(s);break;default:Lo(s)}}function af(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var c=0;c<l.length;c++){var f=l[c];er=f,uy(f,s)}cy(s)}for(s=s.child;s!==null;){switch(l=s,l.tag){case 0:case 11:case 15:Ci(8,l,l.return),af(l);break;case 22:c=l.stateNode,c._visibility&2&&(c._visibility&=-3,af(l));break;default:af(l)}s=s.sibling}}function uy(s,l){for(;er!==null;){var c=er;switch(c.tag){case 0:case 11:case 15:Ci(8,c,l);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var f=c.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:jo(c.memoizedState.cache)}if(f=c.child,f!==null)f.return=c,er=f;else e:for(c=s;er!==null;){f=er;var x=f.sibling,g=f.return;if(ey(f),f===c){er=null;break e}if(x!==null){x.return=g,er=x;break e}er=g}}}var n4={getCacheForType:function(s){var l=nr(Ua),c=l.data.get(s);return c===void 0&&(c=s(),l.data.set(s,c)),c},cacheSignal:function(){return nr(Ua).controller.signal}},i4=typeof WeakMap=="function"?WeakMap:Map,ca=0,pa=null,Ht=null,Yt=0,ua=0,os=null,Ai=!1,gc=!1,bm=!1,$n=0,Da=0,ki=0,Nl=0,Nm=0,us=0,vc=0,Po=null,$r=null,wm=!1,rf=0,dy=0,sf=1/0,nf=null,Di=null,Ka=0,Oi=null,yc=null,Kn=0,Sm=0,_m=null,fy=null,Bo=0,Em=null;function ds(){return(ca&2)!==0&&Yt!==0?Yt&-Yt:W.T!==null?Om():M()}function hy(){if(us===0)if((Yt&536870912)===0||$t){var s=ut;ut<<=1,(ut&3932160)===0&&(ut=262144),us=s}else us=536870912;return s=ls.current,s!==null&&(s.flags|=32),us}function Kr(s,l,c){(s===pa&&(ua===2||ua===9)||s.cancelPendingCommit!==null)&&(jc(s,0),Ri(s,Yt,us,!1)),Hr(s,c),((ca&2)===0||s!==pa)&&(s===pa&&((ca&2)===0&&(Nl|=c),Da===4&&Ri(s,Yt,us,!1)),dn(s))}function my(s,l,c){if((ca&6)!==0)throw Error(n(327));var f=!c&&(l&127)===0&&(l&s.expiredLanes)===0||Bs(s,l),x=f?o4(s,l):Cm(s,l,!0),g=f;do{if(x===0){gc&&!f&&Ri(s,l,0,!1);break}else{if(c=s.current.alternate,g&&!l4(c)){x=Cm(s,l,!1),g=!1;continue}if(x===2){if(g=l,s.errorRecoveryDisabledLanes&g)var S=0;else S=s.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){l=S;e:{var F=s;x=Po;var te=F.current.memoizedState.isDehydrated;if(te&&(jc(F,S).flags|=256),S=Cm(F,S,!1),S!==2){if(bm&&!te){F.errorRecoveryDisabledLanes|=g,Nl|=g,x=4;break e}g=$r,$r=x,g!==null&&($r===null?$r=g:$r.push.apply($r,g))}x=S}if(g=!1,x!==2)continue}}if(x===1){jc(s,0),Ri(s,l,0,!0);break}e:{switch(f=s,g=x,g){case 0:case 1:throw Error(n(345));case 4:if((l&4194048)!==l)break;case 6:Ri(f,l,us,!Ai);break e;case 2:$r=null;break;case 3:case 5:break;default:throw Error(n(329))}if((l&62914560)===l&&(x=rf+300-tt(),10<x)){if(Ri(f,l,us,!Ai),Ot(f,0,!0)!==0)break e;Kn=l,f.timeoutHandle=qy(xy.bind(null,f,c,$r,nf,wm,l,us,Nl,vc,Ai,g,"Throttled",-0,0),x);break e}xy(f,c,$r,nf,wm,l,us,Nl,vc,Ai,g,null,-0,0)}}break}while(!0);dn(s)}function xy(s,l,c,f,x,g,S,F,te,fe,_e,Re,ve,be){if(s.timeoutHandle=-1,Re=l.subtreeFlags,Re&8192||(Re&16785408)===16785408){Re={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Fn},ly(l,g,Re);var rt=(g&62914560)===g?rf-tt():(g&4194048)===g?dy-tt():0;if(rt=q4(Re,rt),rt!==null){Kn=g,s.cancelPendingCommit=rt(wy.bind(null,s,l,g,c,f,x,S,F,te,_e,Re,null,ve,be)),Ri(s,g,S,!fe);return}}wy(s,l,g,c,f,x,S,F,te)}function l4(s){for(var l=s;;){var c=l.tag;if((c===0||c===11||c===15)&&l.flags&16384&&(c=l.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var f=0;f<c.length;f++){var x=c[f],g=x.getSnapshot;x=x.value;try{if(!ns(g(),x))return!1}catch{return!1}}if(c=l.child,l.subtreeFlags&16384&&c!==null)c.return=l,l=c;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Ri(s,l,c,f){l&=~Nm,l&=~Nl,s.suspendedLanes|=l,s.pingedLanes&=~l,f&&(s.warmLanes|=l),f=s.expirationTimes;for(var x=l;0<x;){var g=31-_a(x),S=1<<g;f[g]=-1,x&=~S}c!==0&&il(s,c,l)}function lf(){return(ca&6)===0?(Uo(0),!1):!0}function Tm(){if(Ht!==null){if(ua===0)var s=Ht.return;else s=Ht,Bn=hl=null,Hh(s),uc=null,No=0,s=Ht;for(;s!==null;)W1(s.alternate,s),s=s.return;Ht=null}}function jc(s,l){var c=s.timeoutHandle;c!==-1&&(s.timeoutHandle=-1,T4(c)),c=s.cancelPendingCommit,c!==null&&(s.cancelPendingCommit=null,c()),Kn=0,Tm(),pa=s,Ht=c=Ln(s.current,null),Yt=l,ua=0,os=null,Ai=!1,gc=Bs(s,l),bm=!1,vc=us=Nm=Nl=ki=Da=0,$r=Po=null,wm=!1,(l&8)!==0&&(l|=l&32);var f=s.entangledLanes;if(f!==0)for(s=s.entanglements,f&=l;0<f;){var x=31-_a(f),g=1<<x;l|=s[x],f&=~g}return $n=l,Td(),c}function py(s,l){Ft=null,W.H=ko,l===oc||l===Fd?(l=Ov(),ua=3):l===Dh?(l=Ov(),ua=4):ua=l===nm?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,os=l,Ht===null&&(Da=1,$d(s,ws(l,s.current)))}function gy(){var s=ls.current;return s===null?!0:(Yt&4194048)===Yt?Ts===null:(Yt&62914560)===Yt||(Yt&536870912)!==0?s===Ts:!1}function vy(){var s=W.H;return W.H=ko,s===null?ko:s}function yy(){var s=W.A;return W.A=n4,s}function cf(){Da=4,Ai||(Yt&4194048)!==Yt&&ls.current!==null||(gc=!0),(ki&134217727)===0&&(Nl&134217727)===0||pa===null||Ri(pa,Yt,us,!1)}function Cm(s,l,c){var f=ca;ca|=2;var x=vy(),g=yy();(pa!==s||Yt!==l)&&(nf=null,jc(s,l)),l=!1;var S=Da;e:do try{if(ua!==0&&Ht!==null){var F=Ht,te=os;switch(ua){case 8:Tm(),S=6;break e;case 3:case 2:case 9:case 6:ls.current===null&&(l=!0);var fe=ua;if(ua=0,os=null,bc(s,F,te,fe),c&&gc){S=0;break e}break;default:fe=ua,ua=0,os=null,bc(s,F,te,fe)}}c4(),S=Da;break}catch(_e){py(s,_e)}while(!0);return l&&s.shellSuspendCounter++,Bn=hl=null,ca=f,W.H=x,W.A=g,Ht===null&&(pa=null,Yt=0,Td()),S}function c4(){for(;Ht!==null;)jy(Ht)}function o4(s,l){var c=ca;ca|=2;var f=vy(),x=yy();pa!==s||Yt!==l?(nf=null,sf=tt()+500,jc(s,l)):gc=Bs(s,l);e:do try{if(ua!==0&&Ht!==null){l=Ht;var g=os;t:switch(ua){case 1:ua=0,os=null,bc(s,l,g,1);break;case 2:case 9:if(kv(g)){ua=0,os=null,by(l);break}l=function(){ua!==2&&ua!==9||pa!==s||(ua=7),dn(s)},g.then(l,l);break e;case 3:ua=7;break e;case 4:ua=5;break e;case 7:kv(g)?(ua=0,os=null,by(l)):(ua=0,os=null,bc(s,l,g,7));break;case 5:var S=null;switch(Ht.tag){case 26:S=Ht.memoizedState;case 5:case 27:var F=Ht;if(S?ij(S):F.stateNode.complete){ua=0,os=null;var te=F.sibling;if(te!==null)Ht=te;else{var fe=F.return;fe!==null?(Ht=fe,of(fe)):Ht=null}break t}}ua=0,os=null,bc(s,l,g,5);break;case 6:ua=0,os=null,bc(s,l,g,6);break;case 8:Tm(),Da=6;break e;default:throw Error(n(462))}}u4();break}catch(_e){py(s,_e)}while(!0);return Bn=hl=null,W.H=f,W.A=x,ca=c,Ht!==null?0:(pa=null,Yt=0,Td(),Da)}function u4(){for(;Ht!==null&&!ze();)jy(Ht)}function jy(s){var l=G1(s.alternate,s,$n);s.memoizedProps=s.pendingProps,l===null?of(s):Ht=l}function by(s){var l=s,c=l.alternate;switch(l.tag){case 15:case 0:l=P1(c,l,l.pendingProps,l.type,void 0,Yt);break;case 11:l=P1(c,l,l.pendingProps,l.type.render,l.ref,Yt);break;case 5:Hh(l);default:W1(c,l),l=Ht=yv(l,$n),l=G1(c,l,$n)}s.memoizedProps=s.pendingProps,l===null?of(s):Ht=l}function bc(s,l,c,f){Bn=hl=null,Hh(l),uc=null,No=0;var x=l.return;try{if(ZT(s,x,l,c,Yt)){Da=1,$d(s,ws(c,s.current)),Ht=null;return}}catch(g){if(x!==null)throw Ht=x,g;Da=1,$d(s,ws(c,s.current)),Ht=null;return}l.flags&32768?($t||f===1?s=!0:gc||(Yt&536870912)!==0?s=!1:(Ai=s=!0,(f===2||f===9||f===3||f===6)&&(f=ls.current,f!==null&&f.tag===13&&(f.flags|=16384))),Ny(l,s)):of(l)}function of(s){var l=s;do{if((l.flags&32768)!==0){Ny(l,Ai);return}s=l.return;var c=t4(l.alternate,l,$n);if(c!==null){Ht=c;return}if(l=l.sibling,l!==null){Ht=l;return}Ht=l=s}while(l!==null);Da===0&&(Da=5)}function Ny(s,l){do{var c=a4(s.alternate,s);if(c!==null){c.flags&=32767,Ht=c;return}if(c=s.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!l&&(s=s.sibling,s!==null)){Ht=s;return}Ht=s=c}while(s!==null);Da=6,Ht=null}function wy(s,l,c,f,x,g,S,F,te){s.cancelPendingCommit=null;do uf();while(Ka!==0);if((ca&6)!==0)throw Error(n(327));if(l!==null){if(l===s.current)throw Error(n(177));if(g=l.lanes|l.childLanes,g|=ph,nl(s,c,g,S,F,te),s===pa&&(Ht=pa=null,Yt=0),yc=l,Oi=s,Kn=c,Sm=g,_m=x,fy=f,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,m4(Ut,function(){return Cy(),null})):(s.callbackNode=null,s.callbackPriority=0),f=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||f){f=W.T,W.T=null,x=ee.p,ee.p=2,S=ca,ca|=4;try{r4(s,l,c)}finally{ca=S,ee.p=x,W.T=f}}Ka=1,Sy(),_y(),Ey()}}function Sy(){if(Ka===1){Ka=0;var s=Oi,l=yc,c=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||c){c=W.T,W.T=null;var f=ee.p;ee.p=2;var x=ca;ca|=4;try{sy(l,s);var g=Um,S=uv(s.containerInfo),F=g.focusedElem,te=g.selectionRange;if(S!==F&&F&&F.ownerDocument&&ov(F.ownerDocument.documentElement,F)){if(te!==null&&dh(F)){var fe=te.start,_e=te.end;if(_e===void 0&&(_e=fe),"selectionStart"in F)F.selectionStart=fe,F.selectionEnd=Math.min(_e,F.value.length);else{var Re=F.ownerDocument||document,ve=Re&&Re.defaultView||window;if(ve.getSelection){var be=ve.getSelection(),rt=F.textContent.length,Nt=Math.min(te.start,rt),xa=te.end===void 0?Nt:Math.min(te.end,rt);!be.extend&&Nt>xa&&(S=xa,xa=Nt,Nt=S);var ie=cv(F,Nt),se=cv(F,xa);if(ie&&se&&(be.rangeCount!==1||be.anchorNode!==ie.node||be.anchorOffset!==ie.offset||be.focusNode!==se.node||be.focusOffset!==se.offset)){var ce=Re.createRange();ce.setStart(ie.node,ie.offset),be.removeAllRanges(),Nt>xa?(be.addRange(ce),be.extend(se.node,se.offset)):(ce.setEnd(se.node,se.offset),be.addRange(ce))}}}}for(Re=[],be=F;be=be.parentNode;)be.nodeType===1&&Re.push({element:be,left:be.scrollLeft,top:be.scrollTop});for(typeof F.focus=="function"&&F.focus(),F=0;F<Re.length;F++){var ke=Re[F];ke.element.scrollLeft=ke.left,ke.element.scrollTop=ke.top}}Nf=!!Bm,Um=Bm=null}finally{ca=x,ee.p=f,W.T=c}}s.current=l,Ka=2}}function _y(){if(Ka===2){Ka=0;var s=Oi,l=yc,c=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||c){c=W.T,W.T=null;var f=ee.p;ee.p=2;var x=ca;ca|=4;try{J1(s,l.alternate,l)}finally{ca=x,ee.p=f,W.T=c}}Ka=3}}function Ey(){if(Ka===4||Ka===3){Ka=0,vt();var s=Oi,l=yc,c=Kn,f=fy;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?Ka=5:(Ka=0,yc=Oi=null,Ty(s,s.pendingLanes));var x=s.pendingLanes;if(x===0&&(Di=null),rs(c),l=l.stateNode,ia&&typeof ia.onCommitFiberRoot=="function")try{ia.onCommitFiberRoot(zt,l,void 0,(l.current.flags&128)===128)}catch{}if(f!==null){l=W.T,x=ee.p,ee.p=2,W.T=null;try{for(var g=s.onRecoverableError,S=0;S<f.length;S++){var F=f[S];g(F.value,{componentStack:F.stack})}}finally{W.T=l,ee.p=x}}(Kn&3)!==0&&uf(),dn(s),x=s.pendingLanes,(c&261930)!==0&&(x&42)!==0?s===Em?Bo++:(Bo=0,Em=s):Bo=0,Uo(0)}}function Ty(s,l){(s.pooledCacheLanes&=l)===0&&(l=s.pooledCache,l!=null&&(s.pooledCache=null,jo(l)))}function uf(){return Sy(),_y(),Ey(),Cy()}function Cy(){if(Ka!==5)return!1;var s=Oi,l=Sm;Sm=0;var c=rs(Kn),f=W.T,x=ee.p;try{ee.p=32>c?32:c,W.T=null,c=_m,_m=null;var g=Oi,S=Kn;if(Ka=0,yc=Oi=null,Kn=0,(ca&6)!==0)throw Error(n(331));var F=ca;if(ca|=4,oy(g.current),iy(g,g.current,S,c),ca=F,Uo(0,!1),ia&&typeof ia.onPostCommitFiberRoot=="function")try{ia.onPostCommitFiberRoot(zt,g)}catch{}return!0}finally{ee.p=x,W.T=f,Ty(s,l)}}function Ay(s,l,c){l=ws(c,l),l=sm(s.stateNode,l,2),s=_i(s,l,2),s!==null&&(Hr(s,2),dn(s))}function da(s,l,c){if(s.tag===3)Ay(s,s,c);else for(;l!==null;){if(l.tag===3){Ay(l,s,c);break}else if(l.tag===1){var f=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Di===null||!Di.has(f))){s=ws(c,s),c=k1(2),f=_i(l,c,2),f!==null&&(D1(c,f,l,s),Hr(f,2),dn(f));break}}l=l.return}}function Am(s,l,c){var f=s.pingCache;if(f===null){f=s.pingCache=new i4;var x=new Set;f.set(l,x)}else x=f.get(l),x===void 0&&(x=new Set,f.set(l,x));x.has(c)||(bm=!0,x.add(c),s=d4.bind(null,s,l,c),l.then(s,s))}function d4(s,l,c){var f=s.pingCache;f!==null&&f.delete(l),s.pingedLanes|=s.suspendedLanes&c,s.warmLanes&=~c,pa===s&&(Yt&c)===c&&(Da===4||Da===3&&(Yt&62914560)===Yt&&300>tt()-rf?(ca&2)===0&&jc(s,0):Nm|=c,vc===Yt&&(vc=0)),dn(s)}function ky(s,l){l===0&&(l=as()),s=ul(s,l),s!==null&&(Hr(s,l),dn(s))}function f4(s){var l=s.memoizedState,c=0;l!==null&&(c=l.retryLane),ky(s,c)}function h4(s,l){var c=0;switch(s.tag){case 31:case 13:var f=s.stateNode,x=s.memoizedState;x!==null&&(c=x.retryLane);break;case 19:f=s.stateNode;break;case 22:f=s.stateNode._retryCache;break;default:throw Error(n(314))}f!==null&&f.delete(l),ky(s,c)}function m4(s,l){return Jt(s,l)}var df=null,Nc=null,km=!1,ff=!1,Dm=!1,Mi=0;function dn(s){s!==Nc&&s.next===null&&(Nc===null?df=Nc=s:Nc=Nc.next=s),ff=!0,km||(km=!0,p4())}function Uo(s,l){if(!Dm&&ff){Dm=!0;do for(var c=!1,f=df;f!==null;){if(s!==0){var x=f.pendingLanes;if(x===0)var g=0;else{var S=f.suspendedLanes,F=f.pingedLanes;g=(1<<31-_a(42|s)+1)-1,g&=x&~(S&~F),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(c=!0,My(f,g))}else g=Yt,g=Ot(f,f===pa?g:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(g&3)===0||Bs(f,g)||(c=!0,My(f,g));f=f.next}while(c);Dm=!1}}function x4(){Dy()}function Dy(){ff=km=!1;var s=0;Mi!==0&&E4()&&(s=Mi);for(var l=tt(),c=null,f=df;f!==null;){var x=f.next,g=Oy(f,l);g===0?(f.next=null,c===null?df=x:c.next=x,x===null&&(Nc=c)):(c=f,(s!==0||(g&3)!==0)&&(ff=!0)),f=x}Ka!==0&&Ka!==5||Uo(s),Mi!==0&&(Mi=0)}function Oy(s,l){for(var c=s.suspendedLanes,f=s.pingedLanes,x=s.expirationTimes,g=s.pendingLanes&-62914561;0<g;){var S=31-_a(g),F=1<<S,te=x[S];te===-1?((F&c)===0||(F&f)!==0)&&(x[S]=ja(F,l)):te<=l&&(s.expiredLanes|=F),g&=~F}if(l=pa,c=Yt,c=Ot(s,s===l?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),f=s.callbackNode,c===0||s===l&&(ua===2||ua===9)||s.cancelPendingCommit!==null)return f!==null&&f!==null&&fa(f),s.callbackNode=null,s.callbackPriority=0;if((c&3)===0||Bs(s,c)){if(l=c&-c,l===s.callbackPriority)return l;switch(f!==null&&fa(f),rs(c)){case 2:case 8:c=bt;break;case 32:c=Ut;break;case 268435456:c=wt;break;default:c=Ut}return f=Ry.bind(null,s),c=Jt(c,f),s.callbackPriority=l,s.callbackNode=c,l}return f!==null&&f!==null&&fa(f),s.callbackPriority=2,s.callbackNode=null,2}function Ry(s,l){if(Ka!==0&&Ka!==5)return s.callbackNode=null,s.callbackPriority=0,null;var c=s.callbackNode;if(uf()&&s.callbackNode!==c)return null;var f=Yt;return f=Ot(s,s===pa?f:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),f===0?null:(my(s,f,l),Oy(s,tt()),s.callbackNode!=null&&s.callbackNode===c?Ry.bind(null,s):null)}function My(s,l){if(uf())return null;my(s,l,!0)}function p4(){C4(function(){(ca&6)!==0?Jt(ot,x4):Dy()})}function Om(){if(Mi===0){var s=lc;s===0&&(s=Dt,Dt<<=1,(Dt&261888)===0&&(Dt=256)),Mi=s}return Mi}function Fy(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:yd(""+s)}function Iy(s,l){var c=l.ownerDocument.createElement("input");return c.name=l.name,c.value=l.value,s.id&&c.setAttribute("form",s.id),l.parentNode.insertBefore(c,l),s=new FormData(s),c.parentNode.removeChild(c),s}function g4(s,l,c,f,x){if(l==="submit"&&c&&c.stateNode===x){var g=Fy((x[G]||null).action),S=f.submitter;S&&(l=(l=S[G]||null)?Fy(l.formAction):S.getAttribute("formAction"),l!==null&&(g=l,S=null));var F=new wd("action","action",null,f,x);s.push({event:F,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Mi!==0){var te=S?Iy(x,S):new FormData(x);Zh(c,{pending:!0,data:te,method:x.method,action:g},null,te)}}else typeof g=="function"&&(F.preventDefault(),te=S?Iy(x,S):new FormData(x),Zh(c,{pending:!0,data:te,method:x.method,action:g},g,te))},currentTarget:x}]})}}for(var Rm=0;Rm<xh.length;Rm++){var Mm=xh[Rm],v4=Mm.toLowerCase(),y4=Mm[0].toUpperCase()+Mm.slice(1);Vs(v4,"on"+y4)}Vs(hv,"onAnimationEnd"),Vs(mv,"onAnimationIteration"),Vs(xv,"onAnimationStart"),Vs("dblclick","onDoubleClick"),Vs("focusin","onFocus"),Vs("focusout","onBlur"),Vs(FT,"onTransitionRun"),Vs(IT,"onTransitionStart"),Vs(LT,"onTransitionCancel"),Vs(pv,"onTransitionEnd"),pr("onMouseEnter",["mouseout","mouseover"]),pr("onMouseLeave",["mouseout","mouseover"]),pr("onPointerEnter",["pointerout","pointerover"]),pr("onPointerLeave",["pointerout","pointerover"]),la("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),la("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),la("onBeforeInput",["compositionend","keypress","textInput","paste"]),la("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),la("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),la("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),j4=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(zo));function Ly(s,l){l=(l&4)!==0;for(var c=0;c<s.length;c++){var f=s[c],x=f.event;f=f.listeners;e:{var g=void 0;if(l)for(var S=f.length-1;0<=S;S--){var F=f[S],te=F.instance,fe=F.currentTarget;if(F=F.listener,te!==g&&x.isPropagationStopped())break e;g=F,x.currentTarget=fe;try{g(x)}catch(_e){Ed(_e)}x.currentTarget=null,g=te}else for(S=0;S<f.length;S++){if(F=f[S],te=F.instance,fe=F.currentTarget,F=F.listener,te!==g&&x.isPropagationStopped())break e;g=F,x.currentTarget=fe;try{g(x)}catch(_e){Ed(_e)}x.currentTarget=null,g=te}}}}function Gt(s,l){var c=l[ue];c===void 0&&(c=l[ue]=new Set);var f=s+"__bubble";c.has(f)||(Py(l,s,2,!1),c.add(f))}function Fm(s,l,c){var f=0;l&&(f|=4),Py(c,s,f,l)}var hf="_reactListening"+Math.random().toString(36).slice(2);function Im(s){if(!s[hf]){s[hf]=!0,Lt.forEach(function(c){c!=="selectionchange"&&(j4.has(c)||Fm(c,!1,s),Fm(c,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[hf]||(l[hf]=!0,Fm("selectionchange",!1,l))}}function Py(s,l,c,f){switch(hj(l)){case 2:var x=X4;break;case 8:x=$4;break;default:x=Qm}c=x.bind(null,l,c,s),x=void 0,!ah||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(x=!0),f?x!==void 0?s.addEventListener(l,c,{capture:!0,passive:x}):s.addEventListener(l,c,!0):x!==void 0?s.addEventListener(l,c,{passive:x}):s.addEventListener(l,c,!1)}function Lm(s,l,c,f,x){var g=f;if((l&1)===0&&(l&2)===0&&f!==null)e:for(;;){if(f===null)return;var S=f.tag;if(S===3||S===4){var F=f.stateNode.containerInfo;if(F===x)break;if(S===4)for(S=f.return;S!==null;){var te=S.tag;if((te===3||te===4)&&S.stateNode.containerInfo===x)return;S=S.return}for(;F!==null;){if(S=le(F),S===null)return;if(te=S.tag,te===5||te===6||te===26||te===27){f=g=S;continue e}F=F.parentNode}}f=f.return}Hg(function(){var fe=g,_e=eh(c),Re=[];e:{var ve=gv.get(s);if(ve!==void 0){var be=wd,rt=s;switch(s){case"keypress":if(bd(c)===0)break e;case"keydown":case"keyup":be=hT;break;case"focusin":rt="focus",be=ih;break;case"focusout":rt="blur",be=ih;break;case"beforeblur":case"afterblur":be=ih;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":be=Wg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":be=tT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":be=pT;break;case hv:case mv:case xv:be=sT;break;case pv:be=vT;break;case"scroll":case"scrollend":be=JE;break;case"wheel":be=jT;break;case"copy":case"cut":case"paste":be=iT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":be=Xg;break;case"toggle":case"beforetoggle":be=NT}var Nt=(l&4)!==0,xa=!Nt&&(s==="scroll"||s==="scrollend"),ie=Nt?ve!==null?ve+"Capture":null:ve;Nt=[];for(var se=fe,ce;se!==null;){var ke=se;if(ce=ke.stateNode,ke=ke.tag,ke!==5&&ke!==26&&ke!==27||ce===null||ie===null||(ke=co(se,ie),ke!=null&&Nt.push(Vo(se,ke,ce))),xa)break;se=se.return}0<Nt.length&&(ve=new be(ve,rt,null,c,_e),Re.push({event:ve,listeners:Nt}))}}if((l&7)===0){e:{if(ve=s==="mouseover"||s==="pointerover",be=s==="mouseout"||s==="pointerout",ve&&c!==J0&&(rt=c.relatedTarget||c.fromElement)&&(le(rt)||rt[Q]))break e;if((be||ve)&&(ve=_e.window===_e?_e:(ve=_e.ownerDocument)?ve.defaultView||ve.parentWindow:window,be?(rt=c.relatedTarget||c.toElement,be=fe,rt=rt?le(rt):null,rt!==null&&(xa=o(rt),Nt=rt.tag,rt!==xa||Nt!==5&&Nt!==27&&Nt!==6)&&(rt=null)):(be=null,rt=fe),be!==rt)){if(Nt=Wg,ke="onMouseLeave",ie="onMouseEnter",se="mouse",(s==="pointerout"||s==="pointerover")&&(Nt=Xg,ke="onPointerLeave",ie="onPointerEnter",se="pointer"),xa=be==null?ve:Oe(be),ce=rt==null?ve:Oe(rt),ve=new Nt(ke,se+"leave",be,c,_e),ve.target=xa,ve.relatedTarget=ce,ke=null,le(_e)===fe&&(Nt=new Nt(ie,se+"enter",rt,c,_e),Nt.target=ce,Nt.relatedTarget=xa,ke=Nt),xa=ke,be&&rt)t:{for(Nt=b4,ie=be,se=rt,ce=0,ke=ie;ke;ke=Nt(ke))ce++;ke=0;for(var mt=se;mt;mt=Nt(mt))ke++;for(;0<ce-ke;)ie=Nt(ie),ce--;for(;0<ke-ce;)se=Nt(se),ke--;for(;ce--;){if(ie===se||se!==null&&ie===se.alternate){Nt=ie;break t}ie=Nt(ie),se=Nt(se)}Nt=null}else Nt=null;be!==null&&By(Re,ve,be,Nt,!1),rt!==null&&xa!==null&&By(Re,xa,rt,Nt,!0)}}e:{if(ve=fe?Oe(fe):window,be=ve.nodeName&&ve.nodeName.toLowerCase(),be==="select"||be==="input"&&ve.type==="file")var ra=av;else if(ev(ve))if(rv)ra=OT;else{ra=kT;var lt=AT}else be=ve.nodeName,!be||be.toLowerCase()!=="input"||ve.type!=="checkbox"&&ve.type!=="radio"?fe&&Z0(fe.elementType)&&(ra=av):ra=DT;if(ra&&(ra=ra(s,fe))){tv(Re,ra,c,_e);break e}lt&&lt(s,ve,fe),s==="focusout"&&fe&&ve.type==="number"&&fe.memoizedProps.value!=null&&Q0(ve,"number",ve.value)}switch(lt=fe?Oe(fe):window,s){case"focusin":(ev(lt)||lt.contentEditable==="true")&&(Jl=lt,fh=fe,go=null);break;case"focusout":go=fh=Jl=null;break;case"mousedown":hh=!0;break;case"contextmenu":case"mouseup":case"dragend":hh=!1,dv(Re,c,_e);break;case"selectionchange":if(MT)break;case"keydown":case"keyup":dv(Re,c,_e)}var Pt;if(ch)e:{switch(s){case"compositionstart":var Xt="onCompositionStart";break e;case"compositionend":Xt="onCompositionEnd";break e;case"compositionupdate":Xt="onCompositionUpdate";break e}Xt=void 0}else Zl?Zg(s,c)&&(Xt="onCompositionEnd"):s==="keydown"&&c.keyCode===229&&(Xt="onCompositionStart");Xt&&($g&&c.locale!=="ko"&&(Zl||Xt!=="onCompositionStart"?Xt==="onCompositionEnd"&&Zl&&(Pt=Gg()):(vi=_e,rh="value"in vi?vi.value:vi.textContent,Zl=!0)),lt=mf(fe,Xt),0<lt.length&&(Xt=new Yg(Xt,s,null,c,_e),Re.push({event:Xt,listeners:lt}),Pt?Xt.data=Pt:(Pt=Jg(c),Pt!==null&&(Xt.data=Pt)))),(Pt=ST?_T(s,c):ET(s,c))&&(Xt=mf(fe,"onBeforeInput"),0<Xt.length&&(lt=new Yg("onBeforeInput","beforeinput",null,c,_e),Re.push({event:lt,listeners:Xt}),lt.data=Pt)),g4(Re,s,fe,c,_e)}Ly(Re,l)})}function Vo(s,l,c){return{instance:s,listener:l,currentTarget:c}}function mf(s,l){for(var c=l+"Capture",f=[];s!==null;){var x=s,g=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||g===null||(x=co(s,c),x!=null&&f.unshift(Vo(s,x,g)),x=co(s,l),x!=null&&f.push(Vo(s,x,g))),s.tag===3)return f;s=s.return}return[]}function b4(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function By(s,l,c,f,x){for(var g=l._reactName,S=[];c!==null&&c!==f;){var F=c,te=F.alternate,fe=F.stateNode;if(F=F.tag,te!==null&&te===f)break;F!==5&&F!==26&&F!==27||fe===null||(te=fe,x?(fe=co(c,g),fe!=null&&S.unshift(Vo(c,fe,te))):x||(fe=co(c,g),fe!=null&&S.push(Vo(c,fe,te)))),c=c.return}S.length!==0&&s.push({event:l,listeners:S})}var N4=/\r\n?/g,w4=/\u0000|\uFFFD/g;function Uy(s){return(typeof s=="string"?s:""+s).replace(N4,`
`).replace(w4,"")}function zy(s,l){return l=Uy(l),Uy(s)===l}function ma(s,l,c,f,x,g){switch(c){case"children":typeof f=="string"?l==="body"||l==="textarea"&&f===""||$l(s,f):(typeof f=="number"||typeof f=="bigint")&&l!=="body"&&$l(s,""+f);break;case"className":gd(s,"class",f);break;case"tabIndex":gd(s,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":gd(s,c,f);break;case"style":zg(s,f,g);break;case"data":if(l!=="object"){gd(s,"data",f);break}case"src":case"href":if(f===""&&(l!=="a"||c!=="href")){s.removeAttribute(c);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){s.removeAttribute(c);break}f=yd(""+f),s.setAttribute(c,f);break;case"action":case"formAction":if(typeof f=="function"){s.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(c==="formAction"?(l!=="input"&&ma(s,l,"name",x.name,x,null),ma(s,l,"formEncType",x.formEncType,x,null),ma(s,l,"formMethod",x.formMethod,x,null),ma(s,l,"formTarget",x.formTarget,x,null)):(ma(s,l,"encType",x.encType,x,null),ma(s,l,"method",x.method,x,null),ma(s,l,"target",x.target,x,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){s.removeAttribute(c);break}f=yd(""+f),s.setAttribute(c,f);break;case"onClick":f!=null&&(s.onclick=Fn);break;case"onScroll":f!=null&&Gt("scroll",s);break;case"onScrollEnd":f!=null&&Gt("scrollend",s);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(c=f.__html,c!=null){if(x.children!=null)throw Error(n(60));s.innerHTML=c}}break;case"multiple":s.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":s.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){s.removeAttribute("xlink:href");break}c=yd(""+f),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(c,""+f):s.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(c,""):s.removeAttribute(c);break;case"capture":case"download":f===!0?s.setAttribute(c,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(c,f):s.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?s.setAttribute(c,f):s.removeAttribute(c);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?s.removeAttribute(c):s.setAttribute(c,f);break;case"popover":Gt("beforetoggle",s),Gt("toggle",s),Gr(s,"popover",f);break;case"xlinkActuate":Mn(s,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Mn(s,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Mn(s,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Mn(s,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Mn(s,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Mn(s,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Mn(s,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Mn(s,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Mn(s,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":Gr(s,"is",f);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=QE.get(c)||c,Gr(s,c,f))}}function Pm(s,l,c,f,x,g){switch(c){case"style":zg(s,f,g);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(c=f.__html,c!=null){if(x.children!=null)throw Error(n(60));s.innerHTML=c}}break;case"children":typeof f=="string"?$l(s,f):(typeof f=="number"||typeof f=="bigint")&&$l(s,""+f);break;case"onScroll":f!=null&&Gt("scroll",s);break;case"onScrollEnd":f!=null&&Gt("scrollend",s);break;case"onClick":f!=null&&(s.onclick=Fn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Wt.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(x=c.endsWith("Capture"),l=c.slice(2,x?c.length-7:void 0),g=s[G]||null,g=g!=null?g[c]:null,typeof g=="function"&&s.removeEventListener(l,g,x),typeof f=="function")){typeof g!="function"&&g!==null&&(c in s?s[c]=null:s.hasAttribute(c)&&s.removeAttribute(c)),s.addEventListener(l,f,x);break e}c in s?s[c]=f:f===!0?s.setAttribute(c,""):Gr(s,c,f)}}}function lr(s,l,c){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Gt("error",s),Gt("load",s);var f=!1,x=!1,g;for(g in c)if(c.hasOwnProperty(g)){var S=c[g];if(S!=null)switch(g){case"src":f=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:ma(s,l,g,S,c,null)}}x&&ma(s,l,"srcSet",c.srcSet,c,null),f&&ma(s,l,"src",c.src,c,null);return;case"input":Gt("invalid",s);var F=g=S=x=null,te=null,fe=null;for(f in c)if(c.hasOwnProperty(f)){var _e=c[f];if(_e!=null)switch(f){case"name":x=_e;break;case"type":S=_e;break;case"checked":te=_e;break;case"defaultChecked":fe=_e;break;case"value":g=_e;break;case"defaultValue":F=_e;break;case"children":case"dangerouslySetInnerHTML":if(_e!=null)throw Error(n(137,l));break;default:ma(s,l,f,_e,c,null)}}Lg(s,g,F,te,fe,S,x,!1);return;case"select":Gt("invalid",s),f=S=g=null;for(x in c)if(c.hasOwnProperty(x)&&(F=c[x],F!=null))switch(x){case"value":g=F;break;case"defaultValue":S=F;break;case"multiple":f=F;default:ma(s,l,x,F,c,null)}l=g,c=S,s.multiple=!!f,l!=null?Xl(s,!!f,l,!1):c!=null&&Xl(s,!!f,c,!0);return;case"textarea":Gt("invalid",s),g=x=f=null;for(S in c)if(c.hasOwnProperty(S)&&(F=c[S],F!=null))switch(S){case"value":f=F;break;case"defaultValue":x=F;break;case"children":g=F;break;case"dangerouslySetInnerHTML":if(F!=null)throw Error(n(91));break;default:ma(s,l,S,F,c,null)}Bg(s,f,x,g);return;case"option":for(te in c)if(c.hasOwnProperty(te)&&(f=c[te],f!=null))switch(te){case"selected":s.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:ma(s,l,te,f,c,null)}return;case"dialog":Gt("beforetoggle",s),Gt("toggle",s),Gt("cancel",s),Gt("close",s);break;case"iframe":case"object":Gt("load",s);break;case"video":case"audio":for(f=0;f<zo.length;f++)Gt(zo[f],s);break;case"image":Gt("error",s),Gt("load",s);break;case"details":Gt("toggle",s);break;case"embed":case"source":case"link":Gt("error",s),Gt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(fe in c)if(c.hasOwnProperty(fe)&&(f=c[fe],f!=null))switch(fe){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:ma(s,l,fe,f,c,null)}return;default:if(Z0(l)){for(_e in c)c.hasOwnProperty(_e)&&(f=c[_e],f!==void 0&&Pm(s,l,_e,f,c,void 0));return}}for(F in c)c.hasOwnProperty(F)&&(f=c[F],f!=null&&ma(s,l,F,f,c,null))}function S4(s,l,c,f){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,g=null,S=null,F=null,te=null,fe=null,_e=null;for(be in c){var Re=c[be];if(c.hasOwnProperty(be)&&Re!=null)switch(be){case"checked":break;case"value":break;case"defaultValue":te=Re;default:f.hasOwnProperty(be)||ma(s,l,be,null,f,Re)}}for(var ve in f){var be=f[ve];if(Re=c[ve],f.hasOwnProperty(ve)&&(be!=null||Re!=null))switch(ve){case"type":g=be;break;case"name":x=be;break;case"checked":fe=be;break;case"defaultChecked":_e=be;break;case"value":S=be;break;case"defaultValue":F=be;break;case"children":case"dangerouslySetInnerHTML":if(be!=null)throw Error(n(137,l));break;default:be!==Re&&ma(s,l,ve,be,f,Re)}}K0(s,S,F,te,fe,_e,g,x);return;case"select":be=S=F=ve=null;for(g in c)if(te=c[g],c.hasOwnProperty(g)&&te!=null)switch(g){case"value":break;case"multiple":be=te;default:f.hasOwnProperty(g)||ma(s,l,g,null,f,te)}for(x in f)if(g=f[x],te=c[x],f.hasOwnProperty(x)&&(g!=null||te!=null))switch(x){case"value":ve=g;break;case"defaultValue":F=g;break;case"multiple":S=g;default:g!==te&&ma(s,l,x,g,f,te)}l=F,c=S,f=be,ve!=null?Xl(s,!!c,ve,!1):!!f!=!!c&&(l!=null?Xl(s,!!c,l,!0):Xl(s,!!c,c?[]:"",!1));return;case"textarea":be=ve=null;for(F in c)if(x=c[F],c.hasOwnProperty(F)&&x!=null&&!f.hasOwnProperty(F))switch(F){case"value":break;case"children":break;default:ma(s,l,F,null,f,x)}for(S in f)if(x=f[S],g=c[S],f.hasOwnProperty(S)&&(x!=null||g!=null))switch(S){case"value":ve=x;break;case"defaultValue":be=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(n(91));break;default:x!==g&&ma(s,l,S,x,f,g)}Pg(s,ve,be);return;case"option":for(var rt in c)if(ve=c[rt],c.hasOwnProperty(rt)&&ve!=null&&!f.hasOwnProperty(rt))switch(rt){case"selected":s.selected=!1;break;default:ma(s,l,rt,null,f,ve)}for(te in f)if(ve=f[te],be=c[te],f.hasOwnProperty(te)&&ve!==be&&(ve!=null||be!=null))switch(te){case"selected":s.selected=ve&&typeof ve!="function"&&typeof ve!="symbol";break;default:ma(s,l,te,ve,f,be)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Nt in c)ve=c[Nt],c.hasOwnProperty(Nt)&&ve!=null&&!f.hasOwnProperty(Nt)&&ma(s,l,Nt,null,f,ve);for(fe in f)if(ve=f[fe],be=c[fe],f.hasOwnProperty(fe)&&ve!==be&&(ve!=null||be!=null))switch(fe){case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(n(137,l));break;default:ma(s,l,fe,ve,f,be)}return;default:if(Z0(l)){for(var xa in c)ve=c[xa],c.hasOwnProperty(xa)&&ve!==void 0&&!f.hasOwnProperty(xa)&&Pm(s,l,xa,void 0,f,ve);for(_e in f)ve=f[_e],be=c[_e],!f.hasOwnProperty(_e)||ve===be||ve===void 0&&be===void 0||Pm(s,l,_e,ve,f,be);return}}for(var ie in c)ve=c[ie],c.hasOwnProperty(ie)&&ve!=null&&!f.hasOwnProperty(ie)&&ma(s,l,ie,null,f,ve);for(Re in f)ve=f[Re],be=c[Re],!f.hasOwnProperty(Re)||ve===be||ve==null&&be==null||ma(s,l,Re,ve,f,be)}function Vy(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function _4(){if(typeof performance.getEntriesByType=="function"){for(var s=0,l=0,c=performance.getEntriesByType("resource"),f=0;f<c.length;f++){var x=c[f],g=x.transferSize,S=x.initiatorType,F=x.duration;if(g&&F&&Vy(S)){for(S=0,F=x.responseEnd,f+=1;f<c.length;f++){var te=c[f],fe=te.startTime;if(fe>F)break;var _e=te.transferSize,Re=te.initiatorType;_e&&Vy(Re)&&(te=te.responseEnd,S+=_e*(te<F?1:(F-fe)/(te-fe)))}if(--f,l+=8*(g+S)/(x.duration/1e3),s++,10<s)break}}if(0<s)return l/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Bm=null,Um=null;function xf(s){return s.nodeType===9?s:s.ownerDocument}function Hy(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Gy(s,l){if(s===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&l==="foreignObject"?0:s}function zm(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var Vm=null;function E4(){var s=window.event;return s&&s.type==="popstate"?s===Vm?!1:(Vm=s,!0):(Vm=null,!1)}var qy=typeof setTimeout=="function"?setTimeout:void 0,T4=typeof clearTimeout=="function"?clearTimeout:void 0,Wy=typeof Promise=="function"?Promise:void 0,C4=typeof queueMicrotask=="function"?queueMicrotask:typeof Wy<"u"?function(s){return Wy.resolve(null).then(s).catch(A4)}:qy;function A4(s){setTimeout(function(){throw s})}function Fi(s){return s==="head"}function Yy(s,l){var c=l,f=0;do{var x=c.nextSibling;if(s.removeChild(c),x&&x.nodeType===8)if(c=x.data,c==="/$"||c==="/&"){if(f===0){s.removeChild(x),Ec(l);return}f--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")f++;else if(c==="html")Ho(s.ownerDocument.documentElement);else if(c==="head"){c=s.ownerDocument.head,Ho(c);for(var g=c.firstChild;g;){var S=g.nextSibling,F=g.nodeName;g[ae]||F==="SCRIPT"||F==="STYLE"||F==="LINK"&&g.rel.toLowerCase()==="stylesheet"||c.removeChild(g),g=S}}else c==="body"&&Ho(s.ownerDocument.body);c=x}while(c);Ec(l)}function Xy(s,l){var c=s;s=0;do{var f=c.nextSibling;if(c.nodeType===1?l?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(l?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),f&&f.nodeType===8)if(c=f.data,c==="/$"){if(s===0)break;s--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||s++;c=f}while(c)}function Hm(s){var l=s.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var c=l;switch(l=l.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":Hm(c),V(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}s.removeChild(c)}}function k4(s,l,c,f){for(;s.nodeType===1;){var x=c;if(s.nodeName.toLowerCase()!==l.toLowerCase()){if(!f&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(f){if(!s[ae])switch(l){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(g=s.getAttribute("rel"),g==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(g!==x.rel||s.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||s.getAttribute("title")!==(x.title==null?null:x.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(g=s.getAttribute("src"),(g!==(x.src==null?null:x.src)||s.getAttribute("type")!==(x.type==null?null:x.type)||s.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&g&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(l==="input"&&s.type==="hidden"){var g=x.name==null?null:""+x.name;if(x.type==="hidden"&&s.getAttribute("name")===g)return s}else return s;if(s=Cs(s.nextSibling),s===null)break}return null}function D4(s,l,c){if(l==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!c||(s=Cs(s.nextSibling),s===null))return null;return s}function $y(s,l){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=Cs(s.nextSibling),s===null))return null;return s}function Gm(s){return s.data==="$?"||s.data==="$~"}function qm(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function O4(s,l){var c=s.ownerDocument;if(s.data==="$~")s._reactRetry=l;else if(s.data!=="$?"||c.readyState!=="loading")l();else{var f=function(){l(),c.removeEventListener("DOMContentLoaded",f)};c.addEventListener("DOMContentLoaded",f),s._reactRetry=f}}function Cs(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return s}var Wm=null;function Ky(s){s=s.nextSibling;for(var l=0;s;){if(s.nodeType===8){var c=s.data;if(c==="/$"||c==="/&"){if(l===0)return Cs(s.nextSibling);l--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||l++}s=s.nextSibling}return null}function Qy(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var c=s.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(l===0)return s;l--}else c!=="/$"&&c!=="/&"||l++}s=s.previousSibling}return null}function Zy(s,l,c){switch(l=xf(c),s){case"html":if(s=l.documentElement,!s)throw Error(n(452));return s;case"head":if(s=l.head,!s)throw Error(n(453));return s;case"body":if(s=l.body,!s)throw Error(n(454));return s;default:throw Error(n(451))}}function Ho(s){for(var l=s.attributes;l.length;)s.removeAttributeNode(l[0]);V(s)}var As=new Map,Jy=new Set;function pf(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Qn=ee.d;ee.d={f:R4,r:M4,D:F4,C:I4,L:L4,m:P4,X:U4,S:B4,M:z4};function R4(){var s=Qn.f(),l=lf();return s||l}function M4(s){var l=Ne(s);l!==null&&l.tag===5&&l.type==="form"?p1(l):Qn.r(s)}var wc=typeof document>"u"?null:document;function ej(s,l,c){var f=wc;if(f&&typeof l=="string"&&l){var x=bs(l);x='link[rel="'+s+'"][href="'+x+'"]',typeof c=="string"&&(x+='[crossorigin="'+c+'"]'),Jy.has(x)||(Jy.add(x),s={rel:s,crossOrigin:c,href:l},f.querySelector(x)===null&&(l=f.createElement("link"),lr(l,"link",s),We(l),f.head.appendChild(l)))}}function F4(s){Qn.D(s),ej("dns-prefetch",s,null)}function I4(s,l){Qn.C(s,l),ej("preconnect",s,l)}function L4(s,l,c){Qn.L(s,l,c);var f=wc;if(f&&s&&l){var x='link[rel="preload"][as="'+bs(l)+'"]';l==="image"&&c&&c.imageSrcSet?(x+='[imagesrcset="'+bs(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(x+='[imagesizes="'+bs(c.imageSizes)+'"]')):x+='[href="'+bs(s)+'"]';var g=x;switch(l){case"style":g=Sc(s);break;case"script":g=_c(s)}As.has(g)||(s=v({rel:"preload",href:l==="image"&&c&&c.imageSrcSet?void 0:s,as:l},c),As.set(g,s),f.querySelector(x)!==null||l==="style"&&f.querySelector(Go(g))||l==="script"&&f.querySelector(qo(g))||(l=f.createElement("link"),lr(l,"link",s),We(l),f.head.appendChild(l)))}}function P4(s,l){Qn.m(s,l);var c=wc;if(c&&s){var f=l&&typeof l.as=="string"?l.as:"script",x='link[rel="modulepreload"][as="'+bs(f)+'"][href="'+bs(s)+'"]',g=x;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=_c(s)}if(!As.has(g)&&(s=v({rel:"modulepreload",href:s},l),As.set(g,s),c.querySelector(x)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(qo(g)))return}f=c.createElement("link"),lr(f,"link",s),We(f),c.head.appendChild(f)}}}function B4(s,l,c){Qn.S(s,l,c);var f=wc;if(f&&s){var x=Ue(f).hoistableStyles,g=Sc(s);l=l||"default";var S=x.get(g);if(!S){var F={loading:0,preload:null};if(S=f.querySelector(Go(g)))F.loading=5;else{s=v({rel:"stylesheet",href:s,"data-precedence":l},c),(c=As.get(g))&&Ym(s,c);var te=S=f.createElement("link");We(te),lr(te,"link",s),te._p=new Promise(function(fe,_e){te.onload=fe,te.onerror=_e}),te.addEventListener("load",function(){F.loading|=1}),te.addEventListener("error",function(){F.loading|=2}),F.loading|=4,gf(S,l,f)}S={type:"stylesheet",instance:S,count:1,state:F},x.set(g,S)}}}function U4(s,l){Qn.X(s,l);var c=wc;if(c&&s){var f=Ue(c).hoistableScripts,x=_c(s),g=f.get(x);g||(g=c.querySelector(qo(x)),g||(s=v({src:s,async:!0},l),(l=As.get(x))&&Xm(s,l),g=c.createElement("script"),We(g),lr(g,"link",s),c.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},f.set(x,g))}}function z4(s,l){Qn.M(s,l);var c=wc;if(c&&s){var f=Ue(c).hoistableScripts,x=_c(s),g=f.get(x);g||(g=c.querySelector(qo(x)),g||(s=v({src:s,async:!0,type:"module"},l),(l=As.get(x))&&Xm(s,l),g=c.createElement("script"),We(g),lr(g,"link",s),c.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},f.set(x,g))}}function tj(s,l,c,f){var x=(x=xe.current)?pf(x):null;if(!x)throw Error(n(446));switch(s){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(l=Sc(c.href),c=Ue(x).hoistableStyles,f=c.get(l),f||(f={type:"style",instance:null,count:0,state:null},c.set(l,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){s=Sc(c.href);var g=Ue(x).hoistableStyles,S=g.get(s);if(S||(x=x.ownerDocument||x,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(s,S),(g=x.querySelector(Go(s)))&&!g._p&&(S.instance=g,S.state.loading=5),As.has(s)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},As.set(s,c),g||V4(x,s,c,S.state))),l&&f===null)throw Error(n(528,""));return S}if(l&&f!==null)throw Error(n(529,""));return null;case"script":return l=c.async,c=c.src,typeof c=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=_c(c),c=Ue(x).hoistableScripts,f=c.get(l),f||(f={type:"script",instance:null,count:0,state:null},c.set(l,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,s))}}function Sc(s){return'href="'+bs(s)+'"'}function Go(s){return'link[rel="stylesheet"]['+s+"]"}function aj(s){return v({},s,{"data-precedence":s.precedence,precedence:null})}function V4(s,l,c,f){s.querySelector('link[rel="preload"][as="style"]['+l+"]")?f.loading=1:(l=s.createElement("link"),f.preload=l,l.addEventListener("load",function(){return f.loading|=1}),l.addEventListener("error",function(){return f.loading|=2}),lr(l,"link",c),We(l),s.head.appendChild(l))}function _c(s){return'[src="'+bs(s)+'"]'}function qo(s){return"script[async]"+s}function rj(s,l,c){if(l.count++,l.instance===null)switch(l.type){case"style":var f=s.querySelector('style[data-href~="'+bs(c.href)+'"]');if(f)return l.instance=f,We(f),f;var x=v({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return f=(s.ownerDocument||s).createElement("style"),We(f),lr(f,"style",x),gf(f,c.precedence,s),l.instance=f;case"stylesheet":x=Sc(c.href);var g=s.querySelector(Go(x));if(g)return l.state.loading|=4,l.instance=g,We(g),g;f=aj(c),(x=As.get(x))&&Ym(f,x),g=(s.ownerDocument||s).createElement("link"),We(g);var S=g;return S._p=new Promise(function(F,te){S.onload=F,S.onerror=te}),lr(g,"link",f),l.state.loading|=4,gf(g,c.precedence,s),l.instance=g;case"script":return g=_c(c.src),(x=s.querySelector(qo(g)))?(l.instance=x,We(x),x):(f=c,(x=As.get(g))&&(f=v({},c),Xm(f,x)),s=s.ownerDocument||s,x=s.createElement("script"),We(x),lr(x,"link",f),s.head.appendChild(x),l.instance=x);case"void":return null;default:throw Error(n(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(f=l.instance,l.state.loading|=4,gf(f,c.precedence,s));return l.instance}function gf(s,l,c){for(var f=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=f.length?f[f.length-1]:null,g=x,S=0;S<f.length;S++){var F=f[S];if(F.dataset.precedence===l)g=F;else if(g!==x)break}g?g.parentNode.insertBefore(s,g.nextSibling):(l=c.nodeType===9?c.head:c,l.insertBefore(s,l.firstChild))}function Ym(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.title==null&&(s.title=l.title)}function Xm(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.integrity==null&&(s.integrity=l.integrity)}var vf=null;function sj(s,l,c){if(vf===null){var f=new Map,x=vf=new Map;x.set(c,f)}else x=vf,f=x.get(c),f||(f=new Map,x.set(c,f));if(f.has(s))return f;for(f.set(s,null),c=c.getElementsByTagName(s),x=0;x<c.length;x++){var g=c[x];if(!(g[ae]||g[U]||s==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var S=g.getAttribute(l)||"";S=s+S;var F=f.get(S);F?F.push(g):f.set(S,[g])}}return f}function nj(s,l,c){s=s.ownerDocument||s,s.head.insertBefore(c,l==="title"?s.querySelector("head > title"):null)}function H4(s,l,c){if(c===1||l.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return s=l.disabled,typeof l.precedence=="string"&&s==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function ij(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function G4(s,l,c,f){if(c.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var x=Sc(f.href),g=l.querySelector(Go(x));if(g){l=g._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(s.count++,s=yf.bind(s),l.then(s,s)),c.state.loading|=4,c.instance=g,We(g);return}g=l.ownerDocument||l,f=aj(f),(x=As.get(x))&&Ym(f,x),g=g.createElement("link"),We(g);var S=g;S._p=new Promise(function(F,te){S.onload=F,S.onerror=te}),lr(g,"link",f),c.instance=g}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(c,l),(l=c.state.preload)&&(c.state.loading&3)===0&&(s.count++,c=yf.bind(s),l.addEventListener("load",c),l.addEventListener("error",c))}}var $m=0;function q4(s,l){return s.stylesheets&&s.count===0&&bf(s,s.stylesheets),0<s.count||0<s.imgCount?function(c){var f=setTimeout(function(){if(s.stylesheets&&bf(s,s.stylesheets),s.unsuspend){var g=s.unsuspend;s.unsuspend=null,g()}},6e4+l);0<s.imgBytes&&$m===0&&($m=62500*_4());var x=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&bf(s,s.stylesheets),s.unsuspend)){var g=s.unsuspend;s.unsuspend=null,g()}},(s.imgBytes>$m?50:800)+l);return s.unsuspend=c,function(){s.unsuspend=null,clearTimeout(f),clearTimeout(x)}}:null}function yf(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)bf(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var jf=null;function bf(s,l){s.stylesheets=null,s.unsuspend!==null&&(s.count++,jf=new Map,l.forEach(W4,s),jf=null,yf.call(s))}function W4(s,l){if(!(l.state.loading&4)){var c=jf.get(s);if(c)var f=c.get(null);else{c=new Map,jf.set(s,c);for(var x=s.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<x.length;g++){var S=x[g];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(c.set(S.dataset.precedence,S),f=S)}f&&c.set(null,f)}x=l.instance,S=x.getAttribute("data-precedence"),g=c.get(S)||f,g===f&&c.set(null,x),c.set(S,x),this.count++,f=yf.bind(this),x.addEventListener("load",f),x.addEventListener("error",f),g?g.parentNode.insertBefore(x,g.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(x,s.firstChild)),l.state.loading|=4}}var Wo={$$typeof:_,Provider:null,Consumer:null,_currentValue:je,_currentValue2:je,_threadCount:0};function Y4(s,l,c,f,x,g,S,F,te){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Us(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Us(0),this.hiddenUpdates=Us(null),this.identifierPrefix=f,this.onUncaughtError=x,this.onCaughtError=g,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=te,this.incompleteTransitions=new Map}function lj(s,l,c,f,x,g,S,F,te,fe,_e,Re){return s=new Y4(s,l,c,S,te,fe,_e,Re,F),l=1,g===!0&&(l|=24),g=is(3,null,null,l),s.current=g,g.stateNode=s,l=Ch(),l.refCount++,s.pooledCache=l,l.refCount++,g.memoizedState={element:f,isDehydrated:c,cache:l},Oh(g),s}function cj(s){return s?(s=ac,s):ac}function oj(s,l,c,f,x,g){x=cj(x),f.context===null?f.context=x:f.pendingContext=x,f=Si(l),f.payload={element:c},g=g===void 0?null:g,g!==null&&(f.callback=g),c=_i(s,f,l),c!==null&&(Kr(c,s,l),So(c,s,l))}function uj(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var c=s.retryLane;s.retryLane=c!==0&&c<l?c:l}}function Km(s,l){uj(s,l),(s=s.alternate)&&uj(s,l)}function dj(s){if(s.tag===13||s.tag===31){var l=ul(s,67108864);l!==null&&Kr(l,s,67108864),Km(s,67108864)}}function fj(s){if(s.tag===13||s.tag===31){var l=ds();l=xr(l);var c=ul(s,l);c!==null&&Kr(c,s,l),Km(s,l)}}var Nf=!0;function X4(s,l,c,f){var x=W.T;W.T=null;var g=ee.p;try{ee.p=2,Qm(s,l,c,f)}finally{ee.p=g,W.T=x}}function $4(s,l,c,f){var x=W.T;W.T=null;var g=ee.p;try{ee.p=8,Qm(s,l,c,f)}finally{ee.p=g,W.T=x}}function Qm(s,l,c,f){if(Nf){var x=Zm(f);if(x===null)Lm(s,l,f,wf,c),mj(s,f);else if(Q4(x,s,l,c,f))f.stopPropagation();else if(mj(s,f),l&4&&-1<K4.indexOf(s)){for(;x!==null;){var g=Ne(x);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var S=aa(g.pendingLanes);if(S!==0){var F=g;for(F.pendingLanes|=2,F.entangledLanes|=2;S;){var te=1<<31-_a(S);F.entanglements[1]|=te,S&=~te}dn(g),(ca&6)===0&&(sf=tt()+500,Uo(0))}}break;case 31:case 13:F=ul(g,2),F!==null&&Kr(F,g,2),lf(),Km(g,2)}if(g=Zm(f),g===null&&Lm(s,l,f,wf,c),g===x)break;x=g}x!==null&&f.stopPropagation()}else Lm(s,l,f,null,c)}}function Zm(s){return s=eh(s),Jm(s)}var wf=null;function Jm(s){if(wf=null,s=le(s),s!==null){var l=o(s);if(l===null)s=null;else{var c=l.tag;if(c===13){if(s=u(l),s!==null)return s;s=null}else if(c===31){if(s=d(l),s!==null)return s;s=null}else if(c===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null)}}return wf=s,null}function hj(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Qe()){case ot:return 2;case bt:return 8;case Ut:case Ma:return 32;case wt:return 268435456;default:return 32}default:return 32}}var ex=!1,Ii=null,Li=null,Pi=null,Yo=new Map,Xo=new Map,Bi=[],K4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function mj(s,l){switch(s){case"focusin":case"focusout":Ii=null;break;case"dragenter":case"dragleave":Li=null;break;case"mouseover":case"mouseout":Pi=null;break;case"pointerover":case"pointerout":Yo.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xo.delete(l.pointerId)}}function $o(s,l,c,f,x,g){return s===null||s.nativeEvent!==g?(s={blockedOn:l,domEventName:c,eventSystemFlags:f,nativeEvent:g,targetContainers:[x]},l!==null&&(l=Ne(l),l!==null&&dj(l)),s):(s.eventSystemFlags|=f,l=s.targetContainers,x!==null&&l.indexOf(x)===-1&&l.push(x),s)}function Q4(s,l,c,f,x){switch(l){case"focusin":return Ii=$o(Ii,s,l,c,f,x),!0;case"dragenter":return Li=$o(Li,s,l,c,f,x),!0;case"mouseover":return Pi=$o(Pi,s,l,c,f,x),!0;case"pointerover":var g=x.pointerId;return Yo.set(g,$o(Yo.get(g)||null,s,l,c,f,x)),!0;case"gotpointercapture":return g=x.pointerId,Xo.set(g,$o(Xo.get(g)||null,s,l,c,f,x)),!0}return!1}function xj(s){var l=le(s.target);if(l!==null){var c=o(l);if(c!==null){if(l=c.tag,l===13){if(l=u(c),l!==null){s.blockedOn=l,Y(s.priority,function(){fj(c)});return}}else if(l===31){if(l=d(c),l!==null){s.blockedOn=l,Y(s.priority,function(){fj(c)});return}}else if(l===3&&c.stateNode.current.memoizedState.isDehydrated){s.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Sf(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var c=Zm(s.nativeEvent);if(c===null){c=s.nativeEvent;var f=new c.constructor(c.type,c);J0=f,c.target.dispatchEvent(f),J0=null}else return l=Ne(c),l!==null&&dj(l),s.blockedOn=c,!1;l.shift()}return!0}function pj(s,l,c){Sf(s)&&c.delete(l)}function Z4(){ex=!1,Ii!==null&&Sf(Ii)&&(Ii=null),Li!==null&&Sf(Li)&&(Li=null),Pi!==null&&Sf(Pi)&&(Pi=null),Yo.forEach(pj),Xo.forEach(pj)}function _f(s,l){s.blockedOn===l&&(s.blockedOn=null,ex||(ex=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Z4)))}var Ef=null;function gj(s){Ef!==s&&(Ef=s,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Ef===s&&(Ef=null);for(var l=0;l<s.length;l+=3){var c=s[l],f=s[l+1],x=s[l+2];if(typeof f!="function"){if(Jm(f||c)===null)continue;break}var g=Ne(c);g!==null&&(s.splice(l,3),l-=3,Zh(g,{pending:!0,data:x,method:c.method,action:f},f,x))}}))}function Ec(s){function l(te){return _f(te,s)}Ii!==null&&_f(Ii,s),Li!==null&&_f(Li,s),Pi!==null&&_f(Pi,s),Yo.forEach(l),Xo.forEach(l);for(var c=0;c<Bi.length;c++){var f=Bi[c];f.blockedOn===s&&(f.blockedOn=null)}for(;0<Bi.length&&(c=Bi[0],c.blockedOn===null);)xj(c),c.blockedOn===null&&Bi.shift();if(c=(s.ownerDocument||s).$$reactFormReplay,c!=null)for(f=0;f<c.length;f+=3){var x=c[f],g=c[f+1],S=x[G]||null;if(typeof g=="function")S||gj(c);else if(S){var F=null;if(g&&g.hasAttribute("formAction")){if(x=g,S=g[G]||null)F=S.formAction;else if(Jm(x)!==null)continue}else F=S.action;typeof F=="function"?c[f+1]=F:(c.splice(f,3),f-=3),gj(c)}}}function vj(){function s(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(S){return x=S})},focusReset:"manual",scroll:"manual"})}function l(){x!==null&&(x(),x=null),f||setTimeout(c,20)}function c(){if(!f&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,x=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(c,100),function(){f=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),x!==null&&(x(),x=null)}}}function tx(s){this._internalRoot=s}Tf.prototype.render=tx.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(n(409));var c=l.current,f=ds();oj(c,f,s,l,null,null)},Tf.prototype.unmount=tx.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;oj(s.current,2,null,s,null,null),lf(),l[Q]=null}};function Tf(s){this._internalRoot=s}Tf.prototype.unstable_scheduleHydration=function(s){if(s){var l=M();s={blockedOn:null,target:s,priority:l};for(var c=0;c<Bi.length&&l!==0&&l<Bi[c].priority;c++);Bi.splice(c,0,s),c===0&&xj(s)}};var yj=r.version;if(yj!=="19.2.3")throw Error(n(527,yj,"19.2.3"));ee.findDOMNode=function(s){var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(n(188)):(s=Object.keys(s).join(","),Error(n(268,s)));return s=m(l),s=s!==null?p(s):null,s=s===null?null:s.stateNode,s};var J4={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:W,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Cf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Cf.isDisabled&&Cf.supportsFiber)try{zt=Cf.inject(J4),ia=Cf}catch{}}return Jo.createRoot=function(s,l){if(!i(s))throw Error(n(299));var c=!1,f="",x=E1,g=T1,S=C1;return l!=null&&(l.unstable_strictMode===!0&&(c=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onUncaughtError!==void 0&&(x=l.onUncaughtError),l.onCaughtError!==void 0&&(g=l.onCaughtError),l.onRecoverableError!==void 0&&(S=l.onRecoverableError)),l=lj(s,1,!1,null,null,c,f,null,x,g,S,vj),s[Q]=l.current,Im(s),new tx(l)},Jo.hydrateRoot=function(s,l,c){if(!i(s))throw Error(n(299));var f=!1,x="",g=E1,S=T1,F=C1,te=null;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onUncaughtError!==void 0&&(g=c.onUncaughtError),c.onCaughtError!==void 0&&(S=c.onCaughtError),c.onRecoverableError!==void 0&&(F=c.onRecoverableError),c.formState!==void 0&&(te=c.formState)),l=lj(s,1,!0,l,c??null,f,x,te,g,S,F,vj),l.context=cj(null),c=l.current,f=ds(),f=xr(f),x=Si(f),x.callback=null,_i(c,x,f),c=f,l.current.lanes=c,Hr(l,c),dn(l),s[Q]=l.current,Im(s),new Tf(l)},Jo.version="19.2.3",Jo}var _j;function Nk(){if(_j)return rx.exports;_j=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r){console.error(r)}}return e(),rx.exports=bk(),rx.exports}Nk();function Au(e){return!!e&&!Array.isArray(e)&&typeof e=="object"}function wk(){return Object.create(null)}const Sk=typeof Symbol=="function"&&!!Symbol.asyncIterator;function DN(e){return Sk&&Au(e)&&Symbol.asyncIterator in e}var _k=Object.create,ON=Object.defineProperty,Ek=Object.getOwnPropertyDescriptor,RN=Object.getOwnPropertyNames,Tk=Object.getPrototypeOf,Ck=Object.prototype.hasOwnProperty,ad=(e,r)=>function(){return r||(0,e[RN(e)[0]])((r={exports:{}}).exports,r),r.exports},Ak=(e,r,a,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(var i=RN(r),o=0,u=i.length,d;o<u;o++)d=i[o],!Ck.call(e,d)&&d!==a&&ON(e,d,{get:(h=>r[h]).bind(null,d),enumerable:!(n=Ek(r,d))||n.enumerable});return e},kk=(e,r,a)=>(a=e!=null?_k(Tk(e)):{},Ak(ON(a,"default",{value:e,enumerable:!0}),e));const MN=()=>{},Ej=e=>{Object.freeze&&Object.freeze(e)};function FN(e,r,a){var n;const i=r.join(".");return(n=a[i])!==null&&n!==void 0||(a[i]=new Proxy(MN,{get(o,u){if(!(typeof u!="string"||u==="then"))return FN(e,[...r,u],a)},apply(o,u,d){const h=r[r.length-1];let m={args:d,path:r};return h==="call"?m={args:d.length>=2?[d[1]]:[],path:r.slice(0,-1)}:h==="apply"&&(m={args:d.length>=2?d[1]:[],path:r.slice(0,-1)}),Ej(m.args),Ej(m.path),e(m)}})),a[i]}const T0=e=>FN(e,[],wk()),Dp=e=>new Proxy(MN,{get(r,a){if(a!=="then")return e(a)}});var IN=ad({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/typeof.js"(e,r){function a(n){"@babel/helpers - typeof";return r.exports=a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},r.exports.__esModule=!0,r.exports.default=r.exports,a(n)}r.exports=a,r.exports.__esModule=!0,r.exports.default=r.exports}}),Dk=ad({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/toPrimitive.js"(e,r){var a=IN().default;function n(i,o){if(a(i)!="object"||!i)return i;var u=i[Symbol.toPrimitive];if(u!==void 0){var d=u.call(i,o||"default");if(a(d)!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(i)}r.exports=n,r.exports.__esModule=!0,r.exports.default=r.exports}}),Ok=ad({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/toPropertyKey.js"(e,r){var a=IN().default,n=Dk();function i(o){var u=n(o,"string");return a(u)=="symbol"?u:u+""}r.exports=i,r.exports.__esModule=!0,r.exports.default=r.exports}}),Rk=ad({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/defineProperty.js"(e,r){var a=Ok();function n(i,o,u){return(o=a(o))in i?Object.defineProperty(i,o,{value:u,enumerable:!0,configurable:!0,writable:!0}):i[o]=u,i}r.exports=n,r.exports.__esModule=!0,r.exports.default=r.exports}}),Mk=ad({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/objectSpread2.js"(e,r){var a=Rk();function n(o,u){var d=Object.keys(o);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(o);u&&(h=h.filter(function(m){return Object.getOwnPropertyDescriptor(o,m).enumerable})),d.push.apply(d,h)}return d}function i(o){for(var u=1;u<arguments.length;u++){var d=arguments[u]!=null?arguments[u]:{};u%2?n(Object(d),!0).forEach(function(h){a(o,h,d[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(d)):n(Object(d)).forEach(function(h){Object.defineProperty(o,h,Object.getOwnPropertyDescriptor(d,h))})}return o}r.exports=i,r.exports.__esModule=!0,r.exports.default=r.exports}});kk(Mk());function Op(e){const r={subscribe(a){let n=null,i=!1,o=!1,u=!1;function d(){if(n===null){u=!0;return}o||(o=!0,typeof n=="function"?n():n&&n.unsubscribe())}return n=e({next(h){var m;i||(m=a.next)===null||m===void 0||m.call(a,h)},error(h){var m;i||(i=!0,(m=a.error)===null||m===void 0||m.call(a,h),d())},complete(){var h;i||(i=!0,(h=a.complete)===null||h===void 0||h.call(a),d())}}),u&&d(),{unsubscribe:d}},pipe(...a){return a.reduce(Fk,r)}};return r}function Fk(e,r){return r(e)}function Ik(e){const r=new AbortController;return new Promise((n,i)=>{let o=!1;function u(){o||(o=!0,d.unsubscribe())}r.signal.addEventListener("abort",()=>{i(r.signal.reason)});const d=e.subscribe({next(h){o=!0,n(h),u()},error(h){i(h)},complete(){r.abort(),u()}})})}var Lk=Object.create,LN=Object.defineProperty,Pk=Object.getOwnPropertyDescriptor,PN=Object.getOwnPropertyNames,Bk=Object.getPrototypeOf,Uk=Object.prototype.hasOwnProperty,rl=(e,r)=>function(){return r||(0,e[PN(e)[0]])((r={exports:{}}).exports,r),r.exports},zk=(e,r,a,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(var i=PN(r),o=0,u=i.length,d;o<u;o++)d=i[o],!Uk.call(e,d)&&d!==a&&LN(e,d,{get:(h=>r[h]).bind(null,d),enumerable:!(n=Pk(r,d))||n.enumerable});return e},Pl=(e,r,a)=>(a=e!=null?Lk(Bk(e)):{},zk(r||!e||!e.__esModule?LN(a,"default",{value:e,enumerable:!0}):a,e)),Vk=rl({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/objectWithoutPropertiesLoose.js"(e,r){function a(n,i){if(n==null)return{};var o={};for(var u in n)if({}.hasOwnProperty.call(n,u)){if(i.includes(u))continue;o[u]=n[u]}return o}r.exports=a,r.exports.__esModule=!0,r.exports.default=r.exports}}),Hk=rl({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/objectWithoutProperties.js"(e,r){var a=Vk();function n(i,o){if(i==null)return{};var u,d,h=a(i,o);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(i);for(d=0;d<m.length;d++)u=m[d],o.includes(u)||{}.propertyIsEnumerable.call(i,u)&&(h[u]=i[u])}return h}r.exports=n,r.exports.__esModule=!0,r.exports.default=r.exports}}),BN=rl({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/typeof.js"(e,r){function a(n){"@babel/helpers - typeof";return r.exports=a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},r.exports.__esModule=!0,r.exports.default=r.exports,a(n)}r.exports=a,r.exports.__esModule=!0,r.exports.default=r.exports}}),Gk=rl({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/toPrimitive.js"(e,r){var a=BN().default;function n(i,o){if(a(i)!="object"||!i)return i;var u=i[Symbol.toPrimitive];if(u!==void 0){var d=u.call(i,o||"default");if(a(d)!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(i)}r.exports=n,r.exports.__esModule=!0,r.exports.default=r.exports}}),qk=rl({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/toPropertyKey.js"(e,r){var a=BN().default,n=Gk();function i(o){var u=n(o,"string");return a(u)=="symbol"?u:u+""}r.exports=i,r.exports.__esModule=!0,r.exports.default=r.exports}}),Wk=rl({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/defineProperty.js"(e,r){var a=qk();function n(i,o,u){return(o=a(o))in i?Object.defineProperty(i,o,{value:u,enumerable:!0,configurable:!0,writable:!0}):i[o]=u,i}r.exports=n,r.exports.__esModule=!0,r.exports.default=r.exports}}),rd=rl({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/objectSpread2.js"(e,r){var a=Wk();function n(o,u){var d=Object.keys(o);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(o);u&&(h=h.filter(function(m){return Object.getOwnPropertyDescriptor(o,m).enumerable})),d.push.apply(d,h)}return d}function i(o){for(var u=1;u<arguments.length;u++){var d=arguments[u]!=null?arguments[u]:{};u%2?n(Object(d),!0).forEach(function(h){a(o,h,d[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(d)):n(Object(d)).forEach(function(h){Object.defineProperty(o,h,Object.getOwnPropertyDescriptor(d,h))})}return o}r.exports=i,r.exports.__esModule=!0,r.exports.default=r.exports}}),Yk=Pl(Hk(),1),Tj=Pl(rd(),1);const Xk=["cursor","direction"];function vn(e,r,a){const n=e.flatMap(i=>i.split("."));if(!r&&(!a||a==="any"))return n.length?[n]:[];if(a==="infinite"&&Au(r)&&("direction"in r||"cursor"in r)){const{cursor:i,direction:o}=r,u=(0,Yk.default)(r,Xk);return[n,{input:u,type:"infinite"}]}return[n,(0,Tj.default)((0,Tj.default)({},typeof r<"u"&&r!==yn&&{input:r}),a&&a!=="any"&&{type:a})]}function $f(e){return vn(e,void 0,"any")}var $k=Object.create,UN=Object.defineProperty,Kk=Object.getOwnPropertyDescriptor,zN=Object.getOwnPropertyNames,Qk=Object.getPrototypeOf,Zk=Object.prototype.hasOwnProperty,En=(e,r)=>function(){return r||(0,e[zN(e)[0]])((r={exports:{}}).exports,r),r.exports},Jk=(e,r,a,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(var i=zN(r),o=0,u=i.length,d;o<u;o++)d=i[o],!Zk.call(e,d)&&d!==a&&UN(e,d,{get:(h=>r[h]).bind(null,d),enumerable:!(n=Kk(r,d))||n.enumerable});return e},Ba=(e,r,a)=>(a=e!=null?$k(Qk(e)):{},Jk(UN(a,"default",{value:e,enumerable:!0}),e)),VN=En({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/typeof.js"(e,r){function a(n){"@babel/helpers - typeof";return r.exports=a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},r.exports.__esModule=!0,r.exports.default=r.exports,a(n)}r.exports=a,r.exports.__esModule=!0,r.exports.default=r.exports}}),e3=En({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/toPrimitive.js"(e,r){var a=VN().default;function n(i,o){if(a(i)!="object"||!i)return i;var u=i[Symbol.toPrimitive];if(u!==void 0){var d=u.call(i,o||"default");if(a(d)!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(i)}r.exports=n,r.exports.__esModule=!0,r.exports.default=r.exports}}),t3=En({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/toPropertyKey.js"(e,r){var a=VN().default,n=e3();function i(o){var u=n(o,"string");return a(u)=="symbol"?u:u+""}r.exports=i,r.exports.__esModule=!0,r.exports.default=r.exports}}),Bl=En({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/defineProperty.js"(e,r){var a=t3();function n(i,o,u){return(o=a(o))in i?Object.defineProperty(i,o,{value:u,enumerable:!0,configurable:!0,writable:!0}):i[o]=u,i}r.exports=n,r.exports.__esModule=!0,r.exports.default=r.exports}}),sn=En({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/objectSpread2.js"(e,r){var a=Bl();function n(o,u){var d=Object.keys(o);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(o);u&&(h=h.filter(function(m){return Object.getOwnPropertyDescriptor(o,m).enumerable})),d.push.apply(d,h)}return d}function i(o){for(var u=1;u<arguments.length;u++){var d=arguments[u]!=null?arguments[u]:{};u%2?n(Object(d),!0).forEach(function(h){a(o,h,d[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(d)):n(Object(d)).forEach(function(h){Object.defineProperty(o,h,Object.getOwnPropertyDescriptor(d,h))})}return o}r.exports=i,r.exports.__esModule=!0,r.exports.default=r.exports}});function a3(e){return r=>{let a=0,n=null;const i=[];function o(){n||(n=r.subscribe({next(d){for(const m of i){var h;(h=m.next)===null||h===void 0||h.call(m,d)}},error(d){for(const m of i){var h;(h=m.error)===null||h===void 0||h.call(m,d)}},complete(){for(const h of i){var d;(d=h.complete)===null||d===void 0||d.call(h)}}}))}function u(){if(a===0&&n){const d=n;n=null,d.unsubscribe()}}return Op(d=>(a++,i.push(d),o(),{unsubscribe(){a--,u();const h=i.findIndex(m=>m===d);h>-1&&i.splice(h,1)}}))}}function r3(e){let r=e;const a=[],n=u=>{r!==void 0&&u.next(r),a.push(u)},i=u=>{a.splice(a.indexOf(u),1)},o=Op(u=>(n(u),()=>{i(u)}));return o.next=u=>{if(r!==u){r=u;for(const d of a)d.next(u)}},o.get=()=>r,o}function s3(e){return Op(r=>{function a(i=0,o=e.op){const u=e.links[i];if(!u)throw new Error("No more links to execute - did you forget to add an ending link?");return u({op:o,next(h){return a(i+1,h)}})}return a().subscribe(r)})}var Af=Ba(Bl()),Tc=Ba(sn());function n3(e){return e instanceof HN}function i3(e){return Au(e)&&Au(e.error)&&typeof e.error.code=="number"&&typeof e.error.message=="string"}function l3(e,r){return typeof e=="string"?e:Au(e)&&typeof e.message=="string"?e.message:r}var HN=class Kf extends Error{constructor(r,a){var n,i;const o=a?.cause;super(r,{cause:o}),(0,Af.default)(this,"cause",void 0),(0,Af.default)(this,"shape",void 0),(0,Af.default)(this,"data",void 0),(0,Af.default)(this,"meta",void 0),this.meta=a?.meta,this.cause=o,this.shape=a==null||(n=a.result)===null||n===void 0?void 0:n.error,this.data=a==null||(i=a.result)===null||i===void 0?void 0:i.error.data,this.name="TRPCClientError",Object.setPrototypeOf(this,Kf.prototype)}static from(r,a={}){const n=r;return n3(n)?(a.meta&&(n.meta=(0,Tc.default)((0,Tc.default)({},n.meta),a.meta)),n):i3(n)?new Kf(n.error.message,(0,Tc.default)((0,Tc.default)({},a),{},{result:n})):new Kf(l3(n,"Unknown error"),(0,Tc.default)((0,Tc.default)({},a),{},{cause:n}))}};Ba(sn());Ba(sn());Ba(sn());Ba(sn());const GN=(e,...r)=>typeof e=="function"?e(...r):e;Ba(Bl());function c3(){let e,r;return{promise:new Promise((n,i)=>{e=n,r=i}),resolve:e,reject:r}}async function o3(e){const r=await GN(e.url);if(!e.connectionParams)return r;const n=`${r.includes("?")?"&":"?"}connectionParams=1`;return r+n}async function u3(e){const r={method:"connectionParams",data:await GN(e)};return JSON.stringify(r)}Ba(Bl());var wl=Ba(Bl());function d3(e){const{promise:r,resolve:a,reject:n}=c3();return e.addEventListener("open",()=>{e.removeEventListener("error",n),a()}),e.addEventListener("error",n),r}function f3(e,{intervalMs:r,pongTimeoutMs:a}){let n,i;function o(){n=setTimeout(()=>{e.send("PING"),i=setTimeout(()=>{e.close()},a)},r)}function u(){clearTimeout(n),o()}function d(){clearTimeout(i),u()}e.addEventListener("open",o),e.addEventListener("message",({data:h})=>{clearTimeout(n),o(),h==="PONG"&&d()}),e.addEventListener("close",()=>{clearTimeout(n),clearTimeout(i)})}var h3=class zx{constructor(r){var a;if((0,wl.default)(this,"id",++zx.connectCount),(0,wl.default)(this,"WebSocketPonyfill",void 0),(0,wl.default)(this,"urlOptions",void 0),(0,wl.default)(this,"keepAliveOpts",void 0),(0,wl.default)(this,"wsObservable",r3(null)),(0,wl.default)(this,"openPromise",null),this.WebSocketPonyfill=(a=r.WebSocketPonyfill)!==null&&a!==void 0?a:WebSocket,!this.WebSocketPonyfill)throw new Error("No WebSocket implementation found - you probably don't want to use this on the server, but if you do you need to pass a `WebSocket`-ponyfill");this.urlOptions=r.urlOptions,this.keepAliveOpts=r.keepAlive}get ws(){return this.wsObservable.get()}set ws(r){this.wsObservable.next(r)}isOpen(){return!!this.ws&&this.ws.readyState===this.WebSocketPonyfill.OPEN&&!this.openPromise}isClosed(){return!!this.ws&&(this.ws.readyState===this.WebSocketPonyfill.CLOSING||this.ws.readyState===this.WebSocketPonyfill.CLOSED)}async open(){var r=this;if(r.openPromise)return r.openPromise;r.id=++zx.connectCount;const a=o3(r.urlOptions).then(n=>new r.WebSocketPonyfill(n));r.openPromise=a.then(async n=>{r.ws=n,n.binaryType="arraybuffer",n.addEventListener("message",function({data:i}){i==="PING"&&this.send("PONG")}),r.keepAliveOpts.enabled&&f3(n,r.keepAliveOpts),n.addEventListener("close",()=>{r.ws===n&&(r.ws=null)}),await d3(n),r.urlOptions.connectionParams&&n.send(await u3(r.urlOptions.connectionParams))});try{await r.openPromise}finally{r.openPromise=null}}async close(){var r=this;try{await r.openPromise}finally{var a;(a=r.ws)===null||a===void 0||a.close()}}};(0,wl.default)(h3,"connectCount",0);Ba(Bl());Ba(sn());var ix=Ba(Bl()),Cj=Ba(sn()),C0=class{constructor(e){(0,ix.default)(this,"links",void 0),(0,ix.default)(this,"runtime",void 0),(0,ix.default)(this,"requestId",void 0),this.requestId=0,this.runtime={},this.links=e.links.map(r=>r(this.runtime))}$request(e){var r;return s3({links:this.links,op:(0,Cj.default)((0,Cj.default)({},e),{},{context:(r=e.context)!==null&&r!==void 0?r:{},id:++this.requestId})}).pipe(a3())}async requestAsPromise(e){var r=this;try{const a=r.$request(e);return(await Ik(a)).result.data}catch(a){throw HN.from(a)}}query(e,r,a){return this.requestAsPromise({type:"query",path:e,input:r,context:a?.context,signal:a?.signal})}mutation(e,r,a){return this.requestAsPromise({type:"mutation",path:e,input:r,context:a?.context,signal:a?.signal})}subscription(e,r,a){return this.$request({type:"subscription",path:e,input:r,context:a.context,signal:a.signal}).subscribe({next(i){switch(i.result.type){case"state":{var o;(o=a.onConnectionStateChange)===null||o===void 0||o.call(a,i.result);break}case"started":{var u;(u=a.onStarted)===null||u===void 0||u.call(a,{context:i.context});break}case"stopped":{var d;(d=a.onStopped)===null||d===void 0||d.call(a);break}case"data":case void 0:{var h;(h=a.onData)===null||h===void 0||h.call(a,i.result.data);break}}},error(i){var o;(o=a.onError)===null||o===void 0||o.call(a,i)},complete(){var i;(i=a.onComplete)===null||i===void 0||i.call(a)}})}};const qN=Symbol.for("trpc_untypedClient"),m3={query:"query",mutate:"mutation",subscribe:"subscription"},x3=e=>m3[e];function WN(e){const r=T0(({path:a,args:n})=>{const i=[...a],o=x3(i.pop()),u=i.join(".");return e[o](u,...n)});return Dp(a=>a===qN?e:r[a])}function p3(e){const r=new C0(e);return WN(r)}function Rp(e){return e[qN]}Ba(sn());Ba(sn());var g3=En({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/asyncIterator.js"(e,r){function a(i){var o,u,d,h=2;for(typeof Symbol<"u"&&(u=Symbol.asyncIterator,d=Symbol.iterator);h--;){if(u&&(o=i[u])!=null)return o.call(i);if(d&&(o=i[d])!=null)return new n(o.call(i));u="@@asyncIterator",d="@@iterator"}throw new TypeError("Object is not async iterable")}function n(i){function o(u){if(Object(u)!==u)return Promise.reject(new TypeError(u+" is not an object."));var d=u.done;return Promise.resolve(u.value).then(function(h){return{value:h,done:d}})}return n=function(d){this.s=d,this.n=d.next},n.prototype={s:null,n:null,next:function(){return o(this.n.apply(this.s,arguments))},return:function(d){var h=this.s.return;return h===void 0?Promise.resolve({value:d,done:!0}):o(h.apply(this.s,arguments))},throw:function(d){var h=this.s.return;return h===void 0?Promise.reject(d):o(h.apply(this.s,arguments))}},new n(i)}r.exports=a,r.exports.__esModule=!0,r.exports.default=r.exports}});Ba(g3());Ba(sn());var v3=En({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/usingCtx.js"(e,r){function a(){var n=typeof SuppressedError=="function"?SuppressedError:function(d,h){var m=Error();return m.name="SuppressedError",m.error=d,m.suppressed=h,m},i={},o=[];function u(d,h){if(h!=null){if(Object(h)!==h)throw new TypeError("using declarations can only be used with objects, functions, null, or undefined.");if(d)var m=h[Symbol.asyncDispose||Symbol.for("Symbol.asyncDispose")];if(m===void 0&&(m=h[Symbol.dispose||Symbol.for("Symbol.dispose")],d))var p=m;if(typeof m!="function")throw new TypeError("Object is not disposable.");p&&(m=function(){try{p.call(h)}catch(y){return Promise.reject(y)}}),o.push({v:h,d:m,a:d})}else d&&o.push({d:h,a:d});return h}return{e:i,u:u.bind(null,!1),a:u.bind(null,!0),d:function(){var h,m=this.e,p=0;function v(){for(;h=o.pop();)try{if(!h.a&&p===1)return p=0,o.push(h),Promise.resolve().then(v);if(h.d){var N=h.d.call(h.v);if(h.a)return p|=2,Promise.resolve(N).then(v,y)}else p|=1}catch(j){return y(j)}if(p===1)return m!==i?Promise.reject(m):Promise.resolve();if(m!==i)throw m}function y(N){return m=m!==i?new n(N,m):N,v()}return v()}}}r.exports=a,r.exports.__esModule=!0,r.exports.default=r.exports}}),YN=En({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/OverloadYield.js"(e,r){function a(n,i){this.v=n,this.k=i}r.exports=a,r.exports.__esModule=!0,r.exports.default=r.exports}}),y3=En({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/awaitAsyncGenerator.js"(e,r){var a=YN();function n(i){return new a(i,0)}r.exports=n,r.exports.__esModule=!0,r.exports.default=r.exports}}),j3=En({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/wrapAsyncGenerator.js"(e,r){var a=YN();function n(o){return function(){return new i(o.apply(this,arguments))}}function i(o){var u,d;function h(p,v){try{var y=o[p](v),N=y.value,j=N instanceof a;Promise.resolve(j?N.v:N).then(function(b){if(j){var w=p==="return"?"return":"next";if(!N.k||b.done)return h(w,b);b=o[w](b).value}m(y.done?"return":"normal",b)},function(b){h("throw",b)})}catch(b){m("throw",b)}}function m(p,v){switch(p){case"return":u.resolve({value:v,done:!0});break;case"throw":u.reject(v);break;default:u.resolve({value:v,done:!1})}(u=u.next)?h(u.key,u.arg):d=null}this._invoke=function(p,v){return new Promise(function(y,N){var j={key:p,arg:v,resolve:y,reject:N,next:null};d?d=d.next=j:(u=d=j,h(p,v))})},typeof o.return!="function"&&(this.return=void 0)}i.prototype[typeof Symbol=="function"&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},i.prototype.next=function(o){return this._invoke("next",o)},i.prototype.throw=function(o){return this._invoke("throw",o)},i.prototype.return=function(o){return this._invoke("return",o)},r.exports=n,r.exports.__esModule=!0,r.exports.default=r.exports}});Ba(v3());Ba(y3());Ba(j3());Ba(sn());function b3(e){return T0(({path:r,args:a})=>{var n;const i=[...r],o=i.pop();if(o==="useMutation")return e[o](i,...a);if(o==="_def")return{path:i};const[u,...d]=a,h=(n=d[0])!==null&&n!==void 0?n:{};return e[o](i,u,h)})}var lx;const N3=["client","ssrContext","ssrState","abortOnUnmount"],w3=(lx=C.createContext)===null||lx===void 0?void 0:lx.call(rC,null),S3=e=>{switch(e){case"queryOptions":case"fetch":case"ensureData":case"prefetch":case"getData":case"setData":case"setQueriesData":return"query";case"infiniteQueryOptions":case"fetchInfinite":case"prefetchInfinite":case"getInfiniteData":case"setInfiniteData":return"infinite";case"setMutationDefaults":case"getMutationDefaults":case"isMutating":case"cancel":case"invalidate":case"refetch":case"reset":return"any"}};function _3(e){return T0(r=>{const a=[...r.path],n=a.pop(),i=[...r.args],o=i.shift(),u=S3(n),d=vn(a,o,u);return{infiniteQueryOptions:()=>e.infiniteQueryOptions(a,d,i[0]),queryOptions:()=>e.queryOptions(a,d,...i),fetch:()=>e.fetchQuery(d,...i),fetchInfinite:()=>e.fetchInfiniteQuery(d,i[0]),prefetch:()=>e.prefetchQuery(d,...i),prefetchInfinite:()=>e.prefetchInfiniteQuery(d,i[0]),ensureData:()=>e.ensureQueryData(d,...i),invalidate:()=>e.invalidateQueries(d,...i),reset:()=>e.resetQueries(d,...i),refetch:()=>e.refetchQueries(d,...i),cancel:()=>e.cancelQuery(d,...i),setData:()=>{e.setQueryData(d,i[0],i[1])},setQueriesData:()=>e.setQueriesData(d,i[0],i[1],i[2]),setInfiniteData:()=>{e.setInfiniteQueryData(d,i[0],i[1])},getData:()=>e.getQueryData(d),getInfiniteData:()=>e.getInfiniteQueryData(d),setMutationDefaults:()=>e.setMutationDefaults($f(a),o),getMutationDefaults:()=>e.getMutationDefaults($f(a)),isMutating:()=>e.isMutating({mutationKey:$f(a)})}[n]()})}function E3(e){const r=WN(e.client),a=_3(e);return Dp(n=>{const i=n;return i==="client"?r:N3.includes(i)?e[i]:a[n]})}var T3=Pl(rd(),1);function Aj(e){const r=e instanceof C0?e:Rp(e);return T0(a=>{const n=a.path,i=n.join("."),[o,u]=a.args;return(0,T3.default)({queryKey:vn(n,o,"query"),queryFn:()=>r.query(i,o,u?.trpc)},u)})}var cx=Pl(rd(),1);function Dr(e,r,a){var n;const i=e[0];let o=(n=e[1])===null||n===void 0?void 0:n.input;if(a){var u;o=(0,cx.default)((0,cx.default)((0,cx.default)({},(u=o)!==null&&u!==void 0?u:{}),a.pageParam?{cursor:a.pageParam}:{}),{},{direction:a.direction})}return[i.join("."),o,r?.trpc]}var C3=rl({"../../node_modules/.pnpm/@oxc-project+runtime@0.72.2/node_modules/@oxc-project/runtime/src/helpers/asyncIterator.js"(e,r){function a(i){var o,u,d,h=2;for(typeof Symbol<"u"&&(u=Symbol.asyncIterator,d=Symbol.iterator);h--;){if(u&&(o=i[u])!=null)return o.call(i);if(d&&(o=i[d])!=null)return new n(o.call(i));u="@@asyncIterator",d="@@iterator"}throw new TypeError("Object is not async iterable")}function n(i){function o(u){if(Object(u)!==u)return Promise.reject(new TypeError(u+" is not an object."));var d=u.done;return Promise.resolve(u.value).then(function(h){return{value:h,done:d}})}return n=function(d){this.s=d,this.n=d.next},n.prototype={s:null,n:null,next:function(){return o(this.n.apply(this.s,arguments))},return:function(d){var h=this.s.return;return h===void 0?Promise.resolve({value:d,done:!0}):o(h.apply(this.s,arguments))},throw:function(d){var h=this.s.return;return h===void 0?Promise.reject(d):o(h.apply(this.s,arguments))}},new n(i)}r.exports=a,r.exports.__esModule=!0,r.exports.default=r.exports}}),A3=Pl(C3(),1);function Vx(e){return{path:e.path.join(".")}}function eu(e){const r=Vx(e);return C.useMemo(()=>r,[r])}async function XN(e,r,a){const i=r.getQueryCache().build(r,{queryKey:a});i.setState({data:[],status:"success"});const o=[];var u=!1,d=!1,h;try{for(var m=(0,A3.default)(e),p;u=!(p=await m.next()).done;u=!1){const v=p.value;o.push(v),i.setState({data:[...o]})}}catch(v){d=!0,h=v}finally{try{u&&m.return!=null&&await m.return()}finally{if(d)throw h}}return o}var na=Pl(rd(),1);function k3(e){const{client:r,queryClient:a}=e,n=r instanceof C0?r:Rp(r);return{infiniteQueryOptions:(i,o,u)=>{var d,h;const m=((d=o[1])===null||d===void 0?void 0:d.input)===yn,p=async v=>{var y;const N=(0,na.default)((0,na.default)({},u),{},{trpc:(0,na.default)((0,na.default)({},u?.trpc),!(u==null||(y=u.trpc)===null||y===void 0)&&y.abortOnUnmount?{signal:v.signal}:{signal:null})});return await n.query(...Dr(o,N,{direction:v.direction,pageParam:v.pageParam}))};return Object.assign(xC((0,na.default)((0,na.default)({},u),{},{initialData:u?.initialData,queryKey:o,queryFn:m?yn:p,initialPageParam:(h=u?.initialCursor)!==null&&h!==void 0?h:null})),{trpc:Vx({path:i})})},queryOptions:(i,o,u)=>{var d;const h=((d=o[1])===null||d===void 0?void 0:d.input)===yn,m=async p=>{var v;const y=(0,na.default)((0,na.default)({},u),{},{trpc:(0,na.default)((0,na.default)({},u?.trpc),!(u==null||(v=u.trpc)===null||v===void 0)&&v.abortOnUnmount?{signal:p.signal}:{signal:null})}),N=await n.query(...Dr(o,y));return DN(N)?XN(N,a,o):N};return Object.assign(mC((0,na.default)((0,na.default)({},u),{},{initialData:u?.initialData,queryKey:o,queryFn:h?yn:m})),{trpc:Vx({path:i})})},fetchQuery:(i,o)=>a.fetchQuery((0,na.default)((0,na.default)({},o),{},{queryKey:i,queryFn:()=>n.query(...Dr(i,o))})),fetchInfiniteQuery:(i,o)=>{var u;return a.fetchInfiniteQuery((0,na.default)((0,na.default)({},o),{},{queryKey:i,queryFn:({pageParam:d,direction:h})=>n.query(...Dr(i,o,{pageParam:d,direction:h})),initialPageParam:(u=o?.initialCursor)!==null&&u!==void 0?u:null}))},prefetchQuery:(i,o)=>a.prefetchQuery((0,na.default)((0,na.default)({},o),{},{queryKey:i,queryFn:()=>n.query(...Dr(i,o))})),prefetchInfiniteQuery:(i,o)=>{var u;return a.prefetchInfiniteQuery((0,na.default)((0,na.default)({},o),{},{queryKey:i,queryFn:({pageParam:d,direction:h})=>n.query(...Dr(i,o,{pageParam:d,direction:h})),initialPageParam:(u=o?.initialCursor)!==null&&u!==void 0?u:null}))},ensureQueryData:(i,o)=>a.ensureQueryData((0,na.default)((0,na.default)({},o),{},{queryKey:i,queryFn:()=>n.query(...Dr(i,o))})),invalidateQueries:(i,o,u)=>a.invalidateQueries((0,na.default)((0,na.default)({},o),{},{queryKey:i}),u),resetQueries:(i,o,u)=>a.resetQueries((0,na.default)((0,na.default)({},o),{},{queryKey:i}),u),refetchQueries:(i,o,u)=>a.refetchQueries((0,na.default)((0,na.default)({},o),{},{queryKey:i}),u),cancelQuery:(i,o)=>a.cancelQueries({queryKey:i},o),setQueryData:(i,o,u)=>a.setQueryData(i,o,u),setQueriesData:(i,o,u,d)=>a.setQueriesData((0,na.default)((0,na.default)({},o),{},{queryKey:i}),u,d),getQueryData:i=>a.getQueryData(i),setInfiniteQueryData:(i,o,u)=>a.setQueryData(i,o,u),getInfiniteQueryData:i=>a.getQueryData(i),setMutationDefaults:(i,o)=>{const u=i[0],d=h=>n.mutation(...Dr([u,{input:h}],e));return a.setMutationDefaults(i,typeof o=="function"?o({canonicalMutationFn:d}):o)},getMutationDefaults:i=>a.getMutationDefaults(i),isMutating:i=>a.isMutating((0,na.default)((0,na.default)({},i),{},{exact:!0}))}}var Ze=Pl(rd());const kj=(e,r)=>new Proxy(e,{get(n,i){return r(i),n[i]}});function D3(e){var r,a;const n=(r=void 0)!==null&&r!==void 0?r:z=>z.originalFn(),i=(a=void 0)!==null&&a!==void 0?a:w3,o=p3,u=z=>{var O;const{abortOnUnmount:A=!1,queryClient:k,ssrContext:E}=z,[L,H]=C.useState((O=z.ssrState)!==null&&O!==void 0?O:!1),I=z.client instanceof C0?z.client:Rp(z.client),re=C.useMemo(()=>k3({client:I,queryClient:k}),[I,k]),ne=C.useMemo(()=>(0,Ze.default)({abortOnUnmount:A,queryClient:k,client:I,ssrContext:E??null,ssrState:L},re),[A,I,re,k,E,L]);return C.useEffect(()=>{H(ge=>ge?"mounted":!1)},[]),t.jsx(i.Provider,{value:ne,children:z.children})};function d(){const z=C.useContext(i);if(!z)throw new Error("Unable to find tRPC Context. Did you forget to wrap your App inside `withTRPC` HoC?");return z}function h(z,O){var A;const{queryClient:k,ssrState:E}=d();return E&&E!=="mounted"&&((A=k.getQueryCache().find({queryKey:z}))===null||A===void 0?void 0:A.state.status)==="error"?(0,Ze.default)({retryOnMount:!1},O):O}function m(z,O,A){var k,E,L,H,I;const re=d(),{abortOnUnmount:ne,client:ge,ssrState:W,queryClient:ee,prefetchQuery:je}=re,Z=vn(z,O,"query"),De=ee.getQueryDefaults(Z),he=O===yn;typeof window>"u"&&W==="prepass"&&(A==null||(k=A.trpc)===null||k===void 0?void 0:k.ssr)!==!1&&((E=A?.enabled)!==null&&E!==void 0?E:De?.enabled)!==!1&&!he&&!ee.getQueryCache().find({queryKey:Z})&&je(Z,A);const P=h(Z,(0,Ze.default)((0,Ze.default)({},De),A)),q=(L=(H=A==null||(I=A.trpc)===null||I===void 0?void 0:I.abortOnUnmount)!==null&&H!==void 0?H:void 0)!==null&&L!==void 0?L:ne,J=hC((0,Ze.default)((0,Ze.default)({},P),{},{queryKey:Z,queryFn:he?O:async K=>{const xe=(0,Ze.default)((0,Ze.default)({},P),{},{trpc:(0,Ze.default)((0,Ze.default)({},P?.trpc),q?{signal:K.signal}:{signal:null})}),Fe=await ge.query(...Dr(Z,xe));return DN(Fe)?XN(Fe,ee,Z):Fe}}),ee);return J.trpc=eu({path:z}),J}function p(z,O,A){var k,E,L;const H=d(),I=vn(z,O,"query"),re=O===yn,ne=(k=(E=A==null||(L=A.trpc)===null||L===void 0?void 0:L.abortOnUnmount)!==null&&E!==void 0?E:void 0)!==null&&k!==void 0?k:H.abortOnUnmount;fC((0,Ze.default)((0,Ze.default)({},A),{},{queryKey:I,queryFn:re?O:ge=>{const W={trpc:(0,Ze.default)((0,Ze.default)({},A?.trpc),ne?{signal:ge.signal}:{})};return H.client.query(...Dr(I,W))}}))}function v(z,O,A){var k,E,L;const H=d(),I=vn(z,O,"query"),re=(k=(E=A==null||(L=A.trpc)===null||L===void 0?void 0:L.abortOnUnmount)!==null&&E!==void 0?E:void 0)!==null&&k!==void 0?k:H.abortOnUnmount,ne=dC((0,Ze.default)((0,Ze.default)({},A),{},{queryKey:I,queryFn:ge=>{const W=(0,Ze.default)((0,Ze.default)({},A),{},{trpc:(0,Ze.default)((0,Ze.default)({},A?.trpc),re?{signal:ge.signal}:{signal:null})});return H.client.query(...Dr(I,W))}}),H.queryClient);return ne.trpc=eu({path:z}),[ne.data,ne]}function y(z,O){const{client:A,queryClient:k}=d(),E=$f(z),L=k.defaultMutationOptions(k.getMutationDefaults(E)),H=cC((0,Ze.default)((0,Ze.default)({},O),{},{mutationKey:E,mutationFn:I=>A.mutation(...Dr([z,{input:I}],O)),onSuccess(...I){var re,ne;return n({originalFn:()=>{var W,ee,je;return(W=O==null||(ee=O.onSuccess)===null||ee===void 0?void 0:ee.call(O,...I))!==null&&W!==void 0?W:L==null||(je=L.onSuccess)===null||je===void 0?void 0:je.call(L,...I)},queryClient:k,meta:(re=(ne=O?.meta)!==null&&ne!==void 0?ne:L?.meta)!==null&&re!==void 0?re:{}})}}),k);return H.trpc=eu({path:z}),H}const N={data:void 0,error:null,status:"idle"},j={data:void 0,error:null,status:"connecting"};function b(z,O,A){var k;const E=(k=A?.enabled)!==null&&k!==void 0?k:O!==yn,L=lC(vn(z,O,"any")),{client:H}=d(),I=C.useRef(A);C.useEffect(()=>{I.current=A});const[re]=C.useState(new Set([])),ne=C.useCallback(he=>{re.add(he)},[re]),ge=C.useRef(null),W=C.useCallback(he=>{const P=je.current,q=je.current=he(P);let J=!1;for(const K of re)if(P[K]!==q[K]){J=!0;break}J&&De(kj(q,ne))},[ne,re]),ee=C.useCallback(()=>{var he;if((he=ge.current)===null||he===void 0||he.unsubscribe(),!E){W(()=>(0,Ze.default)((0,Ze.default)({},N),{},{reset:ee}));return}W(()=>(0,Ze.default)((0,Ze.default)({},j),{},{reset:ee}));const P=H.subscription(z.join("."),O??void 0,{onStarted:()=>{var q,J;(q=(J=I.current).onStarted)===null||q===void 0||q.call(J),W(K=>(0,Ze.default)((0,Ze.default)({},K),{},{status:"pending",error:null}))},onData:q=>{var J,K;(J=(K=I.current).onData)===null||J===void 0||J.call(K,q),W(xe=>(0,Ze.default)((0,Ze.default)({},xe),{},{status:"pending",data:q,error:null}))},onError:q=>{var J,K;(J=(K=I.current).onError)===null||J===void 0||J.call(K,q),W(xe=>(0,Ze.default)((0,Ze.default)({},xe),{},{status:"error",error:q}))},onConnectionStateChange:q=>{W(J=>{switch(q.state){case"idle":return(0,Ze.default)((0,Ze.default)({},J),{},{status:q.state,error:null,data:void 0});case"connecting":return(0,Ze.default)((0,Ze.default)({},J),{},{error:q.error,status:q.state});case"pending":return J}})},onComplete:()=>{var q,J;(q=(J=I.current).onComplete)===null||q===void 0||q.call(J),W(K=>(0,Ze.default)((0,Ze.default)({},K),{},{status:"idle",error:null,data:void 0}))}});ge.current=P},[H,L,E,W]);C.useEffect(()=>(ee(),()=>{var he;(he=ge.current)===null||he===void 0||he.unsubscribe()}),[ee]);const je=C.useRef(E?(0,Ze.default)((0,Ze.default)({},j),{},{reset:ee}):(0,Ze.default)((0,Ze.default)({},N),{},{reset:ee})),[Z,De]=C.useState(kj(je.current,ne));return Z}function w(z,O,A){var k,E,L,H,I;const{client:re,ssrState:ne,prefetchInfiniteQuery:ge,queryClient:W,abortOnUnmount:ee}=d(),je=vn(z,O,"infinite"),Z=W.getQueryDefaults(je),De=O===yn;typeof window>"u"&&ne==="prepass"&&(A==null||(k=A.trpc)===null||k===void 0?void 0:k.ssr)!==!1&&((E=A?.enabled)!==null&&E!==void 0?E:Z?.enabled)!==!1&&!De&&!W.getQueryCache().find({queryKey:je})&&ge(je,(0,Ze.default)((0,Ze.default)({},Z),A));const he=h(je,(0,Ze.default)((0,Ze.default)({},Z),A)),P=(L=A==null||(H=A.trpc)===null||H===void 0?void 0:H.abortOnUnmount)!==null&&L!==void 0?L:ee,q=iC((0,Ze.default)((0,Ze.default)({},he),{},{initialPageParam:(I=A.initialCursor)!==null&&I!==void 0?I:null,persister:A.persister,queryKey:je,queryFn:De?O:J=>{var K;const xe=(0,Ze.default)((0,Ze.default)({},he),{},{trpc:(0,Ze.default)((0,Ze.default)({},he?.trpc),P?{signal:J.signal}:{signal:null})});return re.query(...Dr(je,xe,{pageParam:(K=J.pageParam)!==null&&K!==void 0?K:A.initialCursor,direction:J.direction}))}}),W);return q.trpc=eu({path:z}),q}function T(z,O,A){var k,E,L;const H=d(),I=vn(z,O,"infinite"),re=H.queryClient.getQueryDefaults(I),ne=O===yn,ge=h(I,(0,Ze.default)((0,Ze.default)({},re),A)),W=(k=A==null||(E=A.trpc)===null||E===void 0?void 0:E.abortOnUnmount)!==null&&k!==void 0?k:H.abortOnUnmount;nC((0,Ze.default)((0,Ze.default)({},A),{},{initialPageParam:(L=A.initialCursor)!==null&&L!==void 0?L:null,queryKey:I,queryFn:ne?O:ee=>{var je;const Z=(0,Ze.default)((0,Ze.default)({},ge),{},{trpc:(0,Ze.default)((0,Ze.default)({},ge?.trpc),W?{signal:ee.signal}:{})});return H.client.query(...Dr(I,Z,{pageParam:(je=ee.pageParam)!==null&&je!==void 0?je:A.initialCursor,direction:ee.direction}))}}))}function D(z,O,A){var k,E,L;const H=d(),I=vn(z,O,"infinite"),re=H.queryClient.getQueryDefaults(I),ne=h(I,(0,Ze.default)((0,Ze.default)({},re),A)),ge=(k=A==null||(E=A.trpc)===null||E===void 0?void 0:E.abortOnUnmount)!==null&&k!==void 0?k:H.abortOnUnmount,W=sC((0,Ze.default)((0,Ze.default)({},A),{},{initialPageParam:(L=A.initialCursor)!==null&&L!==void 0?L:null,queryKey:I,queryFn:ee=>{var je;const Z=(0,Ze.default)((0,Ze.default)({},ne),{},{trpc:(0,Ze.default)((0,Ze.default)({},ne?.trpc),ge?{signal:ee.signal}:{})});return H.client.query(...Dr(I,Z,{pageParam:(je=ee.pageParam)!==null&&je!==void 0?je:A.initialCursor,direction:ee.direction}))}}),H.queryClient);return W.trpc=eu({path:z}),[W.data,W]}return{Provider:u,createClient:o,useContext:d,useUtils:d,useQuery:m,usePrefetchQuery:p,useSuspenseQuery:v,useQueries:(z,O)=>{const{ssrState:A,queryClient:k,prefetchQuery:E,client:L}=d(),H=Aj(L),I=z(H);if(typeof window>"u"&&A==="prepass")for(const ne of I){var re;const ge=ne;((re=ge.trpc)===null||re===void 0?void 0:re.ssr)!==!1&&!k.getQueryCache().find({queryKey:ge.queryKey})&&E(ge.queryKey,ge)}return uC({queries:I.map(ne=>(0,Ze.default)((0,Ze.default)({},ne),{},{queryKey:ne.queryKey})),combine:O?.combine},k)},useSuspenseQueries:z=>{const{queryClient:O,client:A}=d(),k=Aj(A),E=z(k),L=oC({queries:E.map(H=>(0,Ze.default)((0,Ze.default)({},H),{},{queryFn:H.queryFn,queryKey:H.queryKey}))},O);return[L.map(H=>H.data),L]},useMutation:y,useSubscription:b,useInfiniteQuery:w,usePrefetchInfiniteQuery:T,useSuspenseInfiniteQuery:D}}function O3(e){const r=b3(e);return Dp(a=>a==="useContext"||a==="useUtils"?()=>{const n=e.useUtils();return C.useMemo(()=>E3(n),[n])}:e.hasOwnProperty(a)?e[a]:r[a])}function R3(e){const r=D3();return O3(r)}const et=R3();var M3=(function(){function e(){this.keyToValue=new Map,this.valueToKey=new Map}return e.prototype.set=function(r,a){this.keyToValue.set(r,a),this.valueToKey.set(a,r)},e.prototype.getByKey=function(r){return this.keyToValue.get(r)},e.prototype.getByValue=function(r){return this.valueToKey.get(r)},e.prototype.clear=function(){this.keyToValue.clear(),this.valueToKey.clear()},e})(),$N=(function(){function e(r){this.generateIdentifier=r,this.kv=new M3}return e.prototype.register=function(r,a){this.kv.getByValue(r)||(a||(a=this.generateIdentifier(r)),this.kv.set(a,r))},e.prototype.clear=function(){this.kv.clear()},e.prototype.getIdentifier=function(r){return this.kv.getByValue(r)},e.prototype.getValue=function(r){return this.kv.getByKey(r)},e})(),F3=(function(){var e=function(r,a){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])},e(r,a)};return function(r,a){if(typeof a!="function"&&a!==null)throw new TypeError("Class extends value "+String(a)+" is not a constructor or null");e(r,a);function n(){this.constructor=r}r.prototype=a===null?Object.create(a):(n.prototype=a.prototype,new n)}})(),I3=(function(e){F3(r,e);function r(){var a=e.call(this,function(n){return n.name})||this;return a.classToAllowedProps=new Map,a}return r.prototype.register=function(a,n){typeof n=="object"?(n.allowProps&&this.classToAllowedProps.set(a,n.allowProps),e.prototype.register.call(this,a,n.identifier)):e.prototype.register.call(this,a,n)},r.prototype.getAllowedProps=function(a){return this.classToAllowedProps.get(a)},r})($N),L3=function(e,r){var a=typeof Symbol=="function"&&e[Symbol.iterator];if(!a)return e;var n=a.call(e),i,o=[],u;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(d){u={error:d}}finally{try{i&&!i.done&&(a=n.return)&&a.call(n)}finally{if(u)throw u.error}}return o};function P3(e){if("values"in Object)return Object.values(e);var r=[];for(var a in e)e.hasOwnProperty(a)&&r.push(e[a]);return r}function B3(e,r){var a=P3(e);if("find"in a)return a.find(r);for(var n=a,i=0;i<n.length;i++){var o=n[i];if(r(o))return o}}function Vc(e,r){Object.entries(e).forEach(function(a){var n=L3(a,2),i=n[0],o=n[1];return r(o,i)})}function Qf(e,r){return e.indexOf(r)!==-1}function Dj(e,r){for(var a=0;a<e.length;a++){var n=e[a];if(r(n))return n}}var U3=(function(){function e(){this.transfomers={}}return e.prototype.register=function(r){this.transfomers[r.name]=r},e.prototype.findApplicable=function(r){return B3(this.transfomers,function(a){return a.isApplicable(r)})},e.prototype.findByName=function(r){return this.transfomers[r]},e})(),z3=function(e){return Object.prototype.toString.call(e).slice(8,-1)},KN=function(e){return typeof e>"u"},V3=function(e){return e===null},ku=function(e){return typeof e!="object"||e===null||e===Object.prototype?!1:Object.getPrototypeOf(e)===null?!0:Object.getPrototypeOf(e)===Object.prototype},Hx=function(e){return ku(e)&&Object.keys(e).length===0},Ki=function(e){return Array.isArray(e)},H3=function(e){return typeof e=="string"},G3=function(e){return typeof e=="number"&&!isNaN(e)},q3=function(e){return typeof e=="boolean"},W3=function(e){return e instanceof RegExp},Du=function(e){return e instanceof Map},Ou=function(e){return e instanceof Set},QN=function(e){return z3(e)==="Symbol"},Y3=function(e){return e instanceof Date&&!isNaN(e.valueOf())},X3=function(e){return e instanceof Error},Oj=function(e){return typeof e=="number"&&isNaN(e)},$3=function(e){return q3(e)||V3(e)||KN(e)||G3(e)||H3(e)||QN(e)},K3=function(e){return typeof e=="bigint"},Q3=function(e){return e===1/0||e===-1/0},Z3=function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},J3=function(e){return e instanceof URL},ZN=function(e){return e.replace(/\./g,"\\.")},ox=function(e){return e.map(String).map(ZN).join(".")},xu=function(e){for(var r=[],a="",n=0;n<e.length;n++){var i=e.charAt(n),o=i==="\\"&&e.charAt(n+1)===".";if(o){a+=".",n++;continue}var u=i===".";if(u){r.push(a),a="";continue}a+=i}var d=a;return r.push(d),r},Gx=function(){return Gx=Object.assign||function(e){for(var r,a=1,n=arguments.length;a<n;a++){r=arguments[a];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Gx.apply(this,arguments)},qx=function(e,r){var a=typeof Symbol=="function"&&e[Symbol.iterator];if(!a)return e;var n=a.call(e),i,o=[],u;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(d){u={error:d}}finally{try{i&&!i.done&&(a=n.return)&&a.call(n)}finally{if(u)throw u.error}}return o},Wx=function(e,r){for(var a=0,n=r.length,i=e.length;a<n;a++,i++)e[i]=r[a];return e};function fn(e,r,a,n){return{isApplicable:e,annotation:r,transform:a,untransform:n}}var JN=[fn(KN,"undefined",function(){return null},function(){}),fn(K3,"bigint",function(e){return e.toString()},function(e){return typeof BigInt<"u"?BigInt(e):(console.error("Please add a BigInt polyfill."),e)}),fn(Y3,"Date",function(e){return e.toISOString()},function(e){return new Date(e)}),fn(X3,"Error",function(e,r){var a={name:e.name,message:e.message};return r.allowedErrorProps.forEach(function(n){a[n]=e[n]}),a},function(e,r){var a=new Error(e.message);return a.name=e.name,a.stack=e.stack,r.allowedErrorProps.forEach(function(n){a[n]=e[n]}),a}),fn(W3,"regexp",function(e){return""+e},function(e){var r=e.slice(1,e.lastIndexOf("/")),a=e.slice(e.lastIndexOf("/")+1);return new RegExp(r,a)}),fn(Ou,"set",function(e){return Wx([],qx(e.values()))},function(e){return new Set(e)}),fn(Du,"map",function(e){return Wx([],qx(e.entries()))},function(e){return new Map(e)}),fn(function(e){return Oj(e)||Q3(e)},"number",function(e){return Oj(e)?"NaN":e>0?"Infinity":"-Infinity"},Number),fn(function(e){return e===0&&1/e===-1/0},"number",function(){return"-0"},Number),fn(J3,"URL",function(e){return e.toString()},function(e){return new URL(e)})];function A0(e,r,a,n){return{isApplicable:e,annotation:r,transform:a,untransform:n}}var ew=A0(function(e,r){if(QN(e)){var a=!!r.symbolRegistry.getIdentifier(e);return a}return!1},function(e,r){var a=r.symbolRegistry.getIdentifier(e);return["symbol",a]},function(e){return e.description},function(e,r,a){var n=a.symbolRegistry.getValue(r[1]);if(!n)throw new Error("Trying to deserialize unknown symbol");return n}),eD=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,Uint8ClampedArray].reduce(function(e,r){return e[r.name]=r,e},{}),tw=A0(Z3,function(e){return["typed-array",e.constructor.name]},function(e){return Wx([],qx(e))},function(e,r){var a=eD[r[1]];if(!a)throw new Error("Trying to deserialize unknown typed array");return new a(e)});function aw(e,r){if(e?.constructor){var a=!!r.classRegistry.getIdentifier(e.constructor);return a}return!1}var rw=A0(aw,function(e,r){var a=r.classRegistry.getIdentifier(e.constructor);return["class",a]},function(e,r){var a=r.classRegistry.getAllowedProps(e.constructor);if(!a)return Gx({},e);var n={};return a.forEach(function(i){n[i]=e[i]}),n},function(e,r,a){var n=a.classRegistry.getValue(r[1]);if(!n)throw new Error("Trying to deserialize unknown class - check https://github.com/blitz-js/superjson/issues/116#issuecomment-773996564");return Object.assign(Object.create(n.prototype),e)}),sw=A0(function(e,r){return!!r.customTransformerRegistry.findApplicable(e)},function(e,r){var a=r.customTransformerRegistry.findApplicable(e);return["custom",a.name]},function(e,r){var a=r.customTransformerRegistry.findApplicable(e);return a.serialize(e)},function(e,r,a){var n=a.customTransformerRegistry.findByName(r[1]);if(!n)throw new Error("Trying to deserialize unknown custom value");return n.deserialize(e)}),tD=[rw,ew,sw,tw],Rj=function(e,r){var a=Dj(tD,function(i){return i.isApplicable(e,r)});if(a)return{value:a.transform(e,r),type:a.annotation(e,r)};var n=Dj(JN,function(i){return i.isApplicable(e,r)});if(n)return{value:n.transform(e,r),type:n.annotation}},nw={};JN.forEach(function(e){nw[e.annotation]=e});var aD=function(e,r,a){if(Ki(r))switch(r[0]){case"symbol":return ew.untransform(e,r,a);case"class":return rw.untransform(e,r,a);case"custom":return sw.untransform(e,r,a);case"typed-array":return tw.untransform(e,r,a);default:throw new Error("Unknown transformation: "+r)}else{var n=nw[r];if(!n)throw new Error("Unknown transformation: "+r);return n.untransform(e,a)}},Rc=function(e,r){for(var a=e.keys();r>0;)a.next(),r--;return a.next().value};function iw(e){if(Qf(e,"__proto__"))throw new Error("__proto__ is not allowed as a property");if(Qf(e,"prototype"))throw new Error("prototype is not allowed as a property");if(Qf(e,"constructor"))throw new Error("constructor is not allowed as a property")}var rD=function(e,r){iw(r);for(var a=0;a<r.length;a++){var n=r[a];if(Ou(e))e=Rc(e,+n);else if(Du(e)){var i=+n,o=+r[++a]==0?"key":"value",u=Rc(e,i);switch(o){case"key":e=u;break;case"value":e=e.get(u);break}}else e=e[n]}return e},Yx=function(e,r,a){if(iw(r),r.length===0)return a(e);for(var n=e,i=0;i<r.length-1;i++){var o=r[i];if(Ki(n)){var u=+o;n=n[u]}else if(ku(n))n=n[o];else if(Ou(n)){var d=+o;n=Rc(n,d)}else if(Du(n)){var h=i===r.length-2;if(h)break;var d=+o,m=+r[++i]==0?"key":"value",p=Rc(n,d);switch(m){case"key":n=p;break;case"value":n=n.get(p);break}}}var v=r[r.length-1];if(Ki(n)?n[+v]=a(n[+v]):ku(n)&&(n[v]=a(n[v])),Ou(n)){var y=Rc(n,+v),N=a(y);y!==N&&(n.delete(y),n.add(N))}if(Du(n)){var d=+r[r.length-2],j=Rc(n,d),m=+v==0?"key":"value";switch(m){case"key":{var b=a(j);n.set(b,n.get(j)),b!==j&&n.delete(j);break}case"value":{n.set(j,a(n.get(j)));break}}}return e},Zn=function(e,r){var a=typeof Symbol=="function"&&e[Symbol.iterator];if(!a)return e;var n=a.call(e),i,o=[],u;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(d){u={error:d}}finally{try{i&&!i.done&&(a=n.return)&&a.call(n)}finally{if(u)throw u.error}}return o},Gi=function(e,r){for(var a=0,n=r.length,i=e.length;a<n;a++,i++)e[i]=r[a];return e};function Xx(e,r,a){if(a===void 0&&(a=[]),!!e){if(!Ki(e)){Vc(e,function(u,d){return Xx(u,r,Gi(Gi([],Zn(a)),Zn(xu(d))))});return}var n=Zn(e,2),i=n[0],o=n[1];o&&Vc(o,function(u,d){Xx(u,r,Gi(Gi([],Zn(a)),Zn(xu(d))))}),r(i,a)}}function sD(e,r,a){return Xx(r,function(n,i){e=Yx(e,i,function(o){return aD(o,n,a)})}),e}function nD(e,r){function a(u,d){var h=rD(e,xu(d));u.map(xu).forEach(function(m){e=Yx(e,m,function(){return h})})}if(Ki(r)){var n=Zn(r,2),i=n[0],o=n[1];i.forEach(function(u){e=Yx(e,xu(u),function(){return e})}),o&&Vc(o,a)}else Vc(r,a);return e}var iD=function(e,r){return ku(e)||Ki(e)||Du(e)||Ou(e)||aw(e,r)};function lD(e,r,a){var n=a.get(e);n?n.push(r):a.set(e,[r])}function cD(e,r){var a={},n=void 0;return e.forEach(function(i){if(!(i.length<=1)){r||(i=i.map(function(h){return h.map(String)}).sort(function(h,m){return h.length-m.length}));var o=Zn(i),u=o[0],d=o.slice(1);u.length===0?n=d.map(ox):a[ox(u)]=d.map(ox)}}),n?Hx(a)?[n]:[n,a]:Hx(a)?void 0:a}var lw=function(e,r,a,n,i,o,u){var d;i===void 0&&(i=[]),o===void 0&&(o=[]),u===void 0&&(u=new Map);var h=$3(e);if(!h){lD(e,i,r);var m=u.get(e);if(m)return n?{transformedValue:null}:m}if(!iD(e,a)){var p=Rj(e,a),v=p?{transformedValue:p.value,annotations:[p.type]}:{transformedValue:e};return h||u.set(e,v),v}if(Qf(o,e))return{transformedValue:null};var y=Rj(e,a),N=(d=y?.value)!==null&&d!==void 0?d:e,j=Ki(N)?[]:{},b={};Vc(N,function(T,D){var _=lw(T,r,a,n,Gi(Gi([],Zn(i)),[D]),Gi(Gi([],Zn(o)),[e]),u);j[D]=_.transformedValue,Ki(_.annotations)?b[D]=_.annotations:ku(_.annotations)&&Vc(_.annotations,function(R,z){b[ZN(D)+"."+z]=R})});var w=Hx(b)?{transformedValue:j,annotations:y?[y.type]:void 0}:{transformedValue:j,annotations:y?[y.type,b]:b};return h||u.set(e,w),w};function cw(e){return Object.prototype.toString.call(e).slice(8,-1)}function Mj(e){return cw(e)==="Array"}function oD(e){if(cw(e)!=="Object")return!1;const r=Object.getPrototypeOf(e);return!!r&&r.constructor===Object&&r===Object.prototype}function uD(e,r,a,n,i){const o={}.propertyIsEnumerable.call(n,r)?"enumerable":"nonenumerable";o==="enumerable"&&(e[r]=a),i&&o==="nonenumerable"&&Object.defineProperty(e,r,{value:a,enumerable:!1,writable:!0,configurable:!0})}function $x(e,r={}){if(Mj(e))return e.map(i=>$x(i,r));if(!oD(e))return e;const a=Object.getOwnPropertyNames(e),n=Object.getOwnPropertySymbols(e);return[...a,...n].reduce((i,o)=>{if(Mj(r.props)&&!r.props.includes(o))return i;const u=e[o],d=$x(u,r);return uD(i,o,d,e,r.nonenumerable),i},{})}var _l=function(){return _l=Object.assign||function(e){for(var r,a=1,n=arguments.length;a<n;a++){r=arguments[a];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},_l.apply(this,arguments)},dD=function(e,r){var a=typeof Symbol=="function"&&e[Symbol.iterator];if(!a)return e;var n=a.call(e),i,o=[],u;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(d){u={error:d}}finally{try{i&&!i.done&&(a=n.return)&&a.call(n)}finally{if(u)throw u.error}}return o},fD=function(e,r){for(var a=0,n=r.length,i=e.length;a<n;a++,i++)e[i]=r[a];return e};(function(){function e(r){var a=r===void 0?{}:r,n=a.dedupe,i=n===void 0?!1:n;this.classRegistry=new I3,this.symbolRegistry=new $N(function(o){var u;return(u=o.description)!==null&&u!==void 0?u:""}),this.customTransformerRegistry=new U3,this.allowedErrorProps=[],this.dedupe=i}return e.prototype.serialize=function(r){var a=new Map,n=lw(r,a,this,this.dedupe),i={json:n.transformedValue};n.annotations&&(i.meta=_l(_l({},i.meta),{values:n.annotations}));var o=cD(a,this.dedupe);return o&&(i.meta=_l(_l({},i.meta),{referentialEqualities:o})),i},e.prototype.deserialize=function(r){var a=r.json,n=r.meta,i=$x(a);return n?.values&&(i=sD(i,n.values,this)),n?.referentialEqualities&&(i=nD(i,n.referentialEqualities)),i},e.prototype.stringify=function(r){return JSON.stringify(this.serialize(r))},e.prototype.parse=function(r){return this.deserialize(JSON.parse(r))},e.prototype.registerClass=function(r,a){this.classRegistry.register(r,a)},e.prototype.registerSymbol=function(r,a){this.symbolRegistry.register(r,a)},e.prototype.registerCustom=function(r,a){this.customTransformerRegistry.register(_l({name:a},r))},e.prototype.allowErrorProps=function(){for(var r,a=[],n=0;n<arguments.length;n++)a[n]=arguments[n];(r=this.allowedErrorProps).push.apply(r,fD([],dD(a)))},e.defaultInstance=new e,e.serialize=e.defaultInstance.serialize.bind(e.defaultInstance),e.deserialize=e.defaultInstance.deserialize.bind(e.defaultInstance),e.stringify=e.defaultInstance.stringify.bind(e.defaultInstance),e.parse=e.defaultInstance.parse.bind(e.defaultInstance),e.registerClass=e.defaultInstance.registerClass.bind(e.defaultInstance),e.registerSymbol=e.defaultInstance.registerSymbol.bind(e.defaultInstance),e.registerCustom=e.defaultInstance.registerCustom.bind(e.defaultInstance),e.allowErrorProps=e.defaultInstance.allowErrorProps.bind(e.defaultInstance),e})();const hD={theme:"system",setTheme:()=>null},ow=C.createContext(hD),Fj=["dark","light","system"];function mD({children:e,defaultTheme:r="system",storageKey:a="vite-ui-theme",...n}){const[i,o]=C.useState(()=>{const d=localStorage.getItem(a);return d&&Fj.includes(d)?d:(d&&localStorage.removeItem(a),r)});C.useEffect(()=>{const d=window.document.documentElement;if(d.classList.remove("light","dark"),i==="system"){const h=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";d.classList.add(h);return}d.classList.add(i)},[i]);const u={theme:i,setTheme:d=>{Fj.includes(d)&&(localStorage.setItem(a,d),o(d))}};return t.jsx(ow.Provider,{...n,value:u,children:e})}const Mp=()=>{const e=C.useContext(ow);if(e===void 0)throw new Error("useTheme must be used within a ThemeProvider");return e},xD=({...e})=>{const{theme:r}=Mp();return t.jsx(SC,{className:"toaster group",theme:r,toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})},Ij=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,Lj=S2,k0=(e,r)=>a=>{var n;if(r?.variants==null)return Lj(e,a?.class,a?.className);const{variants:i,defaultVariants:o}=r,u=Object.keys(i).map(m=>{const p=a?.[m],v=o?.[m];if(p===null)return null;const y=Ij(p)||Ij(v);return i[m][y]}),d=a&&Object.entries(a).reduce((m,p)=>{let[v,y]=p;return y===void 0||(m[v]=y),m},{}),h=r==null||(n=r.compoundVariants)===null||n===void 0?void 0:n.reduce((m,p)=>{let{class:v,className:y,...N}=p;return Object.entries(N).every(j=>{let[b,w]=j;return Array.isArray(w)?w.includes({...o,...d}[b]):{...o,...d}[b]===w})?[...m,v,y]:m},[]);return Lj(e,u,h,a?.class,a?.className)};function me(...e){return _C(S2(e))}const Ru=k0("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md font-medium text-sm transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),oe=C.forwardRef(({className:e,variant:r,size:a,asChild:n=!1,...i},o)=>{const u=n?vp:"button";return t.jsx(u,{className:me(Ru({variant:r,size:a,className:e})),ref:o,...i})});oe.displayName="Button";function pD(){return t.jsxs("div",{className:"flex min-h-screen flex-col items-center justify-center space-y-4 bg-background text-foreground",children:[t.jsx("h1",{className:"font-bold font-display text-4xl",children:"404"}),t.jsx("p",{className:"text-muted-foreground text-xl",children:"Pgina no encontrada"}),t.jsxs("div",{className:"max-w-md break-all rounded-lg bg-muted/50 p-4 font-mono text-sm",children:["URL: ",typeof window<"u"?window.location.href:"Unknown"]}),t.jsx(oe,{asChild:!0,children:t.jsx(Br,{to:"/",children:"Voltar para o incio"})})]})}const Tn=pC()({component:gD,notFoundComponent:pD});function gD(){return t.jsxs(mD,{defaultTheme:"dark",storageKey:"gpus-ui-theme",children:[t.jsx(Yc,{}),t.jsx(xD,{})]})}const vD=()=>typeof document<"u"&&"startViewTransition"in document;function yD(){const e=typeof window<"u"?window.matchMedia("(prefers-reduced-motion: reduce)").matches:!1;return{animateThemeChange:(a,n,i)=>{if(!vD()||e){n();return}const o=a==="dark";document.startViewTransition(()=>{n()}).ready.then(()=>{if(!i)return;const{x:d,y:h}=i,m=Math.hypot(Math.max(d,window.innerWidth-d),Math.max(h,window.innerHeight-h)),p=400,v="ease-in-out";o?document.documentElement.animate({clipPath:[`circle(0px at ${d}px ${h}px)`,`circle(${m}px at ${d}px ${h}px)`]},{duration:p,easing:v,pseudoElement:"::view-transition-new(root)"}):document.documentElement.animate({clipPath:[`circle(${m}px at ${d}px ${h}px)`,`circle(0px at ${d}px ${h}px)`]},{duration:p,easing:v,pseudoElement:"::view-transition-old(root)"})})}}}function jD(){const{setTheme:e,theme:r}=Mp(),{animateThemeChange:a}=yD(),n=r==="dark",i=o=>{const u=n?"light":"dark",d={x:o.clientX,y:o.clientY};a(u,()=>e(u),d)};return t.jsxs(oe,{"aria-label":`Alternar para tema ${n?"claro":"escuro"}`,className:"relative",onClick:i,size:"icon",variant:"ghost",children:[t.jsx(_2,{className:`h-[1.2rem] w-[1.2rem] transition-all duration-300 ${n?"-rotate-90 scale-0":"rotate-0 scale-100"}`}),t.jsx(E2,{className:`absolute h-[1.2rem] w-[1.2rem] transition-all duration-300 ${n?"rotate-0 scale-100":"rotate-90 scale-0"}`})]})}const uw=C.createContext(void 0),Fp=()=>{const e=C.useContext(uw);if(!e)throw new Error("useSidebar must be used within a SidebarProvider");return e},bD=({children:e,open:r,setOpen:a,animate:n=!0})=>{const[i,o]=C.useState(!1),u=r!==void 0?r:i,d=a!==void 0?a:o;return t.jsx(uw.Provider,{value:{open:u,setOpen:d,animate:n},children:e})},ND=({children:e,open:r,setOpen:a,animate:n})=>t.jsx(bD,{animate:n,open:r,setOpen:a,children:e}),wD=e=>t.jsxs(t.Fragment,{children:[t.jsx(_D,{...e}),t.jsx(ED,{...e})]}),SD="60px",Pj="250px",_D=({className:e,children:r,...a})=>{const{open:n,setOpen:i,animate:o}=Fp();let u=Pj;return o&&(u=n?Pj:SD),t.jsx(at.div,{animate:{width:u},className:me("hidden h-full shrink-0 bg-sidebar-background px-4 py-4 md:flex md:flex-col",e),onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),...a,children:r})},ED=({className:e,children:r,...a})=>{const{open:n,setOpen:i}=Fp();return t.jsxs("div",{className:me("flex h-10 w-full flex-row items-center justify-between bg-sidebar-background px-4 py-4 md:hidden"),...a,children:[t.jsx("div",{className:"z-20 flex w-full justify-end",children:t.jsx(EC,{className:"text-sidebar-foreground",onClick:()=>i(!n)})}),t.jsx(AN,{children:n&&t.jsxs(at.div,{animate:{x:0,opacity:1},className:me("fixed inset-0 z-100 flex h-full w-full flex-col justify-between bg-background p-10",e),exit:{x:"-100%",opacity:0},initial:{x:"-100%",opacity:0},transition:{duration:.3,ease:"easeInOut"},children:[t.jsx("button",{"aria-label":"Close sidebar",className:"absolute top-10 right-10 z-50 text-foreground",onClick:()=>i(!n),type:"button",children:t.jsx(ga,{})}),r]})})]})},ux=({link:e,className:r,...a})=>{const{open:n,animate:i}=Fp(),u=gC()({to:e.href,fuzzy:!0}),d=ok(Number.POSITIVE_INFINITY),h=C.useRef(null),m=Rr(d,j=>{const b=h.current?.getBoundingClientRect()??{x:0,width:0};return j-b.x-b.width/2}),p=Rr(m,[-150,0,150],[.8,1.3,.8]),v=Vi(p,{mass:.1,stiffness:150,damping:12});let y="inline-block",N=1;return i&&(y=n?"inline-block":"none",N=n?1:0),t.jsxs(Br,{className:me("group/sidebar flex items-center justify-start gap-2 py-2.5",u&&"rounded-md bg-sidebar-accent px-2",r),onMouseLeave:()=>d.set(Number.POSITIVE_INFINITY),onMouseMove:j=>d.set(j.pageX),to:e.href,...a,children:[t.jsx(at.div,{className:"origin-center will-change-transform",ref:h,style:{scale:v},transition:{type:"spring",stiffness:150,damping:12},children:e.icon}),t.jsx(at.span,{animate:{display:y,opacity:N},className:"m-0! inline-block whitespace-pre p-0! text-sidebar-foreground text-sm transition duration-150 group-hover/sidebar:translate-x-1",children:e.label})]})},Bj=[{label:"Painel",href:"/dashboard",icon:t.jsx(T2,{className:"h-5 w-5 shrink-0 text-sidebar-foreground"})},{label:"CRM",href:"/crm",icon:t.jsx(TC,{className:"h-5 w-5 shrink-0 text-sidebar-foreground"})},{label:"Alunos",href:"/students",icon:t.jsx(Xi,{className:"h-5 w-5 shrink-0 text-sidebar-foreground"})},{label:"Chat",href:"/chat",icon:t.jsx(CC,{className:"h-5 w-5 shrink-0 text-sidebar-foreground"})},{label:"Marketing",href:"/marketing/dashboard",icon:t.jsx(AC,{className:"h-5 w-5 shrink-0 text-sidebar-foreground"})},{label:"Leads de Captura",href:"/marketing/leads",icon:t.jsx(yp,{className:"h-5 w-5 shrink-0 text-sidebar-foreground"})},{label:"Relatrios",href:"/reports",icon:t.jsx(Al,{className:"h-5 w-5 shrink-0 text-sidebar-foreground"})},{label:"Configuraes",href:"/settings",icon:t.jsx(kC,{className:"h-5 w-5 shrink-0 text-sidebar-foreground"})}];function TD(){const{user:e}=j0(),[r,a]=C.useState(!1);return t.jsx(ND,{open:r,setOpen:a,children:t.jsxs(wD,{className:"justify-between gap-10",children:[t.jsxs("div",{className:"flex flex-1 flex-col overflow-y-auto overflow-x-hidden",children:[r?t.jsx(CD,{}):t.jsx(AD,{}),t.jsxs("div",{className:"mt-8",children:[t.jsx("div",{className:"hidden flex-col gap-2 md:flex",children:Bj.map((n,i)=>t.jsx(ux,{link:n},i))}),t.jsx("div",{className:"flex flex-col gap-2 md:hidden",children:Bj.map((n,i)=>t.jsx(ux,{link:n},i))})]})]}),t.jsxs("div",{children:[t.jsx(ux,{link:{label:e?.fullName||"Usurio",href:"#",icon:t.jsx("div",{className:"flex h-7 w-7 shrink-0 items-center justify-center overflow-hidden rounded-full bg-muted",children:t.jsx(y2,{afterSignOutUrl:"/sign-in",appearance:{elements:{avatarBox:"h-7 w-7"}}})})}}),t.jsx("div",{className:"mt-2 pl-2",children:t.jsx(jD,{})})]})]})})}const CD=()=>t.jsxs(Br,{className:"relative z-20 flex items-center space-x-2 py-1 font-normal text-foreground text-sm",to:"/dashboard",children:[t.jsx("div",{className:"h-5 w-6 shrink-0 rounded-tl-lg rounded-tr-sm rounded-br-lg rounded-bl-sm bg-foreground"}),t.jsx(at.span,{animate:{opacity:1},className:"whitespace-pre font-medium text-foreground",initial:{opacity:0},children:"Grupo US"})]}),AD=()=>t.jsx(Br,{className:"relative z-20 flex items-center space-x-2 py-1 font-normal text-foreground text-sm",to:"/dashboard",children:t.jsx("div",{className:"h-5 w-6 shrink-0 rounded-tl-lg rounded-tr-sm rounded-br-lg rounded-bl-sm bg-foreground"})}),Te=C.forwardRef(({className:e,variant:r="default",...a},n)=>t.jsx("div",{className:me("rounded-xl border text-card-foreground shadow",r==="glass"?"card-glass":"bg-card",e),ref:n,...a}));Te.displayName="Card";const Me=C.forwardRef(({className:e,...r},a)=>t.jsx("div",{className:me("flex flex-col space-y-1.5 p-6",e),ref:a,...r}));Me.displayName="CardHeader";const Le=C.forwardRef(({className:e,...r},a)=>t.jsx("div",{className:me("font-semibold leading-none tracking-tight",e),ref:a,...r}));Le.displayName="CardTitle";const ta=C.forwardRef(({className:e,...r},a)=>t.jsx("div",{className:me("text-muted-foreground text-sm",e),ref:a,...r}));ta.displayName="CardDescription";const Ce=C.forwardRef(({className:e,...r},a)=>t.jsx("div",{className:me("p-6 pt-0",e),ref:a,...r}));Ce.displayName="CardContent";const dw=C.forwardRef(({className:e,...r},a)=>t.jsx("div",{className:me("flex items-center p-6 pt-0",e),ref:a,...r}));dw.displayName="CardFooter";var D0="Collapsible",[kD]=jp(D0),[DD,Ip]=kD(D0),fw=C.forwardRef((e,r)=>{const{__scopeCollapsible:a,open:n,defaultOpen:i,disabled:o,onOpenChange:u,...d}=e,[h,m]=C2({prop:n,defaultProp:i??!1,onChange:u,caller:D0});return t.jsx(DD,{scope:a,disabled:o,contentId:DC(),open:h,onOpenToggle:C.useCallback(()=>m(p=>!p),[m]),children:t.jsx(qu.div,{"data-state":Pp(h),"data-disabled":o?"":void 0,...d,ref:r})})});fw.displayName=D0;var hw="CollapsibleTrigger",mw=C.forwardRef((e,r)=>{const{__scopeCollapsible:a,...n}=e,i=Ip(hw,a);return t.jsx(qu.button,{type:"button","aria-controls":i.contentId,"aria-expanded":i.open||!1,"data-state":Pp(i.open),"data-disabled":i.disabled?"":void 0,disabled:i.disabled,...n,ref:r,onClick:bp(e.onClick,i.onOpenToggle)})});mw.displayName=hw;var Lp="CollapsibleContent",xw=C.forwardRef((e,r)=>{const{forceMount:a,...n}=e,i=Ip(Lp,e.__scopeCollapsible);return t.jsx(OC,{present:a||i.open,children:({present:o})=>t.jsx(OD,{...n,ref:r,present:o})})});xw.displayName=Lp;var OD=C.forwardRef((e,r)=>{const{__scopeCollapsible:a,present:n,children:i,...o}=e,u=Ip(Lp,a),[d,h]=C.useState(n),m=C.useRef(null),p=Wu(r,m),v=C.useRef(0),y=v.current,N=C.useRef(0),j=N.current,b=u.open||d,w=C.useRef(b),T=C.useRef(void 0);return C.useEffect(()=>{const D=requestAnimationFrame(()=>w.current=!1);return()=>cancelAnimationFrame(D)},[]),RC(()=>{const D=m.current;if(D){T.current=T.current||{transitionDuration:D.style.transitionDuration,animationName:D.style.animationName},D.style.transitionDuration="0s",D.style.animationName="none";const _=D.getBoundingClientRect();v.current=_.height,N.current=_.width,w.current||(D.style.transitionDuration=T.current.transitionDuration,D.style.animationName=T.current.animationName),h(n)}},[u.open,n]),t.jsx(qu.div,{"data-state":Pp(u.open),"data-disabled":u.disabled?"":void 0,id:u.contentId,hidden:!b,...o,ref:p,style:{"--radix-collapsible-content-height":y?`${y}px`:void 0,"--radix-collapsible-content-width":j?`${j}px`:void 0,...e.style},children:b&&i})});function Pp(e){return e?"open":"closed"}var RD=fw,MD=mw,FD=xw;const Bp=RD,Up=MD,zp=FD,dt=C.forwardRef(({className:e,type:r,label:a,...n},i)=>{const[o,u]=C.useState(!1),[d,h]=C.useState(!1),m=C.useRef(null),p=C.useId();C.useImperativeHandle(i,()=>{if(!m.current)throw new Error("Input ref is not available");return m.current});const v=b=>{u(!0),n.onFocus?.(b)},y=b=>{u(!1),h(b.target.value!==""),n.onBlur?.(b)},N=b=>{h(b.target.value!==""),n.onChange?.(b)},j=o||d||n.value||n.defaultValue;return t.jsxs("div",{className:"input-wrapper relative",children:[a&&t.jsx("label",{className:me("input-label pointer-events-none absolute left-3 text-muted-foreground transition-all duration-200 ease-out",j?"top-0 -translate-y-1/2 scale-75 bg-background px-1 text-primary":"top-1/2 -translate-y-1/2 text-sm"),htmlFor:p,children:a}),t.jsx("input",{className:me("input-field flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-all file:border-0 file:bg-transparent file:font-medium file:text-foreground file:text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a&&"pt-3",e),id:p,onBlur:y,onChange:N,onFocus:v,ref:m,type:r,...n})]})});dt.displayName="Input";const l0=typeof window<"u"?window.matchMedia("(prefers-reduced-motion: reduce)").matches:!1,ID={duration:l0?.01:.6,ease:[.16,1,.3,1]},or={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:ID}},O0={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:l0?0:.1,delayChildren:l0?0:.1}}},LD={hidden:{y:0},visible:{y:[-4,4,-4],transition:{duration:l0?.01:3,repeat:Number.POSITIVE_INFINITY,ease:"easeInOut"}}};function Sl({children:e,className:r,stagger:a=0,delay:n=0,...i}){const o=C.useRef(null),u=uk(o,{once:!0,margin:"-50px"});return t.jsx(at.div,{animate:u?"visible":"hidden",className:me(r),initial:"hidden",ref:o,style:{transitionDelay:`${n}ms`},variants:O0,...i,children:C.Children.map(e,(d,h)=>C.isValidElement(d)?t.jsx(at.div,{transition:{delay:n+h*(a/1e3)},variants:or,children:d}):d)})}const Sa=C.forwardRef(({className:e,orientation:r="horizontal",decorative:a=!0,...n},i)=>t.jsx(A2,{className:me("shrink-0 bg-border",r==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),decorative:a,orientation:r,ref:i,...n}));Sa.displayName=A2.displayName;function PD(){const[e,r]=C.useState(!1),[a,n]=C.useState(""),[i,o]=C.useState(!1),[u,d]=C.useState([{id:"1",content:"Ol! Sou o assistente IA do Grupo US. Estou aqui para iluminar seu caminho na sade esttica. Como posso ajudar voc hoje?",sender:"ai",timestamp:new Date}]),h=C.useRef(null),m=C.useCallback(()=>{h.current?.scrollIntoView({behavior:"smooth"})},[]);C.useEffect(()=>{m()},[m]);const p=j=>{const b=j.toLowerCase();return b.includes("trintae3")||b.includes("curso")?"A TRINTAE3  nosso programa completo que transforma profissionais da sade em empresrios da esttica. Voc aprender tcnica avanada + business. Quer saber mais sobre as turmas ou o investimento?":b.includes("preo")||b.includes("valor")||b.includes("investimento")?"Ns acreditamos que a TRINTAE3  um investimento, no um custo. A maioria dos nossos alunos recupera o investimento em 3-6 meses aps formar o negcio. Posso te apresentar as opes de parcelamento?":b.includes("tempo")||b.includes("durao")?"O programa tem durao de 6 meses com encontros ao vivo + aulas gravadas. Desenvolvemos tudo pensando no profissional que trabalha - voc estuda no seu ritmo. Faz sentido para voc agora?":b.includes("virada")||b.includes("transformao")?"A Virada Esttica  o nosso conceito principal: sair da exausto dos plantes para se tornar um empresrio da sade esttica.  exatamente o que realizamos com nossos alunos. Em que etapa da sua jornada voc est?":b.includes("agncia")||b.includes("marketing")?"Sim! Alm da formao tcnica e de negcio, temos programas avanados de marketing e agncia para alunos que querem escala. Voc j tem sua clnica ou est planejando abrir?":"Entendo sua dvida. No Grupo US, no ensinamos apenas tcnica - formamos empresrios da sade esttica. Nossa abordagem completa inclui: tcnica avanada, business, marketing e posicionamento. O que mais te desafia hoje na sua jornada?"},v=async()=>{if(!a.trim()||i)return;const j={id:Date.now().toString(),content:a,sender:"user",timestamp:new Date};d(b=>[...b,j]),n(""),o(!0);try{await new Promise(T=>setTimeout(T,1500));const b=p(a),w={id:(Date.now()+1).toString(),content:b,sender:"ai",timestamp:new Date};d(T=>[...T,w])}catch{Ie.error("Erro ao processar mensagem")}finally{o(!1)}},y=j=>{j.key==="Enter"&&!j.shiftKey&&(j.preventDefault(),v())},N=()=>{d(j=>[...j,{id:Date.now().toString(),content:"Entendido. Vou transferir sua conversa para um de nossos especialistas humanos. Eles entraro em contato em breve. Por favor, aguarde.",sender:"bot",timestamp:new Date}]),Ie.success("Conversa transferida para atendimento humano")};return t.jsx("div",{className:"fixed right-4 bottom-4 z-50",children:t.jsxs(Bp,{onOpenChange:r,open:e,children:[t.jsx(Up,{asChild:!0,children:t.jsx(oe,{"aria-label":e?"Fechar assistente IA":"Abrir assistente IA",className:"h-14 w-14 animate-pulse-subtle rounded-full border-2 border-background bg-linear-to-r from-purple-600 to-pink-600 shadow-lg hover:from-purple-700 hover:to-pink-700",size:"lg",children:e?t.jsx(ga,{className:"h-6 w-6"}):t.jsx(lu,{className:"h-6 w-6"})})}),t.jsx(zp,{className:"absolute right-0 bottom-16 mb-2 w-96",children:t.jsx(Sl,{children:t.jsxs(Te,{className:"glass-card border-0 shadow-2xl",children:[t.jsx(Me,{className:"border-b bg-linear-to-r from-purple-600/10 to-pink-600/10",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(lu,{className:"h-5 w-5 text-purple-600"}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-sm",children:"Assistente IA"}),t.jsx("p",{className:"text-muted-foreground text-xs",children:"Grupo US"})]})]}),t.jsx(oe,{className:"h-6 w-6",onClick:()=>r(!1),size:"icon",variant:"ghost",children:t.jsx(ga,{className:"h-4 w-4"})})]})}),t.jsx(Ce,{className:"p-0",children:t.jsxs("div",{className:"flex h-112 flex-col",children:[t.jsxs("div",{className:"flex-1 space-y-3 overflow-y-auto p-4",children:[u.map(j=>t.jsx("div",{className:`flex ${j.sender==="user"?"justify-end":"justify-start"}`,children:t.jsxs("div",{className:`flex max-w-[80%] items-start gap-2 ${j.sender==="user"?"flex-row-reverse":"flex-row"}`,children:[t.jsxs("div",{className:`rounded-lg px-3 py-2 ${j.sender==="user"?"bg-primary text-primary-foreground":"bg-muted"}`,children:[t.jsx("p",{className:"whitespace-pre-wrap text-sm",children:j.content}),t.jsx("p",{className:"mt-1 text-xs opacity-70",children:j.timestamp.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})})]}),t.jsx("div",{className:`flex h-6 w-6 items-center justify-center rounded-full text-xs ${j.sender==="user"?"ml-2 bg-primary text-primary-foreground":"mr-2 bg-muted text-muted-foreground"}`,children:j.sender==="user"?t.jsx(li,{className:"h-3 w-3"}):t.jsx(lu,{className:"h-3 w-3"})})]})},j.id)),i&&t.jsx("div",{className:"flex justify-start",children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx("div",{className:"mr-2 flex h-6 w-6 items-center justify-center rounded-full bg-muted",children:t.jsx(lu,{className:"h-3 w-3 text-muted-foreground"})}),t.jsx("div",{className:"rounded-lg bg-muted px-3 py-2",children:t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"h-2 w-2 animate-pulse rounded-full bg-muted-foreground"}),t.jsx("div",{className:"h-2 w-2 animate-pulse rounded-full bg-muted-foreground delay-75"}),t.jsx("div",{className:"h-2 w-2 animate-pulse rounded-full bg-muted-foreground delay-150"})]})})]})}),t.jsx("div",{ref:h})]}),t.jsx(Sa,{}),t.jsxs("div",{className:"p-3",children:[t.jsxs("div",{className:"mb-2 flex gap-2",children:[t.jsx(dt,{className:"flex-1",disabled:i,onChange:j=>n(j.target.value),onKeyPress:y,placeholder:"Digite sua mensagem sobre a Virada Esttica...",value:a}),t.jsx(oe,{disabled:!a.trim()||i,onClick:v,size:"icon",children:t.jsx(Nn,{className:"h-4 w-4"})})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-xs",children:[t.jsx(MC,{className:"h-3 w-3"}),t.jsx("span",{children:"Precisa de ajuda humana?"})]}),t.jsx(oe,{className:"text-xs",onClick:N,size:"sm",variant:"outline",children:"Falar com humano"})]}),t.jsx("div",{className:"mt-2 border-t pt-2 text-center text-muted-foreground text-xs",children:t.jsx("p",{children:'IA treinada na narrativa "Profissional Abandonado  Empresrio da Sade Esttica"'})})]})]})})]})})})]})})}const pw=C.forwardRef(({...e},r)=>t.jsx("nav",{"aria-label":"breadcrumb",ref:r,...e}));pw.displayName="Breadcrumb";const gw=C.forwardRef(({className:e,...r},a)=>t.jsx("ol",{className:me("flex flex-wrap items-center gap-1.5 break-words text-muted-foreground text-sm sm:gap-2.5",e),ref:a,...r}));gw.displayName="BreadcrumbList";const Kx=C.forwardRef(({className:e,...r},a)=>t.jsx("li",{className:me("inline-flex items-center gap-1.5",e),ref:a,...r}));Kx.displayName="BreadcrumbItem";const vw=C.forwardRef(({asChild:e,className:r,...a},n)=>{const i=e?vp:"a";return t.jsx(i,{className:me("transition-colors hover:text-foreground",r),ref:n,...a})});vw.displayName="BreadcrumbLink";const yw=C.forwardRef(({className:e,...r},a)=>t.jsx("span",{"aria-current":"page",className:me("font-normal text-foreground",e),ref:a,...r}));yw.displayName="BreadcrumbPage";const jw=({children:e,className:r,...a})=>t.jsx("li",{"aria-hidden":"true",className:me("[&>svg]:h-3.5 [&>svg]:w-3.5",r),role:"presentation",...a,children:e??t.jsx(Sn,{})});jw.displayName="BreadcrumbSeparator";function BD({children:e}){const r=v2(),a=C.useId();return t.jsxs("div",{className:"flex h-screen w-full flex-col md:flex-row",children:[t.jsx(TD,{}),t.jsxs("main",{className:"flex flex-1 flex-col overflow-hidden bg-mesh bg-noise",id:a,children:[t.jsxs("header",{className:"z-10 flex h-16 shrink-0 items-center gap-2 border-b bg-background px-4",children:[t.jsxs("div",{className:"flex items-center gap-2 px-4",children:[t.jsx(Sa,{className:"mr-2 hidden h-4 md:block",orientation:"vertical"}),t.jsx(pw,{children:t.jsxs(gw,{children:[t.jsx(Kx,{className:"hidden md:block",children:t.jsx(vw,{href:"/",children:"Portal"})}),r.pathname!=="/"&&t.jsxs(t.Fragment,{children:[t.jsx(jw,{className:"hidden md:block"}),t.jsx(Kx,{children:t.jsx(yw,{children:r.pathname.split("/").filter(Boolean).pop()?.toUpperCase()||"DASHBOARD"})})]})]})})]}),t.jsx("div",{className:"ml-auto px-4",children:t.jsx(y2,{afterSignOutUrl:"/"})})]}),t.jsx("div",{className:"flex-1 overflow-auto p-6",children:e})]}),t.jsx(PD,{})]})}function UD(){const{isSignedIn:e,isLoaded:r}=j2(),{user:a}=j0(),[n,i]=C.useState("loading"),[o,u]=C.useState(null),d=r&&e,{data:h}=et.users.me.useQuery(void 0,{enabled:d}),m=et.users.ensureUser.useMutation();return C.useEffect(()=>{if(!r)return;if(!e){i("synced");return}if(h){i("synced");return}if(h===void 0)return;(async()=>{if(a)try{await m.mutateAsync({clerkId:a.id,email:a.primaryEmailAddress?.emailAddress??a.emailAddresses?.[0]?.emailAddress??"",name:a.fullName??a.firstName??"User",avatarUrl:a.imageUrl}),i("synced")}catch(v){console.error("Failed to sync user:",v),i("error"),u(v instanceof Error?v:new Error("Unknown sync error"))}})()},[r,e,h,a,m]),{status:n,error:o,isLoading:n==="loading",user:h}}const zD=jt("/_authenticated")({beforeLoad:({context:e})=>{if(e.auth?.isLoaded!==!1&&!e.auth?.userId)throw Gu({to:"/sign-in"})},component:VD});function VD(){const{status:e,error:r,isLoading:a}=UD();return a?t.jsx("div",{className:"flex h-screen w-full items-center justify-center bg-background",children:t.jsxs("div",{className:"flex flex-col items-center gap-4",children:[t.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent"}),t.jsx("p",{className:"text-muted-foreground text-sm",children:"Sincronizando perfil..."})]})}):e==="error"?t.jsx("div",{className:"flex h-screen w-full items-center justify-center bg-background p-4",children:t.jsxs("div",{className:"flex max-w-md flex-col items-center gap-6 text-center",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx("h2",{className:"font-bold text-destructive text-xl",children:"Erro de Sincronizao"}),t.jsx("p",{className:"text-muted-foreground",children:r?.message||"No foi possvel sincronizar seu perfil. Por favor, tente novamente."})]}),t.jsxs("div",{className:"flex gap-4",children:[t.jsx(oe,{onClick:()=>window.location.reload(),children:"Tentar novamente"}),t.jsx(oe,{onClick:()=>{window.location.href="/sign-in"},variant:"outline",children:"Voltar para Login"})]})]})}):t.jsx(BD,{children:t.jsx(Yc,{})})}function HD({heading:e="Veja seu negcio em tempo real",subheading:r="Dashboard completo com mtricas atualizadas e insights acionveis para tomar decises melhores.",containerClassName:a="",textClassName:n="",subNoteClassName:i="",floatDistance:o=80,duration:u=.8}){const d=C.useRef(null),{scrollYProgress:h}=E0({target:d,offset:["start end","center center"]}),m=Rr(h,[0,1],[o,0]),p=Vi(m,{stiffness:100,damping:30,restDelta:.001}),v=Rr(h,[0,.5,1],[0,.8,1]);return t.jsx("div",{className:`relative overflow-hidden ${a}`,ref:d,children:t.jsxs(at.div,{className:"space-y-4 text-center",style:{y:p,opacity:v},transition:{duration:u},children:[t.jsx(at.h2,{className:n||"bg-linear-to-r from-foreground to-foreground/50 bg-clip-text font-bold text-4xl text-transparent md:text-5xl lg:text-6xl",children:e}),t.jsx(at.p,{className:i||"mx-auto max-w-3xl text-lg text-muted-foreground md:text-xl",children:r})]})})}function GD({children:e,showGradient:r=!0,title:a,badge:n,className:i}){const o=C.useRef(null),u=dk(),{scrollYProgress:d}=E0({target:o,offset:["start end","end start"]}),h=Rr(d,[0,.3,.7,1],u?[1,1,1,1]:[.8,1,1,1]),m=Rr(d,[0,.3,.7,1],u?[0,0,0,0]:[20,0,0,0]),p=Rr(d,[0,.2,.8,1],u?[1,1,1,1]:[0,1,1,1]),v=Rr(d,[0,.3],u?[0,0]:[-40,0]),y=Rr(d,[0,.2],u?[1,1]:[0,1]);return t.jsxs("div",{className:me("relative flex w-full flex-col items-center justify-center py-16 md:py-24",i),ref:o,style:{perspective:"1200px"},children:[r&&t.jsx("div",{className:"pointer-events-none absolute inset-0 -z-10 bg-linear-to-b from-primary/5 via-transparent to-transparent opacity-50 blur-3xl"}),a&&t.jsx(at.div,{className:"relative z-20 mb-12 text-center",style:{opacity:p,y:v},children:typeof a=="string"?t.jsx("h3",{className:"font-bold font-display text-3xl text-foreground tracking-tight",children:a}):a}),t.jsxs(at.div,{className:"relative flex flex-col items-center",style:{scale:h,rotateX:m,transformStyle:"preserve-3d"},children:[t.jsxs("div",{className:"relative z-10 h-80 w-lg rounded-2xl border-4 border-zinc-800 bg-zinc-900 p-2 shadow-2xl transition-colors duration-300 md:h-120 md:w-3xl dark:border-zinc-800 dark:bg-zinc-950",children:[t.jsx("div",{className:"absolute top-0 left-1/2 z-20 flex h-6 w-32 -translate-x-1/2 items-center justify-center rounded-b-xl border-zinc-800/50 border-x border-b bg-zinc-900",children:t.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-zinc-800"})}),t.jsxs("div",{className:"relative h-full w-full overflow-hidden rounded-xl border border-white/5 bg-zinc-950",children:[t.jsx("div",{className:"pointer-events-none absolute inset-0 z-10 bg-linear-to-tr from-white/5 to-transparent opacity-20"}),t.jsx(at.div,{className:"h-full w-full overflow-hidden",style:{opacity:y},children:e})]})]}),t.jsx("div",{className:"relative -mt-2 flex h-4 w-xl items-start justify-center rounded-t-sm rounded-b-2xl border-zinc-400/20 border-t bg-zinc-300 shadow-[0_20px_50px_-12px_rgba(0,0,0,0.5)] md:w-216 dark:bg-zinc-800",children:t.jsx("div",{className:"mt-1 h-3 w-32 rounded-full bg-zinc-400/20 blur-[1px] md:w-48"})})]}),n&&t.jsx(at.div,{className:"mt-12",style:{opacity:p},children:n})]})}function qD({children:e,className:r}){return t.jsx("div",{className:me("no-scrollbar h-full w-full overflow-y-auto bg-background/5 p-4 md:p-6 lg:p-8",r),children:e})}function WD({title:e,value:r,icon:a,delay:n=0}){return t.jsx(at.div,{animate:"visible",initial:"hidden",transition:{delay:n,duration:3,repeat:Number.POSITIVE_INFINITY,ease:"easeInOut"},variants:LD,children:t.jsxs(Te,{className:"glass-card transition-all duration-300 hover:shadow-primary/20 hover:shadow-xl",children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between pb-2",children:[t.jsx(Le,{className:"font-medium text-muted-foreground text-sm",children:e}),t.jsx(a,{className:"h-4 w-4 text-primary"})]}),t.jsx(Ce,{children:t.jsx("div",{className:"font-bold font-display text-2xl",children:r})})]})})}function YD(){const e=[{title:"Leads este ms",value:"127",icon:ya},{title:"Taxa de Converso",value:"24.5%",icon:tn},{title:"Faturamento",value:"R$ 245k",icon:$i},{title:"Crescimento",value:"+18%",icon:Al}];return t.jsxs(qD,{className:"bg-background/95",children:[t.jsx("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2 md:gap-4 lg:grid-cols-4",children:e.map((r,a)=>t.jsx(WD,{delay:a*.2,icon:r.icon,title:r.title,value:r.value},r.title))}),t.jsx(at.div,{animate:"visible",className:"mt-4 flex h-32 items-center justify-center rounded-lg border border-primary/20 bg-linear-to-br from-primary/10 via-us-purple-light/10 to-us-gold/10 md:mt-6 md:h-48 lg:h-56",initial:"hidden",variants:or,children:t.jsxs("div",{className:"text-center",children:[t.jsx(Al,{className:"mx-auto mb-2 h-8 w-8 text-primary/50 md:mb-3 md:h-10 md:w-10"}),t.jsx("p",{className:"font-sans text-muted-foreground text-xs md:text-sm",children:"Visualizao de dados em tempo real"})]})})]})}function XD(){return t.jsxs("section",{className:"relative overflow-hidden py-16 md:py-24",children:[t.jsx("div",{className:"absolute inset-0 bg-linear-to-b from-transparent via-background/50 to-background"}),t.jsxs(at.div,{className:"container relative z-10 mx-auto px-4 md:px-6",initial:"hidden",variants:O0,viewport:{once:!0,margin:"-100px"},whileInView:"visible",children:[t.jsx(at.div,{className:"mb-8 md:mb-12",variants:or,children:t.jsx(HD,{containerClassName:"max-w-4xl mx-auto",subNoteClassName:"text-lg md:text-xl text-muted-foreground max-w-2xl mx-auto mt-4",textClassName:"text-3xl md:text-4xl font-display font-bold tracking-tight bg-clip-text text-transparent bg-linear-to-r from-foreground to-foreground/50"})}),t.jsx(at.div,{variants:or,children:t.jsx(GD,{showGradient:!0,children:t.jsx(YD,{})})})]})]})}const $D=[{title:"AI Lead Scoring",description:"Inteligncia artificial para classificar e priorizar seus leads mais qualificados.",icon:FC,color:"text-primary",bgColor:"bg-primary/10"},{title:"Omnichannel Chat",description:"Converse com seus clientes em mltiplos canais de forma integrada.",icon:IC,color:"text-us-gold",bgColor:"bg-us-gold/10"},{title:"Predictive Analytics",description:"Anlises preditivas para antecendar tendncias e oportunidades.",icon:Al,color:"text-primary",bgColor:"bg-primary/10"},{title:"Smart Segmentation",description:"Segmentao inteligente de clientes para campanhas personalizadas.",icon:ya,color:"text-us-success",bgColor:"bg-us-success/10"},{title:"Instant Automation",description:"Automao instantnea de processos repetitivos e workflows.",icon:k2,color:"text-us-warning",bgColor:"bg-us-warning/10"},{title:"Medical Grade Security",description:"Segurana de nvel mdico para proteo de dados sensveis.",icon:D2,color:"text-us-info",bgColor:"bg-us-info/10"}],KD=({products:e,header:r})=>{const a=e.slice(0,5),n=e.slice(5,10),i=e.slice(10,15),o=Xe.useRef(null),{scrollYProgress:u}=E0({target:o,offset:["start start","end start"]}),d={stiffness:300,damping:30,bounce:100},h=Vi(Rr(u,[0,1],[0,1e3]),d),m=Vi(Rr(u,[0,1],[0,-1e3]),d),p=Vi(Rr(u,[0,.2],[15,0]),d),v=Vi(Rr(u,[0,.2],[.2,1]),d),y=Vi(Rr(u,[0,.2],[20,0]),d),N=Vi(Rr(u,[0,.2],[-700,500]),d);return t.jsxs("div",{className:"perspective-[1000px] transform-3d relative flex h-[300vh] flex-col self-auto overflow-hidden py-40 antialiased",ref:o,children:[r,t.jsxs(at.div,{className:"",style:{rotateX:p,rotateZ:y,translateY:N,opacity:v},children:[t.jsx(at.div,{className:"mb-20 flex flex-row-reverse space-x-20 space-x-reverse",children:a.map(j=>t.jsx(dx,{product:j,translate:h},j.title))}),t.jsx(at.div,{className:"mb-20 flex flex-row space-x-20",children:n.map(j=>t.jsx(dx,{product:j,translate:m},j.title))}),t.jsx(at.div,{className:"flex flex-row-reverse space-x-20 space-x-reverse",children:i.map(j=>t.jsx(dx,{product:j,translate:h},j.title))})]})]})},dx=({product:e,translate:r})=>t.jsxs(at.div,{className:"group/product relative h-96 w-120 shrink-0",style:{x:r},whileHover:{y:-20},children:[e.link?t.jsx("a",{className:"block h-full w-full group-hover/product:shadow-2xl",href:e.link,children:e.content?e.content:t.jsx("img",{alt:e.title,className:"absolute inset-0 h-full w-full object-cover object-top-left",height:"600",src:e.thumbnail,width:"600"})}):t.jsx("div",{className:"block h-full w-full group-hover/product:shadow-2xl",children:e.content?e.content:t.jsx("img",{alt:e.title,className:"absolute inset-0 h-full w-full object-cover object-top-left",height:"600",src:e.thumbnail,width:"600"})}),!e.content&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"pointer-events-none absolute inset-0 h-full w-full bg-black opacity-0 group-hover/product:opacity-80"}),t.jsx("h2",{className:"absolute bottom-4 left-4 text-white opacity-0 group-hover/product:opacity-100",children:e.title})]})]},e.title);function QD(){const e=$D.map(n=>({title:n.title,link:void 0,thumbnail:void 0,content:t.jsxs(Te,{className:"glass-card group flex h-full flex-col justify-center border-border/50 transition-all duration-300 hover:border-primary/50 hover:shadow-primary/10 hover:shadow-xl",children:[t.jsxs(Me,{children:[t.jsx("div",{className:`h-12 w-12 rounded-lg ${n.bgColor} mb-4 flex items-center justify-center transition-transform group-hover:scale-110`,children:t.jsx(n.icon,{className:`h-6 w-6 ${n.color}`})}),t.jsx(Le,{className:"font-display text-xl",children:n.title})]}),t.jsx(Ce,{children:t.jsx("p",{className:"font-sans text-muted-foreground text-sm",children:n.description})})]})})),r=[...e,...e,...e].slice(0,15),a=()=>t.jsx("div",{className:"relative top-0 left-0 mx-auto w-full max-w-7xl px-4 py-20 md:py-40",children:t.jsxs(at.div,{className:"max-w-3xl",initial:"hidden",variants:or,whileInView:"visible",children:[t.jsx("h2",{className:"mb-4 font-bold font-display text-3xl text-foreground tracking-tight md:text-5xl",children:"Tudo que voc precisa para crescer"}),t.jsx("p",{className:"font-sans text-lg text-muted-foreground md:text-xl",children:"Ferramentas poderosas desenhadas para impulsionar seu negcio para o prximo nvel."})]})});return t.jsx(KD,{header:t.jsx(a,{}),products:r})}const kf={produtos:[{label:"TRINTAE3",href:"#"},{label:"Black NEON",href:"#"},{label:"Comunidade US",href:"#"},{label:"OTB MBA",href:"#"},{label:"Aurculo",href:"#"}],empresa:[{label:"Sobre Ns",href:"#"},{label:"Depoimentos",href:"#"},{label:"Blog",href:"#"},{label:"Carreiras",href:"#"}],suporte:[{label:"Central de Ajuda",href:"#"},{label:"Contato",href:"#"},{label:"Poltica de Privacidade",href:"#"},{label:"Termos de Uso",href:"#"}],contato:[{label:"contato@grupous.com.br",href:"mailto:contato@grupous.com.br",icon:rr},{label:"(11) 99999-9999",href:"tel:+5511999999999",icon:Yu}]},ZD=[{label:"Instagram",href:"#",icon:LC},{label:"Facebook",href:"#",icon:PC},{label:"LinkedIn",href:"#",icon:BC}];function JD(){return t.jsx("footer",{className:"relative border-border/50 border-t bg-background/80 backdrop-blur-xl",children:t.jsxs(at.div,{className:"container mx-auto px-4 py-12 md:px-6 md:py-16",initial:"hidden",variants:O0,viewport:{once:!0,margin:"-50px"},whileInView:"visible",children:[t.jsxs("div",{className:"grid grid-cols-1 gap-8 md:grid-cols-2 md:gap-12 lg:grid-cols-4",children:[t.jsxs(at.div,{className:"space-y-4",variants:or,children:[t.jsxs(Br,{className:"group flex items-center space-x-2",to:"/",children:[t.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-gradient-to-br from-primary to-us-gold transition-transform group-hover:scale-105",children:t.jsx("span",{className:"font-bold font-display text-primary-foreground text-sm",children:"GU"})}),t.jsx("span",{className:"font-bold font-display text-xl tracking-tight",children:"Grupo US"})]}),t.jsx("p",{className:"font-sans text-muted-foreground text-sm",children:"Transformando profissionais da sade esttica atravs de educao, tecnologia e comunidade."}),t.jsx("div",{className:"flex items-center gap-4",children:ZD.map(e=>t.jsx("a",{"aria-label":e.label,className:"text-muted-foreground transition-colors hover:text-primary",href:e.href,children:t.jsx(e.icon,{className:"h-5 w-5"})},e.label))})]}),t.jsxs(at.div,{className:"space-y-4",variants:or,children:[t.jsx("h3",{className:"font-display font-semibold text-sm uppercase tracking-wider",children:"Produtos"}),t.jsx("ul",{className:"space-y-2",children:kf.produtos.map(e=>t.jsx("li",{children:t.jsx("a",{className:"font-sans text-muted-foreground text-sm transition-colors hover:text-foreground",href:e.href,children:e.label})},e.label))})]}),t.jsxs(at.div,{className:"space-y-4",variants:or,children:[t.jsx("h3",{className:"font-display font-semibold text-sm uppercase tracking-wider",children:"Empresa"}),t.jsx("ul",{className:"space-y-2",children:kf.empresa.map(e=>t.jsx("li",{children:t.jsx("a",{className:"font-sans text-muted-foreground text-sm transition-colors hover:text-foreground",href:e.href,children:e.label})},e.label))})]}),t.jsxs(at.div,{className:"space-y-4",variants:or,children:[t.jsx("h3",{className:"font-display font-semibold text-sm uppercase tracking-wider",children:"Suporte"}),t.jsx("ul",{className:"space-y-2",children:kf.suporte.map(e=>t.jsx("li",{children:t.jsx("a",{className:"font-sans text-muted-foreground text-sm transition-colors hover:text-foreground",href:e.href,children:e.label})},e.label))}),t.jsx("div",{className:"space-y-2 pt-4",children:kf.contato.map(e=>t.jsxs("a",{className:"flex items-center gap-2 font-sans text-muted-foreground text-sm transition-colors hover:text-foreground",href:e.href,children:[e.icon&&t.jsx(e.icon,{className:"h-4 w-4"}),e.label]},e.label))})]})]}),t.jsxs(at.div,{className:"mt-12 border-border/50 border-t pt-8 text-center",variants:or,children:[t.jsxs("p",{className:"font-sans text-muted-foreground text-sm",children:[" ",new Date().getFullYear()," Grupo US. Todos os direitos reservados."]}),t.jsx("p",{className:"mt-2 font-sans text-muted-foreground text-xs",children:"CNPJ: 00.000.000/0001-00 | So Paulo, SP - Brasil"})]})]})})}function eO(){return t.jsxs("section",{className:"relative flex min-h-screen items-center justify-center overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:"linear-gradient(hsl(var(--border)) 1px, transparent 1px), linear-gradient(90deg, hsl(var(--border)) 1px, transparent 1px)",backgroundSize:"50px 50px"}}),t.jsx("div",{className:"absolute top-0 left-0 -z-10 h-[500px] w-full bg-linear-to-b from-primary/5 to-transparent"}),t.jsxs("div",{className:"pointer-events-none absolute top-0 left-1/2 -z-10 h-full w-full max-w-7xl -translate-x-1/2",children:[t.jsx(at.div,{animate:{scale:[1,1.1,1],opacity:[.3,.5,.3]},className:"absolute top-1/4 left-1/4 h-96 w-96 rounded-full bg-primary/10 blur-3xl",transition:{duration:4,repeat:Number.POSITIVE_INFINITY,ease:"easeInOut"}}),t.jsx(at.div,{animate:{scale:[1,1.2,1],opacity:[.2,.4,.2]},className:"absolute right-1/4 bottom-1/4 h-96 w-96 rounded-full bg-us-gold/10 blur-3xl",transition:{duration:5,repeat:Number.POSITIVE_INFINITY,ease:"easeInOut",delay:1}})]}),t.jsxs(at.div,{animate:"visible",className:"container relative z-10 mx-auto flex flex-col items-center space-y-8 px-4 text-center md:px-6",initial:"hidden",variants:O0,children:[t.jsxs(at.div,{className:"inline-flex items-center gap-2 rounded-full border border-primary/20 bg-primary/10 px-4 py-2 font-medium text-primary text-sm backdrop-blur-xl",variants:or,children:[t.jsx("div",{className:"flex items-center gap-1",children:[...new Array(3)].map((e,r)=>t.jsx(UC,{className:"h-3 w-3 fill-us-gold text-us-gold"},r))}),t.jsx("span",{className:"font-display",children:"Nova Era de Gesto"})]}),t.jsxs(at.h1,{className:"max-w-4xl font-bold font-display text-4xl tracking-tight md:text-6xl lg:text-7xl",variants:or,children:[t.jsx("span",{className:"bg-linear-to-r from-foreground via-primary to-foreground bg-clip-text text-transparent",children:"Potencialize sua Gesto com"}),t.jsx("span",{className:"block bg-linear-to-r from-primary via-us-purple-light to-primary bg-clip-text text-transparent",children:"Inteligncia Artificial"})]}),t.jsx(at.p,{className:"mx-auto max-w-2xl font-sans text-muted-foreground text-xl",variants:or,children:"A plataforma que escala suas vendas, gerencia o controle de leads e automatiza seus processos, em um s lugar!"})]})]})}function tO({children:e,containerClassName:r,className:a,as:n="button",duration:i=1,clockwise:o=!0,...u}){const[d,h]=C.useState(!1),[m,p]=C.useState("TOP"),v=C.useCallback(j=>{const b=["TOP","LEFT","BOTTOM","RIGHT"],w=b.indexOf(j),T=o?(w-1+b.length)%b.length:(w+1)%b.length;return b[T]},[o]),y={TOP:"radial-gradient(20.7% 50% at 50% 0%, hsl(var(--primary)) 0%, rgba(255, 255, 255, 0) 100%)",LEFT:"radial-gradient(16.6% 43.1% at 0% 50%, hsl(var(--primary)) 0%, rgba(255, 255, 255, 0) 100%)",BOTTOM:"radial-gradient(20.7% 50% at 50% 100%, hsl(var(--primary)) 0%, rgba(255, 255, 255, 0) 100%)",RIGHT:"radial-gradient(16.2% 41.199999999999996% at 100% 50%, hsl(var(--primary)) 0%, rgba(255, 255, 255, 0) 100%)"},N="radial-gradient(75% 181.15942028985506% at 50% 50%, #3275F8 0%, rgba(255, 255, 255, 0) 100%)";return C.useEffect(()=>{if(!d){const j=setInterval(()=>{p(b=>v(b))},i*1e3);return()=>clearInterval(j)}},[d,i,v]),t.jsxs(n,{className:me("relative flex h-min w-fit flex-col flex-nowrap content-center items-center justify-center gap-10 overflow-visible rounded-full border bg-black/20 box-decoration-clone p-px transition-duration-500 hover:bg-black/10",r),onMouseEnter:j=>{h(!0)},onMouseLeave:()=>h(!1),...u,children:[t.jsx("div",{className:me("z-10 w-auto rounded-[inherit] bg-black px-4 py-2 text-white",a),children:e}),t.jsx(at.div,{animate:{background:d?[y[m],N]:y[m]},className:me("absolute inset-0 z-0 flex-none overflow-hidden rounded-[inherit]"),initial:{background:y[m]},style:{filter:"blur(2px)",position:"absolute",width:"100%",height:"100%"},transition:{ease:"linear",duration:i??1}}),t.jsx("div",{className:"absolute inset-[2px] z-1 flex-none rounded-[100px] bg-black"})]})}const bw=Xe.forwardRef(({className:e,children:r,rippleColor:a="rgba(255, 255, 255, 0.5)",duration:n=600,onClick:i,...o},u)=>{const[d,h]=Xe.useState([]),m=p=>{const y=p.currentTarget.getBoundingClientRect(),N=Math.max(y.width,y.height),j=p.clientX-y.left-N/2,b=p.clientY-y.top-N/2,w={x:j,y:b,size:N,key:Date.now()};h(T=>[...T,w])};return Xe.useEffect(()=>{if(d.length>0){const p=d.at(-1);if(!p)return;const v=setTimeout(()=>{h(y=>y.filter(N=>N.key!==p.key))},n);return()=>clearTimeout(v)}},[d,n]),t.jsxs("button",{className:me("relative cursor-pointer overflow-hidden",e),onClick:p=>{m(p),i?.(p)},ref:u,...o,children:[t.jsx("span",{className:"relative z-10",children:r}),d.map(p=>t.jsx("span",{className:"pointer-events-none absolute animate-ripple rounded-full",style:{top:p.y,left:p.x,width:p.size,height:p.size,backgroundColor:a,transform:"scale(0)",animationDuration:`${n}ms`}},p.key))]})});bw.displayName="RippleButton";const aO=({className:e})=>{const{scrollYProgress:r}=E0(),[a,n]=C.useState(!0);return fk(r,"change",i=>{if(typeof i=="number"){const o=r.getPrevious(),u=o!==void 0?i-o:0;r.get()<.05||u<0?n(!0):n(!1)}}),t.jsx(AN,{mode:"wait",children:t.jsx(at.nav,{animate:{y:a?0:-100,opacity:a?1:0},className:me("fixed inset-x-0 top-10 z-5000 mx-auto flex max-w-fit items-center justify-center rounded-full",e),initial:{opacity:1,y:-100},transition:{duration:.2},children:t.jsx(Br,{to:"/sign-in",children:t.jsx(tO,{as:"div",className:"flex items-center space-x-2 bg-background text-foreground",containerClassName:"rounded-full",children:t.jsx(bw,{className:"bg-transparent px-8 py-2 font-bold text-amber-400 text-lg transition-transform hover:scale-105 hover:bg-transparent",rippleColor:"rgba(217, 119, 6, 0.2)",children:"Login"})})})})})},rO=jt("/")({component:sO});function sO(){return t.jsxs("div",{className:"min-h-screen bg-background text-foreground",children:[t.jsx(aO,{}),t.jsxs("main",{children:[t.jsx(eO,{}),t.jsx(XD,{}),t.jsx(QD,{})]}),t.jsx(JD,{})]})}const nO=jt("/sign-up/")({component:iO});function iO(){return t.jsxs("div",{className:"relative flex min-h-screen items-center justify-center overflow-hidden bg-mesh bg-noise",children:[t.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[t.jsx(at.div,{animate:{scale:[1,1.2,1],opacity:[.3,.5,.3]},className:"absolute top-1/4 left-1/4 h-96 w-96 rounded-full bg-primary/10 blur-3xl",transition:{duration:8,repeat:Number.POSITIVE_INFINITY,ease:"easeInOut"}}),t.jsx(at.div,{animate:{scale:[1.2,1,1.2],opacity:[.2,.4,.2]},className:"absolute right-1/4 bottom-1/4 h-96 w-96 rounded-full bg-us-gold/10 blur-3xl",transition:{duration:10,repeat:Number.POSITIVE_INFINITY,ease:"easeInOut",delay:1}})]}),t.jsx(at.div,{animate:"visible",className:"relative z-10 w-full max-w-md px-4",initial:"hidden",variants:or,children:t.jsx("div",{className:"glass-card rounded-2xl p-8 shadow-2xl",children:t.jsx(b2,{appearance:{elements:{rootBox:"mx-auto",card:"bg-transparent shadow-none",headerTitle:"font-display text-2xl font-bold",headerSubtitle:"font-sans text-muted-foreground",socialButtonsBlockButton:"bg-background/50 border-border hover:bg-background/70",formButtonPrimary:"bg-primary hover:bg-primary/90 text-primary-foreground rounded-lg",formFieldInput:"bg-background/50 border-border focus:border-primary focus:ring-primary",footerActionLink:"text-primary hover:text-primary/80"}},forceRedirectUrl:"/dashboard",path:"/sign-up",routing:"path",signInUrl:"/sign-in"})})})]})}const lO=jt("/sign-in/")({component:cO});function cO(){return t.jsxs("div",{className:"relative flex min-h-screen items-center justify-center overflow-hidden bg-mesh bg-noise",children:[t.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[t.jsx(at.div,{animate:{scale:[1,1.2,1],opacity:[.3,.5,.3]},className:"absolute top-1/4 left-1/4 h-96 w-96 rounded-full bg-primary/10 blur-3xl",transition:{duration:8,repeat:Number.POSITIVE_INFINITY,ease:"easeInOut"}}),t.jsx(at.div,{animate:{scale:[1.2,1,1.2],opacity:[.2,.4,.2]},className:"absolute right-1/4 bottom-1/4 h-96 w-96 rounded-full bg-us-gold/10 blur-3xl",transition:{duration:10,repeat:Number.POSITIVE_INFINITY,ease:"easeInOut",delay:1}})]}),t.jsx(at.div,{animate:"visible",className:"relative z-10 w-full max-w-md px-4",initial:"hidden",variants:or,children:t.jsx("div",{className:"glass-card rounded-2xl p-8 shadow-2xl",children:t.jsx(N2,{appearance:{elements:{rootBox:"mx-auto",card:"bg-transparent shadow-none",headerTitle:"font-display text-2xl font-bold",headerSubtitle:"font-sans text-muted-foreground",socialButtonsBlockButton:"bg-background/50 border-border hover:bg-background/70",formButtonPrimary:"bg-primary hover:bg-primary/90 text-primary-foreground rounded-lg",formFieldInput:"bg-background/50 border-border focus:border-primary focus:ring-primary",footerActionLink:"text-primary hover:text-primary/80"}},forceRedirectUrl:"/dashboard",path:"/sign-in",routing:"path",signUpUrl:"/sign-up"})})})]})}const jr=C.forwardRef(({className:e,...r},a)=>t.jsx(O2,{className:me("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),ref:a,...r,children:t.jsx(zC,{className:me("flex items-center justify-center text-current"),children:t.jsx(Xu,{className:"h-4 w-4"})})}));jr.displayName=O2.displayName;const oO=k0("font-medium text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),yt=C.forwardRef(({className:e,...r},a)=>t.jsx(R2,{className:me(oO(),e),ref:a,...r}));yt.displayName=R2.displayName;const es=mk,Nw=C.createContext(null),nt=({...e})=>t.jsx(Nw.Provider,{value:{name:e.name},children:t.jsx(xk,{...e})}),R0=()=>{const e=C.useContext(Nw),r=C.useContext(ww),{getFieldState:a,formState:n}=hk();if(!e)throw new Error("useFormField should be used within <FormField>");if(!r)throw new Error("useFormField should be used within <FormItem>");const i=a(e.name,n),{id:o}=r;return{id:o,name:e.name,formItemId:`${o}-form-item`,formDescriptionId:`${o}-form-item-description`,formMessageId:`${o}-form-item-message`,...i}},ww=C.createContext(null),st=C.forwardRef(({className:e,...r},a)=>{const n=C.useId();return t.jsx(ww.Provider,{value:{id:n},children:t.jsx("div",{className:me("space-y-2",e),ref:a,...r})})});st.displayName="FormItem";const ct=C.forwardRef(({className:e,...r},a)=>{const{error:n,formItemId:i}=R0();return t.jsx(yt,{className:me(n&&"text-destructive",e),htmlFor:i,ref:a,...r})});ct.displayName="FormLabel";const it=C.forwardRef(({...e},r)=>{const{error:a,formItemId:n,formDescriptionId:i,formMessageId:o}=R0();return t.jsx(vp,{"aria-describedby":a?`${i} ${o}`:`${i}`,"aria-invalid":!!a,id:n,ref:r,...e})});it.displayName="FormControl";const ps=C.forwardRef(({className:e,...r},a)=>{const{formDescriptionId:n}=R0();return t.jsx("p",{className:me("text-[0.8rem] text-muted-foreground",e),id:n,ref:a,...r})});ps.displayName="FormDescription";const xt=C.forwardRef(({className:e,children:r,...a},n)=>{const{error:i,formMessageId:o}=R0(),u=i?String(i?.message??""):r;return u?t.jsx("p",{className:me("font-medium text-[0.8rem] text-destructive",e),id:o,ref:n,...a,children:u}):null});xt.displayName="FormMessage";const Rt=YC,Mt=XC,At=C.forwardRef(({className:e,children:r,...a},n)=>t.jsxs(M2,{className:me("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[placeholder]:text-muted-foreground [&>span]:line-clamp-1",e),ref:n,...a,children:[r,t.jsx(VC,{asChild:!0,children:t.jsx(Il,{className:"h-4 w-4 opacity-50"})})]}));At.displayName=M2.displayName;const Sw=C.forwardRef(({className:e,...r},a)=>t.jsx(F2,{className:me("flex cursor-default items-center justify-center py-1",e),ref:a,...r,children:t.jsx($u,{className:"h-4 w-4"})}));Sw.displayName=F2.displayName;const _w=C.forwardRef(({className:e,...r},a)=>t.jsx(I2,{className:me("flex cursor-default items-center justify-center py-1",e),ref:a,...r,children:t.jsx(Il,{className:"h-4 w-4"})}));_w.displayName=I2.displayName;const kt=C.forwardRef(({className:e,children:r,position:a="popper",...n},i)=>t.jsx(HC,{children:t.jsxs(L2,{className:me("data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] origin-[--radix-select-content-transform-origin] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=closed]:animate-out data-[state=open]:animate-in",a==="popper"&&"data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=bottom]:translate-y-1 data-[side=top]:-translate-y-1",e),position:a,ref:i,...n,children:[t.jsx(Sw,{}),t.jsx(GC,{className:me("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),t.jsx(_w,{})]})}));kt.displayName=L2.displayName;const uO=C.forwardRef(({className:e,...r},a)=>t.jsx(P2,{className:me("px-2 py-1.5 font-semibold text-sm",e),ref:a,...r}));uO.displayName=P2.displayName;const ye=C.forwardRef(({className:e,children:r,...a},n)=>t.jsxs(B2,{className:me("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pr-8 pl-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),ref:n,...a,children:[t.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:t.jsx(qC,{children:t.jsx(Xu,{className:"h-4 w-4"})})}),t.jsx(WC,{children:r})]}));ye.displayName=B2.displayName;const dO=C.forwardRef(({className:e,...r},a)=>t.jsx(U2,{className:me("-mx-1 my-1 h-px bg-muted",e),ref:a,...r}));dO.displayName=U2.displayName;const xi=C.forwardRef(({className:e,...r},a)=>t.jsx("textarea",{className:me("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:a,...r}));xi.displayName="Textarea";function fO(e){const r=e.replace(/\D/g,""),a=r.slice(0,11);return a.length<=2?a?`(${a}`:"":a.length<=7?`(${a.slice(0,2)}) ${a.slice(2)}`:`(${r.slice(0,2)}) ${r.slice(2,7)}-${r.slice(7,11)}`}const Ew=["Harmonizao Facial","Esttica Corporal","Bioestimuladores","Outros"],hO=[...Ew],mO=Pa({name:Ke().min(2,"Nome deve ter pelo menos 2 caracteres").max(100),email:Ke().email("Email invlido"),phone:Ke().regex(/^\(\d{2}\) \d{5}-\d{4}$/,"Formato: (11) 99999-9999"),interest:ui(hO),message:Ke().max(500,"Mensagem deve ter no mximo 500 caracteres").optional(),lgpdConsent:oi().refine(e=>e===!0,{message:"Voc deve aceitar os termos"}),whatsappConsent:oi(),honeypot:Ke().max(0,"Invalid submission").optional(),utmSource:Ke().optional(),utmCampaign:Ke().optional(),utmMedium:Ke().optional(),utmContent:Ke().optional(),utmTerm:Ke().optional(),company:Ke().optional(),jobRole:Ke().optional(),origin:Ke().optional(),typebotId:Ke().optional(),resultId:Ke().optional(),externalTimestamp:Ap().optional()}),xO={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.1}}},Cc={hidden:{opacity:0,y:20},show:{opacity:1,y:0}};function pO({control:e,disabled:r}){return t.jsxs(at.div,{animate:"show",className:"space-y-4",initial:"hidden",variants:xO,children:[t.jsx(at.div,{variants:Cc,children:t.jsx(nt,{control:e,name:"name",render:({field:a})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Nome Completo"}),t.jsx(it,{children:t.jsx(dt,{disabled:r,placeholder:"Seu nome",...a})}),t.jsx(xt,{})]})})}),t.jsx(at.div,{variants:Cc,children:t.jsx(nt,{control:e,name:"phone",render:({field:a})=>t.jsxs(st,{children:[t.jsx(ct,{children:"WhatsApp"}),t.jsx(it,{children:t.jsx(dt,{disabled:r,placeholder:"(11) 99999-9999",type:"tel",...a,maxLength:15,onChange:n=>{const i=fO(n.target.value);a.onChange(i)}})}),t.jsx(xt,{})]})})}),t.jsx(at.div,{variants:Cc,children:t.jsx(nt,{control:e,name:"interest",render:({field:a})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Tenho interesse em"}),t.jsxs(Rt,{disabled:r,onValueChange:a.onChange,value:a.value??"",children:[t.jsx(it,{children:t.jsx(At,{children:t.jsx(Mt,{placeholder:"Selecione uma opo"})})}),t.jsx(kt,{children:Ew.map(n=>t.jsx(ye,{value:n,children:n},n))})]}),t.jsx(xt,{})]})})}),t.jsx(at.div,{variants:Cc,children:t.jsx(nt,{control:e,name:"email",render:({field:a})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Email"}),t.jsx(it,{children:t.jsx(dt,{disabled:r,placeholder:"seu@email.com",type:"email",...a})}),t.jsx(xt,{})]})})}),t.jsx(at.div,{variants:Cc,children:t.jsx(nt,{control:e,name:"message",render:({field:a})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Mensagem (Opcional)"}),t.jsx(it,{children:t.jsx(xi,{className:"resize-none",disabled:r,placeholder:"Como podemos ajudar?",...a})}),t.jsx(xt,{})]})})}),t.jsxs(at.div,{className:"space-y-3 pt-2",variants:Cc,children:[t.jsx(nt,{control:e,name:"lgpdConsent",render:({field:a})=>t.jsxs(st,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[t.jsx(it,{children:t.jsx(jr,{checked:a.value,disabled:r,onCheckedChange:a.onChange})}),t.jsxs("div",{className:"space-y-1 leading-none",children:[t.jsxs(ct,{children:["Concordo com a"," ",t.jsx(Br,{className:"text-primary hover:underline",target:"_blank",to:"/",children:"Poltica de Privacidade"})]}),t.jsx(xt,{})]})]})}),t.jsx(nt,{control:e,name:"whatsappConsent",render:({field:a})=>t.jsxs(st,{className:"flex flex-row items-start space-x-3 space-y-0 p-1",children:[t.jsx(it,{children:t.jsx(jr,{checked:a.value,disabled:r,onCheckedChange:a.onChange})}),t.jsx("div",{className:"space-y-1 leading-none",children:t.jsx(ct,{className:"font-normal",children:"Aceito receber contatos via WhatsApp"})})]})})]})]})}function gO({onReset:e}){return t.jsx("div",{className:"rounded-xl border bg-card p-8 text-center shadow-sm",children:t.jsxs(at.div,{animate:{scale:1,opacity:1},className:"flex flex-col items-center justify-center space-y-4",initial:{scale:.8,opacity:0},children:[t.jsx("div",{className:"rounded-full bg-green-100 p-3 dark:bg-green-900/20",children:t.jsx(Np,{className:"h-12 w-12 text-green-600 dark:text-green-400"})}),t.jsx("h3",{className:"font-bold text-2xl",children:"Sucesso!"}),t.jsx("p",{className:"text-muted-foreground",children:"Recebemos seus dados e entraremos em contato em breve."}),t.jsx(oe,{className:"mt-4",onClick:e,variant:"outline",children:"Enviar nova mensagem"})]})})}function vO(){const e=vC({strict:!1});return{utmSource:typeof e.utm_source=="string"?e.utm_source:void 0,utmCampaign:typeof e.utm_campaign=="string"?e.utm_campaign:void 0,utmMedium:typeof e.utm_medium=="string"?e.utm_medium:void 0,utmContent:typeof e.utm_content=="string"?e.utm_content:void 0,utmTerm:typeof e.utm_term=="string"?e.utm_term:void 0}}function yO({className:e,defaultSource:r="landing_page"}){const[a,n]=C.useState(!1),i=et.leads.create.useMutation(),o=vO(),u=Zr({resolver:Jr(mO),defaultValues:{name:"",phone:"",email:"",message:"",interest:void 0,lgpdConsent:!1,whatsappConsent:!1,honeypot:"",utmSource:o.utmSource||r,utmCampaign:o.utmCampaign,utmMedium:o.utmMedium,utmContent:o.utmContent,utmTerm:o.utmTerm}}),d=async h=>{try{if(h.honeypot){n(!0);return}await i.mutateAsync({name:h.name,email:h.email||void 0,phone:h.phone,source:"landing_page"}),n(!0),Ie.success("Solicitao recebida com sucesso!")}catch{Ie.error("Erro ao enviar formulrio. Tente novamente.")}};return a?t.jsx(gO,{onReset:()=>{n(!1),u.reset()}}):t.jsx("div",{className:e,children:t.jsx(es,{...u,children:t.jsxs("form",{className:"space-y-6",onSubmit:u.handleSubmit(d),children:[t.jsx(pO,{control:u.control,disabled:u.formState.isSubmitting}),t.jsx(nt,{control:u.control,name:"honeypot",render:({field:h})=>t.jsx(st,{className:"hidden",children:t.jsx(it,{children:t.jsx(dt,{...h,autoComplete:"off",tabIndex:-1})})})}),t.jsxs(oe,{className:"w-full",disabled:u.formState.isSubmitting,size:"lg",type:"submit",children:[u.formState.isSubmitting&&t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}),"Enviar Solicitao"]})]})})})}const jO=k0("inline-flex items-center rounded-md border px-2.5 py-0.5 font-semibold text-xs transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Ve({className:e,variant:r,...a}){return t.jsx("div",{className:me(jO({variant:r}),e),...a})}const bO=Pa({utm_source:Ke().optional(),utm_medium:Ke().optional(),utm_campaign:Ke().optional(),utm_content:Ke().optional(),utm_term:Ke().optional()}),NO={"@context":"https://schema.org","@type":"WebPage",name:"Captura de Leads - GPUS",description:"Transforme sua carreira na esttica com contedos exclusivos",mainEntity:{"@type":"Organization",name:"Grupo US",url:"https://gpus.com.br"}},Tw=jt("/captura/")({component:wO,validateSearch:e=>bO.parse(e),head:()=>({meta:[{title:"Transforme sua Carreira na Esttica | GPUS"},{name:"description",content:"Receba contedos exclusivos e oportunidades de formao. Junte-se a +2.000 profissionais."},{property:"og:title",content:"Transforme sua Carreira na Esttica | GPUS"},{property:"og:description",content:"Receba contedos exclusivos e oportunidades de formao. Junte-se a +2.000 profissionais."},{property:"og:type",content:"website"},{property:"og:url",content:"https://gpus.com.br/captura"},{name:"twitter:card",content:"summary_large_image"},{name:"twitter:title",content:"Transforme sua Carreira na Esttica | GPUS"},{name:"twitter:description",content:"Receba contedos exclusivos e oportunidades de formao"}],scripts:[{type:"application/ld+json",children:JSON.stringify(NO)}]})});function wO(){const r=Tw.useSearch().utm_source||"landing_page";return t.jsxs("div",{className:"min-h-screen bg-background text-foreground selection:bg-primary/20",children:[t.jsxs("div",{className:"pointer-events-none fixed inset-0 -z-10 overflow-hidden",children:[t.jsx("div",{className:"absolute top-0 left-1/4 h-[500px] w-[500px] rounded-full bg-purple-500/10 blur-[128px]"}),t.jsx("div",{className:"absolute right-1/4 bottom-0 h-[500px] w-[500px] rounded-full bg-blue-500/10 blur-[128px]"})]}),t.jsx("div",{className:"container mx-auto max-w-6xl px-4 py-12 md:py-24",children:t.jsxs("div",{className:"grid grid-cols-1 items-center gap-12 lg:grid-cols-2",children:[t.jsxs(at.div,{animate:{opacity:1,x:0},className:"space-y-8",initial:{opacity:0,x:-20},transition:{duration:.6},children:[t.jsxs("div",{className:"space-y-4",children:[t.jsxs("h1",{className:"font-bold text-4xl leading-tight tracking-tight md:text-5xl lg:text-6xl",children:["Transforme sua ",t.jsx("br",{className:"hidden lg:block"}),t.jsx("span",{className:"bg-linear-to-r from-purple-400 to-blue-400 bg-clip-text text-transparent",children:"Carreira na Esttica"})]}),t.jsx("p",{className:"max-w-lg text-muted-foreground text-xl leading-relaxed",children:"Receba contedos exclusivos e oportunidades de formao com a metodologia GPUS."})]}),t.jsx("div",{className:"space-y-4",children:["Acesso exclusivo a estratgias validadas","Mentoria com especialistas do mercado","Comunidade de alta performance"].map((a,n)=>t.jsxs(at.div,{animate:{opacity:1,y:0},className:"flex items-center space-x-3",initial:{opacity:0,y:10},transition:{delay:.2+n*.1},children:[t.jsx("div",{className:"flex h-6 w-6 shrink-0 items-center justify-center rounded-full bg-primary/20",children:t.jsx(Xu,{className:"h-4 w-4 text-primary"})}),t.jsx("span",{className:"text-lg",children:a})]},n))}),t.jsxs("div",{className:"flex flex-wrap items-center gap-4 pt-4 text-muted-foreground text-sm",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(D2,{className:"h-5 w-5"}),t.jsx("span",{children:"Seus dados esto protegidos"})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(rr,{className:"h-5 w-5"}),t.jsx("span",{children:"Sem spam, prometemos"})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(ga,{className:"h-5 w-5"}),t.jsx("span",{children:"Cancele quando quiser"})]})]}),t.jsx(at.div,{animate:{opacity:1},initial:{opacity:0},transition:{delay:.5},children:t.jsxs(Ve,{className:"px-4 py-2 text-base",variant:"secondary",children:[t.jsx(ya,{className:"mr-2 h-4 w-4"}),"Junte-se a +2.000 profissionais"]})})]}),t.jsxs(at.div,{animate:{opacity:1,y:0},className:"relative",initial:{opacity:0,y:20},transition:{delay:.3,duration:.6},children:[t.jsx("div",{className:"absolute -inset-1 rounded-2xl bg-linear-to-r from-purple-500 to-blue-500 opacity-20 blur-lg"}),t.jsxs("div",{className:"relative rounded-xl border bg-card p-6 shadow-2xl md:p-8",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h2",{className:"font-bold text-2xl",children:"Comece Sua Transformao"}),t.jsx("p",{className:"text-muted-foreground",children:"Preencha o formulrio e receba contedos exclusivos"})]}),t.jsx(yO,{className:"w-full",defaultSource:r})]})]})]})})]})}const SO=jt("/sign-up/sso-callback")({component:_O});function _O(){return t.jsx("div",{className:"flex min-h-screen items-center justify-center bg-mesh bg-noise",children:t.jsx(w2,{signInForceRedirectUrl:"/dashboard",signUpForceRedirectUrl:"/dashboard"})})}const EO=jt("/sign-up/$")({component:TO});function TO(){return t.jsxs("div",{className:"relative flex min-h-screen items-center justify-center overflow-hidden bg-mesh bg-noise",children:[t.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[t.jsx(at.div,{animate:{scale:[1,1.2,1],opacity:[.3,.5,.3]},className:"absolute top-1/4 left-1/4 h-96 w-96 rounded-full bg-primary/10 blur-3xl",transition:{duration:8,repeat:Number.POSITIVE_INFINITY,ease:"easeInOut"}}),t.jsx(at.div,{animate:{scale:[1.2,1,1.2],opacity:[.2,.4,.2]},className:"absolute right-1/4 bottom-1/4 h-96 w-96 rounded-full bg-us-gold/10 blur-3xl",transition:{duration:10,repeat:Number.POSITIVE_INFINITY,ease:"easeInOut",delay:1}})]}),t.jsx(at.div,{animate:"visible",className:"relative z-10 w-full max-w-md px-4",initial:"hidden",variants:or,children:t.jsx("div",{className:"glass-card rounded-2xl p-8 shadow-2xl",children:t.jsx(b2,{appearance:{elements:{rootBox:"mx-auto",card:"bg-transparent shadow-none",headerTitle:"font-display text-2xl font-bold",headerSubtitle:"font-sans text-muted-foreground",socialButtonsBlockButton:"bg-background/50 border-border hover:bg-background/70",formButtonPrimary:"bg-primary hover:bg-primary/90 text-primary-foreground rounded-lg",formFieldInput:"bg-background/50 border-border focus:border-primary focus:ring-primary",footerActionLink:"text-primary hover:text-primary/80"}},forceRedirectUrl:"/dashboard",path:"/sign-up",routing:"path",signInUrl:"/sign-in"})})})]})}const CO=jt("/sign-in/sso-callback")({component:AO});function AO(){return t.jsx("div",{className:"flex min-h-screen items-center justify-center bg-mesh bg-noise",children:t.jsx(w2,{signInForceRedirectUrl:"/dashboard",signUpForceRedirectUrl:"/dashboard"})})}const kO=jt("/sign-in/$")({component:DO});function DO(){return t.jsxs("div",{className:"relative flex min-h-screen items-center justify-center overflow-hidden bg-mesh bg-noise",children:[t.jsxs("div",{className:"pointer-events-none absolute inset-0",children:[t.jsx(at.div,{animate:{scale:[1,1.2,1],opacity:[.3,.5,.3]},className:"absolute top-1/4 left-1/4 h-96 w-96 rounded-full bg-primary/10 blur-3xl",transition:{duration:8,repeat:Number.POSITIVE_INFINITY,ease:"easeInOut"}}),t.jsx(at.div,{animate:{scale:[1.2,1,1.2],opacity:[.2,.4,.2]},className:"absolute right-1/4 bottom-1/4 h-96 w-96 rounded-full bg-us-gold/10 blur-3xl",transition:{duration:10,repeat:Number.POSITIVE_INFINITY,ease:"easeInOut",delay:1}})]}),t.jsx(at.div,{animate:"visible",className:"relative z-10 w-full max-w-md px-4",initial:"hidden",variants:or,children:t.jsx("div",{className:"glass-card rounded-2xl p-8 shadow-2xl",children:t.jsx(N2,{appearance:{elements:{rootBox:"mx-auto",card:"bg-transparent shadow-none",headerTitle:"font-display text-2xl font-bold",headerSubtitle:"font-sans text-muted-foreground",socialButtonsBlockButton:"bg-background/50 border-border hover:bg-background/70",formButtonPrimary:"bg-primary hover:bg-primary/90 text-primary-foreground rounded-lg",formFieldInput:"bg-background/50 border-border focus:border-primary focus:ring-primary",footerActionLink:"text-primary hover:text-primary/80"}},forceRedirectUrl:"/dashboard",path:"/sign-in",routing:"path",signUpUrl:"/sign-up"})})})]})}function OO({message:e="Nenhum aluno matriculado neste produto.",onAddStudent:r}){return t.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center rounded-lg border border-dashed bg-muted/5 py-12 text-center",children:[t.jsx("div",{className:"mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-muted",children:t.jsx(Xi,{className:"h-6 w-6 text-muted-foreground"})}),t.jsx("p",{className:"mb-4 text-muted-foreground text-sm",children:e}),r&&t.jsxs(oe,{onClick:r,size:"sm",variant:"outline",children:[t.jsx(_n,{className:"mr-2 h-4 w-4"}),"Adicionar aluno"]})]})}const Ol={trintae3:"TRINTAE3",otb:"OTB MBA",black_neon:"Black NEON",comunidade:"Comunidade US",auriculo:"Aurculo",na_mesa_certa:"Na Mesa Certa"},Cw={ativo:"Ativo",inativo:"Inativo",pausado:"Pausado",formado:"Formado"},Aw={ativo:"default",inativo:"secondary",pausado:"outline",formado:"default"},$q={aguardando_atendente:"Aguardando",em_atendimento:"Em Atendimento",aguardando_cliente:"Aguardando Cliente",resolvido:"Resolvido",bot_ativo:"Bot Ativo"},RO={baixo:"text-green-500",medio:"text-yellow-500",alto:"text-red-500"},Uj={trintae3:{color:"bg-[#3B82F6]",bg:"bg-[#3B82F6]/10 hover:bg-[#3B82F6]/20"},otb:{color:"bg-[#10B981]",bg:"bg-[#10B981]/10 hover:bg-[#10B981]/20"},black_neon:{color:"bg-[#F59E0B]",bg:"bg-[#F59E0B]/10 hover:bg-[#F59E0B]/20"},comunidade:{color:"bg-[#EF4444]",bg:"bg-[#EF4444]/10 hover:bg-[#EF4444]/20"},auriculo:{color:"bg-[#8B5CF6]",bg:"bg-[#8B5CF6]/10 hover:bg-[#8B5CF6]/20"},na_mesa_certa:{color:"bg-[#EC4899]",bg:"bg-[#EC4899]/10 hover:bg-[#EC4899]/20"},sem_produto:{color:"bg-gray-500",bg:"bg-gray-500/10 hover:bg-gray-500/20"}},cu=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),c0={new:"Novo",contacted:"Contatado",converted:"Convertido",unsubscribed:"Descadastrado"},MO={new:"default",contacted:"secondary",converted:"outline",unsubscribed:"destructive"},zj={"Harmonizao Facial":"Harmonizao Facial","Esttica Corporal":"Esttica Corporal",Bioestimuladores:"Bioestimuladores",Outros:"Outros"},Vj={trintae3:k2,otb:KC,black_neon:zc,comunidade:ya,auriculo:Eu,na_mesa_certa:$C,sem_produto:z2};function FO({productId:e,count:r,totalCount:a,isExpanded:n}){const i=Ol[e]||"Sem Produto",o=Uj[e]||Uj.sem_produto,u=Vj[e]||Vj.sem_produto;return t.jsx(Up,{asChild:!0,children:t.jsxs("button",{"aria-expanded":n,"aria-label":`${n?"Recolher":"Expandir"} seo de ${i}`,className:me("group flex h-16 w-full cursor-pointer items-center justify-between p-4 outline-none transition-colors duration-200 focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",o.bg),type:"button",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:me("flex h-8 w-8 items-center justify-center rounded-lg text-white shadow-sm transition-transform group-hover:scale-105",o.color),children:t.jsx(u,{className:"h-5 w-5"})}),t.jsxs("div",{className:"flex flex-col items-start gap-0.5",children:[t.jsx("h2",{className:"font-semibold text-foreground text-lg tracking-tight",children:i}),t.jsx(Ve,{className:"h-5 px-1.5 font-normal text-xs",variant:"secondary",children:a?`${r} de ${a} alunos`:`${r} alunos`})]})]}),t.jsx("div",{className:"flex items-center gap-3",children:t.jsx("div",{className:"flex h-8 items-center rounded-md border border-muted-foreground/20 px-2 text-muted-foreground text-xs group-hover:text-foreground",children:n?t.jsxs(t.Fragment,{children:[t.jsx($u,{className:"mr-1 h-3.5 w-3.5"}),"Recolher"]}):t.jsxs(t.Fragment,{children:[t.jsx(Il,{className:"mr-1 h-3.5 w-3.5"}),"Expandir"]})})})]})})}const IO={lessThanXSeconds:{one:"menos de um segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"meio minuto",lessThanXMinutes:{one:"menos de um minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"cerca de 1 hora",other:"cerca de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 dia",other:"{{count}} dias"},aboutXWeeks:{one:"cerca de 1 semana",other:"cerca de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"cerca de 1 ms",other:"cerca de {{count}} meses"},xMonths:{one:"1 ms",other:"{{count}} meses"},aboutXYears:{one:"cerca de 1 ano",other:"cerca de {{count}} anos"},xYears:{one:"1 ano",other:"{{count}} anos"},overXYears:{one:"mais de 1 ano",other:"mais de {{count}} anos"},almostXYears:{one:"quase 1 ano",other:"quase {{count}} anos"}},LO=(e,r,a)=>{let n;const i=IO[e];return typeof i=="string"?n=i:r===1?n=i.one:n=i.other.replace("{{count}}",String(r)),a?.addSuffix?a.comparison&&a.comparison>0?"em "+n:"h "+n:n},PO={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/yyyy"},BO={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},UO={full:"{{date}} 's' {{time}}",long:"{{date}} 's' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},zO={date:ax({formats:PO,defaultWidth:"full"}),time:ax({formats:BO,defaultWidth:"full"}),dateTime:ax({formats:UO,defaultWidth:"full"})},VO={lastWeek:e=>{const r=e.getDay();return"'"+(r===0||r===6?"ltimo":"ltima")+"' eeee 's' p"},yesterday:"'ontem s' p",today:"'hoje s' p",tomorrow:"'amanh s' p",nextWeek:"eeee 's' p",other:"P"},HO=(e,r,a,n)=>{const i=VO[e];return typeof i=="function"?i(r):i},GO={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","depois de cristo"]},qO={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1 trimestre","2 trimestre","3 trimestre","4 trimestre"]},WO={narrow:["j","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],wide:["janeiro","fevereiro","maro","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"]},YO={narrow:["D","S","T","Q","Q","S","S"],short:["dom","seg","ter","qua","qui","sex","sab"],abbreviated:["domingo","segunda","tera","quarta","quinta","sexta","sbado"],wide:["domingo","segunda-feira","tera-feira","quarta-feira","quinta-feira","sexta-feira","sbado"]},XO={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"}},$O={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"}},KO=(e,r)=>{const a=Number(e);return r?.unit==="week"?a+"":a+""},QO={ordinalNumber:KO,era:Ko({values:GO,defaultWidth:"wide"}),quarter:Ko({values:qO,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Ko({values:WO,defaultWidth:"wide"}),day:Ko({values:YO,defaultWidth:"wide"}),dayPeriod:Ko({values:XO,defaultWidth:"wide",formattingValues:$O,defaultFormattingWidth:"wide"})},ZO=/^(\d+)[o]?/i,JO=/\d+/i,eR={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|d\.?\s?c\.?)/i,wide:/^(antes de cristo|depois de cristo)/i},tR={any:[/^ac/i,/^dc/i],wide:[/^antes de cristo/i,/^depois de cristo/i]},aR={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234]()? trimestre/i},rR={any:[/1/i,/2/i,/3/i,/4/i]},sR={narrow:/^[jfmajsond]/i,abbreviated:/^(jan|fev|mar|abr|mai|jun|jul|ago|set|out|nov|dez)/i,wide:/^(janeiro|fevereiro|maro|abril|maio|junho|julho|agosto|setembro|outubro|novembro|dezembro)/i},nR={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^fev/i,/^mar/i,/^abr/i,/^mai/i,/^jun/i,/^jul/i,/^ago/i,/^set/i,/^out/i,/^nov/i,/^dez/i]},iR={narrow:/^(dom|[23456]?|s[a]b)/i,short:/^(dom|[23456]?|s[a]b)/i,abbreviated:/^(dom|seg|ter|qua|qui|sex|s[a]b)/i,wide:/^(domingo|(segunda|ter[c]a|quarta|quinta|sexta)([- ]feira)?|s[a]bado)/i},lR={short:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],narrow:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],any:[/^d/i,/^seg/i,/^t/i,/^qua/i,/^qui/i,/^sex/i,/^s[a]b/i]},cR={narrow:/^(a|p|mn|md|(da) (manh|tarde|noite))/i,any:/^([ap]\.?\s?m\.?|meia[-\s]noite|meio[-\s]dia|(da) (manh|tarde|noite))/i},oR={any:{am:/^a/i,pm:/^p/i,midnight:/^mn|^meia[-\s]noite/i,noon:/^md|^meio[-\s]dia/i,morning:/manh/i,afternoon:/tarde/i,evening:/tarde/i,night:/noite/i}},uR={ordinalNumber:QC({matchPattern:ZO,parsePattern:JO,valueCallback:e=>parseInt(e,10)}),era:Qo({matchPatterns:eR,defaultMatchWidth:"wide",parsePatterns:tR,defaultParseWidth:"any"}),quarter:Qo({matchPatterns:aR,defaultMatchWidth:"wide",parsePatterns:rR,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Qo({matchPatterns:sR,defaultMatchWidth:"wide",parsePatterns:nR,defaultParseWidth:"any"}),day:Qo({matchPatterns:iR,defaultMatchWidth:"wide",parsePatterns:lR,defaultParseWidth:"any"}),dayPeriod:Qo({matchPatterns:cR,defaultMatchWidth:"any",parsePatterns:oR,defaultParseWidth:"any"})},Ir={code:"pt-BR",formatDistance:LO,formatLong:zO,formatRelative:HO,localize:QO,match:uR,options:{weekStartsOn:0,firstWeekContainsDate:1}},dR={ativo:"Ativo",inativo:"Inativo",pausado:"Pausado",formado:"Formado"},fR={ativo:"default",inativo:"secondary",pausado:"outline",formado:"default"},hR={baixo:"text-green-500",medio:"text-yellow-500",alto:"text-red-500"};function mR(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function fx({text:e,term:r}){if(!e)return null;if(!r)return t.jsx(t.Fragment,{children:e});const a=mR(r.trim().slice(0,100));if(!a)return t.jsx(t.Fragment,{children:e});let n;try{n=e.split(new RegExp(`(${a})`,"gi"))}catch{return t.jsx(t.Fragment,{children:e})}return t.jsx(t.Fragment,{children:n.map((i,o)=>i.toLowerCase()===a.toLowerCase()?t.jsx("mark",{className:"rounded-xs bg-yellow-200 px-0.5 text-foreground dark:bg-yellow-800",children:i},o):i)})}function xR({student:e,onClick:r,searchTerm:a}){return t.jsxs(Te,{className:me("cursor-pointer transition-all hover:shadow-md",r&&"hover:border-primary/50"),onClick:r,children:[t.jsx(Me,{className:"pb-2",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-linear-to-br from-purple-500 to-indigo-500",children:t.jsx(li,{className:"h-5 w-5 text-white"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-sm",children:t.jsx(fx,{term:a,text:e.name})}),t.jsx("p",{className:"text-muted-foreground text-xs",children:e.profession})]})]}),t.jsx(Ve,{variant:fR[e.status??"ativo"],children:dR[e.status??"ativo"]})]})}),t.jsxs(Ce,{className:"space-y-3",children:[t.jsxs("div",{className:"flex flex-wrap gap-3 text-muted-foreground text-xs",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(Yu,{className:"h-3 w-3"}),t.jsx(fx,{term:a,text:e.phone??void 0})]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(rr,{className:"h-3 w-3"}),t.jsx(fx,{term:a,text:e.email??void 0})]})]}),e.hasClinic&&e.clinicName&&t.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground text-xs",children:[t.jsx(V2,{className:"h-3 w-3"}),e.clinicName,e.clinicCity&&` - ${e.clinicCity}`]}),t.jsxs("div",{className:"flex items-center justify-between border-t pt-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Xi,{className:"h-4 w-4 text-muted-foreground"}),t.jsxs("span",{className:"text-muted-foreground text-xs",children:["Desde ",bn(e.createdAt,{locale:Ir})]})]}),e.churnRisk!=="baixo"&&t.jsxs("div",{className:me("flex items-center gap-1",hR[e.churnRisk??"baixo"]),children:[t.jsx(Ll,{className:"h-3 w-3"}),t.jsxs("span",{className:"font-medium text-xs",children:["Risco ",e.churnRisk]})]})]})]})]})}function pR({productId:e,count:r,totalCount:a,isExpanded:n,onToggle:i,students:o,onStudentClick:u,searchTerm:d,className:h}){return t.jsxs(Bp,{className:me("overflow-hidden rounded-lg border bg-card text-card-foreground shadow-sm transition-all duration-200",n?"mb-6":"mb-2",h),onOpenChange:i,open:n,children:[t.jsx(FO,{count:r,isExpanded:n,productId:e,totalCount:a}),t.jsx(zp,{className:"overflow-hidden data-[state=closed]:animate-collapsible-up data-[state=open]:animate-collapsible-down",children:t.jsx("div",{className:"border-t bg-muted/5 p-4 pt-0",children:o.length>0?t.jsx("div",{className:"grid gap-4 pt-4 md:grid-cols-2 lg:grid-cols-3",children:o.map(m=>t.jsx(xR,{onClick:()=>u(m.id),searchTerm:d,student:m},m.id))}):t.jsx("div",{className:"pt-4",children:t.jsx(OO,{})})})})]})}function gt({className:e,...r}){return t.jsx("div",{className:me("animate-pulse rounded-md bg-primary/10",e),...r})}function gR(){return t.jsxs("div",{className:"mb-4 overflow-hidden rounded-lg border bg-card shadow-sm",children:[t.jsxs("div",{className:"flex h-16 items-center justify-between border-b p-4",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(gt,{className:"h-8 w-1 rounded-full"}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(gt,{className:"h-5 w-32"}),t.jsx(gt,{className:"h-4 w-24"})]})]}),t.jsx(gt,{className:"h-5 w-5 rounded-full"})]}),t.jsx("div",{className:"bg-muted/5 p-4",children:t.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:Array.from({length:3}).map((e,r)=>t.jsxs("div",{className:"space-y-3 rounded-lg border bg-card p-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(gt,{className:"h-10 w-10 rounded-full"}),t.jsxs("div",{className:"space-y-1",children:[t.jsx(gt,{className:"h-4 w-24"}),t.jsx(gt,{className:"h-3 w-16"})]})]}),t.jsx(gt,{className:"h-5 w-16 rounded-full"})]}),t.jsxs("div",{className:"space-y-2 pt-2",children:[t.jsx(gt,{className:"h-3 w-full"}),t.jsx(gt,{className:"h-3 w-2/3"})]})]},r))})})]})}const vR="modulepreload",yR=function(e){return"/"+e},Hj={},Tr=function(r,a,n){let i=Promise.resolve();if(a&&a.length>0){let h=function(m){return Promise.all(m.map(p=>Promise.resolve(p).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),d=u?.nonce||u?.getAttribute("nonce");i=h(a.map(m=>{if(m=yR(m),m in Hj)return;Hj[m]=!0;const p=m.endsWith(".css"),v=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${v}`))return;const y=document.createElement("link");if(y.rel=p?"stylesheet":vR,p||(y.as="script"),y.crossOrigin="",y.href=m,d&&y.setAttribute("nonce",d),document.head.appendChild(y),p)return new Promise((N,j)=>{y.addEventListener("load",N),y.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${m}`)))})}))}function o(u){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=u,window.dispatchEvent(d),!d.defaultPrevented)throw u}return i.then(u=>{for(const d of u||[])d.status==="rejected"&&o(d.reason);return r().catch(o)})},_r=Sp,Qi=H2,jR=wp,kw=C.forwardRef(({className:e,...r},a)=>t.jsx(Ku,{className:me("dialog-overlay data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 data-[state=closed]:animate-out data-[state=open]:animate-in",e),ref:a,...r}));kw.displayName=Ku.displayName;const fr=C.forwardRef(({className:e,children:r,...a},n)=>t.jsxs(jR,{children:[t.jsx(kw,{}),t.jsxs(Qu,{className:me("dialog-content data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] fixed top-[50%] left-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=closed]:animate-out data-[state=open]:animate-in sm:rounded-lg",e),ref:n,...a,children:[r,t.jsxs(b0,{className:"absolute top-4 right-4 rounded-sm opacity-70 ring-offset-background transition-all hover:scale-110 hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[t.jsx(ga,{className:"h-4 w-4"}),t.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));fr.displayName=Qu.displayName;const hr=({className:e,...r})=>t.jsx("div",{className:me("flex flex-col space-y-1.5 text-center sm:text-left",e),...r});hr.displayName="DialogHeader";const di=({className:e,...r})=>t.jsx("div",{className:me("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...r});di.displayName="DialogFooter";const mr=C.forwardRef(({className:e,...r},a)=>t.jsx(Zu,{className:me("font-semibold text-lg leading-none tracking-tight",e),ref:a,...r}));mr.displayName=Zu.displayName;const ts=C.forwardRef(({className:e,...r},a)=>t.jsx(Ju,{className:me("text-muted-foreground text-sm",e),ref:a,...r}));ts.displayName=Ju.displayName;const bR=Pa({name:Ke().min(2,{message:"Nome deve ter pelo menos 2 caracteres"}),email:Ke().email({message:"Email invlido"}),phone:Ke().min(10,{message:"Telefone invlido"}),cpf:Ke().optional(),profession:Ke().min(1,{message:"Profisso  obrigatria"}),professionalId:Ke().optional(),hasClinic:oi(),clinicName:Ke().optional(),clinicCity:Ke().optional(),assignedCS:Ke().optional(),lgpdConsent:oi().refine(e=>e===!0,{message:"Voc deve aceitar os termos da LGPD"})});function Dw({studentId:e,trigger:r,onSuccess:a}){const[n,i]=C.useState(!1),o=et.students.create.useMutation(),u=et.students.update.useMutation(),{data:d}=et.students.get.useQuery({id:e},{enabled:!!e}),{data:h}=et.users.listSystemUsers.useQuery(),m=!!e,p=m?"Editar Aluno":"Novo Aluno",v=m?"Atualize os dados cadastrais deste aluno.":"Insira os dados para cadastrar um novo aluno no sistema.",y=Zr({resolver:Jr(bR),defaultValues:{name:"",email:"",phone:"",cpf:"",profession:"",professionalId:"",hasClinic:!1,clinicName:"",clinicCity:"",assignedCS:"",lgpdConsent:!1}});C.useEffect(()=>{m&&d&&!y.formState.isDirty&&y.reset({name:d.name,email:d.email,phone:d.phone,cpf:d.cpf||"",profession:d.profession,professionalId:d.professionalId||"",hasClinic:d.hasClinic,clinicName:d.clinicName||"",clinicCity:d.clinicCity||"",assignedCS:d.assignedCS||""})},[m,d,y]);const N=async w=>{await o.mutateAsync({name:w.name,email:w.email,phone:w.phone,cpf:w.cpf||void 0,profession:w.profession,professionalId:w.professionalId||void 0,hasClinic:w.hasClinic,clinicName:w.clinicName||void 0,clinicCity:w.clinicCity||void 0,status:"ativo",assignedCS:w.assignedCS?w.assignedCS:void 0,lgpdConsent:w.lgpdConsent}),Ie.success("Aluno criado com sucesso!")},j=async(w,T)=>{await u.mutateAsync({studentId:T,patch:{name:w.name,email:w.email,phone:w.phone,profession:w.profession,professionalId:w.professionalId||void 0,hasClinic:w.hasClinic,clinicName:w.clinicName||void 0,clinicCity:w.clinicCity||void 0,cpf:w.cpf||void 0,assignedCS:w.assignedCS?w.assignedCS:void 0}}),Ie.success("Aluno atualizado com sucesso!")},b=async w=>{try{m&&e?await j(w,e):await N(w),i(!1),y.reset(),a?.()}catch{Ie.error(m?"Erro ao atualizar aluno.":"Erro ao criar aluno.")}};return t.jsxs(_r,{onOpenChange:i,open:n,children:[t.jsx(Qi,{asChild:!0,children:r||t.jsxs(oe,{className:"gap-2 bg-linear-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700",children:[t.jsx(_n,{className:"h-4 w-4"}),p]})}),t.jsxs(fr,{className:"max-h-[90vh] overflow-y-auto sm:max-w-[600px]",children:[t.jsxs(hr,{children:[t.jsx(mr,{children:p}),t.jsx(ts,{children:v})]}),t.jsx(es,{...y,children:t.jsxs("form",{className:"space-y-6",onSubmit:y.handleSubmit(b),children:[t.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[t.jsx(nt,{control:y.control,name:"name",render:({field:w})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Nome Completo"}),t.jsx(it,{children:t.jsx(dt,{placeholder:"Ex: Joo Silva",...w})}),t.jsx(xt,{})]})}),t.jsx(nt,{control:y.control,name:"email",render:({field:w})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Email"}),t.jsx(it,{children:t.jsx(dt,{placeholder:"Ex: joao@email.com",type:"email",...w})}),t.jsx(xt,{})]})}),t.jsx(nt,{control:y.control,name:"phone",render:({field:w})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Telefone"}),t.jsx(it,{children:t.jsx(dt,{placeholder:"Ex: 11999999999",...w})}),t.jsx(xt,{})]})}),t.jsx(nt,{control:y.control,name:"cpf",render:({field:w})=>t.jsxs(st,{children:[t.jsx(ct,{children:"CPF (Opcional)"}),t.jsx(it,{children:t.jsx(dt,{placeholder:"Ex: 123.456.789-00",...w})}),t.jsx(xt,{})]})}),t.jsx(nt,{control:y.control,name:"profession",render:({field:w})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Profisso"}),t.jsx(it,{children:t.jsx(dt,{placeholder:"Ex: Enfermeiro",...w})}),t.jsx(xt,{})]})}),t.jsx(nt,{control:y.control,name:"professionalId",render:({field:w})=>t.jsxs(st,{children:[t.jsx(ct,{children:"ID Profissional (Opcional)"}),t.jsx(it,{children:t.jsx(dt,{placeholder:"Ex: COREN, CRO",...w})}),t.jsx(xt,{})]})}),t.jsx(nt,{control:y.control,name:"assignedCS",render:({field:w})=>t.jsxs(st,{children:[t.jsx(ct,{children:"CS Atribudo (Opcional)"}),t.jsxs(Rt,{onValueChange:T=>w.onChange(T==="none"?"":T),value:w.value||"none",children:[t.jsx(it,{children:t.jsx(At,{children:t.jsx(Mt,{placeholder:"Selecione um CS"})})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"none",children:"Nenhum"}),h?.map(T=>t.jsx(ye,{value:T.id,children:T.name},T.id))]})]}),t.jsx(xt,{})]})})]}),t.jsx(nt,{control:y.control,name:"hasClinic",render:({field:w})=>t.jsxs(st,{className:"flex flex-row items-start space-x-3 space-y-0",children:[t.jsx(it,{children:t.jsx(jr,{checked:w.value,onCheckedChange:w.onChange})}),t.jsx("div",{className:"space-y-1 leading-none",children:t.jsx(ct,{children:"Tem clnica"})})]})}),y.watch("hasClinic")&&t.jsx(nt,{control:y.control,name:"clinicName",render:({field:w})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Nome da Clnica"}),t.jsx(it,{children:t.jsx(dt,{placeholder:"Ex: Clnica Esttica",...w})}),t.jsx(xt,{})]})}),y.watch("hasClinic")&&t.jsx(nt,{control:y.control,name:"clinicCity",render:({field:w})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Cidade da Clnica"}),t.jsx(it,{children:t.jsx(dt,{placeholder:"Ex: So Paulo",...w})}),t.jsx(xt,{})]})}),!m&&t.jsx(nt,{control:y.control,name:"lgpdConsent",render:({field:w})=>t.jsxs(st,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border bg-muted/50 p-4",children:[t.jsx(it,{children:t.jsx(jr,{checked:w.value,onCheckedChange:w.onChange})}),t.jsxs("div",{className:"space-y-1 leading-none",children:[t.jsx(ct,{children:"Estou de acordo com o processamento dos meus dados pessoais para fins acadmicos e de gesto, conforme a Lei Geral de Proteo de Dados (LGPD)."}),t.jsx(xt,{})]})]})}),t.jsx("div",{className:"flex justify-end pt-4",children:t.jsx(oe,{className:"w-full bg-primary hover:bg-primary/90 sm:w-auto",disabled:y.formState.isSubmitting,type:"submit",children:y.formState.isSubmitting?t.jsxs(t.Fragment,{children:[t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}),m?"Atualizando...":"Criando..."]}):m?"Atualizar Aluno":"Criar Aluno"})})]})})]})]})}const sd=C.forwardRef(({className:e,children:r,...a},n)=>t.jsxs(G2,{className:me("relative overflow-hidden",e),ref:n,...a,children:[t.jsx(ZC,{className:"h-full w-full rounded-[inherit]",children:r}),t.jsx(Ow,{}),t.jsx(JC,{})]}));sd.displayName=G2.displayName;const Ow=C.forwardRef(({className:e,orientation:r="vertical",...a},n)=>t.jsx(q2,{className:me("flex touch-none select-none transition-colors",r==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",r==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),orientation:r,ref:n,...a,children:t.jsx(eA,{className:"relative flex-1 rounded-full bg-border"})}));Ow.displayName=q2.displayName;const Vp=Sp,NR=wp,Rw=C.forwardRef(({className:e,...r},a)=>t.jsx(Ku,{className:me("data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80 data-[state=closed]:animate-out data-[state=open]:animate-in",e),...r,ref:a}));Rw.displayName=Ku.displayName;const wR=k0("fixed z-50 gap-4 bg-background p-6 shadow-lg",{variants:{side:{top:"inset-x-0 top-0 border-b",bottom:"inset-x-0 bottom-0 border-t",left:"inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm"}},defaultVariants:{side:"right"}}),SR={top:{initial:{y:"-100%"},animate:{y:0},exit:{y:"-100%"}},bottom:{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"}},left:{initial:{x:"-100%"},animate:{x:0},exit:{x:"-100%"}},right:{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"}}},M0=C.forwardRef(({side:e="right",className:r,children:a,showCloseButton:n=!0,style:i,transition:o,...u},d)=>{const h=SR[e||"right"],m={type:"spring",stiffness:150,damping:22},{onEscapeKeyDown:p,onPointerDownOutside:v,onInteractOutside:y,...N}=u;return t.jsxs(NR,{children:[t.jsx(Rw,{}),t.jsx(Qu,{onEscapeKeyDown:p,onInteractOutside:y,onPointerDownOutside:v,ref:d,...N,children:t.jsxs(at.div,{animate:h.animate,className:me(wR({side:e}),r),exit:h.exit,initial:h.initial,style:i,transition:o||m,children:[a,n&&t.jsxs(b0,{className:"absolute top-4 right-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[t.jsx(ga,{className:"h-4 w-4"}),t.jsx("span",{className:"sr-only",children:"Close"})]})]})})]})});M0.displayName=Qu.displayName;const F0=({className:e,...r})=>t.jsx("div",{className:me("flex flex-col space-y-2 text-center sm:text-left",e),...r});F0.displayName="SheetHeader";const I0=C.forwardRef(({className:e,...r},a)=>t.jsx(Zu,{className:me("font-semibold text-foreground text-lg",e),ref:a,...r}));I0.displayName=Zu.displayName;const Hp=C.forwardRef(({className:e,...r},a)=>t.jsx(Ju,{className:me("text-muted-foreground text-sm",e),ref:a,...r}));Hp.displayName=Ju.displayName;const Kc=tA,Ul=C.forwardRef(({className:e,...r},a)=>t.jsx(W2,{className:me("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",e),ref:a,...r}));Ul.displayName=W2.displayName;const Nr=C.forwardRef(({className:e,...r},a)=>t.jsx(Y2,{className:me("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 font-medium text-sm ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",e),ref:a,...r}));Nr.displayName=Y2.displayName;const ei=C.forwardRef(({className:e,...r},a)=>t.jsx(X2,{className:me("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),ref:a,...r}));ei.displayName=X2.displayName;const Gp=e=>{if((e.message?.includes("Failed to fetch dynamically imported module")||e.message?.includes("Importing a module script failed"))&&typeof window<"u"&&!sessionStorage.getItem("chunk_retry"))return sessionStorage.setItem("chunk_retry","true"),window.location.reload(),new Promise(()=>{});throw e},_R=C.lazy(()=>Tr(()=>import("./student-enrollments-tab-oVxkB0sl.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(e=>({default:e.StudentEnrollmentsTab})).catch(Gp)),ER=C.lazy(()=>Tr(()=>import("./student-payments-tab-Cg6B6HrT.js"),__vite__mapDeps([7,1,2,3,4,5,6])).then(e=>({default:e.StudentPaymentsTab})).catch(Gp)),TR=C.lazy(()=>Tr(()=>import("./student-conversations-tab-D7oFgikg.js"),__vite__mapDeps([8,1,2,3,4,5,6])).then(e=>({default:e.StudentConversationsTab})).catch(Gp));function hx({studentId:e,Component:r}){return e?t.jsx(r,{studentId:e}):null}function Mw({studentId:e,onClose:r}){const[a,n]=C.useState("enrollments"),{data:i}=et.students.get.useQuery({id:e},{enabled:!!e}),{data:o}=et.enrollments.listByStudent.useQuery({studentId:e},{enabled:!!e}),u=[],d=!!e;return t.jsx(Vp,{onOpenChange:h=>!h&&r(),open:d,children:t.jsxs(M0,{className:"flex w-full flex-col overflow-hidden p-0 sm:max-w-3xl",side:"right",transition:{type:"spring",stiffness:150,damping:22},children:[t.jsxs(F0,{className:"sr-only",children:[t.jsx(I0,{children:"Detalhes do Aluno"}),t.jsx(Hp,{children:"Visualize e edite as informaes, matrculas e histrico do aluno."})]}),i?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"border-b p-6",children:t.jsxs("div",{className:"flex flex-col items-start gap-6 md:flex-row",children:[t.jsx("div",{className:"flex h-20 w-20 shrink-0 items-center justify-center rounded-full bg-linear-to-br from-purple-500 to-indigo-500",children:t.jsx(li,{className:"h-10 w-10 text-white"})}),t.jsxs("div",{className:"min-w-0 flex-1 space-y-3",children:[t.jsxs("div",{className:"flex items-start justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"font-bold text-2xl",children:i.name}),t.jsx("p",{className:"text-muted-foreground",children:i.profession})]}),t.jsx(Ve,{className:"text-sm",variant:Aw[i.status],children:Cw[i.status]})]}),t.jsx(Sa,{}),t.jsxs("div",{className:"flex flex-wrap gap-4 text-muted-foreground text-sm",children:[t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx(Yu,{className:"h-4 w-4"}),i.phone]}),t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx(rr,{className:"h-4 w-4"}),i.email]}),i.hasClinic&&i.clinicName&&t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx(V2,{className:"h-4 w-4"}),i.clinicName,i.clinicCity&&` - ${i.clinicCity}`]})]}),t.jsxs("div",{className:"flex flex-wrap gap-2 pt-2",children:[t.jsx(oe,{asChild:!0,className:"gap-2",size:"sm",variant:"outline",children:t.jsxs("a",{href:`https://wa.me/${(i.phone??"").replace(/\D/g,"")}`,rel:"noopener noreferrer",target:"_blank",children:[t.jsx(an,{className:"h-4 w-4"}),"WhatsApp"]})}),t.jsx(oe,{asChild:!0,className:"gap-2",size:"sm",variant:"outline",children:t.jsxs("a",{href:`mailto:${i.email}`,children:[t.jsx(rr,{className:"h-4 w-4"}),"E-mail"]})}),t.jsx(Dw,{studentId:e??void 0,trigger:t.jsxs(oe,{className:"gap-2",size:"sm",variant:"outline",children:[t.jsx(ed,{className:"h-4 w-4"}),"Editar"]})})]})]})]})}),t.jsxs("div",{className:"grid gap-4 px-6 py-4 md:grid-cols-3",children:[t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Total de Matrculas"}),t.jsx(Xi,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsx(Ce,{children:t.jsx("div",{className:"font-bold text-2xl",children:o?.length??0})})]}),t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Matrculas Ativas"}),t.jsx(aA,{className:"h-4 w-4 text-green-500"})]}),t.jsx(Ce,{children:t.jsx("div",{className:"font-bold text-2xl text-green-600",children:o?.filter(h=>h.status==="ativo").length??0})})]}),t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Receita Total"}),t.jsx(Bx,{className:"h-4 w-4 text-primary"})]}),t.jsx(Ce,{children:t.jsx("div",{className:"font-bold text-2xl text-primary",children:cu(o?.reduce((h,m)=>h+(Number(m.totalValue)||0),0)??0)})})]})]}),t.jsx("div",{className:"flex-1 overflow-hidden",children:t.jsxs(Kc,{className:"flex h-full flex-col",onValueChange:h=>n(h),value:a,children:[t.jsxs(Ul,{className:"grid w-full grid-cols-4 px-6",children:[t.jsxs(Nr,{className:"gap-1",value:"enrollments",children:[t.jsx(Xi,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Matrculas"})]}),t.jsxs(Nr,{className:"gap-1",value:"payments",children:[t.jsx(Bx,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Pagamentos"})]}),t.jsxs(Nr,{className:"gap-1",value:"timeline",children:[t.jsx(Eu,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Timeline"})]}),t.jsxs(Nr,{className:"gap-1",value:"conversations",children:[t.jsx(an,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Conversas"})]})]}),t.jsxs(sd,{className:"flex-1 px-6",children:[t.jsx(ei,{className:"mt-4 pb-6",value:"enrollments",children:t.jsx(C.Suspense,{fallback:t.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:[1,2,3,4].map(h=>t.jsx("div",{className:"h-40 animate-pulse rounded-lg bg-muted/20"},h))}),children:t.jsx(hx,{Component:_R,studentId:e})})}),t.jsx(ei,{className:"mt-4 pb-6",value:"payments",children:t.jsx(C.Suspense,{fallback:t.jsx(gt,{className:"h-96 w-full"}),children:t.jsx(hx,{Component:ER,studentId:e})})}),t.jsx(ei,{className:"mt-4 pb-6",value:"timeline",children:!u||u.length===0?t.jsxs("div",{className:"py-12 text-center text-muted-foreground",children:[t.jsx(Eu,{className:"mx-auto mb-4 h-12 w-12 opacity-50"}),t.jsx("p",{children:"Nenhuma atividade registrada"})]}):t.jsx("div",{className:"relative ml-3 space-y-6 border-border/50 border-l",children:u.map(h=>t.jsxs("div",{className:"relative pl-6",children:[t.jsx("div",{className:"absolute top-1 -left-[5px] h-2.5 w-2.5 rounded-full border-2 border-background bg-primary ring-2 ring-primary/20"}),t.jsxs("div",{className:"flex flex-col gap-1",children:[t.jsx("span",{className:"text-muted-foreground text-xs",children:bn(h.createdAt,{addSuffix:!0,locale:Ir})}),t.jsx("p",{className:"font-medium text-sm",children:h.description}),t.jsx(Ve,{className:"w-fit text-xs",variant:"outline",children:h.type.replace(/_/g," ")})]})]},h.id))})}),t.jsx(ei,{className:"mt-4 pb-6",value:"conversations",children:t.jsx(C.Suspense,{fallback:t.jsx("div",{className:"space-y-3",children:[1,2,3,4].map(h=>t.jsx("div",{className:"h-20 animate-pulse rounded-lg bg-muted/20"},h))}),children:t.jsx(hx,{Component:TR,studentId:e})})})]})]})})]}):t.jsxs("div",{className:"space-y-4 p-6",children:[t.jsx("div",{className:"h-32 animate-pulse rounded-lg bg-muted/20"}),t.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:[1,2,3].map(h=>t.jsx("div",{className:"h-24 animate-pulse rounded-lg bg-muted/20"},h))}),t.jsx("div",{className:"h-64 animate-pulse rounded-lg bg-muted/20"})]})]})})}function CR({search:e,onSearchChange:r,status:a,onStatusChange:n,churnRisk:i,onChurnRiskChange:o,product:u,onProductChange:d,onClear:h}){const m=e||a!=="all"||i!=="all"||u!=="all";return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx(Ms,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),t.jsx(dt,{className:"pl-9",onChange:p=>r(p.target.value),placeholder:"Buscar por nome, email ou telefone...",value:e})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[t.jsxs(Rt,{onValueChange:n,value:a,children:[t.jsx(At,{className:"w-[150px]",children:t.jsx(Mt,{placeholder:"Status"})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"all",children:"Todos Status"}),t.jsx(ye,{value:"ativo",children:"Ativos"}),t.jsx(ye,{value:"inativo",children:"Inativos"}),t.jsx(ye,{value:"pausado",children:"Pausados"}),t.jsx(ye,{value:"formado",children:"Formados"})]})]}),t.jsxs(Rt,{onValueChange:o,value:i,children:[t.jsx(At,{className:"w-[160px]",children:t.jsx(Mt,{placeholder:"Risco de Churn"})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"all",children:"Todos Riscos"}),t.jsx(ye,{value:"baixo",children:"Risco Baixo"}),t.jsx(ye,{value:"medio",children:"Risco Mdio"}),t.jsx(ye,{value:"alto",children:"Risco Alto"})]})]}),t.jsxs(Rt,{onValueChange:d,value:u,children:[t.jsx(At,{className:"w-[160px]",children:t.jsx(Mt,{placeholder:"Produto"})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"all",children:"Todos Produtos"}),t.jsx(ye,{value:"trintae3",children:"TRINTAE3"}),t.jsx(ye,{value:"otb",children:"OTB MBA"}),t.jsx(ye,{value:"black_neon",children:"Black NEON"}),t.jsx(ye,{value:"comunidade",children:"Comunidade US"}),t.jsx(ye,{value:"auriculo",children:"Aurculo"}),t.jsx(ye,{value:"na_mesa_certa",children:"Na Mesa Certa"})]})]}),m&&t.jsxs(oe,{className:"ml-auto gap-1",onClick:h,size:"sm",variant:"ghost",children:[t.jsx(ga,{className:"h-4 w-4"}),"Limpar"]})]}),m&&t.jsxs("div",{className:"flex flex-wrap gap-2",children:[e&&t.jsxs(Ve,{className:"gap-1",variant:"secondary",children:['Busca: "',e,'"',t.jsx("button",{className:"ml-1 hover:text-destructive",onClick:()=>r(""),type:"button",children:t.jsx(ga,{className:"h-3 w-3"})})]}),a!=="all"&&t.jsxs(Ve,{className:"gap-1",variant:"secondary",children:["Status: ",a,t.jsx("button",{className:"ml-1 hover:text-destructive",onClick:()=>n("all"),type:"button",children:t.jsx(ga,{className:"h-3 w-3"})})]}),i!=="all"&&t.jsxs(Ve,{className:"gap-1",variant:"secondary",children:["Risco: ",i,t.jsx("button",{className:"ml-1 hover:text-destructive",onClick:()=>o("all"),type:"button",children:t.jsx(ga,{className:"h-3 w-3"})})]}),u!=="all"&&t.jsxs(Ve,{className:"gap-1",variant:"secondary",children:["Produto: ",Ol[u]||u,t.jsx("button",{className:"ml-1 hover:text-destructive",onClick:()=>d("all"),type:"button",children:t.jsx(ga,{className:"h-3 w-3"})})]})]})]})}const AR=sA,kR=nA,DR=iA,Fw=C.forwardRef(({className:e,sideOffset:r=4,...a},n)=>t.jsx(rA,{children:t.jsx($2,{className:me("fade-in-0 zoom-in-95 data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 origin-[--radix-tooltip-content-transform-origin] animate-in overflow-hidden rounded-md bg-primary px-3 py-1.5 text-primary-foreground text-xs data-[state=closed]:animate-out",e),ref:n,sideOffset:r,...a})}));Fw.displayName=$2.displayName;function OR(){const[e,r]=C.useState(!1),a=et.settings.set.useMutation(),n=async()=>{r(!0);try{Ie.info("Iniciando importao do Asaas...");const i=await a({initiatedBy:"manual_import_button"});if(i?.success){const o=i.customers,u=i.payments,d=o?`Clientes: ${o.recordsCreated} criados, ${o.recordsUpdated} atualizados`:"",h=u?`Pagamentos: ${u.recordsCreated} importados, ${u.recordsUpdated} atualizados`:"";Ie.success("Importao concluda com sucesso!",{description:[d,h].filter(Boolean).join(" | ")})}}catch(i){Ie.error("Falha na importao do Asaas",{description:i instanceof Error?i.message:"Erro desconhecido"})}finally{r(!1)}};return t.jsx(AR,{children:t.jsxs(kR,{children:[t.jsx(DR,{asChild:!0,children:t.jsxs(oe,{className:"gap-2 border-purple-200 hover:border-purple-500 hover:text-purple-600 dark:border-purple-800 dark:hover:border-purple-400 dark:hover:text-purple-400",disabled:e,onClick:n,size:"sm",variant:"outline",children:[e?t.jsx(pt,{className:"h-4 w-4 animate-spin"}):t.jsx(xs,{className:"h-4 w-4"}),t.jsx("span",{className:"hidden sm:inline",children:e?"Importando...":"Importar do Asaas"})]})}),t.jsx(Fw,{children:t.jsx("p",{children:"Sincronizar clientes e pagamentos do Asaas"})})]})})}var Zf={exports:{}};var RR=Zf.exports,Gj;function MR(){return Gj||(Gj=1,(function(e,r){((a,n)=>{e.exports=n()})(RR,function a(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},i,o=!n.document&&!!n.postMessage,u=n.IS_PAPA_WORKER||!1,d={},h=0,m={};function p(k){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(E){var L=z(E);L.chunkSize=parseInt(L.chunkSize),E.step||E.chunk||(L.chunkSize=null),this._handle=new b(L),(this._handle.streamer=this)._config=L}).call(this,k),this.parseChunk=function(E,L){var H=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<H){let re=this._config.newline;re||(I=this._config.quoteChar||'"',re=this._handle.guessLineEndings(E,I)),E=[...E.split(re).slice(H)].join(re)}this.isFirstChunk&&A(this._config.beforeFirstChunk)&&(I=this._config.beforeFirstChunk(E))!==void 0&&(E=I),this.isFirstChunk=!1,this._halted=!1;var H=this._partialLine+E,I=(this._partialLine="",this._handle.parse(H,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(E=I.meta.cursor,H=(this._finished||(this._partialLine=H.substring(E-this._baseIndex),this._baseIndex=E),I&&I.data&&(this._rowCount+=I.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),u)n.postMessage({results:I,workerId:m.WORKER_ID,finished:H});else if(A(this._config.chunk)&&!L){if(this._config.chunk(I,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=I=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(I.data),this._completeResults.errors=this._completeResults.errors.concat(I.errors),this._completeResults.meta=I.meta),this._completed||!H||!A(this._config.complete)||I&&I.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),H||I&&I.meta.paused||this._nextChunk(),I}this._halted=!0},this._sendError=function(E){A(this._config.error)?this._config.error(E):u&&this._config.error&&n.postMessage({workerId:m.WORKER_ID,error:E,finished:!1})}}function v(k){var E;(k=k||{}).chunkSize||(k.chunkSize=m.RemoteChunkSize),p.call(this,k),this._nextChunk=o?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(L){this._input=L,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(E=new XMLHttpRequest,this._config.withCredentials&&(E.withCredentials=this._config.withCredentials),o||(E.onload=O(this._chunkLoaded,this),E.onerror=O(this._chunkError,this)),E.open(this._config.downloadRequestBody?"POST":"GET",this._input,!o),this._config.downloadRequestHeaders){var L,H=this._config.downloadRequestHeaders;for(L in H)E.setRequestHeader(L,H[L])}var I;this._config.chunkSize&&(I=this._start+this._config.chunkSize-1,E.setRequestHeader("Range","bytes="+this._start+"-"+I));try{E.send(this._config.downloadRequestBody)}catch(re){this._chunkError(re.message)}o&&E.status===0&&this._chunkError()}},this._chunkLoaded=function(){E.readyState===4&&(E.status<200||400<=E.status?this._chunkError():(this._start+=this._config.chunkSize||E.responseText.length,this._finished=!this._config.chunkSize||this._start>=(L=>(L=L.getResponseHeader("Content-Range"))!==null?parseInt(L.substring(L.lastIndexOf("/")+1)):-1)(E),this.parseChunk(E.responseText)))},this._chunkError=function(L){L=E.statusText||L,this._sendError(new Error(L))}}function y(k){(k=k||{}).chunkSize||(k.chunkSize=m.LocalChunkSize),p.call(this,k);var E,L,H=typeof FileReader<"u";this.stream=function(I){this._input=I,L=I.slice||I.webkitSlice||I.mozSlice,H?((E=new FileReader).onload=O(this._chunkLoaded,this),E.onerror=O(this._chunkError,this)):E=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var I=this._input,re=(this._config.chunkSize&&(re=Math.min(this._start+this._config.chunkSize,this._input.size),I=L.call(I,this._start,re)),E.readAsText(I,this._config.encoding));H||this._chunkLoaded({target:{result:re}})},this._chunkLoaded=function(I){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(I.target.result)},this._chunkError=function(){this._sendError(E.error)}}function N(k){var E;p.call(this,k=k||{}),this.stream=function(L){return E=L,this._nextChunk()},this._nextChunk=function(){var L,H;if(!this._finished)return L=this._config.chunkSize,E=L?(H=E.substring(0,L),E.substring(L)):(H=E,""),this._finished=!E,this.parseChunk(H)}}function j(k){p.call(this,k=k||{});var E=[],L=!0,H=!1;this.pause=function(){p.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){p.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(I){this._input=I,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){H&&E.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),E.length?this.parseChunk(E.shift()):L=!0},this._streamData=O(function(I){try{E.push(typeof I=="string"?I:I.toString(this._config.encoding)),L&&(L=!1,this._checkIsFinished(),this.parseChunk(E.shift()))}catch(re){this._streamError(re)}},this),this._streamError=O(function(I){this._streamCleanUp(),this._sendError(I)},this),this._streamEnd=O(function(){this._streamCleanUp(),H=!0,this._streamData("")},this),this._streamCleanUp=O(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function b(k){var E,L,H,I,re=Math.pow(2,53),ne=-re,ge=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,W=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,ee=this,je=0,Z=0,De=!1,he=!1,P=[],q={data:[],errors:[],meta:{}};function J(Ae){return k.skipEmptyLines==="greedy"?Ae.join("").trim()==="":Ae.length===1&&Ae[0].length===0}function K(){if(q&&H&&(Fe("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+m.DefaultDelimiter+"'"),H=!1),k.skipEmptyLines&&(q.data=q.data.filter(function(Ge){return!J(Ge)})),xe()){let Ge=function(X,ht){A(k.transformHeader)&&(X=k.transformHeader(X,ht)),P.push(X)};if(q)if(Array.isArray(q.data[0])){for(var Ae=0;xe()&&Ae<q.data.length;Ae++)q.data[Ae].forEach(Ge);q.data.splice(0,1)}else q.data.forEach(Ge)}function Ee(Ge,X){for(var ht=k.header?{}:[],Ye=0;Ye<Ge.length;Ye++){var Je=Ye,qe=Ge[Ye],qe=((Be,$e)=>(St=>(k.dynamicTypingFunction&&k.dynamicTyping[St]===void 0&&(k.dynamicTyping[St]=k.dynamicTypingFunction(St)),(k.dynamicTyping[St]||k.dynamicTyping)===!0))(Be)?$e==="true"||$e==="TRUE"||$e!=="false"&&$e!=="FALSE"&&((St=>{if(ge.test(St)&&(St=parseFloat(St),ne<St&&St<re))return 1})($e)?parseFloat($e):W.test($e)?new Date($e):$e===""?null:$e):$e)(Je=k.header?Ye>=P.length?"__parsed_extra":P[Ye]:Je,qe=k.transform?k.transform(qe,Je):qe);Je==="__parsed_extra"?(ht[Je]=ht[Je]||[],ht[Je].push(qe)):ht[Je]=qe}return k.header&&(Ye>P.length?Fe("FieldMismatch","TooManyFields","Too many fields: expected "+P.length+" fields but parsed "+Ye,Z+X):Ye<P.length&&Fe("FieldMismatch","TooFewFields","Too few fields: expected "+P.length+" fields but parsed "+Ye,Z+X)),ht}var we;q&&(k.header||k.dynamicTyping||k.transform)&&(we=1,!q.data.length||Array.isArray(q.data[0])?(q.data=q.data.map(Ee),we=q.data.length):q.data=Ee(q.data,0),k.header&&q.meta&&(q.meta.fields=P),Z+=we)}function xe(){return k.header&&P.length===0}function Fe(Ae,Ee,we,Ge){Ae={type:Ae,code:Ee,message:we},Ge!==void 0&&(Ae.row=Ge),q.errors.push(Ae)}A(k.step)&&(I=k.step,k.step=function(Ae){q=Ae,xe()?K():(K(),q.data.length!==0&&(je+=Ae.data.length,k.preview&&je>k.preview?L.abort():(q.data=q.data[0],I(q,ee))))}),this.parse=function(Ae,Ee,we){var Ge=k.quoteChar||'"',Ge=(k.newline||(k.newline=this.guessLineEndings(Ae,Ge)),H=!1,k.delimiter?A(k.delimiter)&&(k.delimiter=k.delimiter(Ae),q.meta.delimiter=k.delimiter):((Ge=((X,ht,Ye,Je,qe)=>{var Be,$e,St,Jt;qe=qe||[",","	","|",";",m.RECORD_SEP,m.UNIT_SEP];for(var fa=0;fa<qe.length;fa++){for(var ze,vt=qe[fa],tt=0,Qe=0,ot=0,bt=(St=void 0,new T({comments:Je,delimiter:vt,newline:ht,preview:10}).parse(X)),Ut=0;Ut<bt.data.length;Ut++)Ye&&J(bt.data[Ut])?ot++:(ze=bt.data[Ut].length,Qe+=ze,St===void 0?St=ze:0<ze&&(tt+=Math.abs(ze-St),St=ze));0<bt.data.length&&(Qe/=bt.data.length-ot),($e===void 0||tt<=$e)&&(Jt===void 0||Jt<Qe)&&1.99<Qe&&($e=tt,Be=vt,Jt=Qe)}return{successful:!!(k.delimiter=Be),bestDelimiter:Be}})(Ae,k.newline,k.skipEmptyLines,k.comments,k.delimitersToGuess)).successful?k.delimiter=Ge.bestDelimiter:(H=!0,k.delimiter=m.DefaultDelimiter),q.meta.delimiter=k.delimiter),z(k));return k.preview&&k.header&&Ge.preview++,E=Ae,L=new T(Ge),q=L.parse(E,Ee,we),K(),De?{meta:{paused:!0}}:q||{meta:{paused:!1}}},this.paused=function(){return De},this.pause=function(){De=!0,L.abort(),E=A(k.chunk)?"":E.substring(L.getCharIndex())},this.resume=function(){ee.streamer._halted?(De=!1,ee.streamer.parseChunk(E,!0)):setTimeout(ee.resume,3)},this.aborted=function(){return he},this.abort=function(){he=!0,L.abort(),q.meta.aborted=!0,A(k.complete)&&k.complete(q),E=""},this.guessLineEndings=function(X,Ge){X=X.substring(0,1048576);var Ge=new RegExp(w(Ge)+"([^]*?)"+w(Ge),"gm"),we=(X=X.replace(Ge,"")).split("\r"),Ge=X.split(`
`),X=1<Ge.length&&Ge[0].length<we[0].length;if(we.length===1||X)return`
`;for(var ht=0,Ye=0;Ye<we.length;Ye++)we[Ye][0]===`
`&&ht++;return ht>=we.length/2?`\r
`:"\r"}}function w(k){return k.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function T(k){var E=(k=k||{}).delimiter,L=k.newline,H=k.comments,I=k.step,re=k.preview,ne=k.fastMode,ge=null,W=!1,ee=k.quoteChar==null?'"':k.quoteChar,je=ee;if(k.escapeChar!==void 0&&(je=k.escapeChar),(typeof E!="string"||-1<m.BAD_DELIMITERS.indexOf(E))&&(E=","),H===E)throw new Error("Comment character same as delimiter");H===!0?H="#":(typeof H!="string"||-1<m.BAD_DELIMITERS.indexOf(H))&&(H=!1),L!==`
`&&L!=="\r"&&L!==`\r
`&&(L=`
`);var Z=0,De=!1;this.parse=function(he,P,q){if(typeof he!="string")throw new Error("Input must be a string");var J=he.length,K=E.length,xe=L.length,Fe=H.length,Ae=A(I),Ee=[],we=[],Ge=[],X=Z=0;if(!he)return tt();if(ne||ne!==!1&&he.indexOf(ee)===-1){for(var ht=he.split(L),Ye=0;Ye<ht.length;Ye++){if(Ge=ht[Ye],Z+=Ge.length,Ye!==ht.length-1)Z+=L.length;else if(q)return tt();if(!H||Ge.substring(0,Fe)!==H){if(Ae){if(Ee=[],Jt(Ge.split(E)),Qe(),De)return tt()}else Jt(Ge.split(E));if(re&&re<=Ye)return Ee=Ee.slice(0,re),tt(!0)}}return tt()}for(var Je=he.indexOf(E,Z),qe=he.indexOf(L,Z),Be=new RegExp(w(je)+w(ee),"g"),$e=he.indexOf(ee,Z);;)if(he[Z]===ee)for($e=Z,Z++;;){if(($e=he.indexOf(ee,$e+1))===-1)return q||we.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:Ee.length,index:Z}),ze();if($e===J-1)return ze(he.substring(Z,$e).replace(Be,ee));if(ee===je&&he[$e+1]===je)$e++;else if(ee===je||$e===0||he[$e-1]!==je){Je!==-1&&Je<$e+1&&(Je=he.indexOf(E,$e+1));var St=fa((qe=qe!==-1&&qe<$e+1?he.indexOf(L,$e+1):qe)===-1?Je:Math.min(Je,qe));if(he.substr($e+1+St,K)===E){Ge.push(he.substring(Z,$e).replace(Be,ee)),he[Z=$e+1+St+K]!==ee&&($e=he.indexOf(ee,Z)),Je=he.indexOf(E,Z),qe=he.indexOf(L,Z);break}if(St=fa(qe),he.substring($e+1+St,$e+1+St+xe)===L){if(Ge.push(he.substring(Z,$e).replace(Be,ee)),vt($e+1+St+xe),Je=he.indexOf(E,Z),$e=he.indexOf(ee,Z),Ae&&(Qe(),De))return tt();if(re&&Ee.length>=re)return tt(!0);break}we.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:Ee.length,index:Z}),$e++}}else if(H&&Ge.length===0&&he.substring(Z,Z+Fe)===H){if(qe===-1)return tt();Z=qe+xe,qe=he.indexOf(L,Z),Je=he.indexOf(E,Z)}else if(Je!==-1&&(Je<qe||qe===-1))Ge.push(he.substring(Z,Je)),Z=Je+K,Je=he.indexOf(E,Z);else{if(qe===-1)break;if(Ge.push(he.substring(Z,qe)),vt(qe+xe),Ae&&(Qe(),De))return tt();if(re&&Ee.length>=re)return tt(!0)}return ze();function Jt(ot){Ee.push(ot),X=Z}function fa(ot){var bt=0;return bt=ot!==-1&&(ot=he.substring($e+1,ot))&&ot.trim()===""?ot.length:bt}function ze(ot){return q||(ot===void 0&&(ot=he.substring(Z)),Ge.push(ot),Z=J,Jt(Ge),Ae&&Qe()),tt()}function vt(ot){Z=ot,Jt(Ge),Ge=[],qe=he.indexOf(L,Z)}function tt(ot){if(k.header&&!P&&Ee.length&&!W){var bt=Ee[0],Ut=Object.create(null),Ma=new Set(bt);let wt=!1;for(let qt=0;qt<bt.length;qt++){let oa=bt[qt];if(Ut[oa=A(k.transformHeader)?k.transformHeader(oa,qt):oa]){let zt,ia=Ut[oa];for(;zt=oa+"_"+ia,ia++,Ma.has(zt););Ma.add(zt),bt[qt]=zt,Ut[oa]++,wt=!0,(ge=ge===null?{}:ge)[zt]=oa}else Ut[oa]=1,bt[qt]=oa;Ma.add(oa)}wt&&console.warn("Duplicate headers found and renamed."),W=!0}return{data:Ee,errors:we,meta:{delimiter:E,linebreak:L,aborted:De,truncated:!!ot,cursor:X+(P||0),renamedHeaders:ge}}}function Qe(){I(tt()),Ee=[],we=[]}},this.abort=function(){De=!0},this.getCharIndex=function(){return Z}}function D(k){var E=k.data,L=d[E.workerId],H=!1;if(E.error)L.userError(E.error,E.file);else if(E.results&&E.results.data){var I={abort:function(){H=!0,_(E.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:R,resume:R};if(A(L.userStep)){for(var re=0;re<E.results.data.length&&(L.userStep({data:E.results.data[re],errors:E.results.errors,meta:E.results.meta},I),!H);re++);delete E.results}else A(L.userChunk)&&(L.userChunk(E.results,I,E.file),delete E.results)}E.finished&&!H&&_(E.workerId,E.results)}function _(k,E){var L=d[k];A(L.userComplete)&&L.userComplete(E),L.terminate(),delete d[k]}function R(){throw new Error("Not implemented.")}function z(k){if(typeof k!="object"||k===null)return k;var E,L=Array.isArray(k)?[]:{};for(E in k)L[E]=z(k[E]);return L}function O(k,E){return function(){k.apply(E,arguments)}}function A(k){return typeof k=="function"}return m.parse=function(k,E){var L=(E=E||{}).dynamicTyping||!1;if(A(L)&&(E.dynamicTypingFunction=L,L={}),E.dynamicTyping=L,E.transform=!!A(E.transform)&&E.transform,!E.worker||!m.WORKERS_SUPPORTED)return L=null,m.NODE_STREAM_INPUT,typeof k=="string"?(k=(H=>H.charCodeAt(0)!==65279?H:H.slice(1))(k),L=new(E.download?v:N)(E)):k.readable===!0&&A(k.read)&&A(k.on)?L=new j(E):(n.File&&k instanceof File||k instanceof Object)&&(L=new y(E)),L.stream(k);(L=(()=>{var H;return!!m.WORKERS_SUPPORTED&&(H=(()=>{var I=n.URL||n.webkitURL||null,re=a.toString();return m.BLOB_URL||(m.BLOB_URL=I.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",re,")();"],{type:"text/javascript"})))})(),(H=new n.Worker(H)).onmessage=D,H.id=h++,d[H.id]=H)})()).userStep=E.step,L.userChunk=E.chunk,L.userComplete=E.complete,L.userError=E.error,E.step=A(E.step),E.chunk=A(E.chunk),E.complete=A(E.complete),E.error=A(E.error),delete E.worker,L.postMessage({input:k,config:E,workerId:L.id})},m.unparse=function(k,E){var L=!1,H=!0,I=",",re=`\r
`,ne='"',ge=ne+ne,W=!1,ee=null,je=!1,Z=((()=>{if(typeof E=="object"){if(typeof E.delimiter!="string"||m.BAD_DELIMITERS.filter(function(P){return E.delimiter.indexOf(P)!==-1}).length||(I=E.delimiter),typeof E.quotes!="boolean"&&typeof E.quotes!="function"&&!Array.isArray(E.quotes)||(L=E.quotes),typeof E.skipEmptyLines!="boolean"&&typeof E.skipEmptyLines!="string"||(W=E.skipEmptyLines),typeof E.newline=="string"&&(re=E.newline),typeof E.quoteChar=="string"&&(ne=E.quoteChar),typeof E.header=="boolean"&&(H=E.header),Array.isArray(E.columns)){if(E.columns.length===0)throw new Error("Option columns is empty");ee=E.columns}E.escapeChar!==void 0&&(ge=E.escapeChar+ne),E.escapeFormulae instanceof RegExp?je=E.escapeFormulae:typeof E.escapeFormulae=="boolean"&&E.escapeFormulae&&(je=/^[=+\-@\t\r].*$/)}})(),new RegExp(w(ne),"g"));if(typeof k=="string"&&(k=JSON.parse(k)),Array.isArray(k)){if(!k.length||Array.isArray(k[0]))return De(null,k,W);if(typeof k[0]=="object")return De(ee||Object.keys(k[0]),k,W)}else if(typeof k=="object")return typeof k.data=="string"&&(k.data=JSON.parse(k.data)),Array.isArray(k.data)&&(k.fields||(k.fields=k.meta&&k.meta.fields||ee),k.fields||(k.fields=Array.isArray(k.data[0])?k.fields:typeof k.data[0]=="object"?Object.keys(k.data[0]):[]),Array.isArray(k.data[0])||typeof k.data[0]=="object"||(k.data=[k.data])),De(k.fields||[],k.data||[],W);throw new Error("Unable to serialize unrecognized input");function De(P,q,J){var K="",xe=(typeof P=="string"&&(P=JSON.parse(P)),typeof q=="string"&&(q=JSON.parse(q)),Array.isArray(P)&&0<P.length),Fe=!Array.isArray(q[0]);if(xe&&H){for(var Ae=0;Ae<P.length;Ae++)0<Ae&&(K+=I),K+=he(P[Ae],Ae);0<q.length&&(K+=re)}for(var Ee=0;Ee<q.length;Ee++){var we=(xe?P:q[Ee]).length,Ge=!1,X=xe?Object.keys(q[Ee]).length===0:q[Ee].length===0;if(J&&!xe&&(Ge=J==="greedy"?q[Ee].join("").trim()==="":q[Ee].length===1&&q[Ee][0].length===0),J==="greedy"&&xe){for(var ht=[],Ye=0;Ye<we;Ye++){var Je=Fe?P[Ye]:Ye;ht.push(q[Ee][Je])}Ge=ht.join("").trim()===""}if(!Ge){for(var qe=0;qe<we;qe++){0<qe&&!X&&(K+=I);var Be=xe&&Fe?P[qe]:qe;K+=he(q[Ee][Be],qe)}Ee<q.length-1&&(!J||0<we&&!X)&&(K+=re)}}return K}function he(P,q){var J,K;return P==null?"":P.constructor===Date?JSON.stringify(P).slice(1,25):(K=!1,je&&typeof P=="string"&&je.test(P)&&(P="'"+P,K=!0),J=P.toString().replace(Z,ge),(K=K||L===!0||typeof L=="function"&&L(P,q)||Array.isArray(L)&&L[q]||((xe,Fe)=>{for(var Ae=0;Ae<Fe.length;Ae++)if(-1<xe.indexOf(Fe[Ae]))return!0;return!1})(J,m.BAD_DELIMITERS)||-1<J.indexOf(I)||J.charAt(0)===" "||J.charAt(J.length-1)===" ")?ne+J+ne:J)}},m.RECORD_SEP="",m.UNIT_SEP="",m.BYTE_ORDER_MARK="\uFEFF",m.BAD_DELIMITERS=["\r",`
`,'"',m.BYTE_ORDER_MARK],m.WORKERS_SUPPORTED=!o&&!!n.Worker,m.NODE_STREAM_INPUT=1,m.LocalChunkSize=10485760,m.RemoteChunkSize=5242880,m.DefaultDelimiter=",",m.Parser=T,m.ParserHandle=b,m.NetworkStreamer=v,m.FileStreamer=y,m.StringStreamer=N,m.ReadableStreamStreamer=j,n.jQuery&&((i=n.jQuery).fn.parse=function(k){var E=k.config||{},L=[];return this.each(function(re){if(!(i(this).prop("tagName").toUpperCase()==="INPUT"&&i(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var ne=0;ne<this.files.length;ne++)L.push({file:this.files[ne],inputElem:this,instanceConfig:i.extend({},E)})}),H(),this;function H(){if(L.length===0)A(k.complete)&&k.complete();else{var re,ne,ge,W,ee=L[0];if(A(k.before)){var je=k.before(ee.file,ee.inputElem);if(typeof je=="object"){if(je.action==="abort")return re="AbortError",ne=ee.file,ge=ee.inputElem,W=je.reason,void(A(k.error)&&k.error({name:re},ne,ge,W));if(je.action==="skip")return void I();typeof je.config=="object"&&(ee.instanceConfig=i.extend(ee.instanceConfig,je.config))}else if(je==="skip")return void I()}var Z=ee.instanceConfig.complete;ee.instanceConfig.complete=function(De){A(Z)&&Z(De,ee.file,ee.inputElem),I()},m.parse(ee.file,ee.instanceConfig)}}function I(){L.splice(0,1),H()}}),u&&(n.onmessage=function(k){k=k.data,m.WORKER_ID===void 0&&k&&(m.WORKER_ID=k.workerId),typeof k.input=="string"?n.postMessage({workerId:m.WORKER_ID,results:m.parse(k.input,k.config),finished:!0}):(n.File&&k.input instanceof File||k.input instanceof Object)&&(k=m.parse(k.input,k.config))&&n.postMessage({workerId:m.WORKER_ID,results:k,finished:!0})}),(v.prototype=Object.create(p.prototype)).constructor=v,(y.prototype=Object.create(p.prototype)).constructor=y,(N.prototype=Object.create(N.prototype)).constructor=N,(j.prototype=Object.create(p.prototype)).constructor=j,m})})(Zf)),Zf.exports}var FR=MR();const Iw=yC(FR);var Lw=1252,IR=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],qp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Wp=function(e){IR.indexOf(e)!=-1&&(Lw=qp[0]=e)};function LR(){Wp(1252)}var Qs=function(e){Wp(e)};function Pw(){Qs(1200),LR()}function qj(e){for(var r=[],a=0,n=e.length;a<n;++a)r[a]=e.charCodeAt(a);return r}function PR(e){for(var r=[],a=0;a<e.length>>1;++a)r[a]=String.fromCharCode(e.charCodeAt(2*a)+(e.charCodeAt(2*a+1)<<8));return r.join("")}function Bw(e){for(var r=[],a=0;a<e.length>>1;++a)r[a]=String.fromCharCode(e.charCodeAt(2*a+1)+(e.charCodeAt(2*a)<<8));return r.join("")}var ou=function(e){var r=e.charCodeAt(0),a=e.charCodeAt(1);return r==255&&a==254?PR(e.slice(2)):r==254&&a==255?Bw(e.slice(2)):r==65279?e.slice(1):e},Df=function(r){return String.fromCharCode(r)},Wj=function(r){return String.fromCharCode(r)},Mu,qi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Yj(e){for(var r="",a=0,n=0,i=0,o=0,u=0,d=0,h=0,m=0;m<e.length;)a=e.charCodeAt(m++),o=a>>2,n=e.charCodeAt(m++),u=(a&3)<<4|n>>4,i=e.charCodeAt(m++),d=(n&15)<<2|i>>6,h=i&63,isNaN(n)?d=h=64:isNaN(i)&&(h=64),r+=qi.charAt(o)+qi.charAt(u)+qi.charAt(d)+qi.charAt(h);return r}function vs(e){var r="",a=0,n=0,i=0,o=0,u=0,d=0,h=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var m=0;m<e.length;)o=qi.indexOf(e.charAt(m++)),u=qi.indexOf(e.charAt(m++)),a=o<<2|u>>4,r+=String.fromCharCode(a),d=qi.indexOf(e.charAt(m++)),n=(u&15)<<4|d>>2,d!==64&&(r+=String.fromCharCode(n)),h=qi.indexOf(e.charAt(m++)),i=(d&3)<<6|h,h!==64&&(r+=String.fromCharCode(i));return r}var Kt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),zl=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,a){return a?new Buffer(r,a):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}})();function Zi(e){return Kt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Xj(e){return Kt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var $s=function(r){return Kt?zl(r,"binary"):r.split("").map(function(a){return a.charCodeAt(0)&255})};function Vl(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],a=0;a<e.length;++a)r[a]=String.fromCharCode(e[a]);return r.join("")}function Yp(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Yp(new Uint8Array(e));for(var r=new Array(e.length),a=0;a<e.length;++a)r[a]=e[a];return r}var Hi=Kt?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:zl(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,a=0;for(r=0;r<e.length;++r)a+=e[r].length;var n=new Uint8Array(a),i=0;for(r=0,a=0;r<e.length;a+=i,++r)if(i=e[r].length,e[r]instanceof Uint8Array)n.set(e[r],a);else{if(typeof e[r]=="string")throw"wtf";n.set(new Uint8Array(e[r]),a)}return n}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function BR(e){for(var r=[],a=0,n=e.length+250,i=Zi(e.length+255),o=0;o<e.length;++o){var u=e.charCodeAt(o);if(u<128)i[a++]=u;else if(u<2048)i[a++]=192|u>>6&31,i[a++]=128|u&63;else if(u>=55296&&u<57344){u=(u&1023)+64;var d=e.charCodeAt(++o)&1023;i[a++]=240|u>>8&7,i[a++]=128|u>>2&63,i[a++]=128|d>>6&15|(u&3)<<4,i[a++]=128|d&63}else i[a++]=224|u>>12&15,i[a++]=128|u>>6&63,i[a++]=128|u&63;a>n&&(r.push(i.slice(0,a)),a=0,i=Zi(65535),n=65530)}return r.push(i.slice(0,a)),Hi(r)}var Pr=/\u0000/g,uu=/[\u0001-\u0006]/g;function Lc(e){for(var r="",a=e.length-1;a>=0;)r+=e.charAt(a--);return r}function Zs(e,r){var a=""+e;return a.length>=r?a:Oa("0",r-a.length)+a}function Xp(e,r){var a=""+e;return a.length>=r?a:Oa(" ",r-a.length)+a}function o0(e,r){var a=""+e;return a.length>=r?a:a+Oa(" ",r-a.length)}function UR(e,r){var a=""+Math.round(e);return a.length>=r?a:Oa("0",r-a.length)+a}function zR(e,r){var a=""+e;return a.length>=r?a:Oa("0",r-a.length)+a}var $j=Math.pow(2,32);function Ac(e,r){if(e>$j||e<-$j)return UR(e,r);var a=Math.round(e);return zR(a,r)}function u0(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var Kj=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],mx=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function VR(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var It={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Qj={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},HR={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function d0(e,r,a){for(var n=e<0?-1:1,i=e*n,o=0,u=1,d=0,h=1,m=0,p=0,v=Math.floor(i);m<r&&(v=Math.floor(i),d=v*u+o,p=v*m+h,!(i-v<5e-8));)i=1/(i-v),o=u,u=d,h=m,m=p;if(p>r&&(m>r?(p=h,d=o):(p=m,d=u)),!a)return[0,n*d,p];var y=Math.floor(n*d/p);return[y,n*d-y*p,p]}function Tl(e,r,a){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),o=0,u=[],d={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(d.u)<1e-6&&(d.u=0),r&&r.date1904&&(n+=1462),d.u>.9999&&(d.u=0,++i==86400&&(d.T=i=0,++n,++d.D)),n===60)u=a?[1317,10,29]:[1900,2,29],o=3;else if(n===0)u=a?[1317,8,29]:[1900,1,0],o=6;else{n>60&&--n;var h=new Date(1900,0,1);h.setDate(h.getDate()+n-1),u=[h.getFullYear(),h.getMonth()+1,h.getDate()],o=h.getDay(),n<60&&(o=(o+6)%7),a&&(o=$R(h,u))}return d.y=u[0],d.m=u[1],d.d=u[2],d.S=i%60,i=Math.floor(i/60),d.M=i%60,i=Math.floor(i/60),d.H=i,d.q=o,d}var Uw=new Date(1899,11,31,0,0,0),GR=Uw.getTime(),qR=new Date(1900,2,1,0,0,0);function zw(e,r){var a=e.getTime();return r?a-=1461*24*60*60*1e3:e>=qR&&(a+=1440*60*1e3),(a-(GR+(e.getTimezoneOffset()-Uw.getTimezoneOffset())*6e4))/(1440*60*1e3)}function $p(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function WR(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function YR(e){var r=e<0?12:11,a=$p(e.toFixed(12));return a.length<=r||(a=e.toPrecision(10),a.length<=r)?a:e.toExponential(5)}function XR(e){var r=$p(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function Fu(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),a;return r>=-4&&r<=-1?a=e.toPrecision(10+r):Math.abs(r)<=9?a=YR(e):r===10?a=e.toFixed(10).substr(0,12):a=XR(e),$p(WR(a.toUpperCase()))}function Rl(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Fu(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Fs(14,zw(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function $R(e,r){r[0]-=581;var a=e.getDay();return e<60&&(a=(a+6)%7),a}function KR(e,r,a,n){var i="",o=0,u=0,d=a.y,h,m=0;switch(e){case 98:d=a.y+543;case 121:switch(r.length){case 1:case 2:h=d%100,m=2;break;default:h=d%1e4,m=4;break}break;case 109:switch(r.length){case 1:case 2:h=a.m,m=r.length;break;case 3:return mx[a.m-1][1];case 5:return mx[a.m-1][0];default:return mx[a.m-1][2]}break;case 100:switch(r.length){case 1:case 2:h=a.d,m=r.length;break;case 3:return Kj[a.q][0];default:return Kj[a.q][1]}break;case 104:switch(r.length){case 1:case 2:h=1+(a.H+11)%12,m=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:h=a.H,m=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:h=a.M,m=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return a.u===0&&(r=="s"||r=="ss")?Zs(a.S,r.length):(n>=2?u=n===3?1e3:100:u=n===1?10:1,o=Math.round(u*(a.S+a.u)),o>=60*u&&(o=0),r==="s"?o===0?"0":""+o/u:(i=Zs(o,2+n),r==="ss"?i.substr(0,2):"."+i.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":h=a.D*24+a.H;break;case"[m]":case"[mm]":h=(a.D*24+a.H)*60+a.M;break;case"[s]":case"[ss]":h=((a.D*24+a.H)*60+a.M)*60+Math.round(a.S+a.u);break;default:throw"bad abstime format: "+r}m=r.length===3?1:2;break;case 101:h=d,m=1;break}var p=m>0?Zs(h,m):"";return p}function Wi(e){var r=3;if(e.length<=r)return e;for(var a=e.length%r,n=e.substr(0,a);a!=e.length;a+=r)n+=(n.length>0?",":"")+e.substr(a,r);return n}var Vw=/%/g;function QR(e,r,a){var n=r.replace(Vw,""),i=r.length-n.length;return ni(e,n,a*Math.pow(10,2*i))+Oa("%",i)}function ZR(e,r,a){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return ni(e,r.substr(0,n),a/Math.pow(10,3*(r.length-n)))}function Hw(e,r){var a,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Hw(e,-r);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%i;if(o<0&&(o+=i),a=(r/Math.pow(10,o)).toPrecision(n+1+(i+o)%i),a.indexOf("e")===-1){var u=Math.floor(Math.log(r)*Math.LOG10E);for(a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(u-a.length+o):a+="E+"+(u-o);a.substr(0,2)==="0.";)a=a.charAt(0)+a.substr(2,i)+"."+a.substr(2+i),a=a.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,h,m,p){return h+m+p.substr(0,(i+o)%i)+"."+p.substr(o)+"E"})}else a=r.toExponential(n);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}var Gw=/# (\?+)( ?)\/( ?)(\d+)/;function JR(e,r,a){var n=parseInt(e[4],10),i=Math.round(r*n),o=Math.floor(i/n),u=i-o*n,d=n;return a+(o===0?"":""+o)+" "+(u===0?Oa(" ",e[1].length+1+e[4].length):Xp(u,e[1].length)+e[2]+"/"+e[3]+Zs(d,e[4].length))}function e5(e,r,a){return a+(r===0?"":""+r)+Oa(" ",e[1].length+2+e[4].length)}var qw=/^#*0*\.([0#]+)/,Ww=/\).*[0#]/,Yw=/\(###\) ###\\?-####/;function Or(e){for(var r="",a,n=0;n!=e.length;++n)switch(a=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(a)}return r}function Zj(e,r){var a=Math.pow(10,r);return""+Math.round(e*a)/a}function Jj(e,r){var a=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(a*n)).length?0:Math.round(a*n)}function t5(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function a5(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ds(e,r,a){if(e.charCodeAt(0)===40&&!r.match(Ww)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?Ds("n",n,a):"("+Ds("n",n,-a)+")"}if(r.charCodeAt(r.length-1)===44)return ZR(e,r,a);if(r.indexOf("%")!==-1)return QR(e,r,a);if(r.indexOf("E")!==-1)return Hw(r,a);if(r.charCodeAt(0)===36)return"$"+Ds(e,r.substr(r.charAt(1)==" "?2:1),a);var i,o,u,d,h=Math.abs(a),m=a<0?"-":"";if(r.match(/^00+$/))return m+Ac(h,r.length);if(r.match(/^[#?]+$/))return i=Ac(a,0),i==="0"&&(i=""),i.length>r.length?i:Or(r.substr(0,r.length-i.length))+i;if(o=r.match(Gw))return JR(o,h,m);if(r.match(/^#+0+$/))return m+Ac(h,r.length-r.indexOf("0"));if(o=r.match(qw))return i=Zj(a,o[1].length).replace(/^([^\.]+)$/,"$1."+Or(o[1])).replace(/\.$/,"."+Or(o[1])).replace(/\.(\d*)$/,function(j,b){return"."+b+Oa("0",Or(o[1]).length-b.length)}),r.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return m+Zj(h,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return m+Wi(Ac(h,0));if(o=r.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+Ds(e,r,-a):Wi(""+(Math.floor(a)+t5(a,o[1].length)))+"."+Zs(Jj(a,o[1].length),o[1].length);if(o=r.match(/^#,#*,#0/))return Ds(e,r.replace(/^#,#*,/,""),a);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Lc(Ds(e,r.replace(/[\\-]/g,""),a)),u=0,Lc(Lc(r.replace(/\\/g,"")).replace(/[0#]/g,function(j){return u<i.length?i.charAt(u++):j==="0"?"0":""}));if(r.match(Yw))return i=Ds(e,"##########",a),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var p="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(o[4].length,7),d=d0(h,Math.pow(10,u)-1,!1),i=""+m,p=ni("n",o[1],d[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),i+=p+o[2]+"/"+o[3],p=o0(d[2],u),p.length<o[4].length&&(p=Or(o[4].substr(o[4].length-p.length))+p),i+=p,i;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(Math.max(o[1].length,o[4].length),7),d=d0(h,Math.pow(10,u)-1,!0),m+(d[0]||(d[1]?"":"0"))+" "+(d[1]?Xp(d[1],u)+o[2]+"/"+o[3]+o0(d[2],u):Oa(" ",2*u+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return i=Ac(a,0),r.length<=i.length?i:Or(r.substr(0,r.length-i.length))+i;if(o=r.match(/^([#0?]+)\.([#0]+)$/)){i=""+a.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),u=i.indexOf(".");var v=r.indexOf(".")-u,y=r.length-i.length-v;return Or(r.substr(0,v)+i+r.substr(r.length-y))}if(o=r.match(/^00,000\.([#0]*0)$/))return u=Jj(a,o[1].length),a<0?"-"+Ds(e,r,-a):Wi(a5(a)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(j){return"00,"+(j.length<3?Zs(0,3-j.length):"")+j})+"."+Zs(u,o[1].length);switch(r){case"###,##0.00":return Ds(e,"#,##0.00",a);case"###,###":case"##,###":case"#,###":var N=Wi(Ac(h,0));return N!=="0"?m+N:"";case"###,###.00":return Ds(e,"###,##0.00",a).replace(/^0\./,".");case"#,###.00":return Ds(e,"#,##0.00",a).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function r5(e,r,a){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return ni(e,r.substr(0,n),a/Math.pow(10,3*(r.length-n)))}function s5(e,r,a){var n=r.replace(Vw,""),i=r.length-n.length;return ni(e,n,a*Math.pow(10,2*i))+Oa("%",i)}function Xw(e,r){var a,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Xw(e,-r);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%i;if(o<0&&(o+=i),a=(r/Math.pow(10,o)).toPrecision(n+1+(i+o)%i),!a.match(/[Ee]/)){var u=Math.floor(Math.log(r)*Math.LOG10E);a.indexOf(".")===-1?a=a.charAt(0)+"."+a.substr(1)+"E+"+(u-a.length+o):a+="E+"+(u-o),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,h,m,p){return h+m+p.substr(0,(i+o)%i)+"."+p.substr(o)+"E"})}else a=r.toExponential(n);return e.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),e.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}function xn(e,r,a){if(e.charCodeAt(0)===40&&!r.match(Ww)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return a>=0?xn("n",n,a):"("+xn("n",n,-a)+")"}if(r.charCodeAt(r.length-1)===44)return r5(e,r,a);if(r.indexOf("%")!==-1)return s5(e,r,a);if(r.indexOf("E")!==-1)return Xw(r,a);if(r.charCodeAt(0)===36)return"$"+xn(e,r.substr(r.charAt(1)==" "?2:1),a);var i,o,u,d,h=Math.abs(a),m=a<0?"-":"";if(r.match(/^00+$/))return m+Zs(h,r.length);if(r.match(/^[#?]+$/))return i=""+a,a===0&&(i=""),i.length>r.length?i:Or(r.substr(0,r.length-i.length))+i;if(o=r.match(Gw))return e5(o,h,m);if(r.match(/^#+0+$/))return m+Zs(h,r.length-r.indexOf("0"));if(o=r.match(qw))return i=(""+a).replace(/^([^\.]+)$/,"$1."+Or(o[1])).replace(/\.$/,"."+Or(o[1])),i=i.replace(/\.(\d*)$/,function(j,b){return"."+b+Oa("0",Or(o[1]).length-b.length)}),r.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return m+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return m+Wi(""+h);if(o=r.match(/^#,##0\.([#0]*0)$/))return a<0?"-"+xn(e,r,-a):Wi(""+a)+"."+Oa("0",o[1].length);if(o=r.match(/^#,#*,#0/))return xn(e,r.replace(/^#,#*,/,""),a);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Lc(xn(e,r.replace(/[\\-]/g,""),a)),u=0,Lc(Lc(r.replace(/\\/g,"")).replace(/[0#]/g,function(j){return u<i.length?i.charAt(u++):j==="0"?"0":""}));if(r.match(Yw))return i=xn(e,"##########",a),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var p="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(o[4].length,7),d=d0(h,Math.pow(10,u)-1,!1),i=""+m,p=ni("n",o[1],d[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),i+=p+o[2]+"/"+o[3],p=o0(d[2],u),p.length<o[4].length&&(p=Or(o[4].substr(o[4].length-p.length))+p),i+=p,i;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(Math.max(o[1].length,o[4].length),7),d=d0(h,Math.pow(10,u)-1,!0),m+(d[0]||(d[1]?"":"0"))+" "+(d[1]?Xp(d[1],u)+o[2]+"/"+o[3]+o0(d[2],u):Oa(" ",2*u+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return i=""+a,r.length<=i.length?i:Or(r.substr(0,r.length-i.length))+i;if(o=r.match(/^([#0]+)\.([#0]+)$/)){i=""+a.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),u=i.indexOf(".");var v=r.indexOf(".")-u,y=r.length-i.length-v;return Or(r.substr(0,v)+i+r.substr(r.length-y))}if(o=r.match(/^00,000\.([#0]*0)$/))return a<0?"-"+xn(e,r,-a):Wi(""+a).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(j){return"00,"+(j.length<3?Zs(0,3-j.length):"")+j})+"."+Zs(0,o[1].length);switch(r){case"###,###":case"##,###":case"#,###":var N=Wi(""+h);return N!=="0"?m+N:"";default:if(r.match(/\.[0#?]*$/))return xn(e,r.slice(0,r.lastIndexOf(".")),a)+Or(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function ni(e,r,a){return(a|0)===a?xn(e,r,a):Ds(e,r,a)}function n5(e){for(var r=[],a=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:a=!a;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(i,n-i),i=n+1}if(r[r.length]=e.substr(i),a===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var $w=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Qc(e){for(var r=0,a="",n="";r<e.length;)switch(a=e.charAt(r)){case"G":u0(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="/")return!0;++r;break;case"[":for(n=a;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match($w))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(a=e.charAt(++r))>-1||a=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===a;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function i5(e,r,a,n){for(var i=[],o="",u=0,d="",h="t",m,p,v,y="H";u<e.length;)switch(d=e.charAt(u)){case"G":if(!u0(e,u))throw new Error("unrecognized character "+d+" in "+e);i[i.length]={t:"G",v:"General"},u+=7;break;case'"':for(o="";(v=e.charCodeAt(++u))!==34&&u<e.length;)o+=String.fromCharCode(v);i[i.length]={t:"t",v:o},++u;break;case"\\":var N=e.charAt(++u),j=N==="("||N===")"?N:"t";i[i.length]={t:j,v:N},++u;break;case"_":i[i.length]={t:"t",v:" "},u+=2;break;case"@":i[i.length]={t:"T",v:r},++u;break;case"B":case"b":if(e.charAt(u+1)==="1"||e.charAt(u+1)==="2"){if(m==null&&(m=Tl(r,a,e.charAt(u+1)==="2"),m==null))return"";i[i.length]={t:"X",v:e.substr(u,2)},h=d,u+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||m==null&&(m=Tl(r,a),m==null))return"";for(o=d;++u<e.length&&e.charAt(u).toLowerCase()===d;)o+=d;d==="m"&&h.toLowerCase()==="h"&&(d="M"),d==="h"&&(d=y),i[i.length]={t:d,v:o},h=d;break;case"A":case"a":case"":var b={t:d,v:d};if(m==null&&(m=Tl(r,a)),e.substr(u,3).toUpperCase()==="A/P"?(m!=null&&(b.v=m.H>=12?"P":"A"),b.t="T",y="h",u+=3):e.substr(u,5).toUpperCase()==="AM/PM"?(m!=null&&(b.v=m.H>=12?"PM":"AM"),b.t="T",u+=5,y="h"):e.substr(u,5).toUpperCase()==="/"?(m!=null&&(b.v=m.H>=12?"":""),b.t="T",u+=5,y="h"):(b.t="t",++u),m==null&&b.t==="T")return"";i[i.length]=b,h=d;break;case"[":for(o=d;e.charAt(u++)!=="]"&&u<e.length;)o+=e.charAt(u);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match($w)){if(m==null&&(m=Tl(r,a),m==null))return"";i[i.length]={t:"Z",v:o.toLowerCase()},h=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",Qc(e)||(i[i.length]={t:"t",v:o}));break;case".":if(m!=null){for(o=d;++u<e.length&&(d=e.charAt(u))==="0";)o+=d;i[i.length]={t:"s",v:o};break}case"0":case"#":for(o=d;++u<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(u))>-1;)o+=d;i[i.length]={t:"n",v:o};break;case"?":for(o=d;e.charAt(++u)===d;)o+=d;i[i.length]={t:d,v:o},h=d;break;case"*":++u,(e.charAt(u)==" "||e.charAt(u)=="*")&&++u;break;case"(":case")":i[i.length]={t:n===1?"t":d,v:d},++u;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=d;u<e.length&&"0123456789".indexOf(e.charAt(++u))>-1;)o+=e.charAt(u);i[i.length]={t:"D",v:o};break;case" ":i[i.length]={t:d,v:d},++u;break;case"$":i[i.length]={t:"t",v:"$"},++u;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(d)===-1)throw new Error("unrecognized character "+d+" in "+e);i[i.length]={t:"t",v:d},++u;break}var w=0,T=0,D;for(u=i.length-1,h="t";u>=0;--u)switch(i[u].t){case"h":case"H":i[u].t=y,h="h",w<1&&(w=1);break;case"s":(D=i[u].v.match(/\.0+$/))&&(T=Math.max(T,D[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":h=i[u].t;break;case"m":h==="s"&&(i[u].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&i[u].v.match(/[Hh]/)&&(w=1),w<2&&i[u].v.match(/[Mm]/)&&(w=2),w<3&&i[u].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M),m.M>=60&&(m.M=0,++m.H);break;case 2:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M);break}var _="",R;for(u=0;u<i.length;++u)switch(i[u].t){case"t":case"T":case" ":case"D":break;case"X":i[u].v="",i[u].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[u].v=KR(i[u].t.charCodeAt(0),i[u].v,m,T),i[u].t="t";break;case"n":case"?":for(R=u+1;i[R]!=null&&((d=i[R].t)==="?"||d==="D"||(d===" "||d==="t")&&i[R+1]!=null&&(i[R+1].t==="?"||i[R+1].t==="t"&&i[R+1].v==="/")||i[u].t==="("&&(d===" "||d==="n"||d===")")||d==="t"&&(i[R].v==="/"||i[R].v===" "&&i[R+1]!=null&&i[R+1].t=="?"));)i[u].v+=i[R].v,i[R]={v:"",t:";"},++R;_+=i[u].v,u=R-1;break;case"G":i[u].t="t",i[u].v=Rl(r,a);break}var z="",O,A;if(_.length>0){_.charCodeAt(0)==40?(O=r<0&&_.charCodeAt(0)===45?-r:r,A=ni("n",_,O)):(O=r<0&&n>1?-r:r,A=ni("n",_,O),O<0&&i[0]&&i[0].t=="t"&&(A=A.substr(1),i[0].v="-"+i[0].v)),R=A.length-1;var k=i.length;for(u=0;u<i.length;++u)if(i[u]!=null&&i[u].t!="t"&&i[u].v.indexOf(".")>-1){k=u;break}var E=i.length;if(k===i.length&&A.indexOf("E")===-1){for(u=i.length-1;u>=0;--u)i[u]==null||"n?".indexOf(i[u].t)===-1||(R>=i[u].v.length-1?(R-=i[u].v.length,i[u].v=A.substr(R+1,i[u].v.length)):R<0?i[u].v="":(i[u].v=A.substr(0,R+1),R=-1),i[u].t="t",E=u);R>=0&&E<i.length&&(i[E].v=A.substr(0,R+1)+i[E].v)}else if(k!==i.length&&A.indexOf("E")===-1){for(R=A.indexOf(".")-1,u=k;u>=0;--u)if(!(i[u]==null||"n?".indexOf(i[u].t)===-1)){for(p=i[u].v.indexOf(".")>-1&&u===k?i[u].v.indexOf(".")-1:i[u].v.length-1,z=i[u].v.substr(p+1);p>=0;--p)R>=0&&(i[u].v.charAt(p)==="0"||i[u].v.charAt(p)==="#")&&(z=A.charAt(R--)+z);i[u].v=z,i[u].t="t",E=u}for(R>=0&&E<i.length&&(i[E].v=A.substr(0,R+1)+i[E].v),R=A.indexOf(".")+1,u=k;u<i.length;++u)if(!(i[u]==null||"n?(".indexOf(i[u].t)===-1&&u!==k)){for(p=i[u].v.indexOf(".")>-1&&u===k?i[u].v.indexOf(".")+1:0,z=i[u].v.substr(0,p);p<i[u].v.length;++p)R<A.length&&(z+=A.charAt(R++));i[u].v=z,i[u].t="t",E=u}}}for(u=0;u<i.length;++u)i[u]!=null&&"n?".indexOf(i[u].t)>-1&&(O=n>1&&r<0&&u>0&&i[u-1].v==="-"?-r:r,i[u].v=ni(i[u].t,i[u].v,O),i[u].t="t");var L="";for(u=0;u!==i.length;++u)i[u]!=null&&(L+=i[u].v);return L}var eb=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function tb(e,r){if(r==null)return!1;var a=parseFloat(r[2]);switch(r[1]){case"=":if(e==a)return!0;break;case">":if(e>a)return!0;break;case"<":if(e<a)return!0;break;case"<>":if(e!=a)return!0;break;case">=":if(e>=a)return!0;break;case"<=":if(e<=a)return!0;break}return!1}function l5(e,r){var a=n5(e),n=a.length,i=a[n-1].indexOf("@");if(n<4&&i>-1&&--n,a.length>4)throw new Error("cannot find right format for |"+a.join("|")+"|");if(typeof r!="number")return[4,a.length===4||i>-1?a[a.length-1]:"@"];switch(a.length){case 1:a=i>-1?["General","General","General",a[0]]:[a[0],a[0],a[0],"@"];break;case 2:a=i>-1?[a[0],a[0],a[0],a[1]]:[a[0],a[1],a[0],"@"];break;case 3:a=i>-1?[a[0],a[1],a[0],a[2]]:[a[0],a[1],a[2],"@"];break}var o=r>0?a[0]:r<0?a[1]:a[2];if(a[0].indexOf("[")===-1&&a[1].indexOf("[")===-1)return[n,o];if(a[0].match(/\[[=<>]/)!=null||a[1].match(/\[[=<>]/)!=null){var u=a[0].match(eb),d=a[1].match(eb);return tb(r,u)?[n,a[0]]:tb(r,d)?[n,a[1]]:[n,a[u!=null&&d!=null?2:1]]}return[n,o]}function Fs(e,r,a){a==null&&(a={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&a.dateNF?n=a.dateNF:n=e;break;case"number":e==14&&a.dateNF?n=a.dateNF:n=(a.table!=null?a.table:It)[e],n==null&&(n=a.table&&a.table[Qj[e]]||It[Qj[e]]),n==null&&(n=HR[e]||"General");break}if(u0(n,0))return Rl(r,a);r instanceof Date&&(r=zw(r,a.date1904));var i=l5(n,r);if(u0(i[1]))return Rl(r,a);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return i5(i[1],r,a,i[0])}function kl(e,r){if(typeof r!="number"){r=+r||-1;for(var a=0;a<392;++a){if(It[a]==null){r<0&&(r=a);continue}if(It[a]==e){r=a;break}}r<0&&(r=391)}return It[r]=e,r}function Kw(){It=VR()}var c5={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Qw=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function o5(e){var r=typeof e=="number"?It[e]:e;return r=r.replace(Qw,"(\\d+)"),new RegExp("^"+r+"$")}function u5(e,r,a){var n=-1,i=-1,o=-1,u=-1,d=-1,h=-1;(r.match(Qw)||[]).forEach(function(v,y){var N=parseInt(a[y+1],10);switch(v.toLowerCase().charAt(0)){case"y":n=N;break;case"d":o=N;break;case"h":u=N;break;case"s":h=N;break;case"m":u>=0?d=N:i=N;break}}),h>=0&&d==-1&&i>=0&&(d=i,i=-1);var m=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);m.length==7&&(m="0"+m),m.length==8&&(m="20"+m);var p=("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return u==-1&&d==-1&&h==-1?m:n==-1&&i==-1&&o==-1?p:m+"T"+p}var d5=(function(){var e={};e.version="1.2.0";function r(){for(var A=0,k=new Array(256),E=0;E!=256;++E)A=E,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,k[E]=A;return typeof Int32Array<"u"?new Int32Array(k):k}var a=r();function n(A){var k=0,E=0,L=0,H=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(L=0;L!=256;++L)H[L]=A[L];for(L=0;L!=256;++L)for(E=A[L],k=256+L;k<4096;k+=256)E=H[k]=E>>>8^A[E&255];var I=[];for(L=1;L!=16;++L)I[L-1]=typeof Int32Array<"u"?H.subarray(L*256,L*256+256):H.slice(L*256,L*256+256);return I}var i=n(a),o=i[0],u=i[1],d=i[2],h=i[3],m=i[4],p=i[5],v=i[6],y=i[7],N=i[8],j=i[9],b=i[10],w=i[11],T=i[12],D=i[13],_=i[14];function R(A,k){for(var E=k^-1,L=0,H=A.length;L<H;)E=E>>>8^a[(E^A.charCodeAt(L++))&255];return~E}function z(A,k){for(var E=k^-1,L=A.length-15,H=0;H<L;)E=_[A[H++]^E&255]^D[A[H++]^E>>8&255]^T[A[H++]^E>>16&255]^w[A[H++]^E>>>24]^b[A[H++]]^j[A[H++]]^N[A[H++]]^y[A[H++]]^v[A[H++]]^p[A[H++]]^m[A[H++]]^h[A[H++]]^d[A[H++]]^u[A[H++]]^o[A[H++]]^a[A[H++]];for(L+=15;H<L;)E=E>>>8^a[(E^A[H++])&255];return~E}function O(A,k){for(var E=k^-1,L=0,H=A.length,I=0,re=0;L<H;)I=A.charCodeAt(L++),I<128?E=E>>>8^a[(E^I)&255]:I<2048?(E=E>>>8^a[(E^(192|I>>6&31))&255],E=E>>>8^a[(E^(128|I&63))&255]):I>=55296&&I<57344?(I=(I&1023)+64,re=A.charCodeAt(L++)&1023,E=E>>>8^a[(E^(240|I>>8&7))&255],E=E>>>8^a[(E^(128|I>>2&63))&255],E=E>>>8^a[(E^(128|re>>6&15|(I&3)<<4))&255],E=E>>>8^a[(E^(128|re&63))&255]):(E=E>>>8^a[(E^(224|I>>12&15))&255],E=E>>>8^a[(E^(128|I>>6&63))&255],E=E>>>8^a[(E^(128|I&63))&255]);return~E}return e.table=a,e.bstr=R,e.buf=z,e.str=O,e})(),Qt=(function(){var r={};r.version="1.2.1";function a(M,Y){for(var B=M.split("/"),U=Y.split("/"),G=0,Q=0,ue=Math.min(B.length,U.length);G<ue;++G){if(Q=B[G].length-U[G].length)return Q;if(B[G]!=U[G])return B[G]<U[G]?-1:1}return B.length-U.length}function n(M){if(M.charAt(M.length-1)=="/")return M.slice(0,-1).indexOf("/")===-1?M:n(M.slice(0,-1));var Y=M.lastIndexOf("/");return Y===-1?M:M.slice(0,Y+1)}function i(M){if(M.charAt(M.length-1)=="/")return i(M.slice(0,-1));var Y=M.lastIndexOf("/");return Y===-1?M:M.slice(Y+1)}function o(M,Y){typeof Y=="string"&&(Y=new Date(Y));var B=Y.getHours();B=B<<6|Y.getMinutes(),B=B<<5|Y.getSeconds()>>>1,M.write_shift(2,B);var U=Y.getFullYear()-1980;U=U<<4|Y.getMonth()+1,U=U<<5|Y.getDate(),M.write_shift(2,U)}function u(M){var Y=M.read_shift(2)&65535,B=M.read_shift(2)&65535,U=new Date,G=B&31;B>>>=5;var Q=B&15;B>>>=4,U.setMilliseconds(0),U.setFullYear(B+1980),U.setMonth(Q-1),U.setDate(G);var ue=Y&31;Y>>>=5;var Se=Y&63;return Y>>>=6,U.setHours(Y),U.setMinutes(Se),U.setSeconds(ue<<1),U}function d(M){cr(M,0);for(var Y={},B=0;M.l<=M.length-4;){var U=M.read_shift(2),G=M.read_shift(2),Q=M.l+G,ue={};switch(U){case 21589:B=M.read_shift(1),B&1&&(ue.mtime=M.read_shift(4)),G>5&&(B&2&&(ue.atime=M.read_shift(4)),B&4&&(ue.ctime=M.read_shift(4))),ue.mtime&&(ue.mt=new Date(ue.mtime*1e3));break}M.l=Q,Y[U]=ue}return Y}var h;function m(){return h||(h={})}function p(M,Y){if(M[0]==80&&M[1]==75)return Dt(M,Y);if((M[0]|32)==109&&(M[1]|32)==105)return Hr(M,Y);if(M.length<512)throw new Error("CFB file size "+M.length+" < 512");var B=3,U=512,G=0,Q=0,ue=0,Se=0,de=0,pe=[],ae=M.slice(0,512);cr(ae,0);var V=v(ae);switch(B=V[0],B){case 3:U=512;break;case 4:U=4096;break;case 0:if(V[1]==0)return Dt(M,Y);default:throw new Error("Major Version: Expected 3 or 4 saw "+B)}U!==512&&(ae=M.slice(0,U),cr(ae,28));var le=M.slice(0,U);y(ae,B);var Ne=ae.read_shift(4,"i");if(B===3&&Ne!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ne);ae.l+=4,ue=ae.read_shift(4,"i"),ae.l+=4,ae.chk("00100000","Mini Stream Cutoff Size: "),Se=ae.read_shift(4,"i"),G=ae.read_shift(4,"i"),de=ae.read_shift(4,"i"),Q=ae.read_shift(4,"i");for(var Oe=-1,Ue=0;Ue<109&&(Oe=ae.read_shift(4,"i"),!(Oe<0));++Ue)pe[Ue]=Oe;var We=N(M,U);w(de,Q,We,U,pe);var Lt=D(We,ue,pe,U);Lt[ue].name="!Directory",G>0&&Se!==re&&(Lt[Se].name="!MiniFAT"),Lt[pe[0]].name="!FAT",Lt.fat_addrs=pe,Lt.ssz=U;var Wt={},la=[],pr=[],ba=[];_(ue,Lt,We,la,G,Wt,pr,Se),j(pr,ba,la),la.shift();var zs={FileIndex:pr,FullPaths:ba};return Y&&Y.raw&&(zs.raw={header:le,sectors:We}),zs}function v(M){if(M[M.l]==80&&M[M.l+1]==75)return[0,0];M.chk(ne,"Header Signature: "),M.l+=16;var Y=M.read_shift(2,"u");return[M.read_shift(2,"u"),Y]}function y(M,Y){var B=9;switch(M.l+=2,B=M.read_shift(2)){case 9:if(Y!=3)throw new Error("Sector Shift: Expected 9 saw "+B);break;case 12:if(Y!=4)throw new Error("Sector Shift: Expected 12 saw "+B);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+B)}M.chk("0600","Mini Sector Shift: "),M.chk("000000000000","Reserved: ")}function N(M,Y){for(var B=Math.ceil(M.length/Y)-1,U=[],G=1;G<B;++G)U[G-1]=M.slice(G*Y,(G+1)*Y);return U[B-1]=M.slice(B*Y),U}function j(M,Y,B){for(var U=0,G=0,Q=0,ue=0,Se=0,de=B.length,pe=[],ae=[];U<de;++U)pe[U]=ae[U]=U,Y[U]=B[U];for(;Se<ae.length;++Se)U=ae[Se],G=M[U].L,Q=M[U].R,ue=M[U].C,pe[U]===U&&(G!==-1&&pe[G]!==G&&(pe[U]=pe[G]),Q!==-1&&pe[Q]!==Q&&(pe[U]=pe[Q])),ue!==-1&&(pe[ue]=U),G!==-1&&U!=pe[U]&&(pe[G]=pe[U],ae.lastIndexOf(G)<Se&&ae.push(G)),Q!==-1&&U!=pe[U]&&(pe[Q]=pe[U],ae.lastIndexOf(Q)<Se&&ae.push(Q));for(U=1;U<de;++U)pe[U]===U&&(Q!==-1&&pe[Q]!==Q?pe[U]=pe[Q]:G!==-1&&pe[G]!==G&&(pe[U]=pe[G]));for(U=1;U<de;++U)if(M[U].type!==0){if(Se=U,Se!=pe[Se])do Se=pe[Se],Y[U]=Y[Se]+"/"+Y[U];while(Se!==0&&pe[Se]!==-1&&Se!=pe[Se]);pe[U]=-1}for(Y[0]+="/",U=1;U<de;++U)M[U].type!==2&&(Y[U]+="/")}function b(M,Y,B){for(var U=M.start,G=M.size,Q=[],ue=U;B&&G>0&&ue>=0;)Q.push(Y.slice(ue*I,ue*I+I)),G-=I,ue=El(B,ue*4);return Q.length===0?Qa(0):Hi(Q).slice(0,M.size)}function w(M,Y,B,U,G){var Q=re;if(M===re){if(Y!==0)throw new Error("DIFAT chain shorter than expected")}else if(M!==-1){var ue=B[M],Se=(U>>>2)-1;if(!ue)return;for(var de=0;de<Se&&(Q=El(ue,de*4))!==re;++de)G.push(Q);w(El(ue,U-4),Y-1,B,U,G)}}function T(M,Y,B,U,G){var Q=[],ue=[];G||(G=[]);var Se=U-1,de=0,pe=0;for(de=Y;de>=0;){G[de]=!0,Q[Q.length]=de,ue.push(M[de]);var ae=B[Math.floor(de*4/U)];if(pe=de*4&Se,U<4+pe)throw new Error("FAT boundary crossed: "+de+" 4 "+U);if(!M[ae])break;de=El(M[ae],pe)}return{nodes:Q,data:db([ue])}}function D(M,Y,B,U){var G=M.length,Q=[],ue=[],Se=[],de=[],pe=U-1,ae=0,V=0,le=0,Ne=0;for(ae=0;ae<G;++ae)if(Se=[],le=ae+Y,le>=G&&(le-=G),!ue[le]){de=[];var Oe=[];for(V=le;V>=0;){Oe[V]=!0,ue[V]=!0,Se[Se.length]=V,de.push(M[V]);var Ue=B[Math.floor(V*4/U)];if(Ne=V*4&pe,U<4+Ne)throw new Error("FAT boundary crossed: "+V+" 4 "+U);if(!M[Ue]||(V=El(M[Ue],Ne),Oe[V]))break}Q[le]={nodes:Se,data:db([de])}}return Q}function _(M,Y,B,U,G,Q,ue,Se){for(var de=0,pe=U.length?2:0,ae=Y[M].data,V=0,le=0,Ne;V<ae.length;V+=128){var Oe=ae.slice(V,V+128);cr(Oe,64),le=Oe.read_shift(2),Ne=eg(Oe,0,le-pe),U.push(Ne);var Ue={name:Ne,type:Oe.read_shift(1),color:Oe.read_shift(1),L:Oe.read_shift(4,"i"),R:Oe.read_shift(4,"i"),C:Oe.read_shift(4,"i"),clsid:Oe.read_shift(16),state:Oe.read_shift(4,"i"),start:0,size:0},We=Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2);We!==0&&(Ue.ct=R(Oe,Oe.l-8));var Lt=Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2)+Oe.read_shift(2);Lt!==0&&(Ue.mt=R(Oe,Oe.l-8)),Ue.start=Oe.read_shift(4,"i"),Ue.size=Oe.read_shift(4,"i"),Ue.size<0&&Ue.start<0&&(Ue.size=Ue.type=0,Ue.start=re,Ue.name=""),Ue.type===5?(de=Ue.start,G>0&&de!==re&&(Y[de].name="!StreamData")):Ue.size>=4096?(Ue.storage="fat",Y[Ue.start]===void 0&&(Y[Ue.start]=T(B,Ue.start,Y.fat_addrs,Y.ssz)),Y[Ue.start].name=Ue.name,Ue.content=Y[Ue.start].data.slice(0,Ue.size)):(Ue.storage="minifat",Ue.size<0?Ue.size=0:de!==re&&Ue.start!==re&&Y[de]&&(Ue.content=b(Ue,Y[de].data,(Y[Se]||{}).data))),Ue.content&&cr(Ue.content,0),Q[Ne]=Ue,ue.push(Ue)}}function R(M,Y){return new Date((hs(M,Y+4)/1e7*Math.pow(2,32)+hs(M,Y)/1e7-11644473600)*1e3)}function z(M,Y){return m(),p(h.readFileSync(M),Y)}function O(M,Y){var B=Y&&Y.type;switch(B||Kt&&Buffer.isBuffer(M)&&(B="buffer"),B||"base64"){case"file":return z(M,Y);case"base64":return p($s(vs(M)),Y);case"binary":return p($s(M),Y)}return p(M,Y)}function A(M,Y){var B=Y||{},U=B.root||"Root Entry";if(M.FullPaths||(M.FullPaths=[]),M.FileIndex||(M.FileIndex=[]),M.FullPaths.length!==M.FileIndex.length)throw new Error("inconsistent CFB structure");M.FullPaths.length===0&&(M.FullPaths[0]=U+"/",M.FileIndex[0]={name:U,type:5}),B.CLSID&&(M.FileIndex[0].clsid=B.CLSID),k(M)}function k(M){var Y="Sh33tJ5";if(!Qt.find(M,"/"+Y)){var B=Qa(4);B[0]=55,B[1]=B[3]=50,B[2]=54,M.FileIndex.push({name:Y,type:2,content:B,size:4,L:69,R:69,C:69}),M.FullPaths.push(M.FullPaths[0]+Y),E(M)}}function E(M,Y){A(M);for(var B=!1,U=!1,G=M.FullPaths.length-1;G>=0;--G){var Q=M.FileIndex[G];switch(Q.type){case 0:U?B=!0:(M.FileIndex.pop(),M.FullPaths.pop());break;case 1:case 2:case 5:U=!0,isNaN(Q.R*Q.L*Q.C)&&(B=!0),Q.R>-1&&Q.L>-1&&Q.R==Q.L&&(B=!0);break;default:B=!0;break}}if(!(!B&&!Y)){var ue=new Date(1987,1,19),Se=0,de=Object.create?Object.create(null):{},pe=[];for(G=0;G<M.FullPaths.length;++G)de[M.FullPaths[G]]=!0,M.FileIndex[G].type!==0&&pe.push([M.FullPaths[G],M.FileIndex[G]]);for(G=0;G<pe.length;++G){var ae=n(pe[G][0]);U=de[ae],U||(pe.push([ae,{name:i(ae).replace("/",""),type:1,clsid:W,ct:ue,mt:ue,content:null}]),de[ae]=!0)}for(pe.sort(function(Ne,Oe){return a(Ne[0],Oe[0])}),M.FullPaths=[],M.FileIndex=[],G=0;G<pe.length;++G)M.FullPaths[G]=pe[G][0],M.FileIndex[G]=pe[G][1];for(G=0;G<pe.length;++G){var V=M.FileIndex[G],le=M.FullPaths[G];if(V.name=i(le).replace("/",""),V.L=V.R=V.C=-(V.color=1),V.size=V.content?V.content.length:0,V.start=0,V.clsid=V.clsid||W,G===0)V.C=pe.length>1?1:-1,V.size=0,V.type=5;else if(le.slice(-1)=="/"){for(Se=G+1;Se<pe.length&&n(M.FullPaths[Se])!=le;++Se);for(V.C=Se>=pe.length?-1:Se,Se=G+1;Se<pe.length&&n(M.FullPaths[Se])!=n(le);++Se);V.R=Se>=pe.length?-1:Se,V.type=1}else n(M.FullPaths[G+1]||"")==n(le)&&(V.R=G+1),V.type=2}}}function L(M,Y){var B=Y||{};if(B.fileType=="mad")return nl(M,B);switch(E(M),B.fileType){case"zip":return Bt(M,B)}var U=(function(Ne){for(var Oe=0,Ue=0,We=0;We<Ne.FileIndex.length;++We){var Lt=Ne.FileIndex[We];if(Lt.content){var Wt=Lt.content.length;Wt>0&&(Wt<4096?Oe+=Wt+63>>6:Ue+=Wt+511>>9)}}for(var la=Ne.FullPaths.length+3>>2,pr=Oe+7>>3,ba=Oe+127>>7,zs=pr+Ue+la+ba,ss=zs+127>>7,lo=ss<=109?0:Math.ceil((ss-109)/127);zs+ss+lo+127>>7>ss;)lo=++ss<=109?0:Math.ceil((ss-109)/127);var Gr=[1,lo,ss,ba,la,Ue,Oe,0];return Ne.FileIndex[0].size=Oe<<6,Gr[7]=(Ne.FileIndex[0].start=Gr[0]+Gr[1]+Gr[2]+Gr[3]+Gr[4]+Gr[5])+(Gr[6]+7>>3),Gr})(M),G=Qa(U[7]<<9),Q=0,ue=0;{for(Q=0;Q<8;++Q)G.write_shift(1,ge[Q]);for(Q=0;Q<8;++Q)G.write_shift(2,0);for(G.write_shift(2,62),G.write_shift(2,3),G.write_shift(2,65534),G.write_shift(2,9),G.write_shift(2,6),Q=0;Q<3;++Q)G.write_shift(2,0);for(G.write_shift(4,0),G.write_shift(4,U[2]),G.write_shift(4,U[0]+U[1]+U[2]+U[3]-1),G.write_shift(4,0),G.write_shift(4,4096),G.write_shift(4,U[3]?U[0]+U[1]+U[2]-1:re),G.write_shift(4,U[3]),G.write_shift(-4,U[1]?U[0]-1:re),G.write_shift(4,U[1]),Q=0;Q<109;++Q)G.write_shift(-4,Q<U[2]?U[1]+Q:-1)}if(U[1])for(ue=0;ue<U[1];++ue){for(;Q<236+ue*127;++Q)G.write_shift(-4,Q<U[2]?U[1]+Q:-1);G.write_shift(-4,ue===U[1]-1?re:ue+1)}var Se=function(Ne){for(ue+=Ne;Q<ue-1;++Q)G.write_shift(-4,Q+1);Ne&&(++Q,G.write_shift(-4,re))};for(ue=Q=0,ue+=U[1];Q<ue;++Q)G.write_shift(-4,ee.DIFSECT);for(ue+=U[2];Q<ue;++Q)G.write_shift(-4,ee.FATSECT);Se(U[3]),Se(U[4]);for(var de=0,pe=0,ae=M.FileIndex[0];de<M.FileIndex.length;++de)ae=M.FileIndex[de],ae.content&&(pe=ae.content.length,!(pe<4096)&&(ae.start=ue,Se(pe+511>>9)));for(Se(U[6]+7>>3);G.l&511;)G.write_shift(-4,ee.ENDOFCHAIN);for(ue=Q=0,de=0;de<M.FileIndex.length;++de)ae=M.FileIndex[de],ae.content&&(pe=ae.content.length,!(!pe||pe>=4096)&&(ae.start=ue,Se(pe+63>>6)));for(;G.l&511;)G.write_shift(-4,ee.ENDOFCHAIN);for(Q=0;Q<U[4]<<2;++Q){var V=M.FullPaths[Q];if(!V||V.length===0){for(de=0;de<17;++de)G.write_shift(4,0);for(de=0;de<3;++de)G.write_shift(4,-1);for(de=0;de<12;++de)G.write_shift(4,0);continue}ae=M.FileIndex[Q],Q===0&&(ae.start=ae.size?ae.start-1:re);var le=Q===0&&B.root||ae.name;if(pe=2*(le.length+1),G.write_shift(64,le,"utf16le"),G.write_shift(2,pe),G.write_shift(1,ae.type),G.write_shift(1,ae.color),G.write_shift(-4,ae.L),G.write_shift(-4,ae.R),G.write_shift(-4,ae.C),ae.clsid)G.write_shift(16,ae.clsid,"hex");else for(de=0;de<4;++de)G.write_shift(4,0);G.write_shift(4,ae.state||0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,0),G.write_shift(4,ae.start),G.write_shift(4,ae.size),G.write_shift(4,0)}for(Q=1;Q<M.FileIndex.length;++Q)if(ae=M.FileIndex[Q],ae.size>=4096)if(G.l=ae.start+1<<9,Kt&&Buffer.isBuffer(ae.content))ae.content.copy(G,G.l,0,ae.size),G.l+=ae.size+511&-512;else{for(de=0;de<ae.size;++de)G.write_shift(1,ae.content[de]);for(;de&511;++de)G.write_shift(1,0)}for(Q=1;Q<M.FileIndex.length;++Q)if(ae=M.FileIndex[Q],ae.size>0&&ae.size<4096)if(Kt&&Buffer.isBuffer(ae.content))ae.content.copy(G,G.l,0,ae.size),G.l+=ae.size+63&-64;else{for(de=0;de<ae.size;++de)G.write_shift(1,ae.content[de]);for(;de&63;++de)G.write_shift(1,0)}if(Kt)G.l=G.length;else for(;G.l<G.length;)G.write_shift(1,0);return G}function H(M,Y){var B=M.FullPaths.map(function(de){return de.toUpperCase()}),U=B.map(function(de){var pe=de.split("/");return pe[pe.length-(de.slice(-1)=="/"?2:1)]}),G=!1;Y.charCodeAt(0)===47?(G=!0,Y=B[0].slice(0,-1)+Y):G=Y.indexOf("/")!==-1;var Q=Y.toUpperCase(),ue=G===!0?B.indexOf(Q):U.indexOf(Q);if(ue!==-1)return M.FileIndex[ue];var Se=!Q.match(uu);for(Q=Q.replace(Pr,""),Se&&(Q=Q.replace(uu,"!")),ue=0;ue<B.length;++ue)if((Se?B[ue].replace(uu,"!"):B[ue]).replace(Pr,"")==Q||(Se?U[ue].replace(uu,"!"):U[ue]).replace(Pr,"")==Q)return M.FileIndex[ue];return null}var I=64,re=-2,ne="d0cf11e0a1b11ae1",ge=[208,207,17,224,161,177,26,225],W="00000000000000000000000000000000",ee={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:re,FREESECT:-1,HEADER_SIGNATURE:ne,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:W,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function je(M,Y,B){m();var U=L(M,B);h.writeFileSync(Y,U)}function Z(M){for(var Y=new Array(M.length),B=0;B<M.length;++B)Y[B]=String.fromCharCode(M[B]);return Y.join("")}function De(M,Y){var B=L(M,Y);switch(Y&&Y.type||"buffer"){case"file":return m(),h.writeFileSync(Y.filename,B),B;case"binary":return typeof B=="string"?B:Z(B);case"base64":return Yj(typeof B=="string"?B:Z(B));case"buffer":if(Kt)return Buffer.isBuffer(B)?B:zl(B);case"array":return typeof B=="string"?$s(B):B}return B}var he;function P(M){try{var Y=M.InflateRaw,B=new Y;if(B._processChunk(new Uint8Array([3,0]),B._finishFlushFlag),B.bytesRead)he=M;else throw new Error("zlib does not expose bytesRead")}catch(U){console.error("cannot use native zlib: "+(U.message||U))}}function q(M,Y){if(!he)return ln(M,Y);var B=he.InflateRaw,U=new B,G=U._processChunk(M.slice(M.l),U._finishFlushFlag);return M.l+=U.bytesRead,G}function J(M){return he?he.deflateRawSync(M):wt(M)}var K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],xe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Fe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ae(M){var Y=(M<<1|M<<11)&139536|(M<<5|M<<15)&558144;return(Y>>16|Y>>8|Y)&255}for(var Ee=typeof Uint8Array<"u",we=Ee?new Uint8Array(256):[],Ge=0;Ge<256;++Ge)we[Ge]=Ae(Ge);function X(M,Y){var B=we[M&255];return Y<=8?B>>>8-Y:(B=B<<8|we[M>>8&255],Y<=16?B>>>16-Y:(B=B<<8|we[M>>16&255],B>>>24-Y))}function ht(M,Y){var B=Y&7,U=Y>>>3;return(M[U]|(B<=6?0:M[U+1]<<8))>>>B&3}function Ye(M,Y){var B=Y&7,U=Y>>>3;return(M[U]|(B<=5?0:M[U+1]<<8))>>>B&7}function Je(M,Y){var B=Y&7,U=Y>>>3;return(M[U]|(B<=4?0:M[U+1]<<8))>>>B&15}function qe(M,Y){var B=Y&7,U=Y>>>3;return(M[U]|(B<=3?0:M[U+1]<<8))>>>B&31}function Be(M,Y){var B=Y&7,U=Y>>>3;return(M[U]|(B<=1?0:M[U+1]<<8))>>>B&127}function $e(M,Y,B){var U=Y&7,G=Y>>>3,Q=(1<<B)-1,ue=M[G]>>>U;return B<8-U||(ue|=M[G+1]<<8-U,B<16-U)||(ue|=M[G+2]<<16-U,B<24-U)||(ue|=M[G+3]<<24-U),ue&Q}function St(M,Y,B){var U=Y&7,G=Y>>>3;return U<=5?M[G]|=(B&7)<<U:(M[G]|=B<<U&255,M[G+1]=(B&7)>>8-U),Y+3}function Jt(M,Y,B){var U=Y&7,G=Y>>>3;return B=(B&1)<<U,M[G]|=B,Y+1}function fa(M,Y,B){var U=Y&7,G=Y>>>3;return B<<=U,M[G]|=B&255,B>>>=8,M[G+1]=B,Y+8}function ze(M,Y,B){var U=Y&7,G=Y>>>3;return B<<=U,M[G]|=B&255,B>>>=8,M[G+1]=B&255,M[G+2]=B>>>8,Y+16}function vt(M,Y){var B=M.length,U=2*B>Y?2*B:Y+5,G=0;if(B>=Y)return M;if(Kt){var Q=Xj(U);if(M.copy)M.copy(Q);else for(;G<M.length;++G)Q[G]=M[G];return Q}else if(Ee){var ue=new Uint8Array(U);if(ue.set)ue.set(M);else for(;G<B;++G)ue[G]=M[G];return ue}return M.length=U,M}function tt(M){for(var Y=new Array(M),B=0;B<M;++B)Y[B]=0;return Y}function Qe(M,Y,B){var U=1,G=0,Q=0,ue=0,Se=0,de=M.length,pe=Ee?new Uint16Array(32):tt(32);for(Q=0;Q<32;++Q)pe[Q]=0;for(Q=de;Q<B;++Q)M[Q]=0;de=M.length;var ae=Ee?new Uint16Array(de):tt(de);for(Q=0;Q<de;++Q)pe[G=M[Q]]++,U<G&&(U=G),ae[Q]=0;for(pe[0]=0,Q=1;Q<=U;++Q)pe[Q+16]=Se=Se+pe[Q-1]<<1;for(Q=0;Q<de;++Q)Se=M[Q],Se!=0&&(ae[Q]=pe[Se+16]++);var V=0;for(Q=0;Q<de;++Q)if(V=M[Q],V!=0)for(Se=X(ae[Q],U)>>U-V,ue=(1<<U+4-V)-1;ue>=0;--ue)Y[Se|ue<<V]=V&15|Q<<4;return U}var ot=Ee?new Uint16Array(512):tt(512),bt=Ee?new Uint16Array(32):tt(32);if(!Ee){for(var Ut=0;Ut<512;++Ut)ot[Ut]=0;for(Ut=0;Ut<32;++Ut)bt[Ut]=0}(function(){for(var M=[],Y=0;Y<32;Y++)M.push(5);Qe(M,bt,32);var B=[];for(Y=0;Y<=143;Y++)B.push(8);for(;Y<=255;Y++)B.push(9);for(;Y<=279;Y++)B.push(7);for(;Y<=287;Y++)B.push(8);Qe(B,ot,288)})();var Ma=(function(){for(var Y=Ee?new Uint8Array(32768):[],B=0,U=0;B<Fe.length-1;++B)for(;U<Fe[B+1];++U)Y[U]=B;for(;U<32768;++U)Y[U]=29;var G=Ee?new Uint8Array(259):[];for(B=0,U=0;B<xe.length-1;++B)for(;U<xe[B+1];++U)G[U]=B;function Q(Se,de){for(var pe=0;pe<Se.length;){var ae=Math.min(65535,Se.length-pe),V=pe+ae==Se.length;for(de.write_shift(1,+V),de.write_shift(2,ae),de.write_shift(2,~ae&65535);ae-- >0;)de[de.l++]=Se[pe++]}return de.l}function ue(Se,de){for(var pe=0,ae=0,V=Ee?new Uint16Array(32768):[];ae<Se.length;){var le=Math.min(65535,Se.length-ae);if(le<10){for(pe=St(de,pe,+(ae+le==Se.length)),pe&7&&(pe+=8-(pe&7)),de.l=pe/8|0,de.write_shift(2,le),de.write_shift(2,~le&65535);le-- >0;)de[de.l++]=Se[ae++];pe=de.l*8;continue}pe=St(de,pe,+(ae+le==Se.length)+2);for(var Ne=0;le-- >0;){var Oe=Se[ae];Ne=(Ne<<5^Oe)&32767;var Ue=-1,We=0;if((Ue=V[Ne])&&(Ue|=ae&-32768,Ue>ae&&(Ue-=32768),Ue<ae))for(;Se[Ue+We]==Se[ae+We]&&We<250;)++We;if(We>2){Oe=G[We],Oe<=22?pe=fa(de,pe,we[Oe+1]>>1)-1:(fa(de,pe,3),pe+=5,fa(de,pe,we[Oe-23]>>5),pe+=3);var Lt=Oe<8?0:Oe-4>>2;Lt>0&&(ze(de,pe,We-xe[Oe]),pe+=Lt),Oe=Y[ae-Ue],pe=fa(de,pe,we[Oe]>>3),pe-=3;var Wt=Oe<4?0:Oe-2>>1;Wt>0&&(ze(de,pe,ae-Ue-Fe[Oe]),pe+=Wt);for(var la=0;la<We;++la)V[Ne]=ae&32767,Ne=(Ne<<5^Se[ae])&32767,++ae;le-=We-1}else Oe<=143?Oe=Oe+48:pe=Jt(de,pe,1),pe=fa(de,pe,we[Oe]),V[Ne]=ae&32767,++ae}pe=fa(de,pe,0)-1}return de.l=(pe+7)/8|0,de.l}return function(de,pe){return de.length<8?Q(de,pe):ue(de,pe)}})();function wt(M){var Y=Qa(50+Math.floor(M.length*1.1)),B=Ma(M,Y);return Y.slice(0,B)}var qt=Ee?new Uint16Array(32768):tt(32768),oa=Ee?new Uint16Array(32768):tt(32768),zt=Ee?new Uint16Array(128):tt(128),ia=1,Ca=1;function _a(M,Y){var B=qe(M,Y)+257;Y+=5;var U=qe(M,Y)+1;Y+=5;var G=Je(M,Y)+4;Y+=4;for(var Q=0,ue=Ee?new Uint8Array(19):tt(19),Se=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],de=1,pe=Ee?new Uint8Array(8):tt(8),ae=Ee?new Uint8Array(8):tt(8),V=ue.length,le=0;le<G;++le)ue[K[le]]=Q=Ye(M,Y),de<Q&&(de=Q),pe[Q]++,Y+=3;var Ne=0;for(pe[0]=0,le=1;le<=de;++le)ae[le]=Ne=Ne+pe[le-1]<<1;for(le=0;le<V;++le)(Ne=ue[le])!=0&&(Se[le]=ae[Ne]++);var Oe=0;for(le=0;le<V;++le)if(Oe=ue[le],Oe!=0){Ne=we[Se[le]]>>8-Oe;for(var Ue=(1<<7-Oe)-1;Ue>=0;--Ue)zt[Ne|Ue<<Oe]=Oe&7|le<<3}var We=[];for(de=1;We.length<B+U;)switch(Ne=zt[Be(M,Y)],Y+=Ne&7,Ne>>>=3){case 16:for(Q=3+ht(M,Y),Y+=2,Ne=We[We.length-1];Q-- >0;)We.push(Ne);break;case 17:for(Q=3+Ye(M,Y),Y+=3;Q-- >0;)We.push(0);break;case 18:for(Q=11+Be(M,Y),Y+=7;Q-- >0;)We.push(0);break;default:We.push(Ne),de<Ne&&(de=Ne);break}var Lt=We.slice(0,B),Wt=We.slice(B);for(le=B;le<286;++le)Lt[le]=0;for(le=U;le<30;++le)Wt[le]=0;return ia=Qe(Lt,qt,286),Ca=Qe(Wt,oa,30),Y}function nn(M,Y){if(M[0]==3&&!(M[1]&3))return[Zi(Y),2];for(var B=0,U=0,G=Xj(Y||1<<18),Q=0,ue=G.length>>>0,Se=0,de=0;(U&1)==0;){if(U=Ye(M,B),B+=3,U>>>1)U>>1==1?(Se=9,de=5):(B=_a(M,B),Se=ia,de=Ca);else{B&7&&(B+=8-(B&7));var pe=M[B>>>3]|M[(B>>>3)+1]<<8;if(B+=32,pe>0)for(!Y&&ue<Q+pe&&(G=vt(G,Q+pe),ue=G.length);pe-- >0;)G[Q++]=M[B>>>3],B+=8;continue}for(;;){!Y&&ue<Q+32767&&(G=vt(G,Q+32767),ue=G.length);var ae=$e(M,B,Se),V=U>>>1==1?ot[ae]:qt[ae];if(B+=V&15,V>>>=4,(V>>>8&255)===0)G[Q++]=V;else{if(V==256)break;V-=257;var le=V<8?0:V-4>>2;le>5&&(le=0);var Ne=Q+xe[V];le>0&&(Ne+=$e(M,B,le),B+=le),ae=$e(M,B,de),V=U>>>1==1?bt[ae]:oa[ae],B+=V&15,V>>>=4;var Oe=V<4?0:V-2>>1,Ue=Fe[V];for(Oe>0&&(Ue+=$e(M,B,Oe),B+=Oe),!Y&&ue<Ne&&(G=vt(G,Ne+100),ue=G.length);Q<Ne;)G[Q]=G[Q-Ue],++Q}}}return Y?[G,B+7>>>3]:[G.slice(0,Q),B+7>>>3]}function ln(M,Y){var B=M.slice(M.l||0),U=nn(B,Y);return M.l+=U[1],U[0]}function _t(M,Y){if(M)typeof console<"u"&&console.error(Y);else throw new Error(Y)}function Dt(M,Y){var B=M;cr(B,0);var U=[],G=[],Q={FileIndex:U,FullPaths:G};A(Q,{root:Y.root});for(var ue=B.length-4;(B[ue]!=80||B[ue+1]!=75||B[ue+2]!=5||B[ue+3]!=6)&&ue>=0;)--ue;B.l=ue+4,B.l+=4;var Se=B.read_shift(2);B.l+=6;var de=B.read_shift(4);for(B.l=de,ue=0;ue<Se;++ue){B.l+=20;var pe=B.read_shift(4),ae=B.read_shift(4),V=B.read_shift(2),le=B.read_shift(2),Ne=B.read_shift(2);B.l+=8;var Oe=B.read_shift(4),Ue=d(B.slice(B.l+V,B.l+V+le));B.l+=V+le+Ne;var We=B.l;B.l=Oe+4,ut(B,pe,ae,Q,Ue),B.l=We}return Q}function ut(M,Y,B,U,G){M.l+=2;var Q=M.read_shift(2),ue=M.read_shift(2),Se=u(M);if(Q&8257)throw new Error("Unsupported ZIP encryption");for(var de=M.read_shift(4),pe=M.read_shift(4),ae=M.read_shift(4),V=M.read_shift(2),le=M.read_shift(2),Ne="",Oe=0;Oe<V;++Oe)Ne+=String.fromCharCode(M[M.l++]);if(le){var Ue=d(M.slice(M.l,M.l+le));(Ue[21589]||{}).mt&&(Se=Ue[21589].mt),((G||{})[21589]||{}).mt&&(Se=G[21589].mt)}M.l+=le;var We=M.slice(M.l,M.l+pe);switch(ue){case 8:We=q(M,ae);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ue)}var Lt=!1;Q&8&&(de=M.read_shift(4),de==134695760&&(de=M.read_shift(4),Lt=!0),pe=M.read_shift(4),ae=M.read_shift(4)),pe!=Y&&_t(Lt,"Bad compressed size: "+Y+" != "+pe),ae!=B&&_t(Lt,"Bad uncompressed size: "+B+" != "+ae),Rn(U,Ne,We,{unsafe:!0,mt:Se})}function Bt(M,Y){var B=Y||{},U=[],G=[],Q=Qa(1),ue=B.compression?8:0,Se=0,de=0,pe=0,ae=0,V=0,le=M.FullPaths[0],Ne=le,Oe=M.FileIndex[0],Ue=[],We=0;for(de=1;de<M.FullPaths.length;++de)if(Ne=M.FullPaths[de].slice(le.length),Oe=M.FileIndex[de],!(!Oe.size||!Oe.content||Ne=="Sh33tJ5")){var Lt=ae,Wt=Qa(Ne.length);for(pe=0;pe<Ne.length;++pe)Wt.write_shift(1,Ne.charCodeAt(pe)&127);Wt=Wt.slice(0,Wt.l),Ue[V]=d5.buf(Oe.content,0);var la=Oe.content;ue==8&&(la=J(la)),Q=Qa(30),Q.write_shift(4,67324752),Q.write_shift(2,20),Q.write_shift(2,Se),Q.write_shift(2,ue),Oe.mt?o(Q,Oe.mt):Q.write_shift(4,0),Q.write_shift(-4,Ue[V]),Q.write_shift(4,la.length),Q.write_shift(4,Oe.content.length),Q.write_shift(2,Wt.length),Q.write_shift(2,0),ae+=Q.length,U.push(Q),ae+=Wt.length,U.push(Wt),ae+=la.length,U.push(la),Q=Qa(46),Q.write_shift(4,33639248),Q.write_shift(2,0),Q.write_shift(2,20),Q.write_shift(2,Se),Q.write_shift(2,ue),Q.write_shift(4,0),Q.write_shift(-4,Ue[V]),Q.write_shift(4,la.length),Q.write_shift(4,Oe.content.length),Q.write_shift(2,Wt.length),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(4,0),Q.write_shift(4,Lt),We+=Q.l,G.push(Q),We+=Wt.length,G.push(Wt),++V}return Q=Qa(22),Q.write_shift(4,101010256),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(2,V),Q.write_shift(2,V),Q.write_shift(4,We),Q.write_shift(4,ae),Q.write_shift(2,0),Hi([Hi(U),Hi(G),Q])}var aa={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ot(M,Y){if(M.ctype)return M.ctype;var B=M.name||"",U=B.match(/\.([^\.]+)$/);return U&&aa[U[1]]||Y&&(U=(B=Y).match(/[\.\\]([^\.\\])+$/),U&&aa[U[1]])?aa[U[1]]:"application/octet-stream"}function Bs(M){for(var Y=Yj(M),B=[],U=0;U<Y.length;U+=76)B.push(Y.slice(U,U+76));return B.join(`\r
`)+`\r
`}function ja(M){var Y=M.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(pe){var ae=pe.charCodeAt(0).toString(16).toUpperCase();return"="+(ae.length==1?"0"+ae:ae)});Y=Y.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Y.charAt(0)==`
`&&(Y="=0D"+Y.slice(1)),Y=Y.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var B=[],U=Y.split(`\r
`),G=0;G<U.length;++G){var Q=U[G];if(Q.length==0){B.push("");continue}for(var ue=0;ue<Q.length;){var Se=76,de=Q.slice(ue,ue+Se);de.charAt(Se-1)=="="?Se--:de.charAt(Se-2)=="="?Se-=2:de.charAt(Se-3)=="="&&(Se-=3),de=Q.slice(ue,ue+Se),ue+=Se,ue<Q.length&&(de+="="),B.push(de)}}return B.join(`\r
`)}function as(M){for(var Y=[],B=0;B<M.length;++B){for(var U=M[B];B<=M.length&&U.charAt(U.length-1)=="=";)U=U.slice(0,U.length-1)+M[++B];Y.push(U)}for(var G=0;G<Y.length;++G)Y[G]=Y[G].replace(/[=][0-9A-Fa-f]{2}/g,function(Q){return String.fromCharCode(parseInt(Q.slice(1),16))});return $s(Y.join(`\r
`))}function Us(M,Y,B){for(var U="",G="",Q="",ue,Se=0;Se<10;++Se){var de=Y[Se];if(!de||de.match(/^\s*$/))break;var pe=de.match(/^(.*?):\s*([^\s].*)$/);if(pe)switch(pe[1].toLowerCase()){case"content-location":U=pe[2].trim();break;case"content-type":Q=pe[2].trim();break;case"content-transfer-encoding":G=pe[2].trim();break}}switch(++Se,G.toLowerCase()){case"base64":ue=$s(vs(Y.slice(Se).join("")));break;case"quoted-printable":ue=as(Y.slice(Se));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+G)}var ae=Rn(M,U.slice(B.length),ue,{unsafe:!0});Q&&(ae.ctype=Q)}function Hr(M,Y){if(Z(M.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var B=Y&&Y.root||"",U=(Kt&&Buffer.isBuffer(M)?M.toString("binary"):Z(M)).split(`\r
`),G=0,Q="";for(G=0;G<U.length;++G)if(Q=U[G],!!/^Content-Location:/i.test(Q)&&(Q=Q.slice(Q.indexOf("file")),B||(B=Q.slice(0,Q.lastIndexOf("/")+1)),Q.slice(0,B.length)!=B))for(;B.length>0&&(B=B.slice(0,B.length-1),B=B.slice(0,B.lastIndexOf("/")+1),Q.slice(0,B.length)!=B););var ue=(U[1]||"").match(/boundary="(.*?)"/);if(!ue)throw new Error("MAD cannot find boundary");var Se="--"+(ue[1]||""),de=[],pe=[],ae={FileIndex:de,FullPaths:pe};A(ae);var V,le=0;for(G=0;G<U.length;++G){var Ne=U[G];Ne!==Se&&Ne!==Se+"--"||(le++&&Us(ae,U.slice(V,G),B),V=G)}return ae}function nl(M,Y){var B=Y||{},U=B.boundary||"SheetJS";U="------="+U;for(var G=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+U.slice(2)+'"',"","",""],Q=M.FullPaths[0],ue=Q,Se=M.FileIndex[0],de=1;de<M.FullPaths.length;++de)if(ue=M.FullPaths[de].slice(Q.length),Se=M.FileIndex[de],!(!Se.size||!Se.content||ue=="Sh33tJ5")){ue=ue.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(We){return"_x"+We.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(We){return"_u"+We.charCodeAt(0).toString(16)+"_"});for(var pe=Se.content,ae=Kt&&Buffer.isBuffer(pe)?pe.toString("binary"):Z(pe),V=0,le=Math.min(1024,ae.length),Ne=0,Oe=0;Oe<=le;++Oe)(Ne=ae.charCodeAt(Oe))>=32&&Ne<128&&++V;var Ue=V>=le*4/5;G.push(U),G.push("Content-Location: "+(B.root||"file:///C:/SheetJS/")+ue),G.push("Content-Transfer-Encoding: "+(Ue?"quoted-printable":"base64")),G.push("Content-Type: "+Ot(Se,ue)),G.push(""),G.push(Ue?ja(ae):Bs(ae))}return G.push(U+`--\r
`),G.join(`\r
`)}function il(M){var Y={};return A(Y,M),Y}function Rn(M,Y,B,U){var G=U&&U.unsafe;G||A(M);var Q=!G&&Qt.find(M,Y);if(!Q){var ue=M.FullPaths[0];Y.slice(0,ue.length)==ue?ue=Y:(ue.slice(-1)!="/"&&(ue+="/"),ue=(ue+Y).replace("//","/")),Q={name:i(Y),type:2},M.FileIndex.push(Q),M.FullPaths.push(ue),G||Qt.utils.cfb_gc(M)}return Q.content=B,Q.size=B?B.length:0,U&&(U.CLSID&&(Q.clsid=U.CLSID),U.mt&&(Q.mt=U.mt),U.ct&&(Q.ct=U.ct)),Q}function Yl(M,Y){A(M);var B=Qt.find(M,Y);if(B){for(var U=0;U<M.FileIndex.length;++U)if(M.FileIndex[U]==B)return M.FileIndex.splice(U,1),M.FullPaths.splice(U,1),!0}return!1}function xr(M,Y,B){A(M);var U=Qt.find(M,Y);if(U){for(var G=0;G<M.FileIndex.length;++G)if(M.FileIndex[G]==U)return M.FileIndex[G].name=i(B),M.FullPaths[G]=B,!0}return!1}function rs(M){E(M,!0)}return r.find=H,r.read=O,r.parse=p,r.write=De,r.writeFile=je,r.utils={cfb_new:il,cfb_add:Rn,cfb_del:Yl,cfb_mov:xr,cfb_gc:rs,ReadShift:pu,CheckField:yS,prep_blob:cr,bconcat:Hi,use_zlib:P,_deflateRaw:wt,_inflateRaw:ln,consts:ee},r})();function f5(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var a=r.read();return r.close(),a}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function wn(e){for(var r=Object.keys(e),a=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&a.push(r[n]);return a}function Kp(e){for(var r=[],a=wn(e),n=0;n!==a.length;++n)r[e[a[n]]]=a[n];return r}var f0=new Date(1899,11,30,0,0,0);function Ur(e,r){var a=e.getTime(),n=f0.getTime()+(e.getTimezoneOffset()-f0.getTimezoneOffset())*6e4;return(a-n)/(1440*60*1e3)}var Zw=new Date,h5=f0.getTime()+(Zw.getTimezoneOffset()-f0.getTimezoneOffset())*6e4,ab=Zw.getTimezoneOffset();function L0(e){var r=new Date;return r.setTime(e*24*60*60*1e3+h5),r.getTimezoneOffset()!==ab&&r.setTime(r.getTime()+(r.getTimezoneOffset()-ab)*6e4),r}function m5(e){var r=0,a=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=i.length;++o)if(i[o]){switch(a=1,o>3&&(n=!0),i[o].slice(i[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[o].slice(i[o].length-1));case"D":a*=24;case"H":a*=60;case"M":if(n)a*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=a*parseInt(i[o],10)}return r}var rb=new Date("2017-02-19T19:06:09.000Z"),Jw=isNaN(rb.getFullYear())?new Date("2/19/17"):rb,x5=Jw.getFullYear()==2017;function ar(e,r){var a=new Date(e);if(x5)return r>0?a.setTime(a.getTime()+a.getTimezoneOffset()*60*1e3):r<0&&a.setTime(a.getTime()-a.getTimezoneOffset()*60*1e3),a;if(e instanceof Date)return e;if(Jw.getFullYear()==1917&&!isNaN(a.getFullYear())){var n=a.getFullYear();return e.indexOf(""+n)>-1||a.setFullYear(a.getFullYear()+100),a}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function Ml(e,r){if(Kt&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return fu(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return fu(Bw(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return fu(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return fu(new TextDecoder("utf-16be").decode(e.slice(2)))}var a={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(o){return a[o]||o})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function ur(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=ur(e[a]));return r}function Oa(e,r){for(var a="";a.length<r;)a+=e;return a}function en(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var a=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return a*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,o){return a=-a,o}),!isNaN(r=Number(n)))?r/a:r}var p5=["january","february","march","april","may","june","july","august","september","october","november","december"];function Hc(e){var r=new Date(e),a=new Date(NaN),n=r.getYear(),i=r.getMonth(),o=r.getDate();if(isNaN(o))return a;var u=e.toLowerCase();if(u.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(u=u.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),u.length>3&&p5.indexOf(u)==-1)return a}else if(u.match(/[a-z]/))return a;return n<0||n>8099?a:(i>0||o>1)&&n!=101?r:e.match(/[^-0-9:,\/\\]/)?a:r}var g5=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(a,n,i){if(e||typeof n=="string")return a.split(n);for(var o=a.split(n),u=[o[0]],d=1;d<o.length;++d)u.push(i),u.push(o[d]);return u}})();function eS(e){return e?e.content&&e.type?Ml(e.content,!0):e.data?ou(e.data):e.asNodeBuffer&&Kt?ou(e.asNodeBuffer().toString("binary")):e.asBinary?ou(e.asBinary()):e._data&&e._data.getContent?ou(Ml(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function tS(e){if(!e)return null;if(e.data)return qj(e.data);if(e.asNodeBuffer&&Kt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?qj(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function v5(e){return e&&e.name.slice(-4)===".bin"?tS(e):eS(e)}function Os(e,r){for(var a=e.FullPaths||wn(e.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),o=0;o<a.length;++o){var u=a[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==u||i==u)return e.files?e.files[a[o]]:e.FileIndex[o]}return null}function Qp(e,r){var a=Os(e,r);if(a==null)throw new Error("Cannot find file "+r+" in zip");return a}function qa(e,r,a){if(!a)return v5(Qp(e,r));if(!r)return null;try{return qa(e,r)}catch{return null}}function ms(e,r,a){if(!a)return eS(Qp(e,r));if(!r)return null;try{return ms(e,r)}catch{return null}}function y5(e,r,a){return tS(Qp(e,r))}function sb(e){for(var r=e.FullPaths||wn(e.files),a=[],n=0;n<r.length;++n)r[n].slice(-1)!="/"&&a.push(r[n].replace(/^Root Entry[\/]/,""));return a.sort()}function j5(e,r,a){if(e.FullPaths){if(typeof a=="string"){var n;return Kt?n=zl(a):n=BR(a),Qt.utils.cfb_add(e,r,n)}Qt.utils.cfb_add(e,r,a)}else e.file(r,a)}function aS(e,r){switch(r.type){case"base64":return Qt.read(e,{type:"base64"});case"binary":return Qt.read(e,{type:"binary"});case"buffer":case"array":return Qt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function du(e,r){if(e.charAt(0)=="/")return e.slice(1);var a=r.split("/");r.slice(-1)!="/"&&a.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?a.pop():i!=="."&&a.push(i)}return a.join("/")}var rS=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,b5=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,nb=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,N5=/<[^>]*>/g,Cr=rS.match(nb)?nb:N5,w5=/<\w*:/,S5=/<(\/?)\w+:/;function Et(e,r,a){for(var n={},i=0,o=0;i!==e.length&&!((o=e.charCodeAt(i))===32||o===10||o===13);++i);if(r||(n[0]=e.slice(0,i)),i===e.length)return n;var u=e.match(b5),d=0,h="",m=0,p="",v="",y=1;if(u)for(m=0;m!=u.length;++m){for(v=u[m],o=0;o!=v.length&&v.charCodeAt(o)!==61;++o);for(p=v.slice(0,o).trim();v.charCodeAt(o+1)==32;)++o;for(y=(i=v.charCodeAt(o+1))==34||i==39?1:0,h=v.slice(o+1+y,v.length-y),d=0;d!=p.length&&p.charCodeAt(d)!==58;++d);if(d===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),n[p]=h,n[p.toLowerCase()]=h;else{var N=(d===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(d+1);if(n[N]&&p.slice(d-3,d)=="ext")continue;n[N]=h,n[N.toLowerCase()]=h}}return n}function Cn(e){return e.replace(S5,"<$1")}var sS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},_5=Kp(sS),ea=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function a(n){var i=n+"",o=i.indexOf("<![CDATA[");if(o==-1)return i.replace(e,function(d,h){return sS[d]||String.fromCharCode(parseInt(h,d.indexOf("x")>-1?16:10))||d}).replace(r,function(d,h){return String.fromCharCode(parseInt(h,16))});var u=i.indexOf("]]>");return a(i.slice(0,o))+i.slice(o+9,u)+a(i.slice(u+3))}})(),E5=/[&<>'"]/g,T5=/[\u0000-\u001f]/g;function Zp(e){var r=e+"";return r.replace(E5,function(a){return _5[a]}).replace(/\n/g,"<br/>").replace(T5,function(a){return"&#x"+("000"+a.charCodeAt(0).toString(16)).slice(-4)+";"})}var ib=(function(){var e=/&#(\d+);/g;function r(a,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,r)}})();function Ta(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function xx(e){for(var r="",a=0,n=0,i=0,o=0,u=0,d=0;a<e.length;){if(n=e.charCodeAt(a++),n<128){r+=String.fromCharCode(n);continue}if(i=e.charCodeAt(a++),n>191&&n<224){u=(n&31)<<6,u|=i&63,r+=String.fromCharCode(u);continue}if(o=e.charCodeAt(a++),n<240){r+=String.fromCharCode((n&15)<<12|(i&63)<<6|o&63);continue}u=e.charCodeAt(a++),d=((n&7)<<18|(i&63)<<12|(o&63)<<6|u&63)-65536,r+=String.fromCharCode(55296+(d>>>10&1023)),r+=String.fromCharCode(56320+(d&1023))}return r}function lb(e){var r=Zi(2*e.length),a,n,i=1,o=0,u=0,d;for(n=0;n<e.length;n+=i)i=1,(d=e.charCodeAt(n))<128?a=d:d<224?(a=(d&31)*64+(e.charCodeAt(n+1)&63),i=2):d<240?(a=(d&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,a=(d&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),a-=65536,u=55296+(a>>>10&1023),a=56320+(a&1023)),u!==0&&(r[o++]=u&255,r[o++]=u>>>8,u=0),r[o++]=a%256,r[o++]=a>>>8;return r.slice(0,o).toString("ucs2")}function cb(e){return zl(e,"binary").toString("utf8")}var Of="foo bar baz",va=Kt&&(cb(Of)==xx(Of)&&cb||lb(Of)==xx(Of)&&lb)||xx,fu=Kt?function(e){return zl(e,"utf8").toString("binary")}:function(e){for(var r=[],a=0,n=0,i=0;a<e.length;)switch(n=e.charCodeAt(a++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(a++)-56320+(n<<10),r.push(String.fromCharCode(240+(i>>18&7))),r.push(String.fromCharCode(144+(i>>12&63))),r.push(String.fromCharCode(128+(i>>6&63))),r.push(String.fromCharCode(128+(i&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},Iu=(function(){var e={};return function(a,n){var i=a+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+a+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+a+">",n||"")}})(),nS=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(a){for(var n=a.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}})(),C5=(function(){var e={};return function(a){return e[a]!==void 0?e[a]:e[a]=new RegExp("<(?:vt:)?"+a+">([\\s\\S]*?)</(?:vt:)?"+a+">","g")}})(),A5=/<\/?(?:vt:)?variant>/g,k5=/<(?:vt:)([^>]*)>([\s\S]*)</;function ob(e,r){var a=Et(e),n=e.match(C5(a.baseType))||[],i=[];if(n.length!=a.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+a.size);return i}return n.forEach(function(o){var u=o.replace(A5,"").match(k5);u&&i.push({v:va(u[2]),t:u[1]})}),i}var D5=/(^\s|\s$|\n)/;function O5(e){return wn(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function R5(e,r,a){return"<"+e+(a!=null?O5(a):"")+(r!=null?(r.match(D5)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function Jp(e){if(Kt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return va(Vl(Yp(e)));throw new Error("Bad input format: expected Buffer or string")}var Lu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,M5={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},F5=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function I5(e,r){for(var a=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),i=e[r+6]&15,o=5;o>=0;--o)i=i*256+e[r+o];return n==2047?i==0?a*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),a*Math.pow(2,n-52)*i)}function L5(e,r,a){var n=(r<0||1/r==-1/0?1:0)<<7,i=0,o=0,u=n?-r:r;isFinite(u)?u==0?i=o=0:(i=Math.floor(Math.log(u)/Math.LN2),o=u*Math.pow(2,52-i),i<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?i=-1022:(o-=Math.pow(2,52),i+=1023)):(i=2047,o=isNaN(r)?26985:0);for(var d=0;d<=5;++d,o/=256)e[a+d]=o&255;e[a+6]=(i&15)<<4|o&15,e[a+7]=i>>4|n}var ub=function(e){for(var r=[],a=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,o=e[0][n].length;i<o;i+=a)r.push.apply(r,e[0][n].slice(i,i+a));return r},db=Kt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:zl(r)})):ub(e)}:ub,fb=function(e,r,a){for(var n=[],i=r;i<a;i+=2)n.push(String.fromCharCode(ti(e,i)));return n.join("").replace(Pr,"")},eg=Kt?function(e,r,a){return Buffer.isBuffer(e)?e.toString("utf16le",r,a).replace(Pr,""):fb(e,r,a)}:fb,hb=function(e,r,a){for(var n=[],i=r;i<r+a;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},iS=Kt?function(e,r,a){return Buffer.isBuffer(e)?e.toString("hex",r,r+a):hb(e,r,a)}:hb,mb=function(e,r,a){for(var n=[],i=r;i<a;i++)n.push(String.fromCharCode(Oc(e,i)));return n.join("")},nd=Kt?function(r,a,n){return Buffer.isBuffer(r)?r.toString("utf8",a,n):mb(r,a,n)}:mb,lS=function(e,r){var a=hs(e,r);return a>0?nd(e,r+4,r+4+a-1):""},cS=lS,oS=function(e,r){var a=hs(e,r);return a>0?nd(e,r+4,r+4+a-1):""},uS=oS,dS=function(e,r){var a=2*hs(e,r);return a>0?nd(e,r+4,r+4+a-1):""},fS=dS,hS=function(r,a){var n=hs(r,a);return n>0?eg(r,a+4,a+4+n):""},mS=hS,xS=function(e,r){var a=hs(e,r);return a>0?nd(e,r+4,r+4+a):""},pS=xS,gS=function(e,r){return I5(e,r)},h0=gS,vS=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};Kt&&(cS=function(r,a){if(!Buffer.isBuffer(r))return lS(r,a);var n=r.readUInt32LE(a);return n>0?r.toString("utf8",a+4,a+4+n-1):""},uS=function(r,a){if(!Buffer.isBuffer(r))return oS(r,a);var n=r.readUInt32LE(a);return n>0?r.toString("utf8",a+4,a+4+n-1):""},fS=function(r,a){if(!Buffer.isBuffer(r))return dS(r,a);var n=2*r.readUInt32LE(a);return r.toString("utf16le",a+4,a+4+n-1)},mS=function(r,a){if(!Buffer.isBuffer(r))return hS(r,a);var n=r.readUInt32LE(a);return r.toString("utf16le",a+4,a+4+n)},pS=function(r,a){if(!Buffer.isBuffer(r))return xS(r,a);var n=r.readUInt32LE(a);return r.toString("utf8",a+4,a+4+n)},h0=function(r,a){return Buffer.isBuffer(r)?r.readDoubleLE(a):gS(r,a)},vS=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var Oc=function(e,r){return e[r]},ti=function(e,r){return e[r+1]*256+e[r]},P5=function(e,r){var a=e[r+1]*256+e[r];return a<32768?a:(65535-a+1)*-1},hs=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},El=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},B5=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function pu(e,r){var a="",n,i,o=[],u,d,h,m;switch(r){case"dbcs":if(m=this.l,Kt&&Buffer.isBuffer(this))a=this.slice(this.l,this.l+2*e).toString("utf16le");else for(h=0;h<e;++h)a+=String.fromCharCode(ti(this,m)),m+=2;e*=2;break;case"utf8":a=nd(this,this.l,this.l+e);break;case"utf16le":e*=2,a=eg(this,this.l,this.l+e);break;case"wstr":return pu.call(this,e,"dbcs");case"lpstr-ansi":a=cS(this,this.l),e=4+hs(this,this.l);break;case"lpstr-cp":a=uS(this,this.l),e=4+hs(this,this.l);break;case"lpwstr":a=fS(this,this.l),e=4+2*hs(this,this.l);break;case"lpp4":e=4+hs(this,this.l),a=mS(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+hs(this,this.l),a=pS(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,a="";(u=Oc(this,this.l+e++))!==0;)o.push(Df(u));a=o.join("");break;case"_wstr":for(e=0,a="";(u=ti(this,this.l+e))!==0;)o.push(Df(u)),e+=2;e+=2,a=o.join("");break;case"dbcs-cont":for(a="",m=this.l,h=0;h<e;++h){if(this.lens&&this.lens.indexOf(m)!==-1)return u=Oc(this,m),this.l=m+1,d=pu.call(this,e-h,u?"dbcs-cont":"sbcs-cont"),o.join("")+d;o.push(Df(ti(this,m))),m+=2}a=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(a="",m=this.l,h=0;h!=e;++h){if(this.lens&&this.lens.indexOf(m)!==-1)return u=Oc(this,m),this.l=m+1,d=pu.call(this,e-h,u?"dbcs-cont":"sbcs-cont"),o.join("")+d;o.push(Df(Oc(this,m))),m+=1}a=o.join("");break;default:switch(e){case 1:return n=Oc(this,this.l),this.l++,n;case 2:return n=(r==="i"?P5:ti)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(n=(e>0?El:B5)(this,this.l),this.l+=4,n):(i=hs(this,this.l),this.l+=4,i);case 8:case-8:if(r==="f")return e==8?i=h0(this,this.l):i=h0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:a=iS(this,this.l,e);break}}return this.l+=e,a}var U5=function(e,r,a){e[a]=r&255,e[a+1]=r>>>8&255,e[a+2]=r>>>16&255,e[a+3]=r>>>24&255},z5=function(e,r,a){e[a]=r&255,e[a+1]=r>>8&255,e[a+2]=r>>16&255,e[a+3]=r>>24&255},V5=function(e,r,a){e[a]=r&255,e[a+1]=r>>>8&255};function H5(e,r,a){var n=0,i=0;if(a==="dbcs"){for(i=0;i!=r.length;++i)V5(this,r.charCodeAt(i),this.l+2*i);n=2*r.length}else if(a==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=r.length;++i)this[this.l+i]=r.charCodeAt(i)&255;n=r.length}else if(a==="hex"){for(;i<e;++i)this[this.l++]=parseInt(r.slice(2*i,2*i+2),16)||0;return this}else if(a==="utf16le"){var o=Math.min(this.l+e,this.length);for(i=0;i<Math.min(r.length,e);++i){var u=r.charCodeAt(i);this[this.l++]=u&255,this[this.l++]=u>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,U5(this,r,this.l);break;case 8:if(n=8,a==="f"){L5(this,r,this.l);break}case 16:break;case-4:n=4,z5(this,r,this.l);break}return this.l+=n,this}function yS(e,r){var a=iS(this,this.l,e.length>>1);if(a!==e)throw new Error(r+"Expected "+e+" saw "+a);this.l+=e.length>>1}function cr(e,r){e.l=r,e.read_shift=pu,e.chk=yS,e.write_shift=H5}function Er(e,r){e.l+=r}function Qa(e){var r=Zi(e);return cr(r,0),r}function pi(e,r,a){if(e){var n,i,o;cr(e,e.l||0);for(var u=e.length,d=0,h=0;e.l<u;){d=e.read_shift(1),d&128&&(d=(d&127)+((e.read_shift(1)&127)<<7));var m=y0[d]||y0[65535];for(n=e.read_shift(1),o=n&127,i=1;i<4&&n&128;++i)o+=((n=e.read_shift(1))&127)<<7*i;h=e.l+o;var p=m.f&&m.f(e,o,a);if(e.l=h,r(p,m,d))return}}}function Qx(){var e=[],r=Kt?256:2048,a=function(m){var p=Qa(m);return cr(p,0),p},n=a(r),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},o=function(m){return n&&m<n.length-n.l?n:(i(),n=a(Math.max(m+1,r)))},u=function(){return i(),Hi(e)},d=function(m){i(),n=m,n.l==null&&(n.l=n.length),o(r)};return{next:o,push:d,end:u,_bufs:e}}function gu(e,r,a){var n=ur(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!a||a.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function xb(e,r,a){var n=ur(e);return n.s=gu(n.s,r.s,a),n.e=gu(n.e,r.s,a),n}function vu(e,r){if(e.cRel&&e.c<0)for(e=ur(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=ur(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var a=Ct(e);return!e.cRel&&e.cRel!=null&&(a=W5(a)),!e.rRel&&e.rRel!=null&&(a=G5(a)),a}function px(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Za(e.s.c)+":"+(e.e.cRel?"":"$")+Za(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+dr(e.s.r)+":"+(e.e.rRel?"":"$")+dr(e.e.r):vu(e.s,r.biff)+":"+vu(e.e,r.biff)}function tg(e){return parseInt(q5(e),10)-1}function dr(e){return""+(e+1)}function G5(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function q5(e){return e.replace(/\$(\d+)$/,"$1")}function ag(e){for(var r=Y5(e),a=0,n=0;n!==r.length;++n)a=26*a+r.charCodeAt(n)-64;return a-1}function Za(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function W5(e){return e.replace(/^([A-Z])/,"$$$1")}function Y5(e){return e.replace(/^\$([A-Z])/,"$1")}function X5(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Lr(e){for(var r=0,a=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?r=10*r+(i-48):i>=65&&i<=90&&(a=26*a+(i-64))}return{c:a-1,r:r-1}}function Ct(e){for(var r=e.c+1,a="";r;r=(r-1)/26|0)a=String.fromCharCode((r-1)%26+65)+a;return a+(e.r+1)}function Zc(e){var r=e.indexOf(":");return r==-1?{s:Lr(e),e:Lr(e)}:{s:Lr(e.slice(0,r)),e:Lr(e.slice(r+1))}}function Zt(e,r){return typeof r>"u"||typeof r=="number"?Zt(e.s,e.e):(typeof e!="string"&&(e=Ct(e)),typeof r!="string"&&(r=Ct(r)),e==r?e:e+":"+r)}function Ra(e){var r={s:{c:0,r:0},e:{c:0,r:0}},a=0,n=0,i=0,o=e.length;for(a=0;n<o&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)a=26*a+i;for(r.s.c=--a,a=0;n<o&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)a=10*a+i;if(r.s.r=--a,n===o||i!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,a=0;n!=o&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)a=26*a+i;for(r.e.c=--a,a=0;n!=o&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)a=10*a+i;return r.e.r=--a,r}function pb(e,r){var a=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=Fs(e.z,a?Ur(r):r)}catch{}try{return e.w=Fs((e.XF||{}).numFmtId||(a?14:0),a?Ur(r):r)}catch{return""+r}}function fi(e,r,a){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&a&&a.dateNF&&(e.z=a.dateNF),e.t=="e"?ql[e.v]||e.v:r==null?pb(e,e.v):pb(e,r))}function sl(e,r){var a=r&&r.sheet?r.sheet:"Sheet1",n={};return n[a]=e,{SheetNames:[a],Sheets:n}}function jS(e,r,a){var n=a||{},i=e?Array.isArray(e):n.dense,o=e||(i?[]:{}),u=0,d=0;if(o&&n.origin!=null){if(typeof n.origin=="number")u=n.origin;else{var h=typeof n.origin=="string"?Lr(n.origin):n.origin;u=h.r,d=h.c}o["!ref"]||(o["!ref"]="A1:A1")}var m={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var p=Ra(o["!ref"]);m.s.c=p.s.c,m.s.r=p.s.r,m.e.c=Math.max(m.e.c,p.e.c),m.e.r=Math.max(m.e.r,p.e.r),u==-1&&(m.e.r=u=p.e.r+1)}for(var v=0;v!=r.length;++v)if(r[v]){if(!Array.isArray(r[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=r[v].length;++y)if(!(typeof r[v][y]>"u")){var N={v:r[v][y]},j=u+v,b=d+y;if(m.s.r>j&&(m.s.r=j),m.s.c>b&&(m.s.c=b),m.e.r<j&&(m.e.r=j),m.e.c<b&&(m.e.c=b),r[v][y]&&typeof r[v][y]=="object"&&!Array.isArray(r[v][y])&&!(r[v][y]instanceof Date))N=r[v][y];else if(Array.isArray(N.v)&&(N.f=r[v][y][1],N.v=N.v[0]),N.v===null)if(N.f)N.t="n";else if(n.nullError)N.t="e",N.v=0;else if(n.sheetStubs)N.t="z";else continue;else typeof N.v=="number"?N.t="n":typeof N.v=="boolean"?N.t="b":N.v instanceof Date?(N.z=n.dateNF||It[14],n.cellDates?(N.t="d",N.w=Fs(N.z,Ur(N.v))):(N.t="n",N.v=Ur(N.v),N.w=Fs(N.z,N.v))):N.t="s";if(i)o[j]||(o[j]=[]),o[j][b]&&o[j][b].z&&(N.z=o[j][b].z),o[j][b]=N;else{var w=Ct({c:b,r:j});o[w]&&o[w].z&&(N.z=o[w].z),o[w]=N}}}return m.s.c<1e7&&(o["!ref"]=Zt(m)),o}function Jc(e,r){return jS(null,e,r)}function $5(e){return e.read_shift(4,"i")}function Sr(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function K5(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function rg(e,r){var a=e.l,n=e.read_shift(1),i=Sr(e),o=[],u={t:i,h:i};if((n&1)!==0){for(var d=e.read_shift(4),h=0;h!=d;++h)o.push(K5(e));u.r=o}else u.r=[{ich:0,ifnt:0}];return e.l=a+r,u}var Q5=rg;function Ls(e){var r=e.read_shift(4),a=e.read_shift(2);return a+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:a}}function Hl(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}var Z5=Sr;function sg(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}var J5=Sr,Zx=sg;function ng(e){var r=e.slice(e.l,e.l+4),a=r[0]&1,n=r[0]&2;e.l+=4;var i=n===0?h0([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):El(r,0)>>2;return a?i/100:i}function bS(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}var Gl=bS;function br(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function e6(e){var r={},a=e.read_shift(1),n=a>>>1,i=e.read_shift(1),o=e.read_shift(2,"i"),u=e.read_shift(1),d=e.read_shift(1),h=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=i;var m=Dl[i];m&&(r.rgb=Bu(m));break;case 2:r.rgb=Bu([u,d,h]);break;case 3:r.theme=i;break}return o!=0&&(r.tint=o>0?o/32767:o/32768),r}function t6(e){var r=e.read_shift(1);e.l++;var a={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return a}function NS(e,r){var a={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return a[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function a6(e){return NS(e,1)}function r6(e){return NS(e,2)}var ig=2,Qr=3,Rf=11,gb=12,m0=19,Mf=64,s6=65,n6=71,i6=4108,l6=4126,tr=80,wS=81,c6=[tr,wS],o6={1:{n:"CodePage",t:ig},2:{n:"Category",t:tr},3:{n:"PresentationFormat",t:tr},4:{n:"ByteCount",t:Qr},5:{n:"LineCount",t:Qr},6:{n:"ParagraphCount",t:Qr},7:{n:"SlideCount",t:Qr},8:{n:"NoteCount",t:Qr},9:{n:"HiddenCount",t:Qr},10:{n:"MultimediaClipCount",t:Qr},11:{n:"ScaleCrop",t:Rf},12:{n:"HeadingPairs",t:i6},13:{n:"TitlesOfParts",t:l6},14:{n:"Manager",t:tr},15:{n:"Company",t:tr},16:{n:"LinksUpToDate",t:Rf},17:{n:"CharacterCount",t:Qr},19:{n:"SharedDoc",t:Rf},22:{n:"HyperlinksChanged",t:Rf},23:{n:"AppVersion",t:Qr,p:"version"},24:{n:"DigSig",t:s6},26:{n:"ContentType",t:tr},27:{n:"ContentStatus",t:tr},28:{n:"Language",t:tr},29:{n:"Version",t:tr},255:{},2147483648:{n:"Locale",t:m0},2147483651:{n:"Behavior",t:m0},1919054434:{}},u6={1:{n:"CodePage",t:ig},2:{n:"Title",t:tr},3:{n:"Subject",t:tr},4:{n:"Author",t:tr},5:{n:"Keywords",t:tr},6:{n:"Comments",t:tr},7:{n:"Template",t:tr},8:{n:"LastAuthor",t:tr},9:{n:"RevNumber",t:tr},10:{n:"EditTime",t:Mf},11:{n:"LastPrinted",t:Mf},12:{n:"CreatedDate",t:Mf},13:{n:"ModifiedDate",t:Mf},14:{n:"PageCount",t:Qr},15:{n:"WordCount",t:Qr},16:{n:"CharCount",t:Qr},17:{n:"Thumbnail",t:n6},18:{n:"Application",t:tr},19:{n:"DocSecurity",t:Qr},255:{},2147483648:{n:"Locale",t:m0},2147483651:{n:"Behavior",t:m0},1919054434:{}},vb={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},d6=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function f6(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var h6=f6([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Dl=ur(h6),ql={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},SS={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},yb={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function m6(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function x6(e){var r=m6();if(!e||!e.match)return r;var a={};if((e.match(Cr)||[]).forEach(function(n){var i=Et(n);switch(i[0].replace(w5,"<")){case"<?xml":break;case"<Types":r.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":a[i.Extension]=i.ContentType;break;case"<Override":r[yb[i.ContentType]]!==void 0&&r[yb[i.ContentType]].push(i.PartName);break}}),r.xmlns!==M5.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=a,delete r.calcchains,r}var Mc={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Jx(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function yu(e,r){var a={"!id":{}};if(!e)return a;r.charAt(0)!=="/"&&(r="/"+r);var n={};return(e.match(Cr)||[]).forEach(function(i){var o=Et(i);if(o[0]==="<Relationship"){var u={};u.Type=o.Type,u.Target=o.Target,u.Id=o.Id,o.TargetMode&&(u.TargetMode=o.TargetMode);var d=o.TargetMode==="External"?o.Target:du(o.Target,r);a[d]=u,n[o.Id]=u}}),a["!id"]=n,a}var p6="application/vnd.oasis.opendocument.spreadsheet";function g6(e,r){for(var a=Jp(e),n,i;n=Lu.exec(a);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Et(n[0],!1),i.path=="/"&&i.type!==p6)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}var ju=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],v6=(function(){for(var e=new Array(ju.length),r=0;r<ju.length;++r){var a=ju[r],n="(?:"+a[0].slice(0,a[0].indexOf(":"))+":)"+a[0].slice(a[0].indexOf(":")+1);e[r]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function _S(e){var r={};e=va(e);for(var a=0;a<ju.length;++a){var n=ju[a],i=e.match(v6[a]);i!=null&&i.length>0&&(r[n[1]]=ea(i[1])),n[2]==="date"&&r[n[1]]&&(r[n[1]]=ar(r[n[1]]))}return r}var y6=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function ES(e,r,a,n){var i=[];if(typeof e=="string")i=ob(e,n);else for(var o=0;o<e.length;++o)i=i.concat(e[o].map(function(p){return{v:p}}));var u=typeof r=="string"?ob(r,n).map(function(p){return p.v}):r,d=0,h=0;if(u.length>0)for(var m=0;m!==i.length;m+=2){switch(h=+i[m+1].v,i[m].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":a.Worksheets=h,a.SheetNames=u.slice(d,d+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":a.NamedRanges=h,a.DefinedNames=u.slice(d,d+h);break;case"Charts":case"Diagramme":a.Chartsheets=h,a.ChartNames=u.slice(d,d+h);break}d+=h}}function j6(e,r,a){var n={};return r||(r={}),e=va(e),y6.forEach(function(i){var o=(e.match(Iu(i[0]))||[])[1];switch(i[2]){case"string":o&&(r[i[1]]=ea(o));break;case"bool":r[i[1]]=o==="true";break;case"raw":var u=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));u&&u.length>0&&(n[i[1]]=u[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&ES(n.HeadingPairs,n.TitlesOfParts,r,a),r}var b6=/<[^>]+>[^<]*/g;function N6(e,r){var a={},n="",i=e.match(b6);if(i)for(var o=0;o!=i.length;++o){var u=i[o],d=Et(u);switch(d[0]){case"<?xml":break;case"<Properties":break;case"<property":n=ea(d.name);break;case"</property>":n=null;break;default:if(u.indexOf("<vt:")===0){var h=u.split(">"),m=h[0].slice(4),p=h[1];switch(m){case"lpstr":case"bstr":case"lpwstr":a[n]=ea(p);break;case"bool":a[n]=Ta(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":a[n]=parseInt(p,10);break;case"r4":case"r8":case"decimal":a[n]=parseFloat(p);break;case"filetime":case"date":a[n]=ar(p);break;case"cy":case"error":a[n]=ea(p);break;default:if(m.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",u,m,h)}}else if(u.slice(0,2)!=="</"){if(r.WTF)throw new Error(u)}}}return a}var w6={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},gx;function S6(e,r,a){gx||(gx=Kp(w6)),r=gx[r]||r,e[r]=a}function lg(e){var r=e.read_shift(4),a=e.read_shift(4);return new Date((a/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function TS(e,r,a){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(a)for(;e.l-n&3;)++e.l;return i}function CS(e,r,a){var n=e.read_shift(0,"lpwstr");return n}function AS(e,r,a){return r===31?CS(e):TS(e,r,a)}function ep(e,r,a){return AS(e,r,a===!1?0:4)}function _6(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return AS(e,r,0)}function E6(e){for(var r=e.read_shift(4),a=[],n=0;n!=r;++n){var i=e.l;a[n]=e.read_shift(0,"lpwstr").replace(Pr,""),e.l-i&2&&(e.l+=2)}return a}function T6(e){for(var r=e.read_shift(4),a=[],n=0;n!=r;++n)a[n]=e.read_shift(0,"lpstr-cp").replace(Pr,"");return a}function C6(e){var r=e.l,a=x0(e,wS);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var n=x0(e,Qr);return[a,n]}function A6(e){for(var r=e.read_shift(4),a=[],n=0;n<r/2;++n)a.push(C6(e));return a}function jb(e,r){for(var a=e.read_shift(4),n={},i=0;i!=a;++i){var o=e.read_shift(4),u=e.read_shift(4);n[o]=e.read_shift(u,r===1200?"utf16le":"utf8").replace(Pr,"").replace(uu,"!"),r===1200&&u%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function kS(e){var r=e.read_shift(4),a=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),a}function k6(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function x0(e,r,a){var n=e.read_shift(2),i,o=a||{};if(e.l+=2,r!==gb&&n!==r&&c6.indexOf(r)===-1&&!((r&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+r+" saw "+n);switch(r===gb?n:r){case 2:return i=e.read_shift(2,"i"),o.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return TS(e,n,4).replace(Pr,"");case 31:return CS(e);case 64:return lg(e);case 65:return kS(e);case 71:return k6(e);case 80:return ep(e,n,!o.raw).replace(Pr,"");case 81:return _6(e,n).replace(Pr,"");case 4108:return A6(e);case 4126:case 4127:return n==4127?E6(e):T6(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function bb(e,r){var a=e.l,n=e.read_shift(4),i=e.read_shift(4),o=[],u=0,d=0,h=-1,m={};for(u=0;u!=i;++u){var p=e.read_shift(4),v=e.read_shift(4);o[u]=[p,v+a]}o.sort(function(D,_){return D[1]-_[1]});var y={};for(u=0;u!=i;++u){if(e.l!==o[u][1]){var N=!0;if(u>0&&r)switch(r[o[u-1][0]].t){case 2:e.l+2===o[u][1]&&(e.l+=2,N=!1);break;case 80:e.l<=o[u][1]&&(e.l=o[u][1],N=!1);break;case 4108:e.l<=o[u][1]&&(e.l=o[u][1],N=!1);break}if((!r||u==0)&&e.l<=o[u][1]&&(N=!1,e.l=o[u][1]),N)throw new Error("Read Error: Expected address "+o[u][1]+" at "+e.l+" :"+u)}if(r){var j=r[o[u][0]];if(y[j.n]=x0(e,j.t,{raw:!0}),j.p==="version"&&(y[j.n]=String(y[j.n]>>16)+"."+("0000"+String(y[j.n]&65535)).slice(-4)),j.n=="CodePage")switch(y[j.n]){case 0:y[j.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Qs(d=y[j.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+y[j.n])}}else if(o[u][0]===1){if(d=y.CodePage=x0(e,ig),Qs(d),h!==-1){var b=e.l;e.l=o[h][1],m=jb(e,d),e.l=b}}else if(o[u][0]===0){if(d===0){h=u,e.l=o[u+1][1];continue}m=jb(e,d)}else{var w=m[o[u][0]],T;switch(e[e.l]){case 65:e.l+=4,T=kS(e);break;case 30:e.l+=4,T=ep(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,T=ep(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,T=e.read_shift(4,"i");break;case 19:e.l+=4,T=e.read_shift(4);break;case 5:e.l+=4,T=e.read_shift(8,"f");break;case 11:e.l+=4,T=La(e,4);break;case 64:e.l+=4,T=ar(lg(e));break;default:throw new Error("unparsed value: "+e[e.l])}y[w]=T}}return e.l=a+n,y}function Nb(e,r,a){var n=e.content;if(!n)return{};cr(n,0);var i,o,u,d,h=0;n.chk("feff","Byte Order: "),n.read_shift(2);var m=n.read_shift(4),p=n.read_shift(16);if(p!==Qt.utils.consts.HEADER_CLSID&&p!==a)throw new Error("Bad PropertySet CLSID "+p);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(o=n.read_shift(16),d=n.read_shift(4),i===1&&d!==n.l)throw new Error("Length mismatch: "+d+" !== "+n.l);i===2&&(u=n.read_shift(16),h=n.read_shift(4));var v=bb(n,r),y={SystemIdentifier:m};for(var N in v)y[N]=v[N];if(y.FMTID=o,i===1)return y;if(h-n.l==2&&(n.l+=2),n.l!==h)throw new Error("Length mismatch 2: "+n.l+" !== "+h);var j;try{j=bb(n,null)}catch{}for(N in j)y[N]=j[N];return y.FMTID=[o,u],y}function zi(e,r){return e.read_shift(r),null}function D6(e,r,a){for(var n=[],i=e.l+r;e.l<i;)n.push(a(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function La(e,r){return e.read_shift(r)===1}function Wa(e){return e.read_shift(2,"u")}function DS(e,r){return D6(e,r,Wa)}function O6(e){var r=e.read_shift(1),a=e.read_shift(1);return a===1?r:r===1}function id(e,r,a){var n=e.read_shift(a&&a.biff>=12?2:1),i="sbcs-cont";if(a&&a.biff>=8,!a||a.biff==8){var o=e.read_shift(1);o&&(i="dbcs-cont")}else a.biff==12&&(i="wstr");a.biff>=2&&a.biff<=5&&(i="cpstr");var u=n?e.read_shift(n,i):"";return u}function R6(e){var r=e.read_shift(2),a=e.read_shift(1),n=a&4,i=a&8,o=1+(a&1),u=0,d,h={};i&&(u=e.read_shift(2)),n&&(d=e.read_shift(4));var m=o==2?"dbcs-cont":"sbcs-cont",p=r===0?"":e.read_shift(r,m);return i&&(e.l+=4*u),n&&(e.l+=d),h.t=p,i||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function Fl(e,r,a){var n;if(a){if(a.biff>=2&&a.biff<=5)return e.read_shift(r,"cpstr");if(a.biff>=12)return e.read_shift(r,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function ld(e,r,a){var n=e.read_shift(a&&a.biff==2?1:2);return n===0?(e.l++,""):Fl(e,n,a)}function Wl(e,r,a){if(a.biff>5)return ld(e,r,a);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,a.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function M6(e){var r=e.read_shift(1);e.l++;var a=e.read_shift(2);return e.l+=2,[r,a]}function F6(e){var r=e.read_shift(4),a=e.l,n=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=a);var i=e.read_shift((n?r-24:r)>>1,"utf16le").replace(Pr,"");return n&&(e.l+=24),i}function I6(e){for(var r=e.read_shift(2),a="";r-- >0;)a+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return a+n.replace(/\\/g,"/");var o=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var u=e.read_shift(o>>1,"utf16le").replace(Pr,"");return a+u}function L6(e,r){var a=e.read_shift(16);switch(a){case"e0c9ea79f9bace118c8200aa004ba90b":return F6(e);case"0303000000000000c000000000000046":return I6(e);default:throw new Error("Unsupported Moniker "+a)}}function Ff(e){var r=e.read_shift(4),a=r>0?e.read_shift(r,"utf16le").replace(Pr,""):"";return a}function P6(e,r){var a=e.l+r,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var o,u,d,h,m="",p,v;i&16&&(o=Ff(e,a-e.l)),i&128&&(u=Ff(e,a-e.l)),(i&257)===257&&(d=Ff(e,a-e.l)),(i&257)===1&&(h=L6(e,a-e.l)),i&8&&(m=Ff(e,a-e.l)),i&32&&(p=e.read_shift(16)),i&64&&(v=lg(e)),e.l=a;var y=u||d||h||"";y&&m&&(y+="#"+m),y||(y="#"+m),i&2&&y.charAt(0)=="/"&&y.charAt(1)!="/"&&(y="file://"+y);var N={Target:y};return p&&(N.guid=p),v&&(N.time=v),o&&(N.Tooltip=o),N}function OS(e){var r=e.read_shift(1),a=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[r,a,n,i]}function RS(e,r){var a=OS(e);return a[3]=0,a}function An(e){var r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{r,c:a,ixfe:n}}function B6(e){var r=e.read_shift(2),a=e.read_shift(2);return e.l+=8,{type:r,flags:a}}function U6(e,r,a){return r===0?"":Wl(e,r,a)}function z6(e,r,a){var n=a.biff>8?4:2,i=e.read_shift(n),o=e.read_shift(n,"i"),u=e.read_shift(n,"i");return[i,o,u]}function MS(e){var r=e.read_shift(2),a=ng(e);return[r,a]}function V6(e,r,a){e.l+=4,r-=4;var n=e.l+r,i=id(e,r,a),o=e.read_shift(2);if(n-=e.l,o!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+o);return e.l+=o,i}function P0(e){var r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r},e:{c:i,r:a}}}function FS(e){var r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r},e:{c:i,r:a}}}var H6=FS;function IS(e){e.l+=4;var r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[a,r,n]}function G6(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function q6(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function gr(e){e.l+=2,e.l+=e.read_shift(2)}var W6={0:gr,4:gr,5:gr,6:gr,7:q6,8:gr,9:gr,10:gr,11:gr,12:gr,13:G6,14:gr,15:gr,16:gr,17:gr,18:gr,19:gr,20:gr,21:IS};function Y6(e,r){for(var a=e.l+r,n=[];e.l<a;){var i=e.read_shift(2);e.l-=2;try{n.push(W6[i](e,a-e.l))}catch{return e.l=a,n}}return e.l!=a&&(e.l=a),n}function If(e,r){var a={BIFFVer:0,dt:0};switch(a.BIFFVer=e.read_shift(2),r-=2,r>=2&&(a.dt=e.read_shift(2),e.l-=2),a.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+a.BIFFVer)}return e.read_shift(r),a}function X6(e,r){return r===0||e.read_shift(2),1200}function $6(e,r,a){if(a.enc)return e.l+=r,"";var n=e.l,i=Wl(e,0,a);return e.read_shift(r+n-e.l),i}function K6(e,r,a){var n=a&&a.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function Q6(e,r,a){var n=e.read_shift(4),i=e.read_shift(1)&3,o=e.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var u=id(e,0,a);return u.length===0&&(u="Sheet1"),{pos:n,hs:i,dt:o,name:u}}function Z6(e,r){for(var a=e.l+r,n=e.read_shift(4),i=e.read_shift(4),o=[],u=0;u!=i&&e.l<a;++u)o.push(R6(e));return o.Count=n,o.Unique=i,o}function J6(e,r){var a={};return a.dsst=e.read_shift(2),e.l+=r-2,a}function eM(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var a=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(r.level=n&7),n&32&&(r.hidden=!0),n&64&&(r.hpt=a/20),r}function tM(e){var r=B6(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var a=e.read_shift(4);return a!==0}function aM(e){return e.read_shift(2),e.read_shift(4)}function wb(e,r,a){var n=0;a&&a.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);a&&a.biff==2&&(n=1-(i>>15),i&=32767);var o={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[o,i]}function rM(e){var r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),u=e.read_shift(2),d=e.read_shift(2),h=e.read_shift(2),m=e.read_shift(2);return{Pos:[r,a],Dim:[n,i],Flags:o,CurTab:u,FirstTab:d,Selected:h,TabRatio:m}}function sM(e,r,a){if(a&&a.biff>=2&&a.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function nM(){}function iM(e,r,a){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(a&&a.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=id(e,0,a),n}function lM(e){var r=An(e);return r.isst=e.read_shift(4),r}function cM(e,r,a){a.biffguess&&a.biff==2&&(a.biff=5);var n=e.l+r,i=An(e);a.biff==2&&e.l++;var o=ld(e,n-e.l,a);return i.val=o,i}function oM(e,r,a){var n=e.read_shift(2),i=Wl(e,0,a);return[n,i]}var uM=Wl;function Sb(e,r,a){var n=e.l+r,i=a.biff==8||!a.biff?4:2,o=e.read_shift(i),u=e.read_shift(i),d=e.read_shift(2),h=e.read_shift(2);return e.l=n,{s:{r:o,c:d},e:{r:u,c:h}}}function dM(e){var r=e.read_shift(2),a=e.read_shift(2),n=MS(e);return{r,c:a,ixfe:n[0],rknum:n[1]}}function fM(e,r){for(var a=e.l+r-2,n=e.read_shift(2),i=e.read_shift(2),o=[];e.l<a;)o.push(MS(e));if(e.l!==a)throw new Error("MulRK read error");var u=e.read_shift(2);if(o.length!=u-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:u,rkrec:o}}function hM(e,r){for(var a=e.l+r-2,n=e.read_shift(2),i=e.read_shift(2),o=[];e.l<a;)o.push(e.read_shift(2));if(e.l!==a)throw new Error("MulBlank read error");var u=e.read_shift(2);if(o.length!=u-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:u,ixfe:o}}function mM(e,r,a,n){var i={},o=e.read_shift(4),u=e.read_shift(4),d=e.read_shift(4),h=e.read_shift(2);return i.patternType=d6[d>>26],n.cellStyles&&(i.alc=o&7,i.fWrap=o>>3&1,i.alcV=o>>4&7,i.fJustLast=o>>7&1,i.trot=o>>8&255,i.cIndent=o>>16&15,i.fShrinkToFit=o>>20&1,i.iReadOrder=o>>22&2,i.fAtrNum=o>>26&1,i.fAtrFnt=o>>27&1,i.fAtrAlc=o>>28&1,i.fAtrBdr=o>>29&1,i.fAtrPat=o>>30&1,i.fAtrProt=o>>31&1,i.dgLeft=u&15,i.dgRight=u>>4&15,i.dgTop=u>>8&15,i.dgBottom=u>>12&15,i.icvLeft=u>>16&127,i.icvRight=u>>23&127,i.grbitDiag=u>>30&3,i.icvTop=d&127,i.icvBottom=d>>7&127,i.icvDiag=d>>14&127,i.dgDiag=d>>21&15,i.icvFore=h&127,i.icvBack=h>>7&127,i.fsxButton=h>>14&1),i}function xM(e,r,a){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,r-=6,n.data=mM(e,r,n.fStyle,a),n}function pM(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function _b(e,r,a){var n=An(e);(a.biff==2||r==9)&&++e.l;var i=O6(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function gM(e,r,a){a.biffguess&&a.biff==2&&(a.biff=5);var n=An(e),i=br(e);return n.val=i,n}var Eb=U6;function vM(e,r,a){var n=e.l+r,i=e.read_shift(2),o=e.read_shift(2);if(a.sbcch=o,o==1025||o==14849)return[o,i];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var u=Fl(e,o),d=[];n>e.l;)d.push(ld(e));return[o,i,u,d]}function Tb(e,r,a){var n=e.read_shift(2),i,o={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return a.sbcch===14849&&(i=V6(e,r-2,a)),o.body=i||e.read_shift(r-2),typeof i=="string"&&(o.Name=i),o}var yM=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Cb(e,r,a){var n=e.l+r,i=e.read_shift(2),o=e.read_shift(1),u=e.read_shift(1),d=e.read_shift(a&&a.biff==2?1:2),h=0;(!a||a.biff>=5)&&(a.biff!=5&&(e.l+=2),h=e.read_shift(2),a.biff==5&&(e.l+=2),e.l+=4);var m=Fl(e,u,a);i&32&&(m=yM[m.charCodeAt(0)]);var p=n-e.l;a&&a.biff==2&&--p;var v=n==e.l||d===0||!(p>0)?[]:eL(e,p,a,d);return{chKey:o,Name:m,itab:h,rgce:v}}function LS(e,r,a){if(a.biff<8)return jM(e,r,a);for(var n=[],i=e.l+r,o=e.read_shift(a.biff>8?4:2);o--!==0;)n.push(z6(e,a.biff>8?12:6,a));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function jM(e,r,a){e[e.l+1]==3&&e[e.l]++;var n=id(e,r,a);return n.charCodeAt(0)==3?n.slice(1):n}function bM(e,r,a){if(a.biff<8){e.l+=r;return}var n=e.read_shift(2),i=e.read_shift(2),o=Fl(e,n,a),u=Fl(e,i,a);return[o,u]}function NM(e,r,a){var n=FS(e);e.l++;var i=e.read_shift(1);return r-=8,[tL(e,r,a),i,n]}function Ab(e,r,a){var n=H6(e);switch(a.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[n,ZI(e,r,a)]}function wM(e){var r=e.read_shift(4)!==0,a=e.read_shift(4)!==0,n=e.read_shift(4);return[r,a,n]}function SM(e,r,a){if(!(a.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),u=e.read_shift(2),d=Wl(e,0,a);return a.biff<8&&e.read_shift(1),[{r:n,c:i},d,u,o]}}function _M(e,r,a){return SM(e,r,a)}function EM(e,r){for(var a=[],n=e.read_shift(2);n--;)a.push(P0(e));return a}function TM(e,r,a){if(a&&a.biff<8)return AM(e,r,a);var n=IS(e),i=Y6(e,r-22,n[1]);return{cmo:n,ft:i}}var CM={8:function(e,r){var a=e.l+r;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=a,{fmt:n}}};function AM(e,r,a){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var u=[];return u.push((CM[n]||Er)(e,r,a)),{cmo:[i,n,o],ft:u}}function kM(e,r,a){var n=e.l,i="";try{e.l+=4;var o=(a.lastobj||{cmo:[0,0]}).cmo[1],u;[0,5,7,11,12,14].indexOf(o)==-1?e.l+=6:u=M6(e,6,a);var d=e.read_shift(2);e.read_shift(2),Wa(e,2);var h=e.read_shift(2);e.l+=h;for(var m=1;m<e.lens.length-1;++m){if(e.l-n!=e.lens[m])throw new Error("TxO: bad continue record");var p=e[e.l],v=Fl(e,e.lens[m+1]-e.lens[m]-1);if(i+=v,i.length>=(p?d:2*d))break}if(i.length!==d&&i.length!==d*2)throw new Error("cchText: "+d+" != "+i.length);return e.l=n+r,{t:i}}catch{return e.l=n+r,{t:i}}}function DM(e,r){var a=P0(e);e.l+=16;var n=P6(e,r-24);return[a,n]}function OM(e,r){e.read_shift(2);var a=P0(e),n=e.read_shift((r-10)/2,"dbcs-cont");return n=n.replace(Pr,""),[a,n]}function RM(e){var r=[0,0],a;return a=e.read_shift(2),r[0]=vb[a]||a,a=e.read_shift(2),r[1]=vb[a]||a,r}function MM(e){for(var r=e.read_shift(2),a=[];r-- >0;)a.push(RS(e));return a}function FM(e){for(var r=e.read_shift(2),a=[];r-- >0;)a.push(RS(e));return a}function IM(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function PS(e,r,a){if(!a.cellStyles)return Er(e,r);var n=a&&a.biff>=12?4:2,i=e.read_shift(n),o=e.read_shift(n),u=e.read_shift(n),d=e.read_shift(n),h=e.read_shift(2);n==2&&(e.l+=2);var m={s:i,e:o,w:u,ixfe:d,flags:h};return(a.biff>=5||!a.biff)&&(m.level=h>>8&7),m}function LM(e,r){var a={};return r<32||(e.l+=16,a.header=br(e),a.footer=br(e),e.l+=2),a}function PM(e,r,a){var n={area:!1};if(a.biff!=5)return e.l+=r,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}var BM=An,UM=DS,zM=ld;function VM(e){var r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(4),i={fmt:r,env:a,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function HM(e,r,a){a.biffguess&&a.biff==5&&(a.biff=2);var n=An(e);++e.l;var i=Wl(e,r-7,a);return n.t="str",n.val=i,n}function GM(e){var r=An(e);++e.l;var a=br(e);return r.t="n",r.val=a,r}function qM(e){var r=An(e);++e.l;var a=e.read_shift(2);return r.t="n",r.val=a,r}function WM(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function YM(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function XM(e,r,a){var n=e.l+r,i=An(e),o=e.read_shift(2),u=Fl(e,o,a);return e.l=n,i.t="str",i.val=u,i}var $M=[2,3,48,49,131,139,140,245],kb=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Kp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function a(d,h){var m=[],p=Zi(1);switch(h.type){case"base64":p=$s(vs(d));break;case"binary":p=$s(d);break;case"buffer":case"array":p=d;break}cr(p,0);var v=p.read_shift(1),y=!!(v&136),N=!1,j=!1;switch(v){case 2:break;case 3:break;case 48:N=!0,y=!0;break;case 49:N=!0,y=!0;break;case 131:break;case 139:break;case 140:j=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var b=0,w=521;v==2&&(b=p.read_shift(2)),p.l+=3,v!=2&&(b=p.read_shift(4)),b>1048576&&(b=1e6),v!=2&&(w=p.read_shift(2));var T=p.read_shift(2),D=h.codepage||1252;v!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(D=e[p[p.l]]),p.l+=1,p.l+=2),j&&(p.l+=36);for(var _=[],R={},z=Math.min(p.length,v==2?521:w-10-(N?264:0)),O=j?32:11;p.l<z&&p[p.l]!=13;)switch(R={},R.name=Mu.utils.decode(D,p.slice(p.l,p.l+O)).replace(/[\u0000\r\n].*$/g,""),p.l+=O,R.type=String.fromCharCode(p.read_shift(1)),v!=2&&!j&&(R.offset=p.read_shift(4)),R.len=p.read_shift(1),v==2&&(R.offset=p.read_shift(2)),R.dec=p.read_shift(1),R.name.length&&_.push(R),v!=2&&(p.l+=j?13:14),R.type){case"B":(!N||R.len!=8)&&h.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+R.type)}if(p[p.l]!==13&&(p.l=w-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=w;var A=0,k=0;for(m[0]=[],k=0;k!=_.length;++k)m[0][k]=_[k].name;for(;b-- >0;){if(p[p.l]===42){p.l+=T;continue}for(++p.l,m[++A]=[],k=0,k=0;k!=_.length;++k){var E=p.slice(p.l,p.l+_[k].len);p.l+=_[k].len,cr(E,0);var L=Mu.utils.decode(D,E);switch(_[k].type){case"C":L.trim().length&&(m[A][k]=L.replace(/\s+$/,""));break;case"D":L.length===8?m[A][k]=new Date(+L.slice(0,4),+L.slice(4,6)-1,+L.slice(6,8)):m[A][k]=L;break;case"F":m[A][k]=parseFloat(L.trim());break;case"+":case"I":m[A][k]=j?E.read_shift(-4,"i")^2147483648:E.read_shift(4,"i");break;case"L":switch(L.trim().toUpperCase()){case"Y":case"T":m[A][k]=!0;break;case"N":case"F":m[A][k]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+L+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));m[A][k]="##MEMO##"+(j?parseInt(L.trim(),10):E.read_shift(4));break;case"N":L=L.replace(/\u0000/g,"").trim(),L&&L!="."&&(m[A][k]=+L||0);break;case"@":m[A][k]=new Date(E.read_shift(-8,"f")-621356832e5);break;case"T":m[A][k]=new Date((E.read_shift(4)-2440588)*864e5+E.read_shift(4));break;case"Y":m[A][k]=E.read_shift(4,"i")/1e4+E.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":m[A][k]=-E.read_shift(-8,"f");break;case"B":if(N&&_[k].len==8){m[A][k]=E.read_shift(8,"f");break}case"G":case"P":E.l+=_[k].len;break;case"0":if(_[k].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[k].type)}}}if(v!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return h&&h.sheetRows&&(m=m.slice(0,h.sheetRows)),h.DBF=_,m}function n(d,h){var m=h||{};m.dateNF||(m.dateNF="yyyymmdd");var p=Jc(a(d,m),m);return p["!cols"]=m.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete m.DBF,p}function i(d,h){try{return sl(n(d,h),h)}catch(m){if(h&&h.WTF)throw m}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function u(d,h){var m=h||{};if(+m.codepage>=0&&Qs(+m.codepage),m.type=="string")throw new Error("Cannot write DBF to JS string");var p=Qx(),v=ip(d,{header:1,raw:!0,cellDates:!0}),y=v[0],N=v.slice(1),j=d["!cols"]||[],b=0,w=0,T=0,D=1;for(b=0;b<y.length;++b){if(((j[b]||{}).DBF||{}).name){y[b]=j[b].DBF.name,++T;continue}if(y[b]!=null){if(++T,typeof y[b]=="number"&&(y[b]=y[b].toString(10)),typeof y[b]!="string")throw new Error("DBF Invalid column name "+y[b]+" |"+typeof y[b]+"|");if(y.indexOf(y[b])!==b){for(w=0;w<1024;++w)if(y.indexOf(y[b]+"_"+w)==-1){y[b]+="_"+w;break}}}}var _=Ra(d["!ref"]),R=[],z=[],O=[];for(b=0;b<=_.e.c-_.s.c;++b){var A="",k="",E=0,L=[];for(w=0;w<N.length;++w)N[w][b]!=null&&L.push(N[w][b]);if(L.length==0||y[b]==null){R[b]="?";continue}for(w=0;w<L.length;++w){switch(typeof L[w]){case"number":k="B";break;case"string":k="C";break;case"boolean":k="L";break;case"object":k=L[w]instanceof Date?"D":"C";break;default:k="C"}E=Math.max(E,String(L[w]).length),A=A&&A!=k?"C":k}E>250&&(E=250),k=((j[b]||{}).DBF||{}).type,k=="C"&&j[b].DBF.len>E&&(E=j[b].DBF.len),A=="B"&&k=="N"&&(A="N",O[b]=j[b].DBF.dec,E=j[b].DBF.len),z[b]=A=="C"||k=="N"?E:o[A]||0,D+=z[b],R[b]=A}var H=p.next(32);for(H.write_shift(4,318902576),H.write_shift(4,N.length),H.write_shift(2,296+32*T),H.write_shift(2,D),b=0;b<4;++b)H.write_shift(4,0);for(H.write_shift(4,0|(+r[Lw]||3)<<8),b=0,w=0;b<y.length;++b)if(y[b]!=null){var I=p.next(32),re=(y[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);I.write_shift(1,re,"sbcs"),I.write_shift(1,R[b]=="?"?"C":R[b],"sbcs"),I.write_shift(4,w),I.write_shift(1,z[b]||o[R[b]]||0),I.write_shift(1,O[b]||0),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(1,0),I.write_shift(4,0),I.write_shift(4,0),w+=z[b]||o[R[b]]||0}var ne=p.next(264);for(ne.write_shift(4,13),b=0;b<65;++b)ne.write_shift(4,0);for(b=0;b<N.length;++b){var ge=p.next(D);for(ge.write_shift(1,0),w=0;w<y.length;++w)if(y[w]!=null)switch(R[w]){case"L":ge.write_shift(1,N[b][w]==null?63:N[b][w]?84:70);break;case"B":ge.write_shift(8,N[b][w]||0,"f");break;case"N":var W="0";for(typeof N[b][w]=="number"&&(W=N[b][w].toFixed(O[w]||0)),T=0;T<z[w]-W.length;++T)ge.write_shift(1,32);ge.write_shift(1,W,"sbcs");break;case"D":N[b][w]?(ge.write_shift(4,("0000"+N[b][w].getFullYear()).slice(-4),"sbcs"),ge.write_shift(2,("00"+(N[b][w].getMonth()+1)).slice(-2),"sbcs"),ge.write_shift(2,("00"+N[b][w].getDate()).slice(-2),"sbcs")):ge.write_shift(8,"00000000","sbcs");break;case"C":var ee=String(N[b][w]!=null?N[b][w]:"").slice(0,z[w]);for(ge.write_shift(1,ee,"sbcs"),T=0;T<z[w]-ee.length;++T)ge.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:i,to_sheet:n,from_sheet:u}})(),KM=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+wn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),a=function(y,N){var j=e[N];return typeof j=="number"?Wj(j):j},n=function(y,N,j){var b=N.charCodeAt(0)-32<<4|j.charCodeAt(0)-48;return b==59?y:Wj(b)};e["|"]=254;function i(y,N){switch(N.type){case"base64":return o(vs(y),N);case"binary":return o(y,N);case"buffer":return o(Kt&&Buffer.isBuffer(y)?y.toString("binary"):Vl(y),N);case"array":return o(Ml(y),N)}throw new Error("Unrecognized type "+N.type)}function o(y,N){var j=y.split(/[\n\r]+/),b=-1,w=-1,T=0,D=0,_=[],R=[],z=null,O={},A=[],k=[],E=[],L=0,H;for(+N.codepage>=0&&Qs(+N.codepage);T!==j.length;++T){L=0;var I=j[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,a),re=I.replace(/;;/g,"\0").split(";").map(function(K){return K.replace(/\u0000/g,";")}),ne=re[0],ge;if(I.length>0)switch(ne){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":re[1].charAt(0)=="P"&&R.push(I.slice(3).replace(/;;/g,";"));break;case"C":var W=!1,ee=!1,je=!1,Z=!1,De=-1,he=-1;for(D=1;D<re.length;++D)switch(re[D].charAt(0)){case"A":break;case"X":w=parseInt(re[D].slice(1))-1,ee=!0;break;case"Y":for(b=parseInt(re[D].slice(1))-1,ee||(w=0),H=_.length;H<=b;++H)_[H]=[];break;case"K":ge=re[D].slice(1),ge.charAt(0)==='"'?ge=ge.slice(1,ge.length-1):ge==="TRUE"?ge=!0:ge==="FALSE"?ge=!1:isNaN(en(ge))?isNaN(Hc(ge).getDate())||(ge=ar(ge)):(ge=en(ge),z!==null&&Qc(z)&&(ge=L0(ge))),W=!0;break;case"E":Z=!0;var P=Pc(re[D].slice(1),{r:b,c:w});_[b][w]=[_[b][w],P];break;case"S":je=!0,_[b][w]=[_[b][w],"S5S"];break;case"G":break;case"R":De=parseInt(re[D].slice(1))-1;break;case"C":he=parseInt(re[D].slice(1))-1;break;default:if(N&&N.WTF)throw new Error("SYLK bad record "+I)}if(W&&(_[b][w]&&_[b][w].length==2?_[b][w][0]=ge:_[b][w]=ge,z=null),je){if(Z)throw new Error("SYLK shared formula cannot have own formula");var q=De>-1&&_[De][he];if(!q||!q[1])throw new Error("SYLK shared formula cannot find base");_[b][w][1]=XS(q[1],{r:b-De,c:w-he})}break;case"F":var J=0;for(D=1;D<re.length;++D)switch(re[D].charAt(0)){case"X":w=parseInt(re[D].slice(1))-1,++J;break;case"Y":for(b=parseInt(re[D].slice(1))-1,H=_.length;H<=b;++H)_[H]=[];break;case"M":L=parseInt(re[D].slice(1))/20;break;case"F":break;case"G":break;case"P":z=R[parseInt(re[D].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(E=re[D].slice(1).split(" "),H=parseInt(E[0],10);H<=parseInt(E[1],10);++H)L=parseInt(E[2],10),k[H-1]=L===0?{hidden:!0}:{wch:L},Gc(k[H-1]);break;case"C":w=parseInt(re[D].slice(1))-1,k[w]||(k[w]={});break;case"R":b=parseInt(re[D].slice(1))-1,A[b]||(A[b]={}),L>0?(A[b].hpt=L,A[b].hpx=Uu(L)):L===0&&(A[b].hidden=!0);break;default:if(N&&N.WTF)throw new Error("SYLK bad record "+I)}J<1&&(z=null);break;default:if(N&&N.WTF)throw new Error("SYLK bad record "+I)}}return A.length>0&&(O["!rows"]=A),k.length>0&&(O["!cols"]=k),N&&N.sheetRows&&(_=_.slice(0,N.sheetRows)),[_,O]}function u(y,N){var j=i(y,N),b=j[0],w=j[1],T=Jc(b,N);return wn(w).forEach(function(D){T[D]=w[D]}),T}function d(y,N){return sl(u(y,N),N)}function h(y,N,j,b){var w="C;Y"+(j+1)+";X"+(b+1)+";K";switch(y.t){case"n":w+=y.v||0,y.f&&!y.F&&(w+=";E"+I8(y.f,{r:j,c:b}));break;case"b":w+=y.v?"TRUE":"FALSE";break;case"e":w+=y.w||y.v;break;case"d":w+='"'+(y.w||y.v)+'"';break;case"s":w+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function m(y,N){N.forEach(function(j,b){var w="F;W"+(b+1)+" "+(b+1)+" ";j.hidden?w+="0":(typeof j.width=="number"&&!j.wpx&&(j.wpx=g0(j.width)),typeof j.wpx=="number"&&!j.wch&&(j.wch=v0(j.wpx)),typeof j.wch=="number"&&(w+=Math.round(j.wch))),w.charAt(w.length-1)!=" "&&y.push(w)})}function p(y,N){N.forEach(function(j,b){var w="F;";j.hidden?w+="M0;":j.hpt?w+="M"+20*j.hpt+";":j.hpx&&(w+="M"+20*qS(j.hpx)+";"),w.length>2&&y.push(w+"R"+(b+1))})}function v(y,N){var j=["ID;PWXL;N;E"],b=[],w=Ra(y["!ref"]),T,D=Array.isArray(y),_=`\r
`;j.push("P;PGeneral"),j.push("F;P0;DG0G8;M255"),y["!cols"]&&m(j,y["!cols"]),y["!rows"]&&p(j,y["!rows"]),j.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var R=w.s.r;R<=w.e.r;++R)for(var z=w.s.c;z<=w.e.c;++z){var O=Ct({r:R,c:z});T=D?(y[R]||[])[z]:y[O],!(!T||T.v==null&&(!T.f||T.F))&&b.push(h(T,y,R,z))}return j.join(_)+_+b.join(_)+_+"E"+_}return{to_workbook:d,to_sheet:u,from_sheet:v}})(),QM=(function(){function e(o,u){switch(u.type){case"base64":return r(vs(o),u);case"binary":return r(o,u);case"buffer":return r(Kt&&Buffer.isBuffer(o)?o.toString("binary"):Vl(o),u);case"array":return r(Ml(o),u)}throw new Error("Unrecognized type "+u.type)}function r(o,u){for(var d=o.split(`
`),h=-1,m=-1,p=0,v=[];p!==d.length;++p){if(d[p].trim()==="BOT"){v[++h]=[],m=0;continue}if(!(h<0)){var y=d[p].trim().split(","),N=y[0],j=y[1];++p;for(var b=d[p]||"";(b.match(/["]/g)||[]).length&1&&p<d.length-1;)b+=`
`+d[++p];switch(b=b.trim(),+N){case-1:if(b==="BOT"){v[++h]=[],m=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?v[h][m]=!0:b==="FALSE"?v[h][m]=!1:isNaN(en(j))?isNaN(Hc(j).getDate())?v[h][m]=j:v[h][m]=ar(j):v[h][m]=en(j),++m;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),v[h][m++]=b!==""?b:null;break}if(b==="EOD")break}}return u&&u.sheetRows&&(v=v.slice(0,u.sheetRows)),v}function a(o,u){return Jc(e(o,u),u)}function n(o,u){return sl(a(o,u),u)}var i=(function(){var o=function(h,m,p,v,y){h.push(m),h.push(p+","+v),h.push('"'+y.replace(/"/g,'""')+'"')},u=function(h,m,p,v){h.push(m+","+p),h.push(m==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(h){var m=[],p=Ra(h["!ref"]),v,y=Array.isArray(h);o(m,"TABLE",0,1,"sheetjs"),o(m,"VECTORS",0,p.e.r-p.s.r+1,""),o(m,"TUPLES",0,p.e.c-p.s.c+1,""),o(m,"DATA",0,0,"");for(var N=p.s.r;N<=p.e.r;++N){u(m,-1,0,"BOT");for(var j=p.s.c;j<=p.e.c;++j){var b=Ct({r:N,c:j});if(v=y?(h[N]||[])[j]:h[b],!v){u(m,1,0,"");continue}switch(v.t){case"n":var w=v.w;!w&&v.v!=null&&(w=v.v),w==null?v.f&&!v.F?u(m,1,0,"="+v.f):u(m,1,0,""):u(m,0,w,"V");break;case"b":u(m,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":u(m,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=Fs(v.z||It[14],Ur(ar(v.v)))),u(m,0,v.w,"V");break;default:u(m,1,0,"")}}}u(m,-1,0,"EOD");var T=`\r
`,D=m.join(T);return D}})();return{to_workbook:n,to_sheet:a,from_sheet:i}})(),ZM=(function(){function e(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function a(v,y){for(var N=v.split(`
`),j=-1,b=-1,w=0,T=[];w!==N.length;++w){var D=N[w].trim().split(":");if(D[0]==="cell"){var _=Lr(D[1]);if(T.length<=_.r)for(j=T.length;j<=_.r;++j)T[j]||(T[j]=[]);switch(j=_.r,b=_.c,D[2]){case"t":T[j][b]=e(D[3]);break;case"v":T[j][b]=+D[3];break;case"vtf":var R=D[D.length-1];case"vtc":switch(D[3]){case"nl":T[j][b]=!!+D[4];break;default:T[j][b]=+D[4];break}D[2]=="vtf"&&(T[j][b]=[T[j][b],R])}}}return y&&y.sheetRows&&(T=T.slice(0,y.sheetRows)),T}function n(v,y){return Jc(a(v,y),y)}function i(v,y){return sl(n(v,y),y)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),u=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,d=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function m(v){if(!v||!v["!ref"])return"";for(var y=[],N=[],j,b="",w=Zc(v["!ref"]),T=Array.isArray(v),D=w.s.r;D<=w.e.r;++D)for(var _=w.s.c;_<=w.e.c;++_)if(b=Ct({r:D,c:_}),j=T?(v[D]||[])[_]:v[b],!(!j||j.v==null||j.t==="z")){switch(N=["cell",b,"t"],j.t){case"s":case"str":N.push(r(j.v));break;case"n":j.f?(N[2]="vtf",N[3]="n",N[4]=j.v,N[5]=r(j.f)):(N[2]="v",N[3]=j.v);break;case"b":N[2]="vt"+(j.f?"f":"c"),N[3]="nl",N[4]=j.v?"1":"0",N[5]=r(j.f||(j.v?"TRUE":"FALSE"));break;case"d":var R=Ur(ar(j.v));N[2]="vtc",N[3]="nd",N[4]=""+R,N[5]=j.w||Fs(j.z||It[14],R);break;case"e":continue}y.push(N.join(":"))}return y.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function p(v){return[o,u,d,u,m(v),h].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:p}})(),Pu=(function(){function e(p,v,y,N,j){j.raw?v[y][N]=p:p===""||(p==="TRUE"?v[y][N]=!0:p==="FALSE"?v[y][N]=!1:isNaN(en(p))?isNaN(Hc(p).getDate())?v[y][N]=p:v[y][N]=ar(p):v[y][N]=en(p))}function r(p,v){var y=v||{},N=[];if(!p||p.length===0)return N;for(var j=p.split(/[\r\n]/),b=j.length-1;b>=0&&j[b].length===0;)--b;for(var w=10,T=0,D=0;D<=b;++D)T=j[D].indexOf(" "),T==-1?T=j[D].length:T++,w=Math.max(w,T);for(D=0;D<=b;++D){N[D]=[];var _=0;for(e(j[D].slice(0,w).trim(),N,D,_,y),_=1;_<=(j[D].length-w)/10+1;++_)e(j[D].slice(w+(_-1)*10,w+_*10).trim(),N,D,_,y)}return y.sheetRows&&(N=N.slice(0,y.sheetRows)),N}var a={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(p){for(var v={},y=!1,N=0,j=0;N<p.length;++N)(j=p.charCodeAt(N))==34?y=!y:!y&&j in a&&(v[j]=(v[j]||0)+1);j=[];for(N in v)Object.prototype.hasOwnProperty.call(v,N)&&j.push([v[N],N]);if(!j.length){v=n;for(N in v)Object.prototype.hasOwnProperty.call(v,N)&&j.push([v[N],N])}return j.sort(function(b,w){return b[0]-w[0]||n[b[1]]-n[w[1]]}),a[j.pop()[1]]||44}function o(p,v){var y=v||{},N="",j=y.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(N=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(N=p.charAt(4),p=p.slice(6)):N=i(p.slice(0,1024)):y&&y.FS?N=y.FS:N=i(p.slice(0,1024));var w=0,T=0,D=0,_=0,R=0,z=N.charCodeAt(0),O=!1,A=0,k=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var E=y.dateNF!=null?o5(y.dateNF):null;function L(){var H=p.slice(_,R),I={};if(H.charAt(0)=='"'&&H.charAt(H.length-1)=='"'&&(H=H.slice(1,-1).replace(/""/g,'"')),H.length===0)I.t="z";else if(y.raw)I.t="s",I.v=H;else if(H.trim().length===0)I.t="s",I.v=H;else if(H.charCodeAt(0)==61)H.charCodeAt(1)==34&&H.charCodeAt(H.length-1)==34?(I.t="s",I.v=H.slice(2,-1).replace(/""/g,'"')):P8(H)?(I.t="n",I.f=H.slice(1)):(I.t="s",I.v=H);else if(H=="TRUE")I.t="b",I.v=!0;else if(H=="FALSE")I.t="b",I.v=!1;else if(!isNaN(D=en(H)))I.t="n",y.cellText!==!1&&(I.w=H),I.v=D;else if(!isNaN(Hc(H).getDate())||E&&H.match(E)){I.z=y.dateNF||It[14];var re=0;E&&H.match(E)&&(H=u5(H,y.dateNF,H.match(E)||[]),re=1),y.cellDates?(I.t="d",I.v=ar(H,re)):(I.t="n",I.v=Ur(ar(H,re))),y.cellText!==!1&&(I.w=Fs(I.z,I.v instanceof Date?Ur(I.v):I.v)),y.cellNF||delete I.z}else I.t="s",I.v=H;if(I.t=="z"||(y.dense?(j[w]||(j[w]=[]),j[w][T]=I):j[Ct({c:T,r:w})]=I),_=R+1,k=p.charCodeAt(_),b.e.c<T&&(b.e.c=T),b.e.r<w&&(b.e.r=w),A==z)++T;else if(T=0,++w,y.sheetRows&&y.sheetRows<=w)return!0}e:for(;R<p.length;++R)switch(A=p.charCodeAt(R)){case 34:k===34&&(O=!O);break;case z:case 10:case 13:if(!O&&L())break e;break}return R-_>0&&L(),j["!ref"]=Zt(b),j}function u(p,v){return!(v&&v.PRN)||v.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?o(p,v):Jc(r(p,v),v)}function d(p,v){var y="",N=v.type=="string"?[0,0,0,0]:xg(p,v);switch(v.type){case"base64":y=vs(p);break;case"binary":y=p;break;case"buffer":v.codepage==65001?y=p.toString("utf8"):v.codepage&&typeof Mu<"u"||(y=Kt&&Buffer.isBuffer(p)?p.toString("binary"):Vl(p));break;case"array":y=Ml(p);break;case"string":y=p;break;default:throw new Error("Unrecognized type "+v.type)}return N[0]==239&&N[1]==187&&N[2]==191?y=va(y.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?y=va(y):v.type=="binary"&&typeof Mu<"u",y.slice(0,19)=="socialcalc:version:"?ZM.to_sheet(v.type=="string"?y:va(y),v):u(y,v)}function h(p,v){return sl(d(p,v),v)}function m(p){for(var v=[],y=Ra(p["!ref"]),N,j=Array.isArray(p),b=y.s.r;b<=y.e.r;++b){for(var w=[],T=y.s.c;T<=y.e.c;++T){var D=Ct({r:b,c:T});if(N=j?(p[b]||[])[T]:p[D],!N||N.v==null){w.push("          ");continue}for(var _=(N.w||(fi(N),N.w)||"").slice(0,10);_.length<10;)_+=" ";w.push(_+(T===0?" ":""))}v.push(w.join(""))}return v.join(`
`)}return{to_workbook:h,to_sheet:d,from_sheet:m}})();function JM(e,r){var a=r||{},n=!!a.WTF;a.WTF=!0;try{var i=KM.to_workbook(e,a);return a.WTF=n,i}catch(o){if(a.WTF=n,!o.message.match(/SYLK bad record ID/)&&n)throw o;return Pu.to_workbook(e,r)}}var bu=(function(){function e(P,q,J){if(P){cr(P,P.l||0);for(var K=J.Enum||De;P.l<P.length;){var xe=P.read_shift(2),Fe=K[xe]||K[65535],Ae=P.read_shift(2),Ee=P.l+Ae,we=Fe.f&&Fe.f(P,Ae,J);if(P.l=Ee,q(we,Fe,xe))return}}}function r(P,q){switch(q.type){case"base64":return a($s(vs(P)),q);case"binary":return a($s(P),q);case"buffer":case"array":return a(P,q)}throw"Unsupported type "+q.type}function a(P,q){if(!P)return P;var J=q||{},K=J.dense?[]:{},xe="Sheet1",Fe="",Ae=0,Ee={},we=[],Ge=[],X={s:{r:0,c:0},e:{r:0,c:0}},ht=J.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)J.Enum=De,e(P,function(Be,$e,St){switch(St){case 0:J.vers=Be,Be>=4096&&(J.qpro=!0);break;case 6:X=Be;break;case 204:Be&&(Fe=Be);break;case 222:Fe=Be;break;case 15:case 51:J.qpro||(Be[1].v=Be[1].v.slice(1));case 13:case 14:case 16:St==14&&(Be[2]&112)==112&&(Be[2]&15)>1&&(Be[2]&15)<15&&(Be[1].z=J.dateNF||It[14],J.cellDates&&(Be[1].t="d",Be[1].v=L0(Be[1].v))),J.qpro&&Be[3]>Ae&&(K["!ref"]=Zt(X),Ee[xe]=K,we.push(xe),K=J.dense?[]:{},X={s:{r:0,c:0},e:{r:0,c:0}},Ae=Be[3],xe=Fe||"Sheet"+(Ae+1),Fe="");var Jt=J.dense?(K[Be[0].r]||[])[Be[0].c]:K[Ct(Be[0])];if(Jt){Jt.t=Be[1].t,Jt.v=Be[1].v,Be[1].z!=null&&(Jt.z=Be[1].z),Be[1].f!=null&&(Jt.f=Be[1].f);break}J.dense?(K[Be[0].r]||(K[Be[0].r]=[]),K[Be[0].r][Be[0].c]=Be[1]):K[Ct(Be[0])]=Be[1];break}},J);else if(P[2]==26||P[2]==14)J.Enum=he,P[2]==14&&(J.qpro=!0,P.l=0),e(P,function(Be,$e,St){switch(St){case 204:xe=Be;break;case 22:Be[1].v=Be[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Be[3]>Ae&&(K["!ref"]=Zt(X),Ee[xe]=K,we.push(xe),K=J.dense?[]:{},X={s:{r:0,c:0},e:{r:0,c:0}},Ae=Be[3],xe="Sheet"+(Ae+1)),ht>0&&Be[0].r>=ht)break;J.dense?(K[Be[0].r]||(K[Be[0].r]=[]),K[Be[0].r][Be[0].c]=Be[1]):K[Ct(Be[0])]=Be[1],X.e.c<Be[0].c&&(X.e.c=Be[0].c),X.e.r<Be[0].r&&(X.e.r=Be[0].r);break;case 27:Be[14e3]&&(Ge[Be[14e3][0]]=Be[14e3][1]);break;case 1537:Ge[Be[0]]=Be[1],Be[0]==Ae&&(xe=Be[1]);break}},J);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(K["!ref"]=Zt(X),Ee[Fe||xe]=K,we.push(Fe||xe),!Ge.length)return{SheetNames:we,Sheets:Ee};for(var Ye={},Je=[],qe=0;qe<Ge.length;++qe)Ee[we[qe]]?(Je.push(Ge[qe]||we[qe]),Ye[Ge[qe]]=Ee[Ge[qe]]||Ee[we[qe]]):(Je.push(Ge[qe]),Ye[Ge[qe]]={"!ref":"A1"});return{SheetNames:Je,Sheets:Ye}}function n(P,q){var J=q||{};if(+J.codepage>=0&&Qs(+J.codepage),J.type=="string")throw new Error("Cannot write WK1 to JS string");var K=Qx(),xe=Ra(P["!ref"]),Fe=Array.isArray(P),Ae=[];Ws(K,0,o(1030)),Ws(K,6,h(xe));for(var Ee=Math.min(xe.e.r,8191),we=xe.s.r;we<=Ee;++we)for(var Ge=dr(we),X=xe.s.c;X<=xe.e.c;++X){we===xe.s.r&&(Ae[X]=Za(X));var ht=Ae[X]+Ge,Ye=Fe?(P[we]||[])[X]:P[ht];if(!(!Ye||Ye.t=="z"))if(Ye.t=="n")(Ye.v|0)==Ye.v&&Ye.v>=-32768&&Ye.v<=32767?Ws(K,13,N(we,X,Ye.v)):Ws(K,14,b(we,X,Ye.v));else{var Je=fi(Ye);Ws(K,15,v(we,X,Je.slice(0,239)))}}return Ws(K,1),K.end()}function i(P,q){var J=q||{};if(+J.codepage>=0&&Qs(+J.codepage),J.type=="string")throw new Error("Cannot write WK3 to JS string");var K=Qx();Ws(K,0,u(P));for(var xe=0,Fe=0;xe<P.SheetNames.length;++xe)(P.Sheets[P.SheetNames[xe]]||{})["!ref"]&&Ws(K,27,Z(P.SheetNames[xe],Fe++));var Ae=0;for(xe=0;xe<P.SheetNames.length;++xe){var Ee=P.Sheets[P.SheetNames[xe]];if(!(!Ee||!Ee["!ref"])){for(var we=Ra(Ee["!ref"]),Ge=Array.isArray(Ee),X=[],ht=Math.min(we.e.r,8191),Ye=we.s.r;Ye<=ht;++Ye)for(var Je=dr(Ye),qe=we.s.c;qe<=we.e.c;++qe){Ye===we.s.r&&(X[qe]=Za(qe));var Be=X[qe]+Je,$e=Ge?(Ee[Ye]||[])[qe]:Ee[Be];if(!(!$e||$e.t=="z"))if($e.t=="n")Ws(K,23,L(Ye,qe,Ae,$e.v));else{var St=fi($e);Ws(K,22,A(Ye,qe,Ae,St.slice(0,239)))}}++Ae}}return Ws(K,1),K.end()}function o(P){var q=Qa(2);return q.write_shift(2,P),q}function u(P){var q=Qa(26);q.write_shift(2,4096),q.write_shift(2,4),q.write_shift(4,0);for(var J=0,K=0,xe=0,Fe=0;Fe<P.SheetNames.length;++Fe){var Ae=P.SheetNames[Fe],Ee=P.Sheets[Ae];if(!(!Ee||!Ee["!ref"])){++xe;var we=Zc(Ee["!ref"]);J<we.e.r&&(J=we.e.r),K<we.e.c&&(K=we.e.c)}}return J>8191&&(J=8191),q.write_shift(2,J),q.write_shift(1,xe),q.write_shift(1,K),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(1,1),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(4,0),q}function d(P,q,J){var K={s:{c:0,r:0},e:{c:0,r:0}};return q==8&&J.qpro?(K.s.c=P.read_shift(1),P.l++,K.s.r=P.read_shift(2),K.e.c=P.read_shift(1),P.l++,K.e.r=P.read_shift(2),K):(K.s.c=P.read_shift(2),K.s.r=P.read_shift(2),q==12&&J.qpro&&(P.l+=2),K.e.c=P.read_shift(2),K.e.r=P.read_shift(2),q==12&&J.qpro&&(P.l+=2),K.s.c==65535&&(K.s.c=K.e.c=K.s.r=K.e.r=0),K)}function h(P){var q=Qa(8);return q.write_shift(2,P.s.c),q.write_shift(2,P.s.r),q.write_shift(2,P.e.c),q.write_shift(2,P.e.r),q}function m(P,q,J){var K=[{c:0,r:0},{t:"n",v:0},0,0];return J.qpro&&J.vers!=20768?(K[0].c=P.read_shift(1),K[3]=P.read_shift(1),K[0].r=P.read_shift(2),P.l+=2):(K[2]=P.read_shift(1),K[0].c=P.read_shift(2),K[0].r=P.read_shift(2)),K}function p(P,q,J){var K=P.l+q,xe=m(P,q,J);if(xe[1].t="s",J.vers==20768){P.l++;var Fe=P.read_shift(1);return xe[1].v=P.read_shift(Fe,"utf8"),xe}return J.qpro&&P.l++,xe[1].v=P.read_shift(K-P.l,"cstr"),xe}function v(P,q,J){var K=Qa(7+J.length);K.write_shift(1,255),K.write_shift(2,q),K.write_shift(2,P),K.write_shift(1,39);for(var xe=0;xe<K.length;++xe){var Fe=J.charCodeAt(xe);K.write_shift(1,Fe>=128?95:Fe)}return K.write_shift(1,0),K}function y(P,q,J){var K=m(P,q,J);return K[1].v=P.read_shift(2,"i"),K}function N(P,q,J){var K=Qa(7);return K.write_shift(1,255),K.write_shift(2,q),K.write_shift(2,P),K.write_shift(2,J,"i"),K}function j(P,q,J){var K=m(P,q,J);return K[1].v=P.read_shift(8,"f"),K}function b(P,q,J){var K=Qa(13);return K.write_shift(1,255),K.write_shift(2,q),K.write_shift(2,P),K.write_shift(8,J,"f"),K}function w(P,q,J){var K=P.l+q,xe=m(P,q,J);if(xe[1].v=P.read_shift(8,"f"),J.qpro)P.l=K;else{var Fe=P.read_shift(2);R(P.slice(P.l,P.l+Fe),xe),P.l+=Fe}return xe}function T(P,q,J){var K=q&32768;return q&=-32769,q=(K?P:0)+(q>=8192?q-16384:q),(K?"":"$")+(J?Za(q):dr(q))}var D={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function R(P,q){cr(P,0);for(var J=[],K=0,xe="",Fe="",Ae="",Ee="";P.l<P.length;){var we=P[P.l++];switch(we){case 0:J.push(P.read_shift(8,"f"));break;case 1:Fe=T(q[0].c,P.read_shift(2),!0),xe=T(q[0].r,P.read_shift(2),!1),J.push(Fe+xe);break;case 2:{var Ge=T(q[0].c,P.read_shift(2),!0),X=T(q[0].r,P.read_shift(2),!1);Fe=T(q[0].c,P.read_shift(2),!0),xe=T(q[0].r,P.read_shift(2),!1),J.push(Ge+X+":"+Fe+xe)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:J.push("("+J.pop()+")");break;case 5:J.push(P.read_shift(2));break;case 6:{for(var ht="";we=P[P.l++];)ht+=String.fromCharCode(we);J.push('"'+ht.replace(/"/g,'""')+'"')}break;case 8:J.push("-"+J.pop());break;case 23:J.push("+"+J.pop());break;case 22:J.push("NOT("+J.pop()+")");break;case 20:case 21:Ee=J.pop(),Ae=J.pop(),J.push(["AND","OR"][we-20]+"("+Ae+","+Ee+")");break;default:if(we<32&&_[we])Ee=J.pop(),Ae=J.pop(),J.push(Ae+_[we]+Ee);else if(D[we]){if(K=D[we][1],K==69&&(K=P[P.l++]),K>J.length){console.error("WK1 bad formula parse 0x"+we.toString(16)+":|"+J.join("|")+"|");return}var Ye=J.slice(-K);J.length-=K,J.push(D[we][0]+"("+Ye.join(",")+")")}else return we<=7?console.error("WK1 invalid opcode "+we.toString(16)):we<=24?console.error("WK1 unsupported op "+we.toString(16)):we<=30?console.error("WK1 invalid opcode "+we.toString(16)):we<=115?console.error("WK1 unsupported function opcode "+we.toString(16)):console.error("WK1 unrecognized opcode "+we.toString(16))}}J.length==1?q[1].f=""+J[0]:console.error("WK1 bad formula parse |"+J.join("|")+"|")}function z(P){var q=[{c:0,r:0},{t:"n",v:0},0];return q[0].r=P.read_shift(2),q[3]=P[P.l++],q[0].c=P[P.l++],q}function O(P,q){var J=z(P);return J[1].t="s",J[1].v=P.read_shift(q-4,"cstr"),J}function A(P,q,J,K){var xe=Qa(6+K.length);xe.write_shift(2,P),xe.write_shift(1,J),xe.write_shift(1,q),xe.write_shift(1,39);for(var Fe=0;Fe<K.length;++Fe){var Ae=K.charCodeAt(Fe);xe.write_shift(1,Ae>=128?95:Ae)}return xe.write_shift(1,0),xe}function k(P,q){var J=z(P);J[1].v=P.read_shift(2);var K=J[1].v>>1;if(J[1].v&1)switch(K&7){case 0:K=(K>>3)*5e3;break;case 1:K=(K>>3)*500;break;case 2:K=(K>>3)/20;break;case 3:K=(K>>3)/200;break;case 4:K=(K>>3)/2e3;break;case 5:K=(K>>3)/2e4;break;case 6:K=(K>>3)/16;break;case 7:K=(K>>3)/64;break}return J[1].v=K,J}function E(P,q){var J=z(P),K=P.read_shift(4),xe=P.read_shift(4),Fe=P.read_shift(2);if(Fe==65535)return K===0&&xe===3221225472?(J[1].t="e",J[1].v=15):K===0&&xe===3489660928?(J[1].t="e",J[1].v=42):J[1].v=0,J;var Ae=Fe&32768;return Fe=(Fe&32767)-16446,J[1].v=(1-Ae*2)*(xe*Math.pow(2,Fe+32)+K*Math.pow(2,Fe)),J}function L(P,q,J,K){var xe=Qa(14);if(xe.write_shift(2,P),xe.write_shift(1,J),xe.write_shift(1,q),K==0)return xe.write_shift(4,0),xe.write_shift(4,0),xe.write_shift(2,65535),xe;var Fe=0,Ae=0,Ee=0,we=0;return K<0&&(Fe=1,K=-K),Ae=Math.log2(K)|0,K/=Math.pow(2,Ae-31),we=K>>>0,(we&2147483648)==0&&(K/=2,++Ae,we=K>>>0),K-=we,we|=2147483648,we>>>=0,K*=Math.pow(2,32),Ee=K>>>0,xe.write_shift(4,Ee),xe.write_shift(4,we),Ae+=16383+(Fe?32768:0),xe.write_shift(2,Ae),xe}function H(P,q){var J=E(P);return P.l+=q-14,J}function I(P,q){var J=z(P),K=P.read_shift(4);return J[1].v=K>>6,J}function re(P,q){var J=z(P),K=P.read_shift(8,"f");return J[1].v=K,J}function ne(P,q){var J=re(P);return P.l+=q-10,J}function ge(P,q){return P[P.l+q-1]==0?P.read_shift(q,"cstr"):""}function W(P,q){var J=P[P.l++];J>q-1&&(J=q-1);for(var K="";K.length<J;)K+=String.fromCharCode(P[P.l++]);return K}function ee(P,q,J){if(!(!J.qpro||q<21)){var K=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var xe=P.read_shift(q-21,"cstr");return[K,xe]}}function je(P,q){for(var J={},K=P.l+q;P.l<K;){var xe=P.read_shift(2);if(xe==14e3){for(J[xe]=[0,""],J[xe][0]=P.read_shift(2);P[P.l];)J[xe][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return J}function Z(P,q){var J=Qa(5+P.length);J.write_shift(2,14e3),J.write_shift(2,q);for(var K=0;K<P.length;++K){var xe=P.charCodeAt(K);J[J.l++]=xe>127?95:xe}return J[J.l++]=0,J}var De={0:{n:"BOF",f:Wa},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:d},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:j},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ge},222:{n:"SHEETNAMELP",f:W},65535:{n:""}},he={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:O},23:{n:"NUMBER17",f:E},24:{n:"NUMBER18",f:k},25:{n:"FORMULA19",f:H},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:je},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:I},38:{n:"??"},39:{n:"NUMBER27",f:re},40:{n:"FORMULA28",f:ne},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ge},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ee},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:r}})();function eF(e){var r={},a=e.match(Cr),n=0,i=!1;if(a)for(;n!=a.length;++n){var o=Et(a[n]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;r.cp=qp[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=o.val;break;case"<sz":r.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":o.rgb&&(r.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(o[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+o[0])}}return r}var tF=(function(){var e=Iu("t"),r=Iu("rPr");function a(o){var u=o.match(e);if(!u)return{t:"s",v:""};var d={t:"s",v:ea(u[1])},h=o.match(r);return h&&(d.s=eF(h[1])),d}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(u){return u.replace(n,"").split(i).map(a).filter(function(d){return d.v})}})(),aF=(function(){var r=/(\r\n|\n)/g;function a(i,o,u){var d=[];i.u&&d.push("text-decoration: underline;"),i.uval&&d.push("text-underline-style:"+i.uval+";"),i.sz&&d.push("font-size:"+i.sz+"pt;"),i.outline&&d.push("text-effect: outline;"),i.shadow&&d.push("text-shadow: auto;"),o.push('<span style="'+d.join("")+'">'),i.b&&(o.push("<b>"),u.push("</b>")),i.i&&(o.push("<i>"),u.push("</i>")),i.strike&&(o.push("<s>"),u.push("</s>"));var h=i.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(o.push("<"+h+">"),u.push("</"+h+">")),u.push("</span>"),i}function n(i){var o=[[],i.v,[]];return i.v?(i.s&&a(i.s,o[0],o[2]),o[0].join("")+o[1].replace(r,"<br/>")+o[2].join("")):""}return function(o){return o.map(n).join("")}})(),rF=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,sF=/<(?:\w+:)?r>/,nF=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function cg(e,r){var a=r?r.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=ea(va(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=va(e),a&&(n.h=Zp(n.t))):e.match(sF)&&(n.r=va(e),n.t=ea(va((e.replace(nF,"").match(rF)||[]).join("").replace(Cr,""))),a&&(n.h=aF(tF(n.r)))),n):{t:""}}var iF=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,lF=/<(?:\w+:)?(?:si|sstItem)>/g,cF=/<\/(?:\w+:)?(?:si|sstItem)>/;function oF(e,r){var a=[],n="";if(!e)return a;var i=e.match(iF);if(i){n=i[2].replace(lF,"").split(cF);for(var o=0;o!=n.length;++o){var u=cg(n[o].trim(),r);u!=null&&(a[a.length]=u)}i=Et(i[1]),a.Count=i.count,a.Unique=i.uniqueCount}return a}function uF(e){return[e.read_shift(4),e.read_shift(4)]}function dF(e,r){var a=[],n=!1;return pi(e,function(o,u,d){switch(d){case 159:a.Count=o[0],a.Unique=o[1];break;case 19:a.push(o);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(u.T,!n||r.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}),a}function BS(e){for(var r=[],a=e.split(""),n=0;n<a.length;++n)r[n]=a[n].charCodeAt(0);return r}function ii(e,r){var a={};return a.Major=e.read_shift(2),a.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),a}function fF(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=ii(e,4),r.U=ii(e,4),r.W=ii(e,4),r}function hF(e){for(var r=e.read_shift(4),a=e.l+r-4,n={},i=e.read_shift(4),o=[];i-- >0;)o.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=o,e.l!=a)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+a);return n}function mF(e){var r=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)r.push(hF(e));return r}function xF(e){var r=[];e.l+=4;for(var a=e.read_shift(4);a-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function pF(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=ii(e,4),r.U=ii(e,4),r.W=ii(e,4),r}function gF(e){var r=pF(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function US(e,r){var a=e.l+r,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(a-e.l>>1,"utf16le"),e.l=a,n}function zS(e,r){var a={},n=e.l+r;return e.l+=4,a.Salt=e.slice(e.l,e.l+16),e.l+=16,a.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),a.VerifierHash=e.slice(e.l,n),e.l=n,a}function vF(e){var r=ii(e);switch(r.Minor){case 2:return[r.Minor,yF(e)];case 3:return[r.Minor,jF()];case 4:return[r.Minor,bF(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function yF(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var a=e.read_shift(4),n=US(e,a),i=zS(e,e.length-e.l);return{t:"Std",h:n,v:i}}function jF(){throw new Error("File is password-protected: ECMA-376 Extensible")}function bF(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var a=e.read_shift(e.length-e.l,"utf8"),n={};return a.replace(Cr,function(o){var u=Et(o);switch(Cn(u[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(d){n[d]=u[d]});break;case"<dataIntegrity":n.encryptedHmacKey=u.encryptedHmacKey,n.encryptedHmacValue=u.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=u.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(u);break;default:throw u[0]}}),n}function NF(e,r){var a={},n=a.EncryptionVersionInfo=ii(e,4);if(r-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);a.Flags=e.read_shift(4),r-=4;var i=e.read_shift(4);return r-=4,a.EncryptionHeader=US(e,i),r-=i,a.EncryptionVerifier=zS(e,r),a}function wF(e){var r={},a=r.EncryptionVersionInfo=ii(e,4);if(a.Major!=1||a.Minor!=1)throw"unrecognized version code "+a.Major+" : "+a.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function SF(e){var r=0,a,n=BS(e),i=n.length+1,o,u,d,h,m;for(a=Zi(i),a[0]=n.length,o=1;o!=i;++o)a[o]=n[o-1];for(o=i-1;o>=0;--o)u=a[o],d=(r&16384)===0?0:1,h=r<<1&32767,m=d|h,r=m^u;return r^52811}var VS=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],a=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(u){return(u/2|u*128)&255},i=function(u,d){return n(u^d)},o=function(u){for(var d=r[u.length-1],h=104,m=u.length-1;m>=0;--m)for(var p=u[m],v=0;v!=7;++v)p&64&&(d^=a[h]),p*=2,--h;return d};return function(u){for(var d=BS(u),h=o(d),m=d.length,p=Zi(16),v=0;v!=16;++v)p[v]=0;var y,N,j;for((m&1)===1&&(y=h>>8,p[m]=i(e[0],y),--m,y=h&255,N=d[d.length-1],p[m]=i(N,y));m>0;)--m,y=h>>8,p[m]=i(d[m],y),--m,y=h&255,p[m]=i(d[m],y);for(m=15,j=15-d.length;j>0;)y=h>>8,p[m]=i(e[j],y),--m,--j,y=h&255,p[m]=i(d[m],y),--m,--j;return p}})(),_F=function(e,r,a,n,i){i||(i=r),n||(n=VS(e));var o,u;for(o=0;o!=r.length;++o)u=r[o],u^=n[a],u=(u>>5|u<<3)&255,i[o]=u,++a;return[i,a,n]},EF=function(e){var r=0,a=VS(e);return function(n){var i=_F("",n,r,a);return r=i[1],i[0]}};function TF(e,r,a,n){var i={key:Wa(e),verificationBytes:Wa(e)};return a.password&&(i.verifier=SF(a.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=EF(a.password)),i}function CF(e,r,a){var n=a||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=wF(e):n.Data=NF(e,r),n}function AF(e,r,a){var n={Type:a.biff>=8?e.read_shift(2):0};return n.Type?CF(e,r-2,n):TF(e,a.biff>=8?r:r-2,a,n),n}var kF=(function(){function e(i,o){switch(o.type){case"base64":return r(vs(i),o);case"binary":return r(i,o);case"buffer":return r(Kt&&Buffer.isBuffer(i)?i.toString("binary"):Vl(i),o);case"array":return r(Ml(i),o)}throw new Error("Unrecognized type "+o.type)}function r(i,o){var u=o||{},d=u.dense?[]:{},h=i.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var m={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(p,v){Array.isArray(d)&&(d[v]=[]);for(var y=/\\\w+\b/g,N=0,j,b=-1;j=y.exec(p);){switch(j[0]){case"\\cell":var w=p.slice(N,y.lastIndex-j[0].length);if(w[0]==" "&&(w=w.slice(1)),++b,w.length){var T={v:w,t:"s"};Array.isArray(d)?d[v][b]=T:d[Ct({r:v,c:b})]=T}break}N=y.lastIndex}b>m.e.c&&(m.e.c=b)}),d["!ref"]=Zt(m),d}function a(i,o){return sl(e(i,o),o)}function n(i){for(var o=["{\\rtf1\\ansi"],u=Ra(i["!ref"]),d,h=Array.isArray(i),m=u.s.r;m<=u.e.r;++m){o.push("\\trowd\\trautofit1");for(var p=u.s.c;p<=u.e.c;++p)o.push("\\cellx"+(p+1));for(o.push("\\pard\\intbl"),p=u.s.c;p<=u.e.c;++p){var v=Ct({r:m,c:p});d=h?(i[m]||[])[p]:i[v],!(!d||d.v==null&&(!d.f||d.F))&&(o.push(" "+(d.w||(fi(d),d.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:a,to_sheet:e,from_sheet:n}})();function DF(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function Bu(e){for(var r=0,a=1;r!=3;++r)a=a*256+(e[r]>255?255:e[r]<0?0:e[r]);return a.toString(16).toUpperCase().slice(1)}function OF(e){var r=e[0]/255,a=e[1]/255,n=e[2]/255,i=Math.max(r,a,n),o=Math.min(r,a,n),u=i-o;if(u===0)return[0,0,r];var d=0,h=0,m=i+o;switch(h=u/(m>1?2-m:m),i){case r:d=((a-n)/u+6)%6;break;case a:d=(n-r)/u+2;break;case n:d=(r-a)/u+4;break}return[d/6,h,m/2]}function RF(e){var r=e[0],a=e[1],n=e[2],i=a*2*(n<.5?n:1-n),o=n-i/2,u=[o,o,o],d=6*r,h;if(a!==0)switch(d|0){case 0:case 6:h=i*d,u[0]+=i,u[1]+=h;break;case 1:h=i*(2-d),u[0]+=h,u[1]+=i;break;case 2:h=i*(d-2),u[1]+=i,u[2]+=h;break;case 3:h=i*(4-d),u[1]+=h,u[2]+=i;break;case 4:h=i*(d-4),u[2]+=i,u[0]+=h;break;case 5:h=i*(6-d),u[2]+=h,u[0]+=i;break}for(var m=0;m!=3;++m)u[m]=Math.round(u[m]*255);return u}function p0(e,r){if(r===0)return e;var a=OF(DF(e));return r<0?a[2]=a[2]*(1+r):a[2]=1-(1-a[2])*(1-r),Bu(RF(a))}var HS=6,MF=15,FF=1,Mr=HS;function g0(e){return Math.floor((e+Math.round(128/Mr)/256)*Mr)}function v0(e){return Math.floor((e-5)/Mr*100+.5)/100}function tp(e){return Math.round((e*Mr+5)/Mr*256)/256}function vx(e){return tp(v0(g0(e)))}function og(e){var r=Math.abs(e-vx(e)),a=Mr;if(r>.005)for(Mr=FF;Mr<MF;++Mr)Math.abs(e-vx(e))<=r&&(r=Math.abs(e-vx(e)),a=Mr);Mr=a}function Gc(e){e.width?(e.wpx=g0(e.width),e.wch=v0(e.wpx),e.MDW=Mr):e.wpx?(e.wch=v0(e.wpx),e.width=tp(e.wch),e.MDW=Mr):typeof e.wch=="number"&&(e.width=tp(e.wch),e.wpx=g0(e.width),e.MDW=Mr),e.customWidth&&delete e.customWidth}var IF=96,GS=IF;function qS(e){return e*96/GS}function Uu(e){return e*GS/96}var LF={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function PF(e,r,a,n){r.Borders=[];var i={},o=!1;(e[0].match(Cr)||[]).forEach(function(u){var d=Et(u);switch(Cn(d[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},d.diagonalUp&&(i.diagonalUp=Ta(d.diagonalUp)),d.diagonalDown&&(i.diagonalDown=Ta(d.diagonalDown)),r.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+d[0]+" in borders")}})}function BF(e,r,a,n){r.Fills=[];var i={},o=!1;(e[0].match(Cr)||[]).forEach(function(u){var d=Et(u);switch(Cn(d[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},r.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":d.patternType&&(i.patternType=d.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),d.indexed&&(i.bgColor.indexed=parseInt(d.indexed,10)),d.theme&&(i.bgColor.theme=parseInt(d.theme,10)),d.tint&&(i.bgColor.tint=parseFloat(d.tint)),d.rgb&&(i.bgColor.rgb=d.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),d.theme&&(i.fgColor.theme=parseInt(d.theme,10)),d.tint&&(i.fgColor.tint=parseFloat(d.tint)),d.rgb!=null&&(i.fgColor.rgb=d.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+d[0]+" in fills")}})}function UF(e,r,a,n){r.Fonts=[];var i={},o=!1;(e[0].match(Cr)||[]).forEach(function(u){var d=Et(u);switch(Cn(d[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(i),i={};break;case"<name":d.val&&(i.name=va(d.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=d.val?Ta(d.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=d.val?Ta(d.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(d.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=d.val?Ta(d.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=d.val?Ta(d.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=d.val?Ta(d.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=d.val?Ta(d.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=d.val?Ta(d.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":d.val&&(i.sz=+d.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":d.val&&(i.vertAlign=d.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":d.val&&(i.family=parseInt(d.val,10));break;case"<family/>":case"</family>":break;case"<scheme":d.val&&(i.scheme=d.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(d.val=="1")break;d.codepage=qp[parseInt(d.val,10)];break;case"<color":if(i.color||(i.color={}),d.auto&&(i.color.auto=Ta(d.auto)),d.rgb)i.color.rgb=d.rgb.slice(-6);else if(d.indexed){i.color.index=parseInt(d.indexed,10);var h=Dl[i.color.index];i.color.index==81&&(h=Dl[1]),h||(h=Dl[1]),i.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else d.theme&&(i.color.theme=parseInt(d.theme,10),d.tint&&(i.color.tint=parseFloat(d.tint)),d.theme&&a.themeElements&&a.themeElements.clrScheme&&(i.color.rgb=p0(a.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+d[0]+" in fonts")}})}function zF(e,r,a){r.NumberFmt=[];for(var n=wn(It),i=0;i<n.length;++i)r.NumberFmt[n[i]]=It[n[i]];var o=e[0].match(Cr);if(o)for(i=0;i<o.length;++i){var u=Et(o[i]);switch(Cn(u[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var d=ea(va(u.formatCode)),h=parseInt(u.numFmtId,10);if(r.NumberFmt[h]=d,h>0){if(h>392){for(h=392;h>60&&r.NumberFmt[h]!=null;--h);r.NumberFmt[h]=d}kl(d,h)}}break;case"</numFmt>":break;default:if(a.WTF)throw new Error("unrecognized "+u[0]+" in numFmts")}}}var Lf=["numFmtId","fillId","fontId","borderId","xfId"],Pf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function VF(e,r,a){r.CellXf=[];var n,i=!1;(e[0].match(Cr)||[]).forEach(function(o){var u=Et(o),d=0;switch(Cn(u[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=u,delete n[0],d=0;d<Lf.length;++d)n[Lf[d]]&&(n[Lf[d]]=parseInt(n[Lf[d]],10));for(d=0;d<Pf.length;++d)n[Pf[d]]&&(n[Pf[d]]=Ta(n[Pf[d]]));if(r.NumberFmt&&n.numFmtId>392){for(d=392;d>60;--d)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[d]){n.numFmtId=d;break}}r.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};u.vertical&&(h.vertical=u.vertical),u.horizontal&&(h.horizontal=u.horizontal),u.textRotation!=null&&(h.textRotation=u.textRotation),u.indent&&(h.indent=u.indent),u.wrapText&&(h.wrapText=Ta(u.wrapText)),n.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+u[0]+" in cellXfs")}})}var HF=(function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,a=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(d,h,m){var p={};if(!d)return p;d=d.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=d.match(r))&&zF(v,p,m),(v=d.match(i))&&UF(v,p,h,m),(v=d.match(n))&&BF(v,p,h,m),(v=d.match(o))&&PF(v,p,h,m),(v=d.match(a))&&VF(v,p,m),p}})();function GF(e,r){var a=e.read_shift(2),n=Sr(e);return[a,n]}function qF(e,r,a){var n={};n.sz=e.read_shift(2)/20;var i=t6(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var o=e.read_shift(2);switch(o===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var u=e.read_shift(1);u!=0&&(n.underline=u);var d=e.read_shift(1);d>0&&(n.family=d);var h=e.read_shift(1);switch(h>0&&(n.charset=h),e.l++,n.color=e6(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Sr(e),n}var WF=Er;function YF(e,r){var a=e.l+r,n=e.read_shift(2),i=e.read_shift(2);return e.l=a,{ixfe:n,numFmtId:i}}var XF=Er;function $F(e,r,a){var n={};n.NumberFmt=[];for(var i in It)n.NumberFmt[i]=It[i];n.CellXf=[],n.Fonts=[];var o=[],u=!1;return pi(e,function(h,m,p){switch(p){case 44:n.NumberFmt[h[0]]=h[1],kl(h[1],h[0]);break;case 43:n.Fonts.push(h),h.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(h.color.rgb=p0(r.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&n.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:u=!0;break;case 36:u=!1;break;case 37:o.push(p),u=!0;break;case 38:o.pop(),u=!1;break;default:if(m.T>0)o.push(p);else if(m.T<0)o.pop();else if(!u||a.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),n}var KF=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function QF(e,r,a){r.themeElements.clrScheme=[];var n={};(e[0].match(Cr)||[]).forEach(function(i){var o=Et(i);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=o.val;break;case"<a:sysClr":n.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(r.themeElements.clrScheme[KF.indexOf(o[0])]=n,n={}):n.name=o[0].slice(3,o[0].length-1);break;default:if(a&&a.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function ZF(){}function JF(){}var e8=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,t8=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,a8=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function r8(e,r,a){r.themeElements={};var n;[["clrScheme",e8,QF],["fontScheme",t8,ZF],["fmtScheme",a8,JF]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,r,a)})}var s8=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function WS(e,r){(!e||e.length===0)&&(e=n8());var a,n={};if(!(a=e.match(s8)))throw new Error("themeElements not found in theme");return r8(a[0],n,r),n.raw=e,n}function n8(e,r){var a=[rS];return a[a.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',a[a.length]="<a:themeElements>",a[a.length]='<a:clrScheme name="Office">',a[a.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',a[a.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',a[a.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',a[a.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',a[a.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',a[a.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',a[a.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',a[a.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',a[a.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',a[a.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',a[a.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',a[a.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',a[a.length]="</a:clrScheme>",a[a.length]='<a:fontScheme name="Office">',a[a.length]="<a:majorFont>",a[a.length]='<a:latin typeface="Cambria"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Times New Roman"/>',a[a.length]='<a:font script="Hebr" typeface="Times New Roman"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="MoolBoran"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Times New Roman"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:majorFont>",a[a.length]="<a:minorFont>",a[a.length]='<a:latin typeface="Calibri"/>',a[a.length]='<a:ea typeface=""/>',a[a.length]='<a:cs typeface=""/>',a[a.length]='<a:font script="Jpan" typeface=" "/>',a[a.length]='<a:font script="Hang" typeface=" "/>',a[a.length]='<a:font script="Hans" typeface=""/>',a[a.length]='<a:font script="Hant" typeface=""/>',a[a.length]='<a:font script="Arab" typeface="Arial"/>',a[a.length]='<a:font script="Hebr" typeface="Arial"/>',a[a.length]='<a:font script="Thai" typeface="Tahoma"/>',a[a.length]='<a:font script="Ethi" typeface="Nyala"/>',a[a.length]='<a:font script="Beng" typeface="Vrinda"/>',a[a.length]='<a:font script="Gujr" typeface="Shruti"/>',a[a.length]='<a:font script="Khmr" typeface="DaunPenh"/>',a[a.length]='<a:font script="Knda" typeface="Tunga"/>',a[a.length]='<a:font script="Guru" typeface="Raavi"/>',a[a.length]='<a:font script="Cans" typeface="Euphemia"/>',a[a.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',a[a.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',a[a.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',a[a.length]='<a:font script="Thaa" typeface="MV Boli"/>',a[a.length]='<a:font script="Deva" typeface="Mangal"/>',a[a.length]='<a:font script="Telu" typeface="Gautami"/>',a[a.length]='<a:font script="Taml" typeface="Latha"/>',a[a.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',a[a.length]='<a:font script="Orya" typeface="Kalinga"/>',a[a.length]='<a:font script="Mlym" typeface="Kartika"/>',a[a.length]='<a:font script="Laoo" typeface="DokChampa"/>',a[a.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',a[a.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',a[a.length]='<a:font script="Viet" typeface="Arial"/>',a[a.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',a[a.length]='<a:font script="Geor" typeface="Sylfaen"/>',a[a.length]="</a:minorFont>",a[a.length]="</a:fontScheme>",a[a.length]='<a:fmtScheme name="Office">',a[a.length]="<a:fillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="1"/>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:lin ang="16200000" scaled="0"/>',a[a.length]="</a:gradFill>",a[a.length]="</a:fillStyleLst>",a[a.length]="<a:lnStyleLst>",a[a.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',a[a.length]="</a:lnStyleLst>",a[a.length]="<a:effectStyleLst>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]="</a:effectStyle>",a[a.length]="<a:effectStyle>",a[a.length]="<a:effectLst>",a[a.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',a[a.length]="</a:effectLst>",a[a.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',a[a.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',a[a.length]="</a:effectStyle>",a[a.length]="</a:effectStyleLst>",a[a.length]="<a:bgFillStyleLst>",a[a.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]='<a:gradFill rotWithShape="1">',a[a.length]="<a:gsLst>",a[a.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',a[a.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',a[a.length]="</a:gsLst>",a[a.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',a[a.length]="</a:gradFill>",a[a.length]="</a:bgFillStyleLst>",a[a.length]="</a:fmtScheme>",a[a.length]="</a:themeElements>",a[a.length]="<a:objectDefaults>",a[a.length]="<a:spDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',a[a.length]="</a:spDef>",a[a.length]="<a:lnDef>",a[a.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',a[a.length]="</a:lnDef>",a[a.length]="</a:objectDefaults>",a[a.length]="<a:extraClrSchemeLst/>",a[a.length]="</a:theme>",a.join("")}function i8(e,r,a){var n=e.l+r,i=e.read_shift(4);if(i!==124226){if(!a.cellStyles){e.l=n;return}var o=e.slice(e.l);e.l=n;var u;try{u=aS(o,{type:"array"})}catch{return}var d=ms(u,"theme/theme/theme1.xml",!0);if(d)return WS(d,a)}}function l8(e){return e.read_shift(4)}function c8(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=o8(e,4);break;case 2:r.xclrValue=OS(e);break;case 3:r.xclrValue=l8(e);break;case 4:e.l+=4;break}return e.l+=8,r}function o8(e,r){return Er(e,r)}function u8(e,r){return Er(e,r)}function d8(e){var r=e.read_shift(2),a=e.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=c8(e);break;case 6:n[1]=u8(e,a);break;case 14:case 15:n[1]=e.read_shift(a===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+a)}return n}function f8(e,r){var a=e.l+r;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),o=[];i-- >0;)o.push(d8(e,a-e.l));return{ixfe:n,ext:o}}function h8(e,r){r.forEach(function(a){a[0]})}function m8(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:Sr(e)}}function x8(e){for(var r=[],a=e.read_shift(4);a-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function p8(e){return e.l+=4,e.read_shift(4)!=0}function g8(e,r,a){var n={Types:[],Cell:[],Value:[]},i=a||{},o=[],u=!1,d=2;return pi(e,function(h,m,p){switch(p){case 335:n.Types.push({name:h.name});break;case 51:h.forEach(function(v){d==1?n.Cell.push({type:n.Types[v[0]-1].name,index:v[1]}):d==0&&n.Value.push({type:n.Types[v[0]-1].name,index:v[1]})});break;case 337:d=h?1:0;break;case 338:d=2;break;case 35:o.push(p),u=!0;break;case 36:o.pop(),u=!1;break;default:if(!m.T){if(!u||i.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),n}function v8(e,r,a){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,o=2,u;return e.replace(Cr,function(d){var h=Et(d);switch(Cn(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var m=0;m<n.Types.length;++m)n.Types[m].name==h.name&&(u=n.Types[m]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?n.Cell.push({type:n.Types[h.t-1].name,index:+h.v}):o==0&&n.Value.push({type:n.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!u)break;u.offsets||(u.offsets=[]),u.offsets.push(+h.i);break;default:if(!i&&a.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return d}),n}function y8(e){var r=[];if(!e)return r;var a=1;return(e.match(Cr)||[]).forEach(function(n){var i=Et(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?a=i.i:i.i=a,r.push(i);break}}),r}function j8(e){var r={};r.i=e.read_shift(4);var a={};a.r=e.read_shift(4),a.c=e.read_shift(4),r.r=Ct(a);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function b8(e,r,a){var n=[];return pi(e,function(o,u,d){switch(d){case 63:n.push(o);break;default:if(!u.T)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function N8(e,r,a,n){if(!e)return e;var i=n||{},o=!1;pi(e,function(d,h,m){switch(m){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!h.T){if(!o||i.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}},i)}function w8(e,r){if(!e)return"??";var a=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][a].Target}function Db(e,r,a,n){var i=Array.isArray(e),o;r.forEach(function(u){var d=Lr(u.ref);if(i?(e[d.r]||(e[d.r]=[]),o=e[d.r][d.c]):o=e[u.ref],!o){o={t:"z"},i?e[d.r][d.c]=o:e[u.ref]=o;var h=Ra(e["!ref"]||"BDWGO1000001:A1");h.s.r>d.r&&(h.s.r=d.r),h.e.r<d.r&&(h.e.r=d.r),h.s.c>d.c&&(h.s.c=d.c),h.e.c<d.c&&(h.e.c=d.c);var m=Zt(h);m!==e["!ref"]&&(e["!ref"]=m)}o.c||(o.c=[]);var p={a:u.author,t:u.t,r:u.r,T:a};u.h&&(p.h=u.h);for(var v=o.c.length-1;v>=0;--v){if(!a&&o.c[v].T)return;a&&!o.c[v].T&&o.c.splice(v,1)}if(a&&n){for(v=0;v<n.length;++v)if(p.a==n[v].id){p.a=n[v].name||p.a;break}}o.c.push(p)})}function S8(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var a=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(u){if(!(u===""||u.trim()==="")){var d=u.match(/<(?:\w+:)?author[^>]*>(.*)/);d&&a.push(d[1])}});var o=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(u){if(!(u===""||u.trim()==="")){var d=u.match(/<(?:\w+:)?comment[^>]*>/);if(d){var h=Et(d[0]),m={author:h.authorId&&a[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},p=Lr(h.ref);if(!(r.sheetRows&&r.sheetRows<=p.r)){var v=u.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),y=!!v&&!!v[1]&&cg(v[1])||{r:"",t:"",h:""};m.r=y.r,y.r=="<t></t>"&&(y.t=y.h=""),m.t=(y.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(m.h=y.h),n.push(m)}}}}),n}function _8(e,r){var a=[],n=!1,i={},o=0;return e.replace(Cr,function(d,h){var m=Et(d);switch(Cn(m[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:m.personId,guid:m.id,ref:m.ref,T:1};break;case"</threadedComment>":i.t!=null&&a.push(i);break;case"<text>":case"<text":o=h+d.length;break;case"</text>":i.t=e.slice(o,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+m[0]+" in threaded comments")}return d}),a}function E8(e,r){var a=[],n=!1;return e.replace(Cr,function(o){var u=Et(o);switch(Cn(u[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":a.push({name:u.displayname,id:u.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),a}function T8(e){var r={};r.iauthor=e.read_shift(4);var a=Gl(e);return r.rfx=a.s,r.ref=Ct(a.s),e.l+=16,r}var C8=Sr;function A8(e,r){var a=[],n=[],i={},o=!1;return pi(e,function(d,h,m){switch(m){case 632:n.push(d);break;case 635:i=d;break;case 637:i.t=d.t,i.h=d.h,i.r=d.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,r.sheetRows&&i.rfx&&r.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,a.push(i);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!o||r.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}),a}var k8="application/vnd.ms-office.vbaProject";function D8(e){var r=Qt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(a,n){if(!(a.slice(-1)==="/"||!a.match(/_VBA_PROJECT_CUR/))){var i=a.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Qt.utils.cfb_add(r,i,e.FileIndex[n].content)}}),Qt.write(r)}function O8(){return{"!type":"dialog"}}function R8(){return{"!type":"dialog"}}function M8(){return{"!type":"macro"}}function F8(){return{"!type":"macro"}}var Pc=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function a(n,i,o,u){var d=!1,h=!1;o.length==0?h=!0:o.charAt(0)=="["&&(h=!0,o=o.slice(1,-1)),u.length==0?d=!0:u.charAt(0)=="["&&(d=!0,u=u.slice(1,-1));var m=o.length>0?parseInt(o,10)|0:0,p=u.length>0?parseInt(u,10)|0:0;return d?p+=r.c:--p,h?m+=r.r:--m,i+(d?"":"$")+Za(p)+(h?"":"$")+dr(m)}return function(i,o){return r=o,i.replace(e,a)}})(),YS=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,I8=(function(){return function(r,a){return r.replace(YS,function(n,i,o,u,d,h){var m=ag(u)-(o?0:a.c),p=tg(h)-(d?0:a.r),v=p==0?"":d?p+1:"["+p+"]",y=m==0?"":o?m+1:"["+m+"]";return i+"R"+v+"C"+y})}})();function XS(e,r){return e.replace(YS,function(a,n,i,o,u,d){return n+(i=="$"?i+o:Za(ag(o)+r.c))+(u=="$"?u+d:dr(tg(d)+r.r))})}function L8(e,r,a){var n=Zc(r),i=n.s,o=Lr(a),u={r:o.r-i.r,c:o.c-i.c};return XS(e,u)}function P8(e){return e.length!=1}function Ob(e){return e.replace(/_xlfn\./g,"")}function Ga(e){e.l+=1}function Ji(e,r){var a=e.read_shift(2);return[a&16383,a>>14&1,a>>15&1]}function $S(e,r,a){var n=2;if(a){if(a.biff>=2&&a.biff<=5)return KS(e);a.biff==12&&(n=4)}var i=e.read_shift(n),o=e.read_shift(n),u=Ji(e),d=Ji(e);return{s:{r:i,c:u[0],cRel:u[1],rRel:u[2]},e:{r:o,c:d[0],cRel:d[1],rRel:d[2]}}}function KS(e){var r=Ji(e),a=Ji(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:a[0],c:i,cRel:a[1],rRel:a[2]}}}function B8(e,r,a){if(a.biff<8)return KS(e);var n=e.read_shift(a.biff==12?4:2),i=e.read_shift(a.biff==12?4:2),o=Ji(e),u=Ji(e);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:u[0],cRel:u[1],rRel:u[2]}}}function QS(e,r,a){if(a&&a.biff>=2&&a.biff<=5)return U8(e);var n=e.read_shift(a&&a.biff==12?4:2),i=Ji(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function U8(e){var r=Ji(e),a=e.read_shift(1);return{r:r[0],c:a,cRel:r[1],rRel:r[2]}}function z8(e){var r=e.read_shift(2),a=e.read_shift(2);return{r,c:a&255,fQuoted:!!(a&16384),cRel:a>>15,rRel:a>>15}}function V8(e,r,a){var n=a&&a.biff?a.biff:8;if(n>=2&&n<=5)return H8(e);var i=e.read_shift(n>=12?4:2),o=e.read_shift(2),u=(o&16384)>>14,d=(o&32768)>>15;if(o&=16383,d==1)for(;i>524287;)i-=1048576;if(u==1)for(;o>8191;)o=o-16384;return{r:i,c:o,cRel:u,rRel:d}}function H8(e){var r=e.read_shift(2),a=e.read_shift(1),n=(r&32768)>>15,i=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),i==1&&a>=128&&(a=a-256),{r,c:a,cRel:i,rRel:n}}function G8(e,r,a){var n=(e[e.l++]&96)>>5,i=$S(e,a.biff>=2&&a.biff<=5?6:8,a);return[n,i]}function q8(e,r,a){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),o=8;if(a)switch(a.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var u=$S(e,o,a);return[n,i,u]}function W8(e,r,a){var n=(e[e.l++]&96)>>5;return e.l+=a&&a.biff>8?12:a.biff<8?6:8,[n]}function Y8(e,r,a){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),o=8;if(a)switch(a.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[n,i]}function X8(e,r,a){var n=(e[e.l++]&96)>>5,i=B8(e,r-1,a);return[n,i]}function $8(e,r,a){var n=(e[e.l++]&96)>>5;return e.l+=a.biff==2?6:a.biff==12?14:7,[n]}function Rb(e){var r=e[e.l+1]&1,a=1;return e.l+=4,[r,a]}function K8(e,r,a){e.l+=2;for(var n=e.read_shift(a&&a.biff==2?1:2),i=[],o=0;o<=n;++o)i.push(e.read_shift(a&&a.biff==2?1:2));return i}function Q8(e,r,a){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(a&&a.biff==2?1:2)]}function Z8(e,r,a){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(a&&a.biff==2?1:2)]}function J8(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function eI(e,r,a){var n=e[e.l+1]&255?1:0;return e.l+=a&&a.biff==2?3:4,[n]}function ZS(e){var r=e.read_shift(1),a=e.read_shift(1);return[r,a]}function tI(e){return e.read_shift(2),ZS(e)}function aI(e){return e.read_shift(2),ZS(e)}function rI(e,r,a){var n=(e[e.l]&96)>>5;e.l+=1;var i=QS(e,0,a);return[n,i]}function sI(e,r,a){var n=(e[e.l]&96)>>5;e.l+=1;var i=V8(e,0,a);return[n,i]}function nI(e,r,a){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);a&&a.biff==5&&(e.l+=12);var o=QS(e,0,a);return[n,i,o]}function iI(e,r,a){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(a&&a.biff<=3?1:2);return[lL[i],t_[i],n]}function lI(e,r,a){var n=e[e.l++],i=e.read_shift(1),o=a&&a.biff<=3?[n==88?-1:0,e.read_shift(1)]:cI(e);return[i,(o[0]===0?t_:iL)[o[1]]]}function cI(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function oI(e,r,a){e.l+=a&&a.biff==2?3:4}function uI(e,r,a){if(e.l++,a&&a.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(a&&a.biff==2?1:2);return[n,i]}function dI(e){return e.l++,ql[e.read_shift(1)]}function fI(e){return e.l++,e.read_shift(2)}function hI(e){return e.l++,e.read_shift(1)!==0}function mI(e){return e.l++,br(e)}function xI(e,r,a){return e.l++,id(e,r-1,a)}function pI(e,r){var a=[e.read_shift(1)];if(r==12)switch(a[0]){case 2:a[0]=4;break;case 4:a[0]=16;break;case 0:a[0]=1;break;case 1:a[0]=2;break}switch(a[0]){case 4:a[1]=La(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:a[1]=ql[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:a[1]=br(e);break;case 2:a[1]=Wl(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+a[0])}return a}function gI(e,r,a){for(var n=e.read_shift(a.biff==12?4:2),i=[],o=0;o!=n;++o)i.push((a.biff==12?Gl:P0)(e));return i}function vI(e,r,a){var n=0,i=0;a.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),a.biff>=2&&a.biff<8&&(--n,--i==0&&(i=256));for(var o=0,u=[];o!=n&&(u[o]=[]);++o)for(var d=0;d!=i;++d)u[o][d]=pI(e,a.biff);return u}function yI(e,r,a){var n=e.read_shift(1)>>>5&3,i=!a||a.biff>=8?4:2,o=e.read_shift(i);switch(a.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,o]}function jI(e,r,a){if(a.biff==5)return bI(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),o=e.read_shift(4);return[n,i,o]}function bI(e){var r=e.read_shift(1)>>>5&3,a=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,a,n]}function NI(e,r,a){var n=e.read_shift(1)>>>5&3;e.l+=a&&a.biff==2?3:4;var i=e.read_shift(a&&a.biff==2?1:2);return[n,i]}function wI(e,r,a){var n=e.read_shift(1)>>>5&3,i=e.read_shift(a&&a.biff==2?1:2);return[n,i]}function SI(e,r,a){var n=e.read_shift(1)>>>5&3;return e.l+=4,a.biff<8&&e.l--,a.biff==12&&(e.l+=2),[n]}function _I(e,r,a){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),o=4;if(a)switch(a.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[n,i]}var EI=Er,TI=Er,CI=Er;function cd(e,r,a){return e.l+=2,[z8(e)]}function ug(e){return e.l+=6,[]}var AI=cd,kI=ug,DI=ug,OI=cd;function JS(e){return e.l+=2,[Wa(e),e.read_shift(2)&1]}var RI=cd,MI=JS,FI=ug,II=cd,LI=cd,PI=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function BI(e){e.l+=2;var r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),o=e.read_shift(2),u=PI[a>>2&31];return{ixti:r,coltype:a&3,rt:u,idx:n,c:i,C:o}}function UI(e){return e.l+=2,[e.read_shift(4)]}function zI(e,r,a){return e.l+=5,e.l+=2,e.l+=a.biff==2?1:4,["PTGSHEET"]}function VI(e,r,a){return e.l+=a.biff==2?4:5,["PTGENDSHEET"]}function HI(e){var r=e.read_shift(1)>>>5&3,a=e.read_shift(2);return[r,a]}function GI(e){var r=e.read_shift(1)>>>5&3,a=e.read_shift(2);return[r,a]}function qI(e){return e.l+=4,[0,0]}var Mb={1:{n:"PtgExp",f:uI},2:{n:"PtgTbl",f:CI},3:{n:"PtgAdd",f:Ga},4:{n:"PtgSub",f:Ga},5:{n:"PtgMul",f:Ga},6:{n:"PtgDiv",f:Ga},7:{n:"PtgPower",f:Ga},8:{n:"PtgConcat",f:Ga},9:{n:"PtgLt",f:Ga},10:{n:"PtgLe",f:Ga},11:{n:"PtgEq",f:Ga},12:{n:"PtgGe",f:Ga},13:{n:"PtgGt",f:Ga},14:{n:"PtgNe",f:Ga},15:{n:"PtgIsect",f:Ga},16:{n:"PtgUnion",f:Ga},17:{n:"PtgRange",f:Ga},18:{n:"PtgUplus",f:Ga},19:{n:"PtgUminus",f:Ga},20:{n:"PtgPercent",f:Ga},21:{n:"PtgParen",f:Ga},22:{n:"PtgMissArg",f:Ga},23:{n:"PtgStr",f:xI},26:{n:"PtgSheet",f:zI},27:{n:"PtgEndSheet",f:VI},28:{n:"PtgErr",f:dI},29:{n:"PtgBool",f:hI},30:{n:"PtgInt",f:fI},31:{n:"PtgNum",f:mI},32:{n:"PtgArray",f:$8},33:{n:"PtgFunc",f:iI},34:{n:"PtgFuncVar",f:lI},35:{n:"PtgName",f:yI},36:{n:"PtgRef",f:rI},37:{n:"PtgArea",f:G8},38:{n:"PtgMemArea",f:NI},39:{n:"PtgMemErr",f:EI},40:{n:"PtgMemNoMem",f:TI},41:{n:"PtgMemFunc",f:wI},42:{n:"PtgRefErr",f:SI},43:{n:"PtgAreaErr",f:W8},44:{n:"PtgRefN",f:sI},45:{n:"PtgAreaN",f:X8},46:{n:"PtgMemAreaN",f:HI},47:{n:"PtgMemNoMemN",f:GI},57:{n:"PtgNameX",f:jI},58:{n:"PtgRef3d",f:nI},59:{n:"PtgArea3d",f:q8},60:{n:"PtgRefErr3d",f:_I},61:{n:"PtgAreaErr3d",f:Y8},255:{}},WI={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},YI={1:{n:"PtgElfLel",f:JS},2:{n:"PtgElfRw",f:II},3:{n:"PtgElfCol",f:AI},6:{n:"PtgElfRwV",f:LI},7:{n:"PtgElfColV",f:OI},10:{n:"PtgElfRadical",f:RI},11:{n:"PtgElfRadicalS",f:FI},13:{n:"PtgElfColS",f:kI},15:{n:"PtgElfColSV",f:DI},16:{n:"PtgElfRadicalLel",f:MI},25:{n:"PtgList",f:BI},29:{n:"PtgSxName",f:UI},255:{}},XI={0:{n:"PtgAttrNoop",f:qI},1:{n:"PtgAttrSemi",f:eI},2:{n:"PtgAttrIf",f:Z8},4:{n:"PtgAttrChoose",f:K8},8:{n:"PtgAttrGoto",f:Q8},16:{n:"PtgAttrSum",f:oI},32:{n:"PtgAttrBaxcel",f:Rb},33:{n:"PtgAttrBaxcel",f:Rb},64:{n:"PtgAttrSpace",f:tI},65:{n:"PtgAttrSpaceSemi",f:aI},128:{n:"PtgAttrIfError",f:J8},255:{}};function od(e,r,a,n){if(n.biff<8)return Er(e,r);for(var i=e.l+r,o=[],u=0;u!==a.length;++u)switch(a[u][0]){case"PtgArray":a[u][1]=vI(e,0,n),o.push(a[u][1]);break;case"PtgMemArea":a[u][2]=gI(e,a[u][1],n),o.push(a[u][2]);break;case"PtgExp":n&&n.biff==12&&(a[u][1][1]=e.read_shift(4),o.push(a[u][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+a[u][0]}return r=i-e.l,r!==0&&o.push(Er(e,r)),o}function ud(e,r,a){for(var n=e.l+r,i,o,u=[];n!=e.l;)r=n-e.l,o=e[e.l],i=Mb[o]||Mb[WI[o]],(o===24||o===25)&&(i=(o===24?YI:XI)[e[e.l+1]]),!i||!i.f?Er(e,r):u.push([i.n,i.f(e,r,a)]);return u}function $I(e){for(var r=[],a=0;a<e.length;++a){for(var n=e[a],i=[],o=0;o<n.length;++o){var u=n[o];if(u)switch(u[0]){case 2:i.push('"'+u[1].replace(/"/g,'""')+'"');break;default:i.push(u[1])}else i.push("")}r.push(i.join(","))}return r.join(";")}var KI={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function QI(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function e_(e,r,a){if(!e)return"SH33TJSERR0";if(a.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(a.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var i="";if(a.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return a.SID!=null?e.SheetNames[a.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Fb(e,r,a){var n=e_(e,r,a);return n=="#REF"?n:QI(n,a)}function vr(e,r,a,n,i){var o=i&&i.biff||8,u={s:{c:0,r:0}},d=[],h,m,p,v=0,y=0,N,j="";if(!e[0]||!e[0][0])return"";for(var b=-1,w="",T=0,D=e[0].length;T<D;++T){var _=e[0][T];switch(_[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=d.pop(),m=d.pop(),b>=0){switch(e[0][b][1][0]){case 0:w=Oa(" ",e[0][b][1][1]);break;case 1:w=Oa("\r",e[0][b][1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}m=m+w,b=-1}d.push(m+KI[_[0]]+h);break;case"PtgIsect":h=d.pop(),m=d.pop(),d.push(m+" "+h);break;case"PtgUnion":h=d.pop(),m=d.pop(),d.push(m+","+h);break;case"PtgRange":h=d.pop(),m=d.pop(),d.push(m+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=gu(_[1][1],u,i),d.push(vu(p,o));break;case"PtgRefN":p=a?gu(_[1][1],a,i):_[1][1],d.push(vu(p,o));break;case"PtgRef3d":v=_[1][1],p=gu(_[1][2],u,i),j=Fb(n,v,i),d.push(j+"!"+vu(p,o));break;case"PtgFunc":case"PtgFuncVar":var R=_[1][0],z=_[1][1];R||(R=0),R&=127;var O=R==0?[]:d.slice(-R);d.length-=R,z==="User"&&(z=O.shift()),d.push(z+"("+O.join(",")+")");break;case"PtgBool":d.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":d.push(_[1]);break;case"PtgNum":d.push(String(_[1]));break;case"PtgStr":d.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":d.push(_[1]);break;case"PtgAreaN":N=xb(_[1][1],a?{s:a}:u,i),d.push(px(N,i));break;case"PtgArea":N=xb(_[1][1],u,i),d.push(px(N,i));break;case"PtgArea3d":v=_[1][1],N=_[1][2],j=Fb(n,v,i),d.push(j+"!"+px(N,i));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=_[1][2];var A=(n.names||[])[y-1]||(n[0]||[])[y],k=A?A.Name:"SH33TJSNAME"+String(y);k&&k.slice(0,6)=="_xlfn."&&!i.xlfn&&(k=k.slice(6)),d.push(k);break;case"PtgNameX":var E=_[1][1];y=_[1][2];var L;if(i.biff<=5)E<0&&(E=-E),n[E]&&(L=n[E][y]);else{var H="";if(((n[E]||[])[0]||[])[0]==14849||(((n[E]||[])[0]||[])[0]==1025?n[E][y]&&n[E][y].itab>0&&(H=n.SheetNames[n[E][y].itab-1]+"!"):H=n.SheetNames[y-1]+"!"),n[E]&&n[E][y])H+=n[E][y].Name;else if(n[0]&&n[0][y])H+=n[0][y].Name;else{var I=(e_(n,E,i)||"").split(";;");I[y-1]?H=I[y-1]:H+="SH33TJSERRX"}d.push(H);break}L||(L={Name:"SH33TJSERRY"}),d.push(L.Name);break;case"PtgParen":var re="(",ne=")";if(b>=0){switch(w="",e[0][b][1][0]){case 2:re=Oa(" ",e[0][b][1][1])+re;break;case 3:re=Oa("\r",e[0][b][1][1])+re;break;case 4:ne=Oa(" ",e[0][b][1][1])+ne;break;case 5:ne=Oa("\r",e[0][b][1][1])+ne;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}b=-1}d.push(re+d.pop()+ne);break;case"PtgRefErr":d.push("#REF!");break;case"PtgRefErr3d":d.push("#REF!");break;case"PtgExp":p={c:_[1][1],r:_[1][0]};var ge={c:a.c,r:a.r};if(n.sharedf[Ct(p)]){var W=n.sharedf[Ct(p)];d.push(vr(W,u,ge,n,i))}else{var ee=!1;for(h=0;h!=n.arrayf.length;++h)if(m=n.arrayf[h],!(p.c<m[0].s.c||p.c>m[0].e.c)&&!(p.r<m[0].s.r||p.r>m[0].e.r)){d.push(vr(m[1],u,ge,n,i)),ee=!0;break}ee||d.push(_[1])}break;case"PtgArray":d.push("{"+$I(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":d.push("");break;case"PtgAreaErr":d.push("#REF!");break;case"PtgAreaErr3d":d.push("#REF!");break;case"PtgList":d.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var je=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&b>=0&&je.indexOf(e[0][T][0])==-1){_=e[0][b];var Z=!0;switch(_[1][0]){case 4:Z=!1;case 0:w=Oa(" ",_[1][1]);break;case 5:Z=!1;case 1:w=Oa("\r",_[1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}d.push((Z?w:"")+d.pop()+(Z?"":w)),b=-1}}if(d.length>1&&i.WTF)throw new Error("bad formula stack");return d[0]}function ZI(e,r,a){var n=e.l+r,i=a.biff==2?1:2,o,u=e.read_shift(i);if(u==65535)return[[],Er(e,r-2)];var d=ud(e,u,a);return r!==u+i&&(o=od(e,r-u-i,d,a)),e.l=n,[d,o]}function JI(e,r,a){var n=e.l+r,i=a.biff==2?1:2,o,u=e.read_shift(i);if(u==65535)return[[],Er(e,r-2)];var d=ud(e,u,a);return r!==u+i&&(o=od(e,r-u-i,d,a)),e.l=n,[d,o]}function eL(e,r,a,n){var i=e.l+r,o=ud(e,n,a),u;return i!==e.l&&(u=od(e,i-e.l,o,a)),[o,u]}function tL(e,r,a){var n=e.l+r,i,o=e.read_shift(2),u=ud(e,o,a);return o==65535?[[],Er(e,r-2)]:(r!==o+2&&(i=od(e,n-o-2,u,a)),[u,i])}function aL(e){var r;if(ti(e,e.l+6)!==65535)return[br(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function yx(e,r,a){var n=e.l+r,i=An(e);a.biff==2&&++e.l;var o=aL(e),u=e.read_shift(1);a.biff!=2&&(e.read_shift(1),a.biff>=5&&e.read_shift(4));var d=JI(e,n-e.l,a);return{cell:i,val:o[0],formula:d,shared:u>>3&1,tt:o[1]}}function B0(e,r,a){var n=e.read_shift(4),i=ud(e,n,a),o=e.read_shift(4),u=o>0?od(e,o,i,a):null;return[i,u]}var rL=B0,U0=B0,sL=B0,nL=B0,iL={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},t_={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},lL={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Ib(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,a){return a.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function jx(e){var r=e.split(":"),a=r[0].split(".")[0];return[a,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var Nu={},Bc={};function wu(e,r){if(e){var a=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(a=[1,1,1,1,.5,.5]),e.left==null&&(e.left=a[0]),e.right==null&&(e.right=a[1]),e.top==null&&(e.top=a[2]),e.bottom==null&&(e.bottom=a[3]),e.header==null&&(e.header=a[4]),e.footer==null&&(e.footer=a[5])}}function a_(e,r,a,n,i,o){try{n.cellNF&&(e.z=It[r])}catch(d){if(n.WTF)throw d}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=ar(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(It[r]==null&&kl(c5[r]||"General",r),e.t==="e")e.w=e.w||ql[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Fu(e.v);else if(e.t==="d"){var u=Ur(e.v);(u|0)===u?e.w=u.toString(10):e.w=Fu(u)}else{if(e.v===void 0)return"";e.w=Rl(e.v,Bc)}else e.t==="d"?e.w=Fs(r,Ur(e.v),Bc):e.w=Fs(r,e.v,Bc)}catch(d){if(n.WTF)throw d}if(n.cellStyles&&a!=null)try{e.s=o.Fills[a],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=p0(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=p0(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(d){if(n.WTF&&o.Fills)throw d}}}function cL(e,r){var a=Ra(r);a.s.r<=a.e.r&&a.s.c<=a.e.c&&a.s.r>=0&&a.s.c>=0&&(e["!ref"]=Zt(a))}var oL=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,uL=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,dL=/<(?:\w:)?hyperlink [^>]*>/mg,fL=/"(\w*:\w*)"/,hL=/<(?:\w:)?col\b[^>]*[\/]?>/g,mL=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,xL=/<(?:\w:)?pageMargins[^>]*\/>/g,r_=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,pL=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,gL=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function vL(e,r,a,n,i,o,u){if(!e)return e;n||(n={"!id":{}});var d=r.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},m="",p="",v=e.match(uL);v?(m=e.slice(0,v.index),p=e.slice(v.index+v[0].length)):m=p=e;var y=m.match(r_);y?dg(y[0],d,i,a):(y=m.match(pL))&&yL(y[0],y[1]||"",d,i,a);var N=(m.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(N>0){var j=m.slice(N,N+50).match(fL);j&&cL(d,j[1])}var b=m.match(gL);b&&b[1]&&_L(b[1],i);var w=[];if(r.cellStyles){var T=m.match(hL);T&&NL(w,T)}v&&EL(v[1],d,r,h,o,u);var D=p.match(mL);D&&(d["!autofilter"]=wL(D[0]));var _=[],R=p.match(oL);if(R)for(N=0;N!=R.length;++N)_[N]=Ra(R[N].slice(R[N].indexOf('"')+1));var z=p.match(dL);z&&jL(d,z,n);var O=p.match(xL);if(O&&(d["!margins"]=bL(Et(O[0]))),!d["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(d["!ref"]=Zt(h)),r.sheetRows>0&&d["!ref"]){var A=Ra(d["!ref"]);r.sheetRows<=+A.e.r&&(A.e.r=r.sheetRows-1,A.e.r>h.e.r&&(A.e.r=h.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>h.e.c&&(A.e.c=h.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),d["!fullref"]=d["!ref"],d["!ref"]=Zt(A))}return w.length>0&&(d["!cols"]=w),_.length>0&&(d["!merges"]=_),d}function dg(e,r,a,n){var i=Et(e);a.Sheets[n]||(a.Sheets[n]={}),i.codeName&&(a.Sheets[n].CodeName=ea(va(i.codeName)))}function yL(e,r,a,n,i){dg(e.slice(0,e.indexOf(">")),a,n,i)}function jL(e,r,a){for(var n=Array.isArray(e),i=0;i!=r.length;++i){var o=Et(va(r[i]),!0);if(!o.ref)return;var u=((a||{})["!id"]||[])[o.id];u?(o.Target=u.Target,o.location&&(o.Target+="#"+ea(o.location))):(o.Target="#"+ea(o.location),u={Target:o.Target,TargetMode:"Internal"}),o.Rel=u,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var d=Ra(o.ref),h=d.s.r;h<=d.e.r;++h)for(var m=d.s.c;m<=d.e.c;++m){var p=Ct({c:m,r:h});n?(e[h]||(e[h]=[]),e[h][m]||(e[h][m]={t:"z",v:void 0}),e[h][m].l=o):(e[p]||(e[p]={t:"z",v:void 0}),e[p].l=o)}}}function bL(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(a){e[a]&&(r[a]=parseFloat(e[a]))}),r}function NL(e,r){for(var a=!1,n=0;n!=r.length;++n){var i=Et(r[n],!0);i.hidden&&(i.hidden=Ta(i.hidden));var o=parseInt(i.min,10)-1,u=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!a&&i.width&&(a=!0,og(i.width)),Gc(i);o<=u;)e[o++]=ur(i)}}function wL(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}var SL=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function _L(e,r){r.Views||(r.Views=[{}]),(e.match(SL)||[]).forEach(function(a,n){var i=Et(a);r.Views[n]||(r.Views[n]={}),+i.zoomScale&&(r.Views[n].zoom=+i.zoomScale),Ta(i.rightToLeft)&&(r.Views[n].RTL=!0)})}var EL=(function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,a=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,o=Iu("v"),u=Iu("f");return function(h,m,p,v,y,N){for(var j=0,b="",w=[],T=[],D=0,_=0,R=0,z="",O,A,k=0,E=0,L,H,I=0,re=0,ne=Array.isArray(N.CellXf),ge,W=[],ee=[],je=Array.isArray(m),Z=[],De={},he=!1,P=!!p.sheetStubs,q=h.split(r),J=0,K=q.length;J!=K;++J){b=q[J].trim();var xe=b.length;if(xe!==0){var Fe=0;e:for(j=0;j<xe;++j)switch(b[j]){case">":if(b[j-1]!="/"){++j;break e}if(p&&p.cellStyles){if(A=Et(b.slice(Fe,j),!0),k=A.r!=null?parseInt(A.r,10):k+1,E=-1,p.sheetRows&&p.sheetRows<k)continue;De={},he=!1,A.ht&&(he=!0,De.hpt=parseFloat(A.ht),De.hpx=Uu(De.hpt)),A.hidden=="1"&&(he=!0,De.hidden=!0),A.outlineLevel!=null&&(he=!0,De.level=+A.outlineLevel),he&&(Z[k-1]=De)}break;case"<":Fe=j;break}if(Fe>=j)break;if(A=Et(b.slice(Fe,j),!0),k=A.r!=null?parseInt(A.r,10):k+1,E=-1,!(p.sheetRows&&p.sheetRows<k)){v.s.r>k-1&&(v.s.r=k-1),v.e.r<k-1&&(v.e.r=k-1),p&&p.cellStyles&&(De={},he=!1,A.ht&&(he=!0,De.hpt=parseFloat(A.ht),De.hpx=Uu(De.hpt)),A.hidden=="1"&&(he=!0,De.hidden=!0),A.outlineLevel!=null&&(he=!0,De.level=+A.outlineLevel),he&&(Z[k-1]=De)),w=b.slice(j).split(e);for(var Ae=0;Ae!=w.length&&w[Ae].trim().charAt(0)=="<";++Ae);for(w=w.slice(Ae),j=0;j!=w.length;++j)if(b=w[j].trim(),b.length!==0){if(T=b.match(a),D=j,_=0,R=0,b="<c "+(b.slice(0,1)=="<"?">":"")+b,T!=null&&T.length===2){for(D=0,z=T[1],_=0;_!=z.length&&!((R=z.charCodeAt(_)-64)<1||R>26);++_)D=26*D+R;--D,E=D}else++E;for(_=0;_!=b.length&&b.charCodeAt(_)!==62;++_);if(++_,A=Et(b.slice(0,_),!0),A.r||(A.r=Ct({r:k-1,c:E})),z=b.slice(_),O={t:""},(T=z.match(o))!=null&&T[1]!==""&&(O.v=ea(T[1])),p.cellFormula){if((T=z.match(u))!=null&&T[1]!==""){if(O.f=ea(va(T[1])).replace(/\r\n/g,`
`),p.xlfn||(O.f=Ob(O.f)),T[0].indexOf('t="array"')>-1)O.F=(z.match(i)||[])[1],O.F.indexOf(":")>-1&&W.push([Ra(O.F),O.F]);else if(T[0].indexOf('t="shared"')>-1){H=Et(T[0]);var Ee=ea(va(T[1]));p.xlfn||(Ee=Ob(Ee)),ee[parseInt(H.si,10)]=[H,Ee,A.r]}}else(T=z.match(/<f[^>]*\/>/))&&(H=Et(T[0]),ee[H.si]&&(O.f=L8(ee[H.si][1],ee[H.si][2],A.r)));var we=Lr(A.r);for(_=0;_<W.length;++_)we.r>=W[_][0].s.r&&we.r<=W[_][0].e.r&&we.c>=W[_][0].s.c&&we.c<=W[_][0].e.c&&(O.F=W[_][1])}if(A.t==null&&O.v===void 0)if(O.f||O.F)O.v=0,O.t="n";else if(P)O.t="z";else continue;else O.t=A.t||"n";switch(v.s.c>E&&(v.s.c=E),v.e.c<E&&(v.e.c=E),O.t){case"n":if(O.v==""||O.v==null){if(!P)continue;O.t="z"}else O.v=parseFloat(O.v);break;case"s":if(typeof O.v>"u"){if(!P)continue;O.t="z"}else L=Nu[parseInt(O.v,10)],O.v=L.t,O.r=L.r,p.cellHTML&&(O.h=L.h);break;case"str":O.t="s",O.v=O.v!=null?va(O.v):"",p.cellHTML&&(O.h=Zp(O.v));break;case"inlineStr":T=z.match(n),O.t="s",T!=null&&(L=cg(T[1]))?(O.v=L.t,p.cellHTML&&(O.h=L.h)):O.v="";break;case"b":O.v=Ta(O.v);break;case"d":p.cellDates?O.v=ar(O.v,1):(O.v=Ur(ar(O.v,1)),O.t="n");break;case"e":(!p||p.cellText!==!1)&&(O.w=O.v),O.v=SS[O.v];break}if(I=re=0,ge=null,ne&&A.s!==void 0&&(ge=N.CellXf[A.s],ge!=null&&(ge.numFmtId!=null&&(I=ge.numFmtId),p.cellStyles&&ge.fillId!=null&&(re=ge.fillId))),a_(O,I,re,p,y,N),p.cellDates&&ne&&O.t=="n"&&Qc(It[I])&&(O.t="d",O.v=L0(O.v)),A.cm&&p.xlmeta){var Ge=(p.xlmeta.Cell||[])[+A.cm-1];Ge&&Ge.type=="XLDAPR"&&(O.D=!0)}if(je){var X=Lr(A.r);m[X.r]||(m[X.r]=[]),m[X.r][X.c]=O}else m[A.r]=O}}}}Z.length>0&&(m["!rows"]=Z)}})();function TL(e,r){var a={},n=e.l+r;a.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=n,o&7&&(a.level=o&7),o&16&&(a.hidden=!0),o&32&&(a.hpt=i/20),a}var CL=Gl;function AL(){}function kL(e,r){var a={},n=e[e.l];return++e.l,a.above=!(n&64),a.left=!(n&128),e.l+=18,a.name=Z5(e),a}function DL(e){var r=Ls(e);return[r]}function OL(e){var r=Hl(e);return[r]}function RL(e){var r=Ls(e),a=e.read_shift(1);return[r,a,"b"]}function ML(e){var r=Hl(e),a=e.read_shift(1);return[r,a,"b"]}function FL(e){var r=Ls(e),a=e.read_shift(1);return[r,a,"e"]}function IL(e){var r=Hl(e),a=e.read_shift(1);return[r,a,"e"]}function LL(e){var r=Ls(e),a=e.read_shift(4);return[r,a,"s"]}function PL(e){var r=Hl(e),a=e.read_shift(4);return[r,a,"s"]}function BL(e){var r=Ls(e),a=br(e);return[r,a,"n"]}function s_(e){var r=Hl(e),a=br(e);return[r,a,"n"]}function UL(e){var r=Ls(e),a=ng(e);return[r,a,"n"]}function zL(e){var r=Hl(e),a=ng(e);return[r,a,"n"]}function VL(e){var r=Ls(e),a=rg(e);return[r,a,"is"]}function HL(e){var r=Ls(e),a=Sr(e);return[r,a,"str"]}function GL(e){var r=Hl(e),a=Sr(e);return[r,a,"str"]}function qL(e,r,a){var n=e.l+r,i=Ls(e);i.r=a["!row"];var o=e.read_shift(1),u=[i,o,"b"];if(a.cellFormula){e.l+=2;var d=U0(e,n-e.l,a);u[3]=vr(d,null,i,a.supbooks,a)}else e.l=n;return u}function WL(e,r,a){var n=e.l+r,i=Ls(e);i.r=a["!row"];var o=e.read_shift(1),u=[i,o,"e"];if(a.cellFormula){e.l+=2;var d=U0(e,n-e.l,a);u[3]=vr(d,null,i,a.supbooks,a)}else e.l=n;return u}function YL(e,r,a){var n=e.l+r,i=Ls(e);i.r=a["!row"];var o=br(e),u=[i,o,"n"];if(a.cellFormula){e.l+=2;var d=U0(e,n-e.l,a);u[3]=vr(d,null,i,a.supbooks,a)}else e.l=n;return u}function XL(e,r,a){var n=e.l+r,i=Ls(e);i.r=a["!row"];var o=Sr(e),u=[i,o,"str"];if(a.cellFormula){e.l+=2;var d=U0(e,n-e.l,a);u[3]=vr(d,null,i,a.supbooks,a)}else e.l=n;return u}var $L=Gl;function KL(e,r){var a=e.l+r,n=Gl(e),i=sg(e),o=Sr(e),u=Sr(e),d=Sr(e);e.l=a;var h={rfx:n,relId:i,loc:o,display:d};return u&&(h.Tooltip=u),h}function QL(){}function ZL(e,r,a){var n=e.l+r,i=bS(e),o=e.read_shift(1),u=[i];if(u[2]=o,a.cellFormula){var d=rL(e,n-e.l,a);u[1]=d}else e.l=n;return u}function JL(e,r,a){var n=e.l+r,i=Gl(e),o=[i];if(a.cellFormula){var u=nL(e,n-e.l,a);o[1]=u,e.l=n}else e.l=n;return o}var eP=["left","right","top","bottom","header","footer"];function tP(e){var r={};return eP.forEach(function(a){r[a]=br(e)}),r}function aP(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function rP(){}function sP(){}function nP(e,r,a,n,i,o,u){if(!e)return e;var d=r||{};n||(n={"!id":{}});var h=d.dense?[]:{},m,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,y=!1,N,j,b,w,T,D,_,R,z,O=[];d.biff=12,d["!row"]=0;var A=0,k=!1,E=[],L={},H=d.supbooks||i.supbooks||[[]];if(H.sharedf=L,H.arrayf=E,H.SheetNames=i.SheetNames||i.Sheets.map(function(je){return je.name}),!d.supbooks&&(d.supbooks=H,i.Names))for(var I=0;I<i.Names.length;++I)H[0][I+1]=i.Names[I];var re=[],ne=[],ge=!1;y0[16]={n:"BrtShortReal",f:s_};var W;if(pi(e,function(Z,De,he){if(!y)switch(he){case 148:m=Z;break;case 0:N=Z,d.sheetRows&&d.sheetRows<=N.r&&(y=!0),R=dr(w=N.r),d["!row"]=N.r,(Z.hidden||Z.hpt||Z.level!=null)&&(Z.hpt&&(Z.hpx=Uu(Z.hpt)),ne[Z.r]=Z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(j={t:Z[2]},Z[2]){case"n":j.v=Z[1];break;case"s":_=Nu[Z[1]],j.v=_.t,j.r=_.r;break;case"b":j.v=!!Z[1];break;case"e":j.v=Z[1],d.cellText!==!1&&(j.w=ql[j.v]);break;case"str":j.t="s",j.v=Z[1];break;case"is":j.t="s",j.v=Z[1].t;break}if((b=u.CellXf[Z[0].iStyleRef])&&a_(j,b.numFmtId,null,d,o,u),T=Z[0].c==-1?T+1:Z[0].c,d.dense?(h[w]||(h[w]=[]),h[w][T]=j):h[Za(T)+R]=j,d.cellFormula){for(k=!1,A=0;A<E.length;++A){var P=E[A];N.r>=P[0].s.r&&N.r<=P[0].e.r&&T>=P[0].s.c&&T<=P[0].e.c&&(j.F=Zt(P[0]),k=!0)}!k&&Z.length>3&&(j.f=Z[3])}if(p.s.r>N.r&&(p.s.r=N.r),p.s.c>T&&(p.s.c=T),p.e.r<N.r&&(p.e.r=N.r),p.e.c<T&&(p.e.c=T),d.cellDates&&b&&j.t=="n"&&Qc(It[b.numFmtId])){var q=Tl(j.v);q&&(j.t="d",j.v=new Date(q.y,q.m-1,q.d,q.H,q.M,q.S,q.u))}W&&(W.type=="XLDAPR"&&(j.D=!0),W=void 0);break;case 1:case 12:if(!d.sheetStubs||v)break;j={t:"z",v:void 0},T=Z[0].c==-1?T+1:Z[0].c,d.dense?(h[w]||(h[w]=[]),h[w][T]=j):h[Za(T)+R]=j,p.s.r>N.r&&(p.s.r=N.r),p.s.c>T&&(p.s.c=T),p.e.r<N.r&&(p.e.r=N.r),p.e.c<T&&(p.e.c=T),W&&(W.type=="XLDAPR"&&(j.D=!0),W=void 0);break;case 176:O.push(Z);break;case 49:W=((d.xlmeta||{}).Cell||[])[Z-1];break;case 494:var J=n["!id"][Z.relId];for(J?(Z.Target=J.Target,Z.loc&&(Z.Target+="#"+Z.loc),Z.Rel=J):Z.relId==""&&(Z.Target="#"+Z.loc),w=Z.rfx.s.r;w<=Z.rfx.e.r;++w)for(T=Z.rfx.s.c;T<=Z.rfx.e.c;++T)d.dense?(h[w]||(h[w]=[]),h[w][T]||(h[w][T]={t:"z",v:void 0}),h[w][T].l=Z):(D=Ct({c:T,r:w}),h[D]||(h[D]={t:"z",v:void 0}),h[D].l=Z);break;case 426:if(!d.cellFormula)break;E.push(Z),z=d.dense?h[w][T]:h[Za(T)+R],z.f=vr(Z[1],p,{r:N.r,c:T},H,d),z.F=Zt(Z[0]);break;case 427:if(!d.cellFormula)break;L[Ct(Z[0].s)]=Z[1],z=d.dense?h[w][T]:h[Za(T)+R],z.f=vr(Z[1],p,{r:N.r,c:T},H,d);break;case 60:if(!d.cellStyles)break;for(;Z.e>=Z.s;)re[Z.e--]={width:Z.w/256,hidden:!!(Z.flags&1),level:Z.level},ge||(ge=!0,og(Z.w/256)),Gc(re[Z.e+1]);break;case 161:h["!autofilter"]={ref:Zt(Z)};break;case 476:h["!margins"]=Z;break;case 147:i.Sheets[a]||(i.Sheets[a]={}),Z.name&&(i.Sheets[a].CodeName=Z.name),(Z.above||Z.left)&&(h["!outline"]={above:Z.above,left:Z.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),Z.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!De.T){if(!v||d.WTF)throw new Error("Unexpected record 0x"+he.toString(16))}}},d),delete d.supbooks,delete d["!row"],!h["!ref"]&&(p.s.r<2e6||m&&(m.e.r>0||m.e.c>0||m.s.r>0||m.s.c>0))&&(h["!ref"]=Zt(m||p)),d.sheetRows&&h["!ref"]){var ee=Ra(h["!ref"]);d.sheetRows<=+ee.e.r&&(ee.e.r=d.sheetRows-1,ee.e.r>p.e.r&&(ee.e.r=p.e.r),ee.e.r<ee.s.r&&(ee.s.r=ee.e.r),ee.e.c>p.e.c&&(ee.e.c=p.e.c),ee.e.c<ee.s.c&&(ee.s.c=ee.e.c),h["!fullref"]=h["!ref"],h["!ref"]=Zt(ee))}return O.length>0&&(h["!merges"]=O),re.length>0&&(h["!cols"]=re),ne.length>0&&(h["!rows"]=ne),h}function iP(e){var r=[],a=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var u=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);u&&(r[+u[1]]=a?+u[2]:u[2])});var i=ea((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){n=o.replace(/<.*?>/g,"")}),[r,i,n]}function lP(e,r,a,n,i,o){var u=o||{"!type":"chart"};if(!e)return o;var d=0,h=0,m="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var y=iP(v);p.s.r=p.s.c=0,p.e.c=d,m=Za(d),y[0].forEach(function(N,j){u[m+dr(j)]={t:"n",v:N,z:y[1]},h=j}),p.e.r<h&&(p.e.r=h),++d}),d>0&&(u["!ref"]=Zt(p)),u}function cP(e,r,a,n,i){if(!e)return e;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},u,d=e.match(r_);return d&&dg(d[0],o,i,a),(u=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=u[1]),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}function oP(e,r){e.l+=10;var a=Sr(e);return{name:a}}function uP(e,r,a,n,i){if(!e)return e;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},u=!1;return pi(e,function(h,m,p){switch(p){case 550:o["!rel"]=h;break;case 651:i.Sheets[a]||(i.Sheets[a]={}),h.name&&(i.Sheets[a].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:u=!0;break;case 36:u=!1;break;case 37:break;case 38:break;default:if(!(m.T>0)){if(!(m.T<0)){if(!u||r.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},r),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}var n_=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],dP=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],fP=[],hP=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Lb(e,r){for(var a=0;a!=e.length;++a)for(var n=e[a],i=0;i!=r.length;++i){var o=r[i];if(n[o[0]]==null)n[o[0]]=o[1];else switch(o[2]){case"bool":typeof n[o[0]]=="string"&&(n[o[0]]=Ta(n[o[0]]));break;case"int":typeof n[o[0]]=="string"&&(n[o[0]]=parseInt(n[o[0]],10));break}}}function Pb(e,r){for(var a=0;a!=r.length;++a){var n=r[a];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Ta(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function i_(e){Pb(e.WBProps,n_),Pb(e.CalcPr,hP),Lb(e.WBView,dP),Lb(e.Sheets,fP),Bc.date1904=Ta(e.WBProps.date1904)}var mP="][*?/\\".split("");function xP(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var a=!0;return mP.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),a}var pP=/<\w+:workbook/;function gP(e,r){if(!e)throw new Error("Could not find file");var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",o={},u=0;if(e.replace(Cr,function(h,m){var p=Et(h);switch(Cn(p[0])){case"<?xml":break;case"<workbook":h.match(pP)&&(i="xmlns"+h.match(/<(\w+):/)[1]),a.xmlns=p[i];break;case"</workbook>":break;case"<fileVersion":delete p[0],a.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":n_.forEach(function(v){if(p[v[0]]!=null)switch(v[2]){case"bool":a.WBProps[v[0]]=Ta(p[v[0]]);break;case"int":a.WBProps[v[0]]=parseInt(p[v[0]],10);break;default:a.WBProps[v[0]]=p[v[0]]}}),p.codeName&&(a.WBProps.CodeName=va(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],a.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=ea(va(p.name)),delete p[0],a.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":o={},o.Name=va(p.name),p.comment&&(o.Comment=p.comment),p.localSheetId&&(o.Sheet=+p.localSheetId),Ta(p.hidden||"0")&&(o.Hidden=!0),u=m+h.length;break;case"</definedName>":o.Ref=ea(va(e.slice(u,m))),a.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete p[0],a.CalcPr=p;break;case"<calcPr/>":delete p[0],a.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&r.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return h}),F5.indexOf(a.xmlns)===-1)throw new Error("Unknown Namespace: "+a.xmlns);return i_(a),a}function vP(e,r){var a={};return a.Hidden=e.read_shift(4),a.iTabID=e.read_shift(4),a.strRelID=Zx(e),a.name=Sr(e),a}function yP(e,r){var a={},n=e.read_shift(4);a.defaultThemeVersion=e.read_shift(4);var i=r>8?Sr(e):"";return i.length>0&&(a.CodeName=i),a.autoCompressPictures=!!(n&65536),a.backupFile=!!(n&64),a.checkCompatibility=!!(n&4096),a.date1904=!!(n&1),a.filterPrivacy=!!(n&8),a.hidePivotFieldList=!!(n&1024),a.promptedSolutions=!!(n&16),a.publishItems=!!(n&2048),a.refreshAllConnections=!!(n&262144),a.saveExternalLinkValues=!!(n&128),a.showBorderUnselectedTables=!!(n&4),a.showInkAnnotation=!!(n&32),a.showObjects=["all","placeholders","none"][n>>13&3],a.showPivotChartFilter=!!(n&32768),a.updateLinks=["userSet","never","always"][n>>8&3],a}function jP(e,r){var a={};return e.read_shift(4),a.ArchID=e.read_shift(4),e.l+=r-8,a}function bP(e,r,a){var n=e.l+r;e.l+=4,e.l+=1;var i=e.read_shift(4),o=J5(e),u=sL(e,0,a),d=sg(e);e.l=n;var h={Name:o,Ptg:u};return i<268435455&&(h.Sheet=i),d&&(h.Comment=d),h}function NP(e,r){var a={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;r||(r={}),r.biff=12;var o=[],u=[[]];return u.SheetNames=[],u.XTI=[],y0[16]={n:"BrtFRTArchID$",f:jP},pi(e,function(h,m,p){switch(p){case 156:u.SheetNames.push(h.name),a.Sheets.push(h);break;case 153:a.WBProps=h;break;case 39:h.Sheet!=null&&(r.SID=h.Sheet),h.Ref=vr(h.Ptg,null,null,u,r),delete r.SID,delete h.Ptg,o.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:u[0].length?u.push([p,h]):u[0]=[p,h],u[u.length-1].XTI=[];break;case 362:u.length===0&&(u[0]=[],u[0].XTI=[]),u[u.length-1].XTI=u[u.length-1].XTI.concat(h),u.XTI=u.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(p),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(p),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!m.T){if(!i||r.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},r),i_(a),a.Names=o,a.supbooks=u,a}function wP(e,r,a){return r.slice(-4)===".bin"?NP(e,a):gP(e,a)}function SP(e,r,a,n,i,o,u,d){return r.slice(-4)===".bin"?nP(e,n,a,i,o,u,d):vL(e,n,a,i,o,u,d)}function _P(e,r,a,n,i,o,u,d){return r.slice(-4)===".bin"?uP(e,n,a,i,o):cP(e,n,a,i,o)}function EP(e,r,a,n,i,o,u,d){return r.slice(-4)===".bin"?M8():F8()}function TP(e,r,a,n,i,o,u,d){return r.slice(-4)===".bin"?O8():R8()}function CP(e,r,a,n){return r.slice(-4)===".bin"?$F(e,a,n):HF(e,a,n)}function AP(e,r,a){return WS(e,a)}function kP(e,r,a){return r.slice(-4)===".bin"?dF(e,a):oF(e,a)}function DP(e,r,a){return r.slice(-4)===".bin"?A8(e,a):S8(e,a)}function OP(e,r,a){return r.slice(-4)===".bin"?b8(e):y8(e)}function RP(e,r,a,n){return a.slice(-4)===".bin"?N8(e,r,a,n):void 0}function MP(e,r,a){return r.slice(-4)===".bin"?g8(e,r,a):v8(e,r,a)}var l_=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,c_=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function qs(e,r){var a=e.split(/\s+/),n=[];if(n[0]=a[0],a.length===1)return n;var i=e.match(l_),o,u,d,h;if(i)for(h=0;h!=i.length;++h)o=i[h].match(c_),(u=o[1].indexOf(":"))===-1?n[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?d="xmlns"+o[1].slice(6):d=o[1].slice(u+1),n[d]=o[2].slice(1,o[2].length-1));return n}function FP(e){var r=e.split(/\s+/),a={};if(r.length===1)return a;var n=e.match(l_),i,o,u,d;if(n)for(d=0;d!=n.length;++d)i=n[d].match(c_),(o=i[1].indexOf(":"))===-1?a[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?u="xmlns"+i[1].slice(6):u=i[1].slice(o+1),a[u]=i[2].slice(1,i[2].length-1));return a}var Su;function IP(e,r){var a=Su[e]||ea(e);return a==="General"?Rl(r):Fs(a,r)}function LP(e,r,a,n){var i=n;switch((a[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Ta(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=ar(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+a[0])}e[ea(r)]=i}function PP(e,r,a){if(e.t!=="z"){if(!a||a.cellText!==!1)try{e.t==="e"?e.w=e.w||ql[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Fu(e.v):e.w=Rl(e.v):e.w=IP(r||"General",e.v)}catch(o){if(a.WTF)throw o}try{var n=Su[r]||r||"General";if(a.cellNF&&(e.z=n),a.cellDates&&e.t=="n"&&Qc(n)){var i=Tl(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(o){if(a.WTF)throw o}}}function BP(e,r,a){if(a.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=LF[n.Pattern]||n.Pattern)}e[r.ID]=r}function UP(e,r,a,n,i,o,u,d,h,m){var p="General",v=n.StyleID,y={};m=m||{};var N=[],j=0;for(v===void 0&&d&&(v=d.StyleID),v===void 0&&u&&(v=u.StyleID);o[v]!==void 0&&(o[v].nf&&(p=o[v].nf),o[v].Interior&&N.push(o[v].Interior),!!o[v].Parent);)v=o[v].Parent;switch(a.Type){case"Boolean":n.t="b",n.v=Ta(e);break;case"String":n.t="s",n.r=ib(ea(e)),n.v=e.indexOf("<")>-1?ea(r||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(ar(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=ea(e):n.v<60&&(n.v=n.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=SS[e],m.cellText!==!1&&(n.w=e);break;default:e==""&&r==""?n.t="z":(n.t="s",n.v=ib(r||e));break}if(PP(n,p,m),m.cellFormula!==!1)if(n.Formula){var b=ea(n.Formula);b.charCodeAt(0)==61&&(b=b.slice(1)),n.f=Pc(b,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Pc("RC:RC",i):n.ArrayRange&&(n.F=Pc(n.ArrayRange,i),h.push([Ra(n.F),n.F]))}else for(j=0;j<h.length;++j)i.r>=h[j][0].s.r&&i.r<=h[j][0].e.r&&i.c>=h[j][0].s.c&&i.c<=h[j][0].e.c&&(n.F=h[j][1]);m.cellStyles&&(N.forEach(function(w){!y.patternType&&w.patternType&&(y.patternType=w.patternType)}),n.s=y),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function zP(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function bx(e,r){var a=r||{};Kw();var n=ou(Jp(e));(a.type=="binary"||a.type=="array"||a.type=="base64")&&(n=va(n));var i=n.slice(0,1024).toLowerCase(),o=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var u=ur(a);return u.type="string",Pu.to_workbook(n,u)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function($e){i.indexOf("<"+$e)>=0&&(o=!0)}),o)return KP(n,a);Su={"General Number":"General","General Date":It[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":It[15],"Short Date":It[14],"Long Time":It[19],"Medium Time":It[18],"Short Time":It[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:It[2],Standard:It[4],Percent:It[10],Scientific:It[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var d,h=[],m,p={},v=[],y=a.dense?[]:{},N="",j={},b={},w=qs('<Data ss:Type="String">'),T=0,D=0,_=0,R={s:{r:2e6,c:2e6},e:{r:0,c:0}},z={},O={},A="",k=0,E=[],L={},H={},I=0,re=[],ne=[],ge={},W=[],ee,je=!1,Z=[],De=[],he={},P=0,q=0,J={Sheets:[],WBProps:{date1904:!1}},K={};Lu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var xe="";d=Lu.exec(n);)switch(d[3]=(xe=d[3]).toLowerCase()){case"data":if(xe=="data"){if(d[1]==="/"){if((m=h.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&h.push([d[3],!0]);break}if(h[h.length-1][1])break;d[1]==="/"?UP(n.slice(T,d.index),A,w,h[h.length-1][0]=="comment"?ge:j,{c:D,r:_},z,W[D],b,Z,a):(A="",w=qs(d[0]),T=d.index+d[0].length);break;case"cell":if(d[1]==="/")if(ne.length>0&&(j.c=ne),(!a.sheetRows||a.sheetRows>_)&&j.v!==void 0&&(a.dense?(y[_]||(y[_]=[]),y[_][D]=j):y[Za(D)+dr(_)]=j),j.HRef&&(j.l={Target:ea(j.HRef)},j.HRefScreenTip&&(j.l.Tooltip=j.HRefScreenTip),delete j.HRef,delete j.HRefScreenTip),(j.MergeAcross||j.MergeDown)&&(P=D+(parseInt(j.MergeAcross,10)|0),q=_+(parseInt(j.MergeDown,10)|0),E.push({s:{c:D,r:_},e:{c:P,r:q}})),!a.sheetStubs)j.MergeAcross?D=P+1:++D;else if(j.MergeAcross||j.MergeDown){for(var Fe=D;Fe<=P;++Fe)for(var Ae=_;Ae<=q;++Ae)(Fe>D||Ae>_)&&(a.dense?(y[Ae]||(y[Ae]=[]),y[Ae][Fe]={t:"z"}):y[Za(Fe)+dr(Ae)]={t:"z"});D=P+1}else++D;else j=FP(d[0]),j.Index&&(D=+j.Index-1),D<R.s.c&&(R.s.c=D),D>R.e.c&&(R.e.c=D),d[0].slice(-2)==="/>"&&++D,ne=[];break;case"row":d[1]==="/"||d[0].slice(-2)==="/>"?(_<R.s.r&&(R.s.r=_),_>R.e.r&&(R.e.r=_),d[0].slice(-2)==="/>"&&(b=qs(d[0]),b.Index&&(_=+b.Index-1)),D=0,++_):(b=qs(d[0]),b.Index&&(_=+b.Index-1),he={},(b.AutoFitHeight=="0"||b.Height)&&(he.hpx=parseInt(b.Height,10),he.hpt=qS(he.hpx),De[_]=he),b.Hidden=="1"&&(he.hidden=!0,De[_]=he));break;case"worksheet":if(d[1]==="/"){if((m=h.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"));v.push(N),R.s.r<=R.e.r&&R.s.c<=R.e.c&&(y["!ref"]=Zt(R),a.sheetRows&&a.sheetRows<=R.e.r&&(y["!fullref"]=y["!ref"],R.e.r=a.sheetRows-1,y["!ref"]=Zt(R))),E.length&&(y["!merges"]=E),W.length>0&&(y["!cols"]=W),De.length>0&&(y["!rows"]=De),p[N]=y}else R={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=D=0,h.push([d[3],!1]),m=qs(d[0]),N=ea(m.Name),y=a.dense?[]:{},E=[],Z=[],De=[],K={name:N,Hidden:0},J.Sheets.push(K);break;case"table":if(d[1]==="/"){if((m=h.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else{if(d[0].slice(-2)=="/>")break;h.push([d[3],!1]),W=[],je=!1}break;case"style":d[1]==="/"?BP(z,O,a):O=qs(d[0]);break;case"numberformat":O.nf=ea(qs(d[0]).Format||"General"),Su[O.nf]&&(O.nf=Su[O.nf]);for(var Ee=0;Ee!=392&&It[Ee]!=O.nf;++Ee);if(Ee==392){for(Ee=57;Ee!=392;++Ee)if(It[Ee]==null){kl(O.nf,Ee);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(ee=qs(d[0]),ee.Hidden&&(ee.hidden=!0,delete ee.Hidden),ee.Width&&(ee.wpx=parseInt(ee.Width,10)),!je&&ee.wpx>10){je=!0,Mr=HS;for(var we=0;we<W.length;++we)W[we]&&Gc(W[we])}je&&Gc(ee),W[ee.Index-1||W.length]=ee;for(var Ge=0;Ge<+ee.Span;++Ge)W[W.length]=ur(ee);break;case"namedrange":if(d[1]==="/")break;J.Names||(J.Names=[]);var X=Et(d[0]),ht={Name:X.Name,Ref:Pc(X.RefersTo.slice(1),{r:0,c:0})};J.Sheets.length>0&&(ht.Sheet=J.Sheets.length-1),J.Names.push(ht);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(d[0].slice(-2)==="/>")break;d[1]==="/"?A+=n.slice(k,d.index):k=d.index+d[0].length;break;case"interior":if(!a.cellStyles)break;O.Interior=qs(d[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(d[0].slice(-2)==="/>")break;d[1]==="/"?S6(L,xe,n.slice(I,d.index)):I=d.index+d[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(d[1]==="/"){if((m=h.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else h.push([d[3],!1]);break;case"comment":if(d[1]==="/"){if((m=h.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"));zP(ge),ne.push(ge)}else h.push([d[3],!1]),m=qs(d[0]),ge={a:m.Author};break;case"autofilter":if(d[1]==="/"){if((m=h.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else if(d[0].charAt(d[0].length-2)!=="/"){var Ye=qs(d[0]);y["!autofilter"]={ref:Pc(Ye.Range).replace(/\$/g,"")},h.push([d[3],!0])}break;case"name":break;case"datavalidation":if(d[1]==="/"){if((m=h.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&h.push([d[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(d[1]==="/"){if((m=h.pop())[0]!==d[3])throw new Error("Bad state: "+m.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&h.push([d[3],!0]);break;case"null":break;default:if(h.length==0&&d[3]=="document"||h.length==0&&d[3]=="uof")return Gb(n,a);var Je=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(d[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Je=!1}break;case"componentoptions":switch(d[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Je=!1}break;case"excelworkbook":switch(d[3]){case"date1904":J.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Je=!1}break;case"workbookoptions":switch(d[3]){case"owcversion":break;case"height":break;case"width":break;default:Je=!1}break;case"worksheetoptions":switch(d[3]){case"visible":if(d[0].slice(-2)!=="/>")if(d[1]==="/")switch(n.slice(I,d.index)){case"SheetHidden":K.Hidden=1;break;case"SheetVeryHidden":K.Hidden=2;break}else I=d.index+d[0].length;break;case"header":y["!margins"]||wu(y["!margins"]={},"xlml"),isNaN(+Et(d[0]).Margin)||(y["!margins"].header=+Et(d[0]).Margin);break;case"footer":y["!margins"]||wu(y["!margins"]={},"xlml"),isNaN(+Et(d[0]).Margin)||(y["!margins"].footer=+Et(d[0]).Margin);break;case"pagemargins":var qe=Et(d[0]);y["!margins"]||wu(y["!margins"]={},"xlml"),isNaN(+qe.Top)||(y["!margins"].top=+qe.Top),isNaN(+qe.Left)||(y["!margins"].left=+qe.Left),isNaN(+qe.Right)||(y["!margins"].right=+qe.Right),isNaN(+qe.Bottom)||(y["!margins"].bottom=+qe.Bottom);break;case"displayrighttoleft":J.Views||(J.Views=[]),J.Views[0]||(J.Views[0]={}),J.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Je=!1}break;case"pivottable":case"pivotcache":switch(d[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Je=!1}break;case"pagebreaks":switch(d[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Je=!1}break;case"autofilter":switch(d[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Je=!1}break;case"querytable":switch(d[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Je=!1}break;case"datavalidation":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Je=!1}break;case"sorting":case"conditionalformatting":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Je=!1}break;case"mapinfo":case"schema":case"data":switch(d[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Je=!1}break;case"smarttags":break;default:Je=!1;break}if(Je||d[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+d[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(d[0].slice(-2)==="/>")break;d[1]==="/"?LP(H,xe,re,n.slice(I,d.index)):(re=d,I=d.index+d[0].length);break}if(a.WTF)throw"Unrecognized tag: "+d[3]+"|"+h.join("|")}var Be={};return!a.bookSheets&&!a.bookProps&&(Be.Sheets=p),Be.SheetNames=v,Be.Workbook=J,Be.SSF=ur(It),Be.Props=L,Be.Custprops=H,Be}function ap(e,r){switch(mg(r=r||{}),r.type||"base64"){case"base64":return bx(vs(e),r);case"binary":case"buffer":case"file":return bx(e,r);case"array":return bx(Vl(e),r)}}function VP(e){var r={},a=e.content;if(a.l=28,r.AnsiUserType=a.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=a6(a),a.length-a.l<=4)return r;var n=a.read_shift(4);if(n==0||n>40||(a.l-=4,r.Reserved1=a.read_shift(0,"lpstr-ansi"),a.length-a.l<=4)||(n=a.read_shift(4),n!==1907505652)||(r.UnicodeClipboardFormat=r6(a),n=a.read_shift(4),n==0||n>40))return r;a.l-=4,r.Reserved2=a.read_shift(0,"lpwstr")}var HP=[60,1084,2066,2165,2175];function GP(e,r,a,n,i){var o=n,u=[],d=a.slice(a.l,a.l+o);if(i&&i.enc&&i.enc.insitu&&d.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(d)}u.push(d),a.l+=o;for(var h=ti(a,a.l),m=rp[h],p=0;m!=null&&HP.indexOf(h)>-1;)o=ti(a,a.l+2),p=a.l+4,h==2066?p+=4:(h==2165||h==2175)&&(p+=12),d=a.slice(p,a.l+4+o),u.push(d),a.l+=4+o,m=rp[h=ti(a,a.l)];var v=Hi(u);cr(v,0);var y=0;v.lens=[];for(var N=0;N<u.length;++N)v.lens.push(y),y+=u[N].length;if(v.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+v.length+" < "+n;return r.f(v,v.length,i)}function hn(e,r,a){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=It[n])}catch(o){if(r.WTF)throw o}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ql[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Fu(e.v):e.w=Rl(e.v):e.w=Fs(n,e.v,{date1904:!!a,dateNF:r&&r.dateNF})}catch(o){if(r.WTF)throw o}if(r.cellDates&&n&&e.t=="n"&&Qc(It[n]||String(n))){var i=Tl(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Bf(e,r,a){return{v:e,ixfe:r,t:a}}function qP(e,r){var a={opts:{}},n={},i=r.dense?[]:{},o={},u={},d=null,h=[],m="",p={},v,y="",N,j,b,w,T={},D=[],_,R,z=[],O=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},k={},E=function(wt){return wt<8?Dl[wt]:wt<64&&O[wt-8]||Dl[wt]},L=function(wt,qt,oa){var zt=qt.XF.data;if(!(!zt||!zt.patternType||!oa||!oa.cellStyles)){qt.s={},qt.s.patternType=zt.patternType;var ia;(ia=Bu(E(zt.icvFore)))&&(qt.s.fgColor={rgb:ia}),(ia=Bu(E(zt.icvBack)))&&(qt.s.bgColor={rgb:ia})}},H=function(wt,qt,oa){if(!(he>1)&&!(oa.sheetRows&&wt.r>=oa.sheetRows)){if(oa.cellStyles&&qt.XF&&qt.XF.data&&L(wt,qt,oa),delete qt.ixfe,delete qt.XF,v=wt,y=Ct(wt),(!u||!u.s||!u.e)&&(u={s:{r:0,c:0},e:{r:0,c:0}}),wt.r<u.s.r&&(u.s.r=wt.r),wt.c<u.s.c&&(u.s.c=wt.c),wt.r+1>u.e.r&&(u.e.r=wt.r+1),wt.c+1>u.e.c&&(u.e.c=wt.c+1),oa.cellFormula&&qt.f){for(var zt=0;zt<D.length;++zt)if(!(D[zt][0].s.c>wt.c||D[zt][0].s.r>wt.r)&&!(D[zt][0].e.c<wt.c||D[zt][0].e.r<wt.r)){qt.F=Zt(D[zt][0]),(D[zt][0].s.c!=wt.c||D[zt][0].s.r!=wt.r)&&delete qt.f,qt.f&&(qt.f=""+vr(D[zt][1],u,wt,Z,I));break}}oa.dense?(i[wt.r]||(i[wt.r]=[]),i[wt.r][wt.c]=qt):i[y]=qt}},I={enc:!1,sbcch:0,snames:[],sharedf:T,arrayf:D,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(I.password=r.password);var re,ne=[],ge=[],W=[],ee=[],je=!1,Z=[];Z.SheetNames=I.snames,Z.sharedf=I.sharedf,Z.arrayf=I.arrayf,Z.names=[],Z.XTI=[];var De=0,he=0,P=0,q=[],J=[],K;I.codepage=1200,Qs(1200);for(var xe=!1;e.l<e.length-1;){var Fe=e.l,Ae=e.read_shift(2);if(Ae===0&&De===10)break;var Ee=e.l===e.length?0:e.read_shift(2),we=rp[Ae];if(we&&we.f){if(r.bookSheets&&De===133&&Ae!==133)break;if(De=Ae,we.r===2||we.r==12){var Ge=e.read_shift(2);if(Ee-=2,!I.enc&&Ge!==Ae&&((Ge&255)<<8|Ge>>8)!==Ae)throw new Error("rt mismatch: "+Ge+"!="+Ae);we.r==12&&(e.l+=10,Ee-=10)}var X={};if(Ae===10?X=we.f(e,Ee,I):X=GP(Ae,we,e,Ee,I),he==0&&[9,521,1033,2057].indexOf(De)===-1)continue;switch(Ae){case 34:a.opts.Date1904=A.WBProps.date1904=X;break;case 134:a.opts.WriteProtect=!0;break;case 47:if(I.enc||(e.l=0),I.enc=X,!r.password)throw new Error("File is password-protected");if(X.valid==null)throw new Error("Encryption scheme unsupported");if(!X.valid)throw new Error("Password is incorrect");break;case 92:I.lastuser=X;break;case 66:var ht=Number(X);switch(ht){case 21010:ht=1200;break;case 32768:ht=1e4;break;case 32769:ht=1252;break}Qs(I.codepage=ht),xe=!0;break;case 317:I.rrtabid=X;break;case 25:I.winlocked=X;break;case 439:a.opts.RefreshAll=X;break;case 12:a.opts.CalcCount=X;break;case 16:a.opts.CalcDelta=X;break;case 17:a.opts.CalcIter=X;break;case 13:a.opts.CalcMode=X;break;case 14:a.opts.CalcPrecision=X;break;case 95:a.opts.CalcSaveRecalc=X;break;case 15:I.CalcRefMode=X;break;case 2211:a.opts.FullCalc=X;break;case 129:X.fDialog&&(i["!type"]="dialog"),X.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),X.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:z.push(X);break;case 430:Z.push([X]),Z[Z.length-1].XTI=[];break;case 35:case 547:Z[Z.length-1].push(X);break;case 24:case 536:K={Name:X.Name,Ref:vr(X.rgce,u,null,Z,I)},X.itab>0&&(K.Sheet=X.itab-1),Z.names.push(K),Z[0]||(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].push(X),X.Name=="_xlnm._FilterDatabase"&&X.itab>0&&X.rgce&&X.rgce[0]&&X.rgce[0][0]&&X.rgce[0][0][0]=="PtgArea3d"&&(J[X.itab-1]={ref:Zt(X.rgce[0][0][1][2])});break;case 22:I.ExternCount=X;break;case 23:Z.length==0&&(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].XTI=Z[Z.length-1].XTI.concat(X),Z.XTI=Z.XTI.concat(X);break;case 2196:if(I.biff<8)break;K!=null&&(K.Comment=X[1]);break;case 18:i["!protect"]=X;break;case 19:X!==0&&I.WTF&&console.error("Password verifier: "+X);break;case 133:o[X.pos]=X,I.snames.push(X.name);break;case 10:{if(--he)break;if(u.e){if(u.e.r>0&&u.e.c>0){if(u.e.r--,u.e.c--,i["!ref"]=Zt(u),r.sheetRows&&r.sheetRows<=u.e.r){var Ye=u.e.r;u.e.r=r.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Zt(u),u.e.r=Ye}u.e.r++,u.e.c++}ne.length>0&&(i["!merges"]=ne),ge.length>0&&(i["!objects"]=ge),W.length>0&&(i["!cols"]=W),ee.length>0&&(i["!rows"]=ee),A.Sheets.push(k)}m===""?p=i:n[m]=i,i=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(I.biff===8&&(I.biff={9:2,521:3,1033:4}[Ae]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[X.BIFFVer]||8),I.biffguess=X.BIFFVer==0,X.BIFFVer==0&&X.dt==4096&&(I.biff=5,xe=!0,Qs(I.codepage=28591)),I.biff==8&&X.BIFFVer==0&&X.dt==16&&(I.biff=2),he++)break;if(i=r.dense?[]:{},I.biff<8&&!xe&&(xe=!0,Qs(I.codepage=r.codepage||1252)),I.biff<5||X.BIFFVer==0&&X.dt==4096){m===""&&(m="Sheet1"),u={s:{r:0,c:0},e:{r:0,c:0}};var Je={pos:e.l-Ee,name:m};o[Je.pos]=Je,I.snames.push(m)}else m=(o[Fe]||{name:""}).name;X.dt==32&&(i["!type"]="chart"),X.dt==64&&(i["!type"]="macro"),ne=[],ge=[],I.arrayf=D=[],W=[],ee=[],je=!1,k={Hidden:(o[Fe]||{hs:0}).hs,name:m}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(r.dense?(i[X.r]||[])[X.c]:i[Ct({c:X.c,r:X.r})])&&++X.c,_={ixfe:X.ixfe,XF:z[X.ixfe]||{},v:X.val,t:"n"},P>0&&(_.z=q[_.ixfe>>8&63]),hn(_,r,a.opts.Date1904),H({c:X.c,r:X.r},_,r);break;case 5:case 517:_={ixfe:X.ixfe,XF:z[X.ixfe],v:X.val,t:X.t},P>0&&(_.z=q[_.ixfe>>8&63]),hn(_,r,a.opts.Date1904),H({c:X.c,r:X.r},_,r);break;case 638:_={ixfe:X.ixfe,XF:z[X.ixfe],v:X.rknum,t:"n"},P>0&&(_.z=q[_.ixfe>>8&63]),hn(_,r,a.opts.Date1904),H({c:X.c,r:X.r},_,r);break;case 189:for(var qe=X.c;qe<=X.C;++qe){var Be=X.rkrec[qe-X.c][0];_={ixfe:Be,XF:z[Be],v:X.rkrec[qe-X.c][1],t:"n"},P>0&&(_.z=q[_.ixfe>>8&63]),hn(_,r,a.opts.Date1904),H({c:qe,r:X.r},_,r)}break;case 6:case 518:case 1030:{if(X.val=="String"){d=X;break}if(_=Bf(X.val,X.cell.ixfe,X.tt),_.XF=z[_.ixfe],r.cellFormula){var $e=X.formula;if($e&&$e[0]&&$e[0][0]&&$e[0][0][0]=="PtgExp"){var St=$e[0][0][1][0],Jt=$e[0][0][1][1],fa=Ct({r:St,c:Jt});T[fa]?_.f=""+vr(X.formula,u,X.cell,Z,I):_.F=((r.dense?(i[St]||[])[Jt]:i[fa])||{}).F}else _.f=""+vr(X.formula,u,X.cell,Z,I)}P>0&&(_.z=q[_.ixfe>>8&63]),hn(_,r,a.opts.Date1904),H(X.cell,_,r),d=X}break;case 7:case 519:if(d)d.val=X,_=Bf(X,d.cell.ixfe,"s"),_.XF=z[_.ixfe],r.cellFormula&&(_.f=""+vr(d.formula,u,d.cell,Z,I)),P>0&&(_.z=q[_.ixfe>>8&63]),hn(_,r,a.opts.Date1904),H(d.cell,_,r),d=null;else throw new Error("String record expects Formula");break;case 33:case 545:{D.push(X);var ze=Ct(X[0].s);if(N=r.dense?(i[X[0].s.r]||[])[X[0].s.c]:i[ze],r.cellFormula&&N){if(!d||!ze||!N)break;N.f=""+vr(X[1],u,X[0],Z,I),N.F=Zt(X[0])}}break;case 1212:{if(!r.cellFormula)break;if(y){if(!d)break;T[Ct(d.cell)]=X[0],N=r.dense?(i[d.cell.r]||[])[d.cell.c]:i[Ct(d.cell)],(N||{}).f=""+vr(X[0],u,v,Z,I)}}break;case 253:_=Bf(h[X.isst].t,X.ixfe,"s"),h[X.isst].h&&(_.h=h[X.isst].h),_.XF=z[_.ixfe],P>0&&(_.z=q[_.ixfe>>8&63]),hn(_,r,a.opts.Date1904),H({c:X.c,r:X.r},_,r);break;case 513:r.sheetStubs&&(_={ixfe:X.ixfe,XF:z[X.ixfe],t:"z"},P>0&&(_.z=q[_.ixfe>>8&63]),hn(_,r,a.opts.Date1904),H({c:X.c,r:X.r},_,r));break;case 190:if(r.sheetStubs)for(var vt=X.c;vt<=X.C;++vt){var tt=X.ixfe[vt-X.c];_={ixfe:tt,XF:z[tt],t:"z"},P>0&&(_.z=q[_.ixfe>>8&63]),hn(_,r,a.opts.Date1904),H({c:vt,r:X.r},_,r)}break;case 214:case 516:case 4:_=Bf(X.val,X.ixfe,"s"),_.XF=z[_.ixfe],P>0&&(_.z=q[_.ixfe>>8&63]),hn(_,r,a.opts.Date1904),H({c:X.c,r:X.r},_,r);break;case 0:case 512:he===1&&(u=X);break;case 252:h=X;break;case 1054:if(I.biff==4){q[P++]=X[1];for(var Qe=0;Qe<P+163&&It[Qe]!=X[1];++Qe);Qe>=163&&kl(X[1],P+163)}else kl(X[1],X[0]);break;case 30:{q[P++]=X;for(var ot=0;ot<P+163&&It[ot]!=X;++ot);ot>=163&&kl(X,P+163)}break;case 229:ne=ne.concat(X);break;case 93:ge[X.cmo[0]]=I.lastobj=X;break;case 438:I.lastobj.TxO=X;break;case 127:I.lastobj.ImData=X;break;case 440:for(w=X[0].s.r;w<=X[0].e.r;++w)for(b=X[0].s.c;b<=X[0].e.c;++b)N=r.dense?(i[w]||[])[b]:i[Ct({c:b,r:w})],N&&(N.l=X[1]);break;case 2048:for(w=X[0].s.r;w<=X[0].e.r;++w)for(b=X[0].s.c;b<=X[0].e.c;++b)N=r.dense?(i[w]||[])[b]:i[Ct({c:b,r:w})],N&&N.l&&(N.l.Tooltip=X[1]);break;case 28:{if(I.biff<=5&&I.biff>=2)break;N=r.dense?(i[X[0].r]||[])[X[0].c]:i[Ct(X[0])];var bt=ge[X[2]];N||(r.dense?(i[X[0].r]||(i[X[0].r]=[]),N=i[X[0].r][X[0].c]={t:"z"}):N=i[Ct(X[0])]={t:"z"},u.e.r=Math.max(u.e.r,X[0].r),u.s.r=Math.min(u.s.r,X[0].r),u.e.c=Math.max(u.e.c,X[0].c),u.s.c=Math.min(u.s.c,X[0].c)),N.c||(N.c=[]),j={a:X[1],t:bt.TxO.t},N.c.push(j)}break;case 2173:h8(z[X.ixfe],X.ext);break;case 125:{if(!I.cellStyles)break;for(;X.e>=X.s;)W[X.e--]={width:X.w/256,level:X.level||0,hidden:!!(X.flags&1)},je||(je=!0,og(X.w/256)),Gc(W[X.e+1])}break;case 520:{var Ut={};X.level!=null&&(ee[X.r]=Ut,Ut.level=X.level),X.hidden&&(ee[X.r]=Ut,Ut.hidden=!0),X.hpt&&(ee[X.r]=Ut,Ut.hpt=X.hpt,Ut.hpx=Uu(X.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||wu(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ae]]=X;break;case 161:i["!margins"]||wu(i["!margins"]={}),i["!margins"].header=X.header,i["!margins"].footer=X.footer;break;case 574:X.RTL&&(A.Views[0].RTL=!0);break;case 146:O=X;break;case 2198:re=X;break;case 140:R=X;break;case 442:m?k.CodeName=X||k.name:A.WBProps.CodeName=X||"ThisWorkbook";break}}else we||console.error("Missing Info for XLS Record 0x"+Ae.toString(16)),e.l+=Ee}return a.SheetNames=wn(o).sort(function(Ma,wt){return Number(Ma)-Number(wt)}).map(function(Ma){return o[Ma].name}),r.bookSheets||(a.Sheets=n),!a.SheetNames.length&&p["!ref"]?(a.SheetNames.push("Sheet1"),a.Sheets&&(a.Sheets.Sheet1=p)):a.Preamble=p,a.Sheets&&J.forEach(function(Ma,wt){a.Sheets[a.SheetNames[wt]]["!autofilter"]=Ma}),a.Strings=h,a.SSF=ur(It),I.enc&&(a.Encryption=I.enc),re&&(a.Themes=re),a.Metadata={},R!==void 0&&(a.Metadata.Country=R),Z.names.length>0&&(A.Names=Z.names),a.Workbook=A,a}var Bb={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function WP(e,r,a){var n=Qt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=Nb(n,o6,Bb.DSI);for(var o in i)r[o]=i[o]}catch(m){if(a.WTF)throw m}var u=Qt.find(e,"/!SummaryInformation");if(u&&u.size>0)try{var d=Nb(u,u6,Bb.SI);for(var h in d)r[h]==null&&(r[h]=d[h])}catch(m){if(a.WTF)throw m}r.HeadingPairs&&r.TitlesOfParts&&(ES(r.HeadingPairs,r.TitlesOfParts,r,a),delete r.HeadingPairs,delete r.TitlesOfParts)}function o_(e,r){r||(r={}),mg(r),Pw(),r.codepage&&Wp(r.codepage);var a,n;if(e.FullPaths){if(Qt.find(e,"/encryption"))throw new Error("File is password-protected");a=Qt.find(e,"!CompObj"),n=Qt.find(e,"/Workbook")||Qt.find(e,"/Book")}else{switch(r.type){case"base64":e=$s(vs(e));break;case"binary":e=$s(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}cr(e,0),n={content:e}}var i,o;if(a&&VP(a),r.bookProps&&!r.bookSheets)i={};else{var u=Kt?"buffer":"array";if(n&&n.content)i=qP(n.content,r);else if((o=Qt.find(e,"PerfectOffice_MAIN"))&&o.content)i=bu.to_workbook(o.content,(r.type=u,r));else if((o=Qt.find(e,"NativeContent_MAIN"))&&o.content)i=bu.to_workbook(o.content,(r.type=u,r));else throw(o=Qt.find(e,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&Qt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=D8(e))}var d={};return e.FullPaths&&WP(e,d,r),i.Props=i.Custprops=d,r.bookFiles&&(i.cfb=e),i}var y0={0:{f:TL},1:{f:DL},2:{f:UL},3:{f:FL},4:{f:RL},5:{f:BL},6:{f:HL},7:{f:LL},8:{f:XL},9:{f:YL},10:{f:qL},11:{f:WL},12:{f:OL},13:{f:zL},14:{f:IL},15:{f:ML},16:{f:s_},17:{f:GL},18:{f:PL},19:{f:rg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:bP},40:{},42:{},43:{f:qF},44:{f:GF},45:{f:WF},46:{f:XF},47:{f:YF},48:{},49:{f:$5},50:{},51:{f:x8},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:PS},62:{f:VL},63:{f:j8},64:{f:rP},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Er,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:aP},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:kL},148:{f:CL,p:16},151:{f:QL},152:{},153:{f:yP},154:{},155:{},156:{f:vP},157:{},158:{},159:{T:1,f:uF},160:{T:-1},161:{T:1,f:Gl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:$L},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:m8},336:{T:-1},337:{f:p8,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Zx},357:{},358:{},359:{},360:{T:1},361:{},362:{f:LS},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:ZL},427:{f:JL},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:tP},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:AL},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:KL},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Zx},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:C8},633:{T:1},634:{T:-1},635:{T:1,f:T8},636:{T:-1},637:{f:Q5},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:oP},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:sP},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},rp={6:{f:yx},10:{f:zi},12:{f:Wa},13:{f:Wa},14:{f:La},15:{f:La},16:{f:br},17:{f:La},18:{f:La},19:{f:Wa},20:{f:Eb},21:{f:Eb},23:{f:LS},24:{f:Cb},25:{f:La},26:{},27:{},28:{f:_M},29:{},34:{f:La},35:{f:Tb},38:{f:br},39:{f:br},40:{f:br},41:{f:br},42:{f:La},43:{f:La},47:{f:AF},49:{f:iM},51:{f:Wa},60:{},61:{f:rM},64:{f:La},65:{f:nM},66:{f:Wa},77:{},80:{},81:{},82:{},85:{f:Wa},89:{},90:{},91:{},92:{f:$6},93:{f:TM},94:{},95:{f:La},96:{},97:{},99:{f:La},125:{f:PS},128:{f:pM},129:{f:K6},130:{f:Wa},131:{f:La},132:{f:La},133:{f:Q6},134:{},140:{f:RM},141:{f:Wa},144:{},146:{f:FM},151:{},152:{},153:{},154:{},155:{},156:{f:Wa},157:{},158:{},160:{f:UM},161:{f:LM},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:fM},190:{f:hM},193:{f:zi},197:{},198:{},199:{},200:{},201:{},202:{f:La},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Wa},220:{},221:{f:La},222:{},224:{f:xM},225:{f:X6},226:{f:zi},227:{},229:{f:EM},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Z6},253:{f:lM},255:{f:J6},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:DS},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:La},353:{f:zi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:vM},431:{f:La},432:{},433:{},434:{},437:{},438:{f:kM},439:{f:La},440:{f:DM},441:{},442:{f:ld},443:{},444:{f:Wa},445:{},446:{},448:{f:zi},449:{f:aM,r:2},450:{f:zi},512:{f:Sb},513:{f:BM},515:{f:gM},516:{f:cM},517:{f:_b},519:{f:zM},520:{f:eM},523:{},545:{f:Ab},549:{f:wb},566:{},574:{f:sM},638:{f:dM},659:{},1048:{},1054:{f:oM},1084:{},1212:{f:NM},2048:{f:OM},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:If},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:zi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:IM,r:12},2173:{f:f8,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:La,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:bM,r:12},2197:{},2198:{f:i8,r:12},2199:{},2200:{},2201:{},2202:{f:wM,r:12},2203:{f:zi},2204:{},2205:{},2206:{},2207:{},2211:{f:tM},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Wa},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:PM},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:MM},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Sb},1:{},2:{f:qM},3:{f:GM},4:{f:HM},5:{f:_b},7:{f:WM},8:{},9:{f:If},11:{},22:{f:Wa},30:{f:uM},31:{},32:{},33:{f:Ab},36:{},37:{f:wb},50:{f:YM},62:{},52:{},67:{},68:{f:Wa},69:{},86:{},126:{},127:{f:VM},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:XM},223:{},234:{},354:{},421:{},518:{f:yx},521:{f:If},536:{f:Cb},547:{f:Tb},561:{},579:{},1030:{f:yx},1033:{f:If},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ws(e,r,a,n){var i=r;if(!isNaN(i)){var o=(a||[]).length||0,u=e.next(4);u.write_shift(2,i),u.write_shift(2,o),o>0&&vS(a)&&e.push(a)}}function Ub(e,r){var a=r||{},n=a.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var o=e.match(/<\/table/i),u=i.index,d=o&&o.index||e.length,h=g5(e.slice(u,d),/(:?<tr[^>]*>)/i,"<tr>"),m=-1,p=0,v=0,y=0,N={s:{r:1e7,c:1e7},e:{r:0,c:0}},j=[];for(u=0;u<h.length;++u){var b=h[u].trim(),w=b.slice(0,3).toLowerCase();if(w=="<tr"){if(++m,a.sheetRows&&a.sheetRows<=m){--m;break}p=0;continue}if(!(w!="<td"&&w!="<th")){var T=b.split(/<\/t[dh]>/i);for(d=0;d<T.length;++d){var D=T[d].trim();if(D.match(/<t[dh]/i)){for(var _=D,R=0;_.charAt(0)=="<"&&(R=_.indexOf(">"))>-1;)_=_.slice(R+1);for(var z=0;z<j.length;++z){var O=j[z];O.s.c==p&&O.s.r<m&&m<=O.e.r&&(p=O.e.c+1,z=-1)}var A=Et(D.slice(0,D.indexOf(">")));y=A.colspan?+A.colspan:1,((v=+A.rowspan)>1||y>1)&&j.push({s:{r:m,c:p},e:{r:m+(v||1)-1,c:p+y-1}});var k=A.t||A["data-t"]||"";if(!_.length){p+=y;continue}if(_=nS(_),N.s.r>m&&(N.s.r=m),N.e.r<m&&(N.e.r=m),N.s.c>p&&(N.s.c=p),N.e.c<p&&(N.e.c=p),!_.length){p+=y;continue}var E={t:"s",v:_};a.raw||!_.trim().length||k=="s"||(_==="TRUE"?E={t:"b",v:!0}:_==="FALSE"?E={t:"b",v:!1}:isNaN(en(_))?isNaN(Hc(_).getDate())||(E={t:"d",v:ar(_)},a.cellDates||(E={t:"n",v:Ur(E.v)}),E.z=a.dateNF||It[14]):E={t:"n",v:en(_)}),a.dense?(n[m]||(n[m]=[]),n[m][p]=E):n[Ct({r:m,c:p})]=E,p+=y}}}}return n["!ref"]=Zt(N),j.length&&(n["!merges"]=j),n}function YP(e,r,a,n){for(var i=e["!merges"]||[],o=[],u=r.s.c;u<=r.e.c;++u){for(var d=0,h=0,m=0;m<i.length;++m)if(!(i[m].s.r>a||i[m].s.c>u)&&!(i[m].e.r<a||i[m].e.c<u)){if(i[m].s.r<a||i[m].s.c<u){d=-1;break}d=i[m].e.r-i[m].s.r+1,h=i[m].e.c-i[m].s.c+1;break}if(!(d<0)){var p=Ct({r:a,c:u}),v=n.dense?(e[a]||[])[u]:e[p],y=v&&v.v!=null&&(v.h||Zp(v.w||(fi(v),v.w)||""))||"",N={};d>1&&(N.rowspan=d),h>1&&(N.colspan=h),n.editable?y='<span contenteditable="true">'+y+"</span>":v&&(N["data-t"]=v&&v.t||"z",v.v!=null&&(N["data-v"]=v.v),v.z!=null&&(N["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+v.l.Target+'">'+y+"</a>")),N.id=(n.id||"sjs")+"-"+p,o.push(R5("td",y,N))}}var j="<tr>";return j+o.join("")+"</tr>"}var XP='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',$P="</body></html>";function KP(e,r){var a=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!a||a.length==0)throw new Error("Invalid HTML: could not find <table>");if(a.length==1)return sl(Ub(a[0],r),r);var n=pg();return a.forEach(function(i,o){gg(n,Ub(i,r),"Sheet"+(o+1))}),n}function QP(e,r,a){var n=[];return n.join("")+"<table"+(a&&a.id?' id="'+a.id+'"':"")+">"}function ZP(e,r){var a=r||{},n=a.header!=null?a.header:XP,i=a.footer!=null?a.footer:$P,o=[n],u=Zc(e["!ref"]);a.dense=Array.isArray(e),o.push(QP(e,u,a));for(var d=u.s.r;d<=u.e.r;++d)o.push(YP(e,u,d,a));return o.push("</table>"+i),o.join("")}function u_(e,r,a){var n=a||{},i=0,o=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var u=typeof n.origin=="string"?Lr(n.origin):n.origin;i=u.r,o=u.c}var d=r.getElementsByTagName("tr"),h=Math.min(n.sheetRows||1e7,d.length),m={s:{r:0,c:0},e:{r:i,c:o}};if(e["!ref"]){var p=Zc(e["!ref"]);m.s.r=Math.min(m.s.r,p.s.r),m.s.c=Math.min(m.s.c,p.s.c),m.e.r=Math.max(m.e.r,p.e.r),m.e.c=Math.max(m.e.c,p.e.c),i==-1&&(m.e.r=i=p.e.r+1)}var v=[],y=0,N=e["!rows"]||(e["!rows"]=[]),j=0,b=0,w=0,T=0,D=0,_=0;for(e["!cols"]||(e["!cols"]=[]);j<d.length&&b<h;++j){var R=d[j];if(zb(R)){if(n.display)continue;N[b]={hidden:!0}}var z=R.children;for(w=T=0;w<z.length;++w){var O=z[w];if(!(n.display&&zb(O))){var A=O.hasAttribute("data-v")?O.getAttribute("data-v"):O.hasAttribute("v")?O.getAttribute("v"):nS(O.innerHTML),k=O.getAttribute("data-z")||O.getAttribute("z");for(y=0;y<v.length;++y){var E=v[y];E.s.c==T+o&&E.s.r<b+i&&b+i<=E.e.r&&(T=E.e.c+1-o,y=-1)}_=+O.getAttribute("colspan")||1,((D=+O.getAttribute("rowspan")||1)>1||_>1)&&v.push({s:{r:b+i,c:T+o},e:{r:b+i+(D||1)-1,c:T+o+(_||1)-1}});var L={t:"s",v:A},H=O.getAttribute("data-t")||O.getAttribute("t")||"";A!=null&&(A.length==0?L.t=H||"z":n.raw||A.trim().length==0||H=="s"||(A==="TRUE"?L={t:"b",v:!0}:A==="FALSE"?L={t:"b",v:!1}:isNaN(en(A))?isNaN(Hc(A).getDate())||(L={t:"d",v:ar(A)},n.cellDates||(L={t:"n",v:Ur(L.v)}),L.z=n.dateNF||It[14]):L={t:"n",v:en(A)})),L.z===void 0&&k!=null&&(L.z=k);var I="",re=O.getElementsByTagName("A");if(re&&re.length)for(var ne=0;ne<re.length&&!(re[ne].hasAttribute("href")&&(I=re[ne].getAttribute("href"),I.charAt(0)!="#"));++ne);I&&I.charAt(0)!="#"&&(L.l={Target:I}),n.dense?(e[b+i]||(e[b+i]=[]),e[b+i][T+o]=L):e[Ct({c:T+o,r:b+i})]=L,m.e.c<T+o&&(m.e.c=T+o),T+=_}}++b}return v.length&&(e["!merges"]=(e["!merges"]||[]).concat(v)),m.e.r=Math.max(m.e.r,b-1+i),e["!ref"]=Zt(m),b>=h&&(e["!fullref"]=Zt((m.e.r=d.length-j+b-1+i,m))),e}function d_(e,r){var a=r||{},n=a.dense?[]:{};return u_(n,e,r)}function JP(e,r){return sl(d_(e,r),r)}function zb(e){var r="",a=e9(e);return a&&(r=a(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function e9(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function t9(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),a=ea(r.replace(/<[^>]*>/g,""));return[a]}var Vb={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function f_(e,r){var a=r||{},n=Jp(e),i=[],o,u,d={name:""},h="",m=0,p,v,y={},N=[],j=a.dense?[]:{},b,w,T={value:""},D="",_=0,R=[],z=-1,O=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},k=0,E={},L=[],H={},I=0,re=0,ne=[],ge=1,W=1,ee=[],je={Names:[]},Z={},De=["",""],he=[],P={},q="",J=0,K=!1,xe=!1,Fe=0;for(Lu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");b=Lu.exec(n);)switch(b[3]=b[3].replace(/_.*$/,"")){case"table":case"":b[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?j["!ref"]=Zt(A):j["!ref"]="A1:A1",a.sheetRows>0&&a.sheetRows<=A.e.r&&(j["!fullref"]=j["!ref"],A.e.r=a.sheetRows-1,j["!ref"]=Zt(A)),L.length&&(j["!merges"]=L),ne.length&&(j["!rows"]=ne),p.name=p.||p.name,typeof JSON<"u"&&JSON.stringify(p),N.push(p.name),y[p.name]=j,xe=!1):b[0].charAt(b[0].length-2)!=="/"&&(p=Et(b[0],!1),z=O=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,j=a.dense?[]:{},L=[],ne=[],xe=!0);break;case"table-row-group":b[1]==="/"?--k:++k;break;case"table-row":case"":if(b[1]==="/"){z+=ge,ge=1;break}if(v=Et(b[0],!1),v.?z=v.-1:z==-1&&(z=0),ge=+v["number-rows-repeated"]||1,ge<10)for(Fe=0;Fe<ge;++Fe)k>0&&(ne[z+Fe]={level:k});O=-1;break;case"covered-table-cell":b[1]!=="/"&&++O,a.sheetStubs&&(a.dense?(j[z]||(j[z]=[]),j[z][O]={t:"z"}):j[Ct({r:z,c:O})]={t:"z"}),D="",R=[];break;case"table-cell":case"":if(b[0].charAt(b[0].length-2)==="/")++O,T=Et(b[0],!1),W=parseInt(T["number-columns-repeated"]||"1",10),w={t:"z",v:null},T.formula&&a.cellFormula!=!1&&(w.f=Ib(ea(T.formula))),(T.||T["value-type"])=="string"&&(w.t="s",w.v=ea(T["string-value"]||""),a.dense?(j[z]||(j[z]=[]),j[z][O]=w):j[Ct({r:z,c:O})]=w),O+=W-1;else if(b[1]!=="/"){++O,D="",_=0,R=[],W=1;var Ae=ge?z+ge-1:z;if(O>A.e.c&&(A.e.c=O),O<A.s.c&&(A.s.c=O),z<A.s.r&&(A.s.r=z),Ae>A.e.r&&(A.e.r=Ae),T=Et(b[0],!1),he=[],P={},w={t:T.||T["value-type"],v:null},a.cellFormula)if(T.formula&&(T.formula=ea(T.formula)),T["number-matrix-columns-spanned"]&&T["number-matrix-rows-spanned"]&&(I=parseInt(T["number-matrix-rows-spanned"],10)||0,re=parseInt(T["number-matrix-columns-spanned"],10)||0,H={s:{r:z,c:O},e:{r:z+I-1,c:O+re-1}},w.F=Zt(H),ee.push([H,w.F])),T.formula)w.f=Ib(T.formula);else for(Fe=0;Fe<ee.length;++Fe)z>=ee[Fe][0].s.r&&z<=ee[Fe][0].e.r&&O>=ee[Fe][0].s.c&&O<=ee[Fe][0].e.c&&(w.F=ee[Fe][1]);switch((T["number-columns-spanned"]||T["number-rows-spanned"])&&(I=parseInt(T["number-rows-spanned"],10)||0,re=parseInt(T["number-columns-spanned"],10)||0,H={s:{r:z,c:O},e:{r:z+I-1,c:O+re-1}},L.push(H)),T["number-columns-repeated"]&&(W=parseInt(T["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Ta(T["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(T.value);break;case"percentage":w.t="n",w.v=parseFloat(T.value);break;case"currency":w.t="n",w.v=parseFloat(T.value);break;case"date":w.t="d",w.v=ar(T["date-value"]),a.cellDates||(w.t="n",w.v=Ur(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=m5(T["time-value"])/86400,a.cellDates&&(w.t="d",w.v=L0(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(T.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",T["string-value"]!=null&&(D=ea(T["string-value"]),R=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(K=!1,w.t==="s"&&(w.v=D||"",R.length&&(w.R=R),K=_==0),Z.Target&&(w.l=Z),he.length>0&&(w.c=he,he=[]),D&&a.cellText!==!1&&(w.w=D),K&&(w.t="z",delete w.v),(!K||a.sheetStubs)&&!(a.sheetRows&&a.sheetRows<=z))for(var Ee=0;Ee<ge;++Ee){if(W=parseInt(T["number-columns-repeated"]||"1",10),a.dense)for(j[z+Ee]||(j[z+Ee]=[]),j[z+Ee][O]=Ee==0?w:ur(w);--W>0;)j[z+Ee][O+W]=ur(w);else for(j[Ct({r:z+Ee,c:O})]=w;--W>0;)j[Ct({r:z+Ee,c:O+W})]=ur(w);A.e.c<=O&&(A.e.c=O)}W=parseInt(T["number-columns-repeated"]||"1",10),O+=W-1,W=0,w={},D="",R=[]}Z={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(b[1]==="/"){if((o=i.pop())[0]!==b[3])throw"Bad state: "+o}else b[0].charAt(b[0].length-2)!=="/"&&i.push([b[3],!0]);break;case"annotation":if(b[1]==="/"){if((o=i.pop())[0]!==b[3])throw"Bad state: "+o;P.t=D,R.length&&(P.R=R),P.a=q,he.push(P)}else b[0].charAt(b[0].length-2)!=="/"&&i.push([b[3],!1]);q="",J=0,D="",_=0,R=[];break;case"creator":b[1]==="/"?q=n.slice(J,b.index):J=b.index+b[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(b[1]==="/"){if((o=i.pop())[0]!==b[3])throw"Bad state: "+o}else b[0].charAt(b[0].length-2)!=="/"&&i.push([b[3],!1]);D="",_=0,R=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(b[1]==="/"){if(E[d.name]=h,(o=i.pop())[0]!==b[3])throw"Bad state: "+o}else b[0].charAt(b[0].length-2)!=="/"&&(h="",d=Et(b[0],!1),i.push([b[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":u=Et(b[0],!1),h+=Vb[b[3]][u.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":u=Et(b[0],!1),h+=Vb[b[3]][u.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(b[0].slice(-2)==="/>")break;if(b[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":h+=n.slice(m,b.index);break}else m=b.index+b[0].length;break;case"named-range":u=Et(b[0],!1),De=jx(u["cell-range-address"]);var we={Name:u.name,Ref:De[0]+"!"+De[1]};xe&&(we.Sheet=N.length),je.Names.push(we);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(b[1]==="/"&&(!T||!T["string-value"])){var Ge=t9(n.slice(_,b.index));D=(D.length>0?D+`
`:"")+Ge[0]}else Et(b[0],!1),_=b.index+b[0].length;break;case"s":break;case"database-range":if(b[1]==="/")break;try{De=jx(Et(b[0])["target-range-address"]),y[De[0]]["!autofilter"]={ref:De[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(b[1]!=="/"){if(Z=Et(b[0],!1),!Z.href)break;Z.Target=ea(Z.href),delete Z.href,Z.Target.charAt(0)=="#"&&Z.Target.indexOf(".")>-1?(De=jx(Z.Target.slice(1)),Z.Target="#"+De[0]+"!"+De[1]):Z.Target.match(/^\.\.[\\\/]/)&&(Z.Target=Z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(b[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(a.WTF)throw new Error(b)}}var X={Sheets:y,SheetNames:N,Workbook:je};return a.bookSheets&&delete X.Sheets,X}function Hb(e,r){r=r||{},Os(e,"META-INF/manifest.xml")&&g6(qa(e,"META-INF/manifest.xml"),r);var a=ms(e,"content.xml");if(!a)throw new Error("Missing content.xml in ODS / UOF file");var n=f_(va(a),r);return Os(e,"meta.xml")&&(n.Props=_S(qa(e,"meta.xml"))),n}function Gb(e,r){return f_(e,r)}function fg(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function sp(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):va(Vl(e))}function np(e){var r=e.reduce(function(i,o){return i+o.length},0),a=new Uint8Array(r),n=0;return e.forEach(function(i){a.set(i,n),n+=i.length}),a}function qb(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function a9(e,r){for(var a=(e[r+15]&127)<<7|e[r+14]>>1,n=e[r+14]&1,i=r+13;i>=r;--i)n=n*256+e[i];return(e[r+15]&128?-n:n)*Math.pow(10,a-6176)}function zu(e,r){var a=r?r[0]:0,n=e[a]&127;e:if(e[a++]>=128&&(n|=(e[a]&127)<<7,e[a++]<128||(n|=(e[a]&127)<<14,e[a++]<128)||(n|=(e[a]&127)<<21,e[a++]<128)||(n+=(e[a]&127)*Math.pow(2,28),++a,e[a++]<128)||(n+=(e[a]&127)*Math.pow(2,35),++a,e[a++]<128)||(n+=(e[a]&127)*Math.pow(2,42),++a,e[a++]<128)))break e;return r&&(r[0]=a),n}function Ja(e){var r=0,a=e[r]&127;e:if(e[r++]>=128){if(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128))break e;a|=(e[r]&127)<<28}return a}function wr(e){for(var r=[],a=[0];a[0]<e.length;){var n=a[0],i=zu(e,a),o=i&7;i=Math.floor(i/8);var u=0,d;if(i==0)break;switch(o){case 0:{for(var h=a[0];e[a[0]++]>=128;);d=e.slice(h,a[0])}break;case 5:u=4,d=e.slice(a[0],a[0]+u),a[0]+=u;break;case 1:u=8,d=e.slice(a[0],a[0]+u),a[0]+=u;break;case 2:u=zu(e,a),d=e.slice(a[0],a[0]+u),a[0]+=u;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(i," at offset ").concat(n))}var m={data:d,type:o};r[i]==null?r[i]=[m]:r[i].push(m)}return r}function hg(e,r){return e?.map(function(a){return r(a.data)})||[]}function r9(e){for(var r,a=[],n=[0];n[0]<e.length;){var i=zu(e,n),o=wr(e.slice(n[0],n[0]+i));n[0]+=i;var u={id:Ja(o[1][0].data),messages:[]};o[2].forEach(function(d){var h=wr(d.data),m=Ja(h[3][0].data);u.messages.push({meta:h,data:e.slice(n[0],n[0]+m)}),n[0]+=m}),(r=o[3])!=null&&r[0]&&(u.merge=Ja(o[3][0].data)>>>0>0),a.push(u)}return a}function s9(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var a=[0],n=zu(r,a),i=[];a[0]<r.length;){var o=r[a[0]]&3;if(o==0){var u=r[a[0]++]>>2;if(u<60)++u;else{var d=u-59;u=r[a[0]],d>1&&(u|=r[a[0]+1]<<8),d>2&&(u|=r[a[0]+2]<<16),d>3&&(u|=r[a[0]+3]<<24),u>>>=0,u++,a[0]+=d}i.push(r.slice(a[0],a[0]+u)),a[0]+=u;continue}else{var h=0,m=0;if(o==1?(m=(r[a[0]]>>2&7)+4,h=(r[a[0]++]&224)<<3,h|=r[a[0]++]):(m=(r[a[0]++]>>2)+1,o==2?(h=r[a[0]]|r[a[0]+1]<<8,a[0]+=2):(h=(r[a[0]]|r[a[0]+1]<<8|r[a[0]+2]<<16|r[a[0]+3]<<24)>>>0,a[0]+=4)),i=[np(i)],h==0)throw new Error("Invalid offset 0");if(h>i[0].length)throw new Error("Invalid offset beyond length");if(m>=h)for(i.push(i[0].slice(-h)),m-=h;m>=i[i.length-1].length;)i.push(i[i.length-1]),m-=i[i.length-1].length;i.push(i[0].slice(-h,-h+m))}}var p=np(i);if(p.length!=n)throw new Error("Unexpected length: ".concat(p.length," != ").concat(n));return p}function n9(e){for(var r=[],a=0;a<e.length;){var n=e[a++],i=e[a]|e[a+1]<<8|e[a+2]<<16;a+=3,r.push(s9(n,e.slice(a,a+i))),a+=i}if(a!==e.length)throw new Error("data is not a valid framed stream!");return np(r)}function i9(e,r,a,n){var i=fg(e),o=i.getUint32(4,!0),u=(n>1?12:8)+qb(o&(n>1?3470:398))*4,d=-1,h=-1,m=NaN,p=new Date(2001,0,1);o&512&&(d=i.getUint32(u,!0),u+=4),u+=qb(o&(n>1?12288:4096))*4,o&16&&(h=i.getUint32(u,!0),u+=4),o&32&&(m=i.getFloat64(u,!0),u+=8),o&64&&(p.setTime(p.getTime()+i.getFloat64(u,!0)*1e3),u+=8);var v;switch(e[2]){case 0:break;case 2:v={t:"n",v:m};break;case 3:v={t:"s",v:r[h]};break;case 5:v={t:"d",v:p};break;case 6:v={t:"b",v:m>0};break;case 7:v={t:"n",v:m/86400};break;case 8:v={t:"e",v:0};break;case 9:if(d>-1)v={t:"s",v:a[d]};else if(h>-1)v={t:"s",v:r[h]};else if(!isNaN(m))v={t:"n",v:m};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return v}function l9(e,r,a){var n=fg(e),i=n.getUint32(8,!0),o=12,u=-1,d=-1,h=NaN,m=NaN,p=new Date(2001,0,1);i&1&&(h=a9(e,o),o+=16),i&2&&(m=n.getFloat64(o,!0),o+=8),i&4&&(p.setTime(p.getTime()+n.getFloat64(o,!0)*1e3),o+=8),i&8&&(d=n.getUint32(o,!0),o+=4),i&16&&(u=n.getUint32(o,!0),o+=4);var v;switch(e[1]){case 0:break;case 2:v={t:"n",v:h};break;case 3:v={t:"s",v:r[d]};break;case 5:v={t:"d",v:p};break;case 6:v={t:"b",v:m>0};break;case 7:v={t:"n",v:m/86400};break;case 8:v={t:"e",v:0};break;case 9:if(u>-1)v={t:"s",v:a[u]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:v={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return v}function c9(e,r,a){switch(e[0]){case 0:case 1:case 2:case 3:return i9(e,r,a,e[0]);case 5:return l9(e,r,a);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Yi(e){var r=wr(e);return zu(r[1][0].data)}function Wb(e,r){var a=wr(r.data),n=Ja(a[1][0].data),i=a[3],o=[];return(i||[]).forEach(function(u){var d=wr(u.data),h=Ja(d[1][0].data)>>>0;switch(n){case 1:o[h]=sp(d[3][0].data);break;case 8:{var m=e[Yi(d[9][0].data)][0],p=wr(m.data),v=e[Yi(p[1][0].data)][0],y=Ja(v.meta[1][0].data);if(y!=2001)throw new Error("2000 unexpected reference to ".concat(y));var N=wr(v.data);o[h]=N[3].map(function(j){return sp(j.data)}).join("")}break}}),o}function o9(e,r){var a,n,i,o,u,d,h,m,p,v,y,N,j,b,w=wr(e),T=Ja(w[1][0].data)>>>0,D=Ja(w[2][0].data)>>>0,_=((n=(a=w[8])==null?void 0:a[0])==null?void 0:n.data)&&Ja(w[8][0].data)>0||!1,R,z;if((o=(i=w[7])==null?void 0:i[0])!=null&&o.data&&r!=0)R=(d=(u=w[7])==null?void 0:u[0])==null?void 0:d.data,z=(m=(h=w[6])==null?void 0:h[0])==null?void 0:m.data;else if((v=(p=w[4])==null?void 0:p[0])!=null&&v.data&&r!=1)R=(N=(y=w[4])==null?void 0:y[0])==null?void 0:N.data,z=(b=(j=w[3])==null?void 0:j[0])==null?void 0:b.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var O=_?4:1,A=fg(R),k=[],E=0;E<R.length/2;++E){var L=A.getUint16(E*2,!0);L<65535&&k.push([E,L])}if(k.length!=D)throw"Expected ".concat(D," cells, found ").concat(k.length);var H=[];for(E=0;E<k.length-1;++E)H[k[E][0]]=z.subarray(k[E][1]*O,k[E+1][1]*O);return k.length>=1&&(H[k[k.length-1][0]]=z.subarray(k[k.length-1][1]*O)),{R:T,cells:H}}function u9(e,r){var a,n=wr(r.data),i=(a=n?.[7])!=null&&a[0]?Ja(n[7][0].data)>>>0>0?1:0:-1,o=hg(n[5],function(u){return o9(u,i)});return{nrows:Ja(n[4][0].data)>>>0,data:o.reduce(function(u,d){return u[d.R]||(u[d.R]=[]),d.cells.forEach(function(h,m){if(u[d.R][m])throw new Error("Duplicate cell r=".concat(d.R," c=").concat(m));u[d.R][m]=h}),u},[])}}function d9(e,r,a){var n,i=wr(r.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(Ja(i[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(o.e.c=(Ja(i[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));a["!ref"]=Zt(o);var u=wr(i[4][0].data),d=Wb(e,e[Yi(u[4][0].data)][0]),h=(n=u[17])!=null&&n[0]?Wb(e,e[Yi(u[17][0].data)][0]):[],m=wr(u[3][0].data),p=0;m[1].forEach(function(v){var y=wr(v.data),N=e[Yi(y[2][0].data)][0],j=Ja(N.meta[1][0].data);if(j!=6002)throw new Error("6001 unexpected reference to ".concat(j));var b=u9(e,N);b.data.forEach(function(w,T){w.forEach(function(D,_){var R=Ct({r:p+T,c:_}),z=c9(D,d,h);z&&(a[R]=z)})}),p+=b.nrows})}function f9(e,r){var a=wr(r.data),n={"!ref":"A1"},i=e[Yi(a[2][0].data)],o=Ja(i[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return d9(e,i[0],n),n}function h9(e,r){var a,n=wr(r.data),i={name:(a=n[1])!=null&&a[0]?sp(n[1][0].data):"",sheets:[]},o=hg(n[2],Yi);return o.forEach(function(u){e[u].forEach(function(d){var h=Ja(d.meta[1][0].data);h==6e3&&i.sheets.push(f9(e,d))})}),i}function m9(e,r){var a=pg(),n=wr(r.data),i=hg(n[1],Yi);if(i.forEach(function(o){e[o].forEach(function(u){var d=Ja(u.meta[1][0].data);if(d==2){var h=h9(e,u);h.sheets.forEach(function(m,p){gg(a,m,p==0?h.name:h.name+"_"+p,!0)})}})}),a.SheetNames.length==0)throw new Error("Empty NUMBERS file");return a}function Nx(e){var r,a,n,i,o={},u=[];if(e.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var m;try{m=n9(h.content)}catch(v){return console.log("?? "+h.content.length+" "+(v.message||v))}var p;try{p=r9(m)}catch(v){return console.log("## "+(v.message||v))}p.forEach(function(v){o[v.id]=v.messages,u.push(v.id)})}}),!u.length)throw new Error("File has no messages");var d=((i=(n=(a=(r=o?.[1])==null?void 0:r[0])==null?void 0:a.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Ja(o[1][0].meta[1][0].data)==1&&o[1][0];if(d||u.forEach(function(h){o[h].forEach(function(m){var p=Ja(m.meta[1][0].data)>>>0;if(p==1)if(!d)d=m;else throw new Error("Document has multiple roots")})}),!d)throw new Error("Cannot find Document root");return m9(o,d)}function x9(e){return function(a){for(var n=0;n!=e.length;++n){var i=e[n];a[i[0]]===void 0&&(a[i[0]]=i[1]),i[2]==="n"&&(a[i[0]]=Number(a[i[0]]))}}}function mg(e){x9([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function p9(e){return Mc.WS.indexOf(e)>-1?"sheet":e==Mc.CS?"chart":e==Mc.DS?"dialog":e==Mc.MS?"macro":e&&e.length?e:"sheet"}function g9(e,r){if(!e)return 0;try{e=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,p9(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function v9(e,r,a,n,i,o,u,d,h,m,p,v){try{o[n]=yu(ms(e,a,!0),r);var y=qa(e,r),N;switch(d){case"sheet":N=SP(y,r,i,h,o[n],m,p,v);break;case"chart":if(N=_P(y,r,i,h,o[n],m,p,v),!N||!N["!drawel"])break;var j=du(N["!drawel"].Target,r),b=Jx(j),w=w8(ms(e,j,!0),yu(ms(e,b,!0),j)),T=du(w,j),D=Jx(T);N=lP(ms(e,T,!0),T,h,yu(ms(e,D,!0),T),m,N);break;case"macro":N=EP(y,r,i,h,o[n],m,p,v);break;case"dialog":N=TP(y,r,i,h,o[n],m,p,v);break;default:throw new Error("Unrecognized sheet type "+d)}u[n]=N;var _=[];o&&o[n]&&wn(o[n]).forEach(function(R){var z="";if(o[n][R].Type==Mc.CMNT){z=du(o[n][R].Target,r);var O=DP(qa(e,z,!0),z,h);if(!O||!O.length)return;Db(N,O,!1)}o[n][R].Type==Mc.TCMNT&&(z=du(o[n][R].Target,r),_=_.concat(_8(qa(e,z,!0),h)))}),_&&_.length&&Db(N,_,!0,h.people||[])}catch(R){if(h.WTF)throw R}}function ks(e){return e.charAt(0)=="/"?e.slice(1):e}function y9(e,r){if(Kw(),r=r||{},mg(r),Os(e,"META-INF/manifest.xml")||Os(e,"objectdata.xml"))return Hb(e,r);if(Os(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Nx<"u"){if(e.FileIndex)return Nx(e);var a=Qt.utils.cfb_new();return sb(e).forEach(function(ne){j5(a,ne,y5(e,ne))}),Nx(a)}throw new Error("Unsupported NUMBERS file")}if(!Os(e,"[Content_Types].xml"))throw Os(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Os(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=sb(e),i=x6(ms(e,"[Content_Types].xml")),o=!1,u,d;if(i.workbooks.length===0&&(d="xl/workbook.xml",qa(e,d,!0)&&i.workbooks.push(d)),i.workbooks.length===0){if(d="xl/workbook.bin",!qa(e,d,!0))throw new Error("Could not find workbook");i.workbooks.push(d),o=!0}i.workbooks[0].slice(-3)=="bin"&&(o=!0);var h={},m={};if(!r.bookSheets&&!r.bookProps){if(Nu=[],i.sst)try{Nu=kP(qa(e,ks(i.sst)),i.sst,r)}catch(ne){if(r.WTF)throw ne}r.cellStyles&&i.themes.length&&(h=AP(ms(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],r)),i.style&&(m=CP(qa(e,ks(i.style)),i.style,h,r))}i.links.map(function(ne){try{var ge=yu(ms(e,Jx(ks(ne))),ne);return RP(qa(e,ks(ne)),ge,ne,r)}catch{}});var p=wP(qa(e,ks(i.workbooks[0])),i.workbooks[0],r),v={},y="";i.coreprops.length&&(y=qa(e,ks(i.coreprops[0]),!0),y&&(v=_S(y)),i.extprops.length!==0&&(y=qa(e,ks(i.extprops[0]),!0),y&&j6(y,v,r)));var N={};(!r.bookSheets||r.bookProps)&&i.custprops.length!==0&&(y=ms(e,ks(i.custprops[0]),!0),y&&(N=N6(y,r)));var j={};if((r.bookSheets||r.bookProps)&&(p.Sheets?u=p.Sheets.map(function(ge){return ge.name}):v.Worksheets&&v.SheetNames.length>0&&(u=v.SheetNames),r.bookProps&&(j.Props=v,j.Custprops=N),r.bookSheets&&typeof u<"u"&&(j.SheetNames=u),r.bookSheets?j.SheetNames:r.bookProps))return j;u={};var b={};r.bookDeps&&i.calcchain&&(b=OP(qa(e,ks(i.calcchain)),i.calcchain));var w=0,T={},D,_;{var R=p.Sheets;v.Worksheets=R.length,v.SheetNames=[];for(var z=0;z!=R.length;++z)v.SheetNames[z]=R[z].name}var O=o?"bin":"xml",A=i.workbooks[0].lastIndexOf("/"),k=(i.workbooks[0].slice(0,A+1)+"_rels/"+i.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");Os(e,k)||(k="xl/_rels/workbook."+O+".rels");var E=yu(ms(e,k,!0),k.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(r.xlmeta=MP(qa(e,ks(i.metadata[0])),i.metadata[0],r)),(i.people||[]).length>=1&&(r.people=E8(qa(e,ks(i.people[0])),r)),E&&(E=g9(E,p.Sheets));var L=qa(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=v.Worksheets;++w){var H="sheet";if(E&&E[w]?(D="xl/"+E[w][1].replace(/[\/]?xl\//,""),Os(e,D)||(D=E[w][1]),Os(e,D)||(D=k.replace(/_rels\/.*$/,"")+E[w][1]),H=E[w][2]):(D="xl/worksheets/sheet"+(w+1-L)+"."+O,D=D.replace(/sheet0\./,"sheet.")),_=D.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(w!=r.sheets)continue e;break;case"string":if(v.SheetNames[w].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var I=!1,re=0;re!=r.sheets.length;++re)typeof r.sheets[re]=="number"&&r.sheets[re]==w&&(I=1),typeof r.sheets[re]=="string"&&r.sheets[re].toLowerCase()==v.SheetNames[w].toLowerCase()&&(I=1);if(!I)continue e}}v9(e,D,_,v.SheetNames[w],w,T,u,H,r,p,h,m)}return j={Directory:i,Workbook:p,Props:v,Custprops:N,Deps:b,Sheets:u,SheetNames:v.SheetNames,Strings:Nu,Styles:m,Themes:h,SSF:ur(It)},r&&r.bookFiles&&(e.files?(j.keys=n,j.files=e.files):(j.keys=[],j.files={},e.FullPaths.forEach(function(ne,ge){ne=ne.replace(/^Root Entry[\/]/,""),j.keys.push(ne),j.files[ne]=e.FileIndex[ge]}))),r&&r.bookVBA&&(i.vba.length>0?j.vbaraw=qa(e,ks(i.vba[0]),!0):i.defaults&&i.defaults.bin===k8&&(j.vbaraw=qa(e,"xl/vbaProject.bin",!0))),j}function j9(e,r){var a=r||{},n="Workbook",i=Qt.find(e,n);try{if(n="/!DataSpaces/Version",i=Qt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(fF(i.content),n="/!DataSpaces/DataSpaceMap",i=Qt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=mF(i.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Qt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=xF(i.content);if(u.length!=1||u[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Qt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);gF(i.content)}catch{}if(n="/EncryptionInfo",i=Qt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var d=vF(i.content);if(n="/EncryptedPackage",i=Qt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(d[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(d[1],i.content,a.password||"",a);if(d[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(d[1],i.content,a.password||"",a);throw new Error("File is password-protected")}function xg(e,r){var a="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":a=vs(e.slice(0,12));break;case"binary":a=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3),a.charCodeAt(4),a.charCodeAt(5),a.charCodeAt(6),a.charCodeAt(7)]}function b9(e,r){return Qt.find(e,"EncryptedPackage")?j9(e,r):o_(e,r)}function N9(e,r){var a,n=e,i=r||{};return i.type||(i.type=Kt&&Buffer.isBuffer(e)?"buffer":"base64"),a=aS(n,i),y9(a,i)}function h_(e,r){var a=0;e:for(;a<e.length;)switch(e.charCodeAt(a)){case 10:case 13:case 32:++a;break;case 60:return ap(e.slice(a),r);default:break e}return Pu.to_workbook(e,r)}function w9(e,r){var a="",n=xg(e,r);switch(r.type){case"base64":a=vs(e);break;case"binary":a=e;break;case"buffer":a=e.toString("binary");break;case"array":a=Ml(e);break;default:throw new Error("Unrecognized type "+r.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(a=va(a)),r.type="binary",h_(a,r)}function S9(e,r){var a=e;return r.type=="base64"&&(a=vs(a)),a=Mu.utils.decode(1200,a.slice(2),"str"),r.type="binary",h_(a,r)}function _9(e){return e.match(/[^\x00-\x7F]/)?fu(e):e}function wx(e,r,a,n){return n?(a.type="string",Pu.to_workbook(e,a)):Pu.to_workbook(r,a)}function Vu(e,r){Pw();var a=r||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Vu(new Uint8Array(e),(a=ur(a),a.type="array",a));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!a.type&&(a.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],o=!1;if(a.cellStyles&&(a.cellNF=!0,a.sheetStubs=!0),Bc={},a.dateNF&&(Bc.dateNF=a.dateNF),a.type||(a.type=Kt&&Buffer.isBuffer(e)?"buffer":"base64"),a.type=="file"&&(a.type=Kt?"buffer":"binary",n=f5(e),typeof Uint8Array<"u"&&!Kt&&(a.type="array")),a.type=="string"&&(o=!0,a.type="binary",a.codepage=65001,n=_9(e)),a.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var u=new ArrayBuffer(3),d=new Uint8Array(u);if(d.foo="bar",!d.foo)return a=ur(a),a.type="array",Vu(Yp(n),a)}switch((i=xg(n,a))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return b9(Qt.read(n,a),a);break;case 9:if(i[1]<=8)return o_(n,a);break;case 60:return ap(n,a);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return JM(n,a);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return QM.to_workbook(n,a);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?N9(n,a):wx(e,n,a,o);case 239:return i[3]===60?ap(n,a):wx(e,n,a,o);case 255:if(i[1]===254)return S9(n,a);if(i[1]===0&&i[2]===2&&i[3]===0)return bu.to_workbook(n,a);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return bu.to_workbook(n,a);break;case 3:case 131:case 139:case 140:return kb.to_workbook(n,a);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return kF.to_workbook(n,a);break;case 10:case 13:case 32:return w9(n,a);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return $M.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?kb.to_workbook(n,a):wx(e,n,a,o)}function E9(e,r,a,n,i,o,u,d){var h=dr(a),m=d.defval,p=d.raw||!Object.prototype.hasOwnProperty.call(d,"raw"),v=!0,y=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:a,enumerable:!1})}catch{y.__rowNum__=a}else y.__rowNum__=a;if(!u||e[a])for(var N=r.s.c;N<=r.e.c;++N){var j=u?e[a][N]:e[n[N]+h];if(j===void 0||j.t===void 0){if(m===void 0)continue;o[N]!=null&&(y[o[N]]=m);continue}var b=j.v;switch(j.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+j.t)}if(o[N]!=null){if(b==null)if(j.t=="e"&&b===null)y[o[N]]=null;else if(m!==void 0)y[o[N]]=m;else if(p&&b===null)y[o[N]]=null;else continue;else y[o[N]]=p&&(j.t!=="n"||j.t==="n"&&d.rawNumbers!==!1)?b:fi(j,b,d);b!=null&&(v=!1)}}return{row:y,isempty:v}}function ip(e,r){if(e==null||e["!ref"]==null)return[];var a={t:"n",v:0},n=0,i=1,o=[],u=0,d="",h={s:{r:0,c:0},e:{r:0,c:0}},m=r||{},p=m.range!=null?m.range:e["!ref"];switch(m.header===1?n=1:m.header==="A"?n=2:Array.isArray(m.header)?n=3:m.header==null&&(n=0),typeof p){case"string":h=Ra(p);break;case"number":h=Ra(e["!ref"]),h.s.r=p;break;default:h=p}n>0&&(i=0);var v=dr(h.s.r),y=[],N=[],j=0,b=0,w=Array.isArray(e),T=h.s.r,D=0,_={};w&&!e[T]&&(e[T]=[]);var R=m.skipHidden&&e["!cols"]||[],z=m.skipHidden&&e["!rows"]||[];for(D=h.s.c;D<=h.e.c;++D)if(!(R[D]||{}).hidden)switch(y[D]=Za(D),a=w?e[T][D]:e[y[D]+v],n){case 1:o[D]=D-h.s.c;break;case 2:o[D]=y[D];break;case 3:o[D]=m.header[D-h.s.c];break;default:if(a==null&&(a={w:"__EMPTY",t:"s"}),d=u=fi(a,null,m),b=_[u]||0,!b)_[u]=1;else{do d=u+"_"+b++;while(_[d]);_[u]=b,_[d]=1}o[D]=d}for(T=h.s.r+i;T<=h.e.r;++T)if(!(z[T]||{}).hidden){var O=E9(e,h,T,y,n,o,w,m);(O.isempty===!1||(n===1?m.blankrows!==!1:m.blankrows))&&(N[j++]=O.row)}return N.length=j,N}var Yb=/"/g;function T9(e,r,a,n,i,o,u,d){for(var h=!0,m=[],p="",v=dr(a),y=r.s.c;y<=r.e.c;++y)if(n[y]){var N=d.dense?(e[a]||[])[y]:e[n[y]+v];if(N==null)p="";else if(N.v!=null){h=!1,p=""+(d.rawNumbers&&N.t=="n"?N.v:fi(N,null,d));for(var j=0,b=0;j!==p.length;++j)if((b=p.charCodeAt(j))===i||b===o||b===34||d.forceQuotes){p='"'+p.replace(Yb,'""')+'"';break}p=="ID"&&(p='"ID"')}else N.f!=null&&!N.F?(h=!1,p="="+N.f,p.indexOf(",")>=0&&(p='"'+p.replace(Yb,'""')+'"')):p="";m.push(p)}return d.blankrows===!1&&h?null:m.join(u)}function m_(e,r){var a=[],n=r??{};if(e==null||e["!ref"]==null)return"";var i=Ra(e["!ref"]),o=n.FS!==void 0?n.FS:",",u=o.charCodeAt(0),d=n.RS!==void 0?n.RS:`
`,h=d.charCodeAt(0),m=new RegExp((o=="|"?"\\|":o)+"+$"),p="",v=[];n.dense=Array.isArray(e);for(var y=n.skipHidden&&e["!cols"]||[],N=n.skipHidden&&e["!rows"]||[],j=i.s.c;j<=i.e.c;++j)(y[j]||{}).hidden||(v[j]=Za(j));for(var b=0,w=i.s.r;w<=i.e.r;++w)(N[w]||{}).hidden||(p=T9(e,i,w,v,u,h,o,n),p!=null&&(n.strip&&(p=p.replace(m,"")),(p||n.blankrows!==!1)&&a.push((b++?d:"")+p)));return delete n.dense,a.join("")}function C9(e,r){r||(r={}),r.FS="	",r.RS=`
`;var a=m_(e,r);return a}function A9(e){var r="",a,n="";if(e==null||e["!ref"]==null)return[];var i=Ra(e["!ref"]),o="",u=[],d,h=[],m=Array.isArray(e);for(d=i.s.c;d<=i.e.c;++d)u[d]=Za(d);for(var p=i.s.r;p<=i.e.r;++p)for(o=dr(p),d=i.s.c;d<=i.e.c;++d)if(r=u[d]+o,a=m?(e[p]||[])[d]:e[r],n="",a!==void 0){if(a.F!=null){if(r=a.F,!a.f)continue;n=a.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(a.f!=null)n=a.f;else{if(a.t=="z")continue;if(a.t=="n"&&a.v!=null)n=""+a.v;else if(a.t=="b")n=a.v?"TRUE":"FALSE";else if(a.w!==void 0)n="'"+a.w;else{if(a.v===void 0)continue;a.t=="s"?n="'"+a.v:n=""+a.v}}h[h.length]=r+"="+n}return h}function x_(e,r,a){var n=a||{},i=+!n.skipHeader,o=e||{},u=0,d=0;if(o&&n.origin!=null)if(typeof n.origin=="number")u=n.origin;else{var h=typeof n.origin=="string"?Lr(n.origin):n.origin;u=h.r,d=h.c}var m,p={s:{c:0,r:0},e:{c:d,r:u+r.length-1+i}};if(o["!ref"]){var v=Ra(o["!ref"]);p.e.c=Math.max(p.e.c,v.e.c),p.e.r=Math.max(p.e.r,v.e.r),u==-1&&(u=v.e.r+1,p.e.r=u+r.length-1+i)}else u==-1&&(u=0,p.e.r=r.length-1+i);var y=n.header||[],N=0;r.forEach(function(b,w){wn(b).forEach(function(T){(N=y.indexOf(T))==-1&&(y[N=y.length]=T);var D=b[T],_="z",R="",z=Ct({c:d+N,r:u+w+i});m=Hu(o,z),D&&typeof D=="object"&&!(D instanceof Date)?o[z]=D:(typeof D=="number"?_="n":typeof D=="boolean"?_="b":typeof D=="string"?_="s":D instanceof Date?(_="d",n.cellDates||(_="n",D=Ur(D)),R=n.dateNF||It[14]):D===null&&n.nullError&&(_="e",D=0),m?(m.t=_,m.v=D,delete m.w,delete m.R,R&&(m.z=R)):o[z]=m={t:_,v:D},R&&(m.z=R))})}),p.e.c=Math.max(p.e.c,d+y.length-1);var j=dr(u);if(i)for(N=0;N<y.length;++N)o[Za(N+d)+j]={t:"s",v:y[N]};return o["!ref"]=Zt(p),o}function k9(e,r){return x_(null,e,r)}function Hu(e,r,a){if(typeof r=="string"){if(Array.isArray(e)){var n=Lr(r);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?Hu(e,Ct(r)):Hu(e,Ct({r,c:a||0}))}function D9(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var a=e.SheetNames.indexOf(r);if(a>-1)return a;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function pg(){return{SheetNames:[],Sheets:{}}}function gg(e,r,a,n){var i=1;if(!a)for(;i<=65535&&e.SheetNames.indexOf(a="Sheet"+i)!=-1;++i,a=void 0);if(!a||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(a)>=0){var o=a.match(/(^.*?)(\d+)$/);i=o&&+o[2]||0;var u=o&&o[1]||a;for(++i;i<=65535&&e.SheetNames.indexOf(a=u+i)!=-1;++i);}if(xP(a),e.SheetNames.indexOf(a)>=0)throw new Error("Worksheet with name |"+a+"| already exists!");return e.SheetNames.push(a),e.Sheets[a]=r,a}function O9(e,r,a){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=D9(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),a){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+a)}e.Workbook.Sheets[n].Hidden=a}function R9(e,r){return e.z=r,e}function p_(e,r,a){return r?(e.l={Target:r},a&&(e.l.Tooltip=a)):delete e.l,e}function M9(e,r,a){return p_(e,"#"+r,a)}function F9(e,r,a){e.c||(e.c=[]),e.c.push({t:r,a:a||"SheetJS"})}function I9(e,r,a,n){for(var i=typeof r!="string"?r:Ra(r),o=typeof r=="string"?r:Zt(r),u=i.s.r;u<=i.e.r;++u)for(var d=i.s.c;d<=i.e.c;++d){var h=Hu(e,u,d);h.t="n",h.F=o,delete h.v,u==i.s.r&&d==i.s.c&&(h.f=a,n&&(h.D=!0))}return e}var g_={encode_col:Za,encode_row:dr,encode_cell:Ct,encode_range:Zt,decode_col:ag,decode_row:tg,split_cell:X5,decode_cell:Lr,decode_range:Zc,format_cell:fi,sheet_add_aoa:jS,sheet_add_json:x_,sheet_add_dom:u_,aoa_to_sheet:Jc,json_to_sheet:k9,table_to_sheet:d_,table_to_book:JP,sheet_to_csv:m_,sheet_to_txt:C9,sheet_to_json:ip,sheet_to_html:ZP,sheet_to_formulae:A9,sheet_to_row_object_array:ip,sheet_get_cell:Hu,book_new:pg,book_append_sheet:gg,book_set_sheet_visibility:O9,cell_set_number_format:R9,cell_set_hyperlink:p_,cell_set_internal_link:M9,cell_add_comment:F9,sheet_set_array_formula:I9,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const z0=C.forwardRef(({className:e,...r},a)=>t.jsx(K2,{className:me("grid gap-2",e),...r,ref:a}));z0.displayName=K2.displayName;const ai=C.forwardRef(({className:e,...r},a)=>t.jsx(Q2,{className:me("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...r,children:t.jsx(lA,{className:"flex items-center justify-center",children:t.jsx(Z2,{className:"h-2.5 w-2.5 fill-current text-current"})})}));ai.displayName=Q2.displayName;const Ya=C.forwardRef(({className:e,...r},a)=>t.jsx("div",{className:"relative w-full overflow-auto",children:t.jsx("table",{className:me("w-full caption-bottom text-sm",e),ref:a,...r})}));Ya.displayName="Table";const Xa=C.forwardRef(({className:e,...r},a)=>t.jsx("thead",{className:me("[&_tr]:border-b",e),ref:a,...r}));Xa.displayName="TableHeader";const $a=C.forwardRef(({className:e,...r},a)=>t.jsx("tbody",{className:me("[&_tr:last-child]:border-0",e),ref:a,...r}));$a.displayName="TableBody";const L9=C.forwardRef(({className:e,...r},a)=>t.jsx("tfoot",{className:me("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),ref:a,...r}));L9.displayName="TableFooter";const Tt=C.forwardRef(({className:e,...r},a)=>t.jsx("tr",{className:me("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),ref:a,...r}));Tt.displayName="TableRow";const He=C.forwardRef(({className:e,...r},a)=>t.jsx("th",{className:me("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),ref:a,...r}));He.displayName="TableHead";const Pe=C.forwardRef(({className:e,...r},a)=>t.jsx("td",{className:me("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),ref:a,...r}));Pe.displayName="TableCell";const P9=C.forwardRef(({className:e,...r},a)=>t.jsx("caption",{className:me("mt-4 text-muted-foreground text-sm",e),ref:a,...r}));P9.displayName="TableCaption";function B9(e,r){if(e.length===0)return r.length;if(r.length===0)return e.length;const a=Array.from({length:r.length+1},(n,i)=>[i]);for(let n=0;n<=e.length;n++)a[0][n]=n;for(let n=1;n<=r.length;n++)for(let i=1;i<=e.length;i++)r.charAt(n-1)===e.charAt(i-1)?a[n][i]=a[n-1][i-1]:a[n][i]=Math.min(a[n-1][i-1]+1,Math.min(a[n][i-1]+1,a[n-1][i]+1));return a[r.length][e.length]}function lp(e,r){const a=_u(e),n=_u(r);if(a===n)return 1;if(!(a&&n))return 0;if(a.includes(n)||n.includes(a))return .9;const i=B9(a,n),o=Math.max(a.length,n.length);return 1-i/o}function _u(e){return e?e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").trim().replace(/[^a-z0-9]/g,""):""}const kc={email:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,cpf:/^\d{3}\.?\d{3}\.?\d{3}-?\d{2}$/,phone:/^(\(?\d{2}\)?\s?)?(9\s?)?\d{4}-?\d{4}$/,date:/^(\d{1,2})[/-](\d{1,2})[/-](\d{2,4})$/,money:/^R?\$?\s?\d{1,3}(\.?\d{3})*(,\d{2})?$/,number:/^\d+([.,]\d+)?$/};function v_(e){const r=e.filter(o=>o!=null&&String(o).trim()!=="").map(String);if(r.length===0)return null;const a={email:0,cpf:0,phone:0,date:0,money:0,number:0};for(const o of r)kc.email.test(o)&&a.email++,kc.cpf.test(o)&&a.cpf++,kc.phone.test(o)&&a.phone++,kc.date.test(o)&&a.date++,kc.money.test(o)&&a.money++,kc.number.test(o)&&a.number++;const n=r.length*.5,i=Object.entries(a).sort((o,u)=>u[1]-o[1]);return i[0][1]>=n?i[0][0]:null}function U9(e,r,a=[]){let n=0,i="semantic";const o=_u(e),u=lp(o,_u(r.value)),d=lp(o,_u(r.label)),h=Math.max(u,d);if(h===1)return{schemaField:r.value,confidence:1,reason:"exact"};if(n+=h*.6,a.length>0){const m=v_(a),v={email:"email",cpf:"cpf",phone:"phone",birthDate:"date",saleDate:"date",startDate:"date",totalValue:"money",installmentValue:"money",installments:"number"}[r.value];v&&m===v?(n+=.4,n>.9&&(i="pattern")):v&&m&&m!==v&&(v==="money"&&m==="date"&&(n-=.3),v==="date"&&m==="email"&&(n-=.5))}return{schemaField:r.value,confidence:Math.min(n,1),reason:n>.8?i:"semantic"}}function z9(e,r){const a=S_().filter(i=>i.value!=="_skip"),n={};for(const i of e){const o=r.slice(0,10).map(d=>d[i]);let u=null;for(const d of a){const h=U9(i,d,o);(!u||h.confidence>u.confidence)&&(u=h)}u&&u.confidence>.4&&(n[i]=u)}return n}const dd=/\D/g,V9=/^(\d)\1{10}$/,H9=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,G9=/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/,q9=/[R$\s]/g,W9=/\./g,Y9=/,/g;function X9(e){if(!e)return!1;const r=e.replace(dd,"");if(r.length!==11||V9.test(r))return!1;let a=0;for(let i=0;i<9;i++)a+=Number.parseInt(r.charAt(i),10)*(10-i);let n=a*10%11;if((n===10||n===11)&&(n=0),n!==Number.parseInt(r.charAt(9),10))return!1;a=0;for(let i=0;i<10;i++)a+=Number.parseInt(r.charAt(i),10)*(11-i);return n=a*10%11,(n===10||n===11)&&(n=0),n===Number.parseInt(r.charAt(10),10)}function $9(e){return e.replace(dd,"")}function K9(e){return e?H9.test(e.trim().toLowerCase()):!1}function y_(e){return e.trim().toLowerCase()}function Q9(e){if(!e)return!1;const r=e.replace(dd,"");return r.length>=10&&r.length<=11}function j_(e){return e.replace(dd,"")}const Z9={enfermagem:"enfermeiro",enfermeiro:"enfermeiro",enfermeira:"enfermeiro",dentista:"dentista",odontologia:"dentista",odontologo:"dentista",odontlogo:"dentista",biomedico:"biomedico",biomdico:"biomedico",biomdica:"biomedico",biomedica:"biomedico",biomedicina:"biomedico",farmaceutico:"farmaceutico",farmacutico:"farmaceutico",farmacutica:"farmaceutico",farmaceutica:"farmaceutico",farmcia:"farmaceutico",farmacia:"farmaceutico",medico:"medico",mdico:"medico",mdica:"medico",medica:"medico",medicina:"medico",esteticista:"esteticista",esttica:"esteticista",estetica:"esteticista",fisioterapeuta:"outro",fisioterapia:"outro"};function b_(e){if(!e)return"outro";const r=e.trim().toLowerCase();return Z9[r]||"outro"}const J9={ativo:"ativo",ativa:"ativo",active:"ativo",inativo:"inativo",inativa:"inativo",inactive:"inativo",pausado:"pausado",pausada:"pausado",paused:"pausado",formado:"formado",formada:"formado",concluido:"formado",concludo:"formado",graduated:"formado",assinado:"ativo"};function N_(e){if(!e)return"ativo";const r=e.trim().toLowerCase();return J9[r]||"ativo"}function w_(e){if(typeof e=="boolean")return e;if(!e)return!1;const r=String(e).trim().toLowerCase();return["sim","yes","true","1","s","y","verdadeiro"].includes(r)}function Jf(e){if(!e)return;if(typeof e=="number")return new Date(1899,11,30).getTime()+e*24*60*60*1e3;const r=String(e).trim(),a=r.match(G9);if(a){const[,i,o,u]=a;return new Date(Number.parseInt(u,10),Number.parseInt(o,10)-1,Number.parseInt(i,10)).getTime()}const n=new Date(r);if(!Number.isNaN(n.getTime()))return n.getTime()}const Xb={nome:"name","nome completo":"name",aluno:"name",email:"email","e-mail":"email","correio eletrnico":"email",telefone:"phone",celular:"phone",whatsapp:"phone",contato:"phone",cpf:"cpf",documento:"cpf","documento cpf":"cpf",graduao:"profession",graduacao:"profession",profisso:"profession",profissao:"profession",formao:"profession",formacao:"profession","tem clnica":"hasClinic","tem clinica":"hasClinic",clinica:"hasClinic","nome clnica":"clinicName","nome clinica":"clinicName","clnica nome":"clinicName","clinica nome":"clinicName","cidade clnica":"clinicCity","cidade clinica":"clinicCity",status:"status","status contrato":"contractStatus",situacao:"status",situao:"status",endereo:"address",endereco:"address",rua:"address",logradouro:"address",nmero:"addressNumber",numero:"addressNumber",n:"addressNumber",complemento:"complement",bairro:"neighborhood",cidade:"city",municipio:"city",municpio:"city",estado:"state",uf:"state",cep:"zipCode","cdigo postal":"zipCode","codigo postal":"zipCode",pas:"country",pais:"country","data nasc":"birthDate","data de nascimento":"birthDate",nascimento:"birthDate","data nascimento":"birthDate","data da venda":"saleDate","data venda":"saleDate",vendedor:"salesperson",vendedora:"salesperson","origem lead":"leadSource",origem:"leadSource",fonte:"leadSource",turma:"cohort","valor total":"totalValue",valor_total:"totalValue",valortotal:"totalValue","total value":"totalValue",total:"totalValue",parcelas:"installments","nmero de parcelas":"installments","numero de parcelas":"installments","qtd parcelas":"installments",installments:"installments","valor parcela":"installmentValue",valor_parcela:"installmentValue",valorparcela:"installmentValue","installment value":"installmentValue","status pagamento":"paymentStatus",status_pagamento:"paymentStatus","payment status":"paymentStatus",pagamento:"paymentStatus","parcelas pagas":"paidInstallments",parcelas_pagas:"paidInstallments","paid installments":"paidInstallments","data incio":"startDate","data inicio":"startDate",data_inicio:"startDate","start date":"startDate",inicio:"startDate",registro:"professionalId","registro profissional":"professionalId",coren:"professionalId",cro:"professionalId",crm:"professionalId",crf:"professionalId"};function tu(e,r=[]){const a={};if(r.length>0){const n=z9(e,r);for(const[i,o]of Object.entries(n))o.confidence>.5&&(a[i]=o.schemaField)}for(const n of e){const i=n.trim().toLowerCase();Xb[i]&&(a[n]=Xb[i])}return a}function S_(){return[{value:"name",label:"Nome",required:!0},{value:"email",label:"Email",required:!0},{value:"phone",label:"Telefone",required:!0},{value:"cpf",label:"CPF",required:!1},{value:"profession",label:"Profisso",required:!1},{value:"hasClinic",label:"Tem Clnica",required:!1},{value:"clinicName",label:"Nome da Clnica",required:!1},{value:"clinicCity",label:"Cidade da Clnica",required:!1},{value:"status",label:"Status",required:!1},{value:"birthDate",label:"Data de Nascimento",required:!1},{value:"address",label:"Endereo",required:!1},{value:"addressNumber",label:"Nmero",required:!1},{value:"complement",label:"Complemento",required:!1},{value:"neighborhood",label:"Bairro",required:!1},{value:"city",label:"Cidade",required:!1},{value:"state",label:"Estado",required:!1},{value:"zipCode",label:"CEP",required:!1},{value:"country",label:"Pas",required:!1},{value:"saleDate",label:"Data da Venda",required:!1},{value:"salesperson",label:"Vendedor",required:!1},{value:"contractStatus",label:"Status do Contrato",required:!1},{value:"leadSource",label:"Origem do Lead",required:!1},{value:"cohort",label:"Turma",required:!1},{value:"totalValue",label:"Valor Total",required:!1},{value:"installments",label:"Parcelas",required:!1},{value:"installmentValue",label:"Valor da Parcela",required:!1},{value:"paymentStatus",label:"Status Pagamento",required:!1},{value:"paidInstallments",label:"Parcelas Pagas",required:!1},{value:"startDate",label:"Data de Incio",required:!1},{value:"professionalId",label:"Registro Profissional",required:!1},{value:"_skip",label:"-- Ignorar --",required:!1}]}const eB=(e,r,a,n,i)=>{!e||String(e).trim().length<2?a.push(`Linha ${r}: Nome  obrigatrio e deve ter pelo menos 2 caracteres`):i.name=String(e).trim()},tB=(e,r,a,n,i)=>{e&&(K9(String(e))?i.email=y_(String(e)):a.push(`Linha ${r}: Email invlido: ${e}`))},aB=(e,r,a,n,i)=>{e?(Q9(String(e))||n.push(`Linha ${r}: Telefone pode estar em formato invlido: ${e}`),i.phone=j_(String(e))):a.push(`Linha ${r}: Telefone  obrigatrio`)},rB=(e,r,a,n,i)=>{if(e){const o=String(e);X9(o)||n.push(`Linha ${r}: CPF invlido: ${e}`),i.cpf=$9(o)}},$b=(e,r,a,n,i,o)=>{if(e){const u=Jf(e);u&&(i[o]=u)}},sB=(e,r,a,n,i,o)=>{e!=null&&e!==""&&(i[o]=String(e).trim())},nB={name:eB,email:tB,phone:aB,cpf:rB,profession:(e,r,a,n,i)=>{i.profession=b_(String(e||""))},hasClinic:(e,r,a,n,i)=>{i.hasClinic=w_(e)},status:(e,r,a,n,i)=>{i.status=N_(String(e||""))},birthDate:$b,saleDate:$b};function iB(e,r,a){const n=[],i=[],o={};for(const[u,d]of Object.entries(a)){if(d==="_skip")continue;const h=e[u];(nB[d]||sB)(h,r,n,i,o,d)}return o.hasClinic===void 0&&(o.hasClinic=!1),{isValid:n.length===0,errors:n,warnings:i,data:o}}const lB={em_dia:"em_dia","em dia":"em_dia",adimplente:"em_dia",regular:"em_dia",atrasado:"atrasado",inadimplente:"atrasado",atraso:"atrasado",quitado:"quitado",pago:"quitado",finalizado:"quitado",cancelado:"cancelado",cancelamento:"cancelado"};function cB(e){if(!e)return"em_dia";const r=e.trim().toLowerCase();return lB[r]||"em_dia"}function Kb(e){if(!e)return 0;if(typeof e=="number")return e;let r=e.replace(q9,"");const a=r.lastIndexOf(","),n=r.lastIndexOf(".");a>n?r=r.replace(W9,"").replace(",","."):n>a?r=r.replace(Y9,""):a!==-1&&(r=r.replace(",","."));const i=Number.parseFloat(r);return Number.isNaN(i)?0:i}function Qb(e){if(!e)return 0;if(typeof e=="number")return Math.floor(e);const r=Number.parseInt(String(e).replace(dd,""),10);return Number.isNaN(r)?0:r}const oB=["nome","nome completo","aluno","email","e-mail","telefone","celular","whatsapp","contato","cpf","documento","endereco","endereo","rua","logradouro","numero","nmero","complemento","bairro","cidade","municipio","municpio","estado","uf","cep","pais","pas","profissao","profisso","graduacao","graduao","formacao","formao","registro","coren","crm","cro","crf","status","situacao","situao","data","nascimento","venda","turma","curso","matricula","matrcula","valor","total","parcela","parcelas","pagamento","pago","vendedor","vendedora","origem","fonte","lead","clinica","clnica"],uB=/^\d+([.,]\d+)?$/,dB=/^\d{1,2}[/.-]\d{1,2}[/.-]\d{2,4}$/;function Zb(e){if(e==null||e==="")return!1;const r=String(e).trim();return!(r===""||uB.test(r)||dB.test(r)||r.length>50)}function fB(e,r){if(!e||e.length===0)return 0;let a=0;const n=e.filter(m=>m!=null&&String(m).trim()!==""),o=e.filter(Zb).length/Math.max(e.length,1);a+=o*30;let u=0;const d=new Set;e.forEach(m=>{if(m==null)return;const p=String(m).trim();if(d.has(p))return;let v=0;for(const y of oB){const N=lp(p,y);N>v&&(v=N)}v>.8&&(u+=10*v,d.add(p))}),a+=Math.min(u,50);const h=n.length/Math.max(e.length,1);return a+=h*20,n.length>=3&&(a+=10),r&&r.length>0&&(r.map(v=>v_([v])).some(v=>v==="email"||v==="cpf"||v==="phone"||v==="date")?a+=40:o>.8&&r.every(v=>!Zb(v))&&(a+=20)),a}function __(e,r=20){const a=[],n=Math.min(e.length,r);for(let u=0;u<n;u++){const d=e[u];if(!(d&&Array.isArray(d)))continue;const h=u+1<e.length?e[u+1]:void 0,m=fB(d,h),p=d.map(v=>String(v??"").trim()).filter(Boolean);p.length>=1&&a.push({rowIndex:u,score:m,headers:p})}if(a.sort((u,d)=>d.score-u.score),a.length===0)return{headerRowIndex:0,confidence:0,headers:(e[0]||[]).map(d=>String(d??"").trim()).filter(Boolean),candidates:[]};const i=a[0];let o;if(a.length===1)o=Math.min(i.score/100,1);else{const d=(i.score-a[1].score)/Math.max(i.score,1),h=i.score/100;o=Math.min((d+h)/2,1)}return{headerRowIndex:i.rowIndex,confidence:Math.round(o*100)/100,headers:i.headers,candidates:a}}function vg(e,r){if(r<0||r>=e.length)throw new Error(`Invalid header row index: ${r}`);const n=e[r].map(o=>String(o??"").trim()).filter(Boolean);if(n.length===0)throw new Error("No valid headers found in the specified row");const i=e.slice(r+1).map(o=>{const u=o,d={};return n.forEach((h,m)=>{d[h]=u[m]}),d});return{headers:n,dataRows:i}}function E_(e,r){try{const a={type:"array",cellDates:!0,cellNF:!1,cellText:!0};return r&&(a.password=r),{success:!0,workbook:Vu(e,a)}}catch(a){const n=a instanceof Error?a.message:String(a);return n.includes("password")||n.includes("encrypted")||n.includes("ECMA-376")||n.includes("Encrypted")?{success:!1,needsPassword:!0}:{success:!1,error:n}}}function hB(e){const r=e.SheetNames[0];if(!r)throw new Error("Workbook has no sheets");const a=e.Sheets[r];if(!a)throw new Error("Could not access first sheet");return g_.sheet_to_json(a,{header:1,defval:""})}async function Kq(e,r){const a=await e.arrayBuffer(),n=E_(a,r);if(!n.success){if("needsPassword"in n&&n.needsPassword)throw new Error("NEEDS_PASSWORD");const d=n;throw new Error(d.error??"Erro ao processar arquivo")}const i=hB(n.workbook);if(i.length===0)throw new Error("Arquivo vazio");const o=__(i),u=vg(i,o.headerRowIndex);return{data:{headers:u.headers,rows:u.dataRows},headerDetection:o}}class Fr extends Error{code;constructor(r,a){super(r),this.code=a,this.name="XLSXParseError"}}async function mB(e){const r=await e.arrayBuffer();return Vu(r,{type:"array"}).SheetNames}function xB(e,r){if(r){const a=E_(e,r);if(!a.success)throw"needsPassword"in a&&a.needsPassword?new Fr("Senha incorreta. Tente novamente.","WRONG_PASSWORD"):"error"in a?new Fr(a.error,"PASSWORD_ERROR"):new Fr("Erro ao processar arquivo protegido.","PASSWORD_ERROR");return a.workbook}return Vu(e,{type:"array",cellDates:!0,cellNF:!1})}function pB(e){throw e instanceof Fr?e:e instanceof Error&&e.message.includes("password")?new Fr("Arquivo protegido por senha. Por favor, informe a senha.","PASSWORD_PROTECTED"):new Fr("Estrutura de arquivo XLSX invlida. Verifique se o arquivo no est corrompido.","INVALID_STRUCTURE")}async function Sx(e,r,a){let n;try{n=await e.arrayBuffer()}catch{throw new Fr("No foi possvel ler o arquivo. O arquivo pode estar corrompido ou inacessvel.","FILE_READ_ERROR")}let i;try{i=xB(n,a)}catch(p){pB(p)}if(!i.SheetNames||i.SheetNames.length===0)throw new Fr("Nenhuma planilha encontrada no arquivo XLSX.","NO_SHEETS");const o=r||i.SheetNames[0],u=i.Sheets[o];if(!u)throw new Fr(r?`Planilha "${r}" no encontrada.`:"Primeira planilha est vazia ou corrompida.","EMPTY_SHEET");let d;try{d=g_.sheet_to_json(u,{header:1,raw:!1,defval:""})}catch{throw new Fr("Erro ao processar dados da planilha. Verifique o formato dos dados.","PARSE_ERROR")}if(!d||d.length===0)throw new Fr("Nenhum dado encontrado na primeira planilha.","NO_DATA");const h=__(d),m=vg(d,h.headerRowIndex);if(m.headers.length===0)throw new Fr("Nenhuma coluna vlida encontrada no cabealho.","INVALID_HEADER");return{data:{headers:m.headers,rows:m.dataRows},headerDetection:h,rawData:d}}async function gB(e){const r=await e.text(),a=Iw.parse(r,{header:!0,skipEmptyLines:!0,transformHeader:n=>n.trim()});return{headers:a.meta.fields||[],rows:a.data}}const vB=10*1024*1024,yB=[".csv",".xlsx",".xls"];function jB(e){const r=e.name.toLowerCase().slice(e.name.lastIndexOf("."));return yB.includes(r)?e.size>vB?{valid:!1,error:`Arquivo muito grande (${(e.size/1048576).toFixed(1)}MB). O tamanho mximo  10MB.`}:e.size===0?{valid:!1,error:"O arquivo est vazio. Selecione um arquivo com dados."}:{valid:!0}:{valid:!1,error:`Formato de arquivo no suportado: ${r}. Use CSV, XLSX ou XLS.`}}const bB={name:e=>String(e||"").trim(),email:e=>y_(String(e||"")),phone:e=>j_(String(e||"")),cpf:e=>e?String(e).replace(/\D/g,""):void 0,profession:e=>b_(String(e||"")),hasClinic:e=>w_(e),status:e=>N_(String(e||"")),birthDate:e=>e?Jf(e):void 0,saleDate:e=>e?Jf(e):void 0,totalValue:e=>Kb(e),installmentValue:e=>Kb(e),installments:e=>Qb(e),paidInstallments:e=>Qb(e),paymentStatus:e=>cB(String(e||"")),startDate:e=>e?Jf(e):void 0,professionalId:e=>e?String(e).trim():void 0},NB=e=>e!=null&&e!==""?String(e).trim():void 0;function wB(e){const{selectedProduct:r="",setSelectedProduct:a,isProcessing:n,fileInputId:i="",handleDrop:o,handleFileSelect:u}=e;let d="Selecione um produto primeiro";return n?d="Processando arquivo...":r&&(d="Arraste e solte um arquivo aqui"),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs("span",{className:"block font-medium text-sm",children:["Produto para matrcula ",t.jsx("span",{className:"text-red-500",children:"*"})]}),t.jsxs(Rt,{onValueChange:a,value:r,children:[t.jsx(At,{"aria-label":"Selecione o produto para matrcula",children:t.jsx(Mt,{placeholder:"Selecione o produto..."})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"trintae3",children:"Trinta e 3"}),t.jsx(ye,{value:"otb",children:"OTB"}),t.jsx(ye,{value:"black_neon",children:"Black Neon"}),t.jsx(ye,{value:"comunidade",children:"Comunidade US"}),t.jsx(ye,{value:"auriculo",children:"Aurculo"}),t.jsx(ye,{value:"na_mesa_certa",children:"Na Mesa Certa"})]})]}),t.jsx("p",{className:"text-muted-foreground text-xs",children:"Todos os alunos importados sero matriculados neste produto."})]}),t.jsxs("button",{className:"w-full cursor-pointer rounded-lg border-2 border-dashed bg-transparent p-8 text-center transition-colors hover:border-purple-500 disabled:cursor-not-allowed disabled:opacity-50",disabled:!r,onClick:()=>document.getElementById(i)?.click(),onDragOver:h=>h.preventDefault(),onDrop:o,type:"button",children:[t.jsx("input",{accept:".csv,.xlsx,.xls",className:"hidden",id:i,onChange:u,type:"file"}),n?t.jsx(pt,{className:"mx-auto mb-4 h-12 w-12 animate-spin text-purple-500"}):t.jsx(N0,{className:"mx-auto mb-4 h-12 w-12 text-muted-foreground"}),t.jsx("p",{className:"font-medium text-lg",children:d}),t.jsx("p",{className:"mt-2 text-muted-foreground text-sm",children:"ou clique para selecionar (CSV, XLSX)"})]})]})}function SB(e){const{fileName:r="",availableSheets:a=[],selectedSheet:n="",setSelectedSheet:i}=e;return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm",children:[t.jsx(_p,{className:"h-4 w-4"}),t.jsxs("span",{children:["Arquivo: ",r]})]}),t.jsxs("p",{className:"text-sm",children:["O arquivo contm ",t.jsxs("strong",{children:[a.length," planilhas"]}),". Selecione qual deseja importar:"]}),t.jsxs(Rt,{onValueChange:i,value:n,children:[t.jsx(At,{children:t.jsx(Mt,{placeholder:"Selecione a planilha..."})}),t.jsx(kt,{children:a.map(o=>t.jsx(ye,{value:o,children:o},o))})]})]})}function _B(e){const{headerDetection:r,selectedHeaderRow:a,setSelectedHeaderRow:n,rawXLSXData:i}=e;if(!(r&&i))return null;const o=i.slice(a+1,a+6),u=i[a];return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-muted-foreground text-sm",children:"Confiana na deteco:"}),t.jsxs(Ve,{variant:r.confidence>=.7?"default":"secondary",children:[Math.round(r.confidence*100),"%"]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(yt,{children:"Selecione a linha de cabealho:"}),t.jsx(z0,{onValueChange:d=>n(Number(d)),value:String(a),children:r.candidates.map(d=>t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(ai,{id:`row-${d.rowIndex}`,value:String(d.rowIndex)}),t.jsxs(yt,{className:"flex-1 cursor-pointer",htmlFor:`row-${d.rowIndex}`,children:[t.jsxs("span",{className:"font-medium",children:["Linha ",d.rowIndex+1]}),t.jsxs("span",{className:"ml-2 text-muted-foreground",children:["(",Math.round(d.score*100),"% - ",d.headers.slice(0,3).join(", "),d.headers.length>3&&"...",")"]})]})]},d.rowIndex))})]}),t.jsx(Te,{children:t.jsxs(Ce,{className:"p-4",children:[t.jsx("p",{className:"mb-2 font-medium text-sm",children:"Prvia dos dados:"}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-xs",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b",children:[u?.slice(0,5).map((d,h)=>t.jsx("th",{className:"p-1 text-left font-medium",children:String(d)||`Col ${h+1}`},h)),(u?.length??0)>5&&t.jsx("th",{className:"p-1",children:"..."})]})}),t.jsx("tbody",{children:o.map((d,h)=>t.jsxs("tr",{className:"border-b last:border-0",children:[d.slice(0,5).map((m,p)=>t.jsx("td",{className:"max-w-[150px] truncate p-1",children:String(m??"")},p)),d.length>5&&t.jsx("td",{className:"p-1",children:"..."})]},h))})]})})]})})]})}function EB(e){const{fileName:r="",parsedData:a,columnMapping:n={},handleMappingChange:i,schemaFields:o=[],canProceed:u,missingFields:d=[],upsertMode:h,setUpsertMode:m}=e;return a?t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between text-muted-foreground text-sm",children:[t.jsxs("span",{children:["Arquivo: ",r]}),t.jsxs("span",{children:[a.rows.length," registros encontrados"]})]}),t.jsx("div",{className:"overflow-hidden rounded-lg border",children:t.jsxs(Ya,{children:[t.jsx(Xa,{children:t.jsxs(Tt,{children:[t.jsx(He,{className:"w-1/3",children:"Coluna do Arquivo"}),t.jsx(He,{className:"w-1/3",children:"Campo do Sistema"}),t.jsx(He,{className:"w-1/3",children:"Exemplo"})]})}),t.jsx($a,{children:a.headers.map(p=>t.jsxs(Tt,{children:[t.jsx(Pe,{className:"font-medium",children:p}),t.jsx(Pe,{children:t.jsxs(Rt,{onValueChange:v=>i?.(p,v),value:n[p]||"_skip",children:[t.jsx(At,{className:"w-full",children:t.jsx(Mt,{placeholder:"Selecione..."})}),t.jsx(kt,{children:o.map(v=>t.jsxs(ye,{value:v.value,children:[v.label,v.required&&" *"]},v.value))})]})}),t.jsx(Pe,{className:"max-w-[200px] truncate text-muted-foreground text-sm",children:String(a.rows[0]?.[p]||"-")})]},p))})]})}),!u&&t.jsxs("div",{className:"flex items-start gap-2 text-amber-500 text-sm",children:[t.jsx(w0,{className:"mt-0.5 h-4 w-4 shrink-0"}),t.jsxs("div",{children:[t.jsx("span",{className:"font-medium",children:"Campos obrigatrios faltando:"}),t.jsx("ul",{className:"mt-1 list-inside list-disc",children:d.map(p=>{const v=o.find(y=>y.value===p)?.label||p;return t.jsx("li",{children:v},p)})})]})]}),t.jsxs("div",{className:"space-y-3 border-t pt-4",children:[t.jsxs("label",{className:"flex cursor-pointer items-center gap-2",children:[t.jsx("input",{checked:h,className:"rounded",onChange:p=>m?.(p.target.checked),type:"checkbox"}),t.jsx("span",{className:"text-sm",children:"Atualizar alunos existentes (se email j cadastrado)"})]}),t.jsx("p",{className:"ml-6 text-muted-foreground text-xs",children:h?"Alunos existentes sero atualizados e nova matrcula ser adicionada.":"Alunos com email duplicado sero ignorados."})]})]}):null}function TB(e){const{parsedData:r,previewValidation:a={valid:0,invalid:0,errors:[]},columnMapping:n={},schemaFields:i=[],transformRowData:o}=e;if(!r)return null;const u=Object.values(n).filter(d=>d!=="_skip").slice(0,5);return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[t.jsxs("div",{className:"rounded-lg border p-4",children:[t.jsx("p",{className:"font-bold text-2xl",children:r.rows.length}),t.jsx("p",{className:"text-muted-foreground text-sm",children:"Total de registros"})]}),t.jsxs("div",{className:"rounded-lg border p-4",children:[t.jsx("p",{className:"font-bold text-2xl text-green-500",children:a.valid}),t.jsx("p",{className:"text-muted-foreground text-sm",children:"Vlidos (amostra)"})]}),t.jsxs("div",{className:"rounded-lg border p-4",children:[t.jsx("p",{className:"font-bold text-2xl text-red-500",children:a.invalid}),t.jsx("p",{className:"text-muted-foreground text-sm",children:"Com erros (amostra)"})]})]}),a.errors.length>0&&t.jsxs("div",{className:"rounded-lg border border-red-200 bg-red-50 p-4 dark:bg-red-950",children:[t.jsx("h4",{className:"mb-2 font-medium text-red-700 dark:text-red-300",children:"Erros encontrados:"}),t.jsx("ul",{className:"list-inside list-disc text-red-600 text-sm dark:text-red-400",children:a.errors.slice(0,5).map((d,h)=>t.jsx("li",{children:d},h))})]}),t.jsx("div",{className:"overflow-hidden rounded-lg border",children:t.jsxs(Ya,{children:[t.jsx(Xa,{children:t.jsxs(Tt,{children:[t.jsx(He,{children:"#"}),u.map(d=>t.jsx(He,{children:i.find(h=>h.value===d)?.label||d},d))]})}),t.jsx($a,{children:r.rows.slice(0,5).map((d,h)=>{const m=o?.(d)||{};return t.jsxs(Tt,{children:[t.jsx(Pe,{children:h+2}),u.map(p=>t.jsx(Pe,{className:"max-w-[150px] truncate",children:String(m[p]||"-")},p))]},h)})})]})})]})}function CB(e){const{parsedData:r,importProgress:a=0}=e;return t.jsxs("div",{className:"py-8 text-center",children:[t.jsx(pt,{className:"mx-auto mb-4 h-12 w-12 animate-spin text-purple-500"}),t.jsx("p",{className:"font-medium text-lg",children:"Importando alunos..."}),t.jsxs("p",{className:"mt-2 text-muted-foreground text-sm",children:["Processando ",r?.rows.length||0," registros"]}),t.jsx("div",{className:"mt-4 h-2 w-full rounded-full bg-secondary",children:t.jsx("div",{className:"h-2 rounded-full bg-purple-500 transition-all",style:{width:`${a}%`}})})]})}function AB(e){const{importResults:r,downloadErrorLog:a}=e;return r?t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[t.jsxs("div",{className:"rounded-lg border p-4",children:[t.jsx("p",{className:"font-bold text-2xl",children:r.totalRows}),t.jsx("p",{className:"text-muted-foreground text-sm",children:"Total"})]}),t.jsxs("div",{className:"rounded-lg border p-4",children:[t.jsx(ci,{className:"mx-auto mb-2 h-6 w-6 text-green-500"}),t.jsx("p",{className:"font-bold text-2xl text-green-500",children:r.successCount}),t.jsx("p",{className:"text-muted-foreground text-sm",children:"Importados"})]}),t.jsxs("div",{className:"rounded-lg border p-4",children:[t.jsx(el,{className:"mx-auto mb-2 h-6 w-6 text-red-500"}),t.jsx("p",{className:"font-bold text-2xl text-red-500",children:r.failureCount}),t.jsx("p",{className:"text-muted-foreground text-sm",children:"Com erros"})]})]}),r.failureCount>0&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"max-h-48 overflow-y-auto rounded-lg border border-red-200 bg-red-50 p-4 dark:bg-red-950",children:[t.jsx("h4",{className:"mb-2 font-medium text-red-700 dark:text-red-300",children:"Erros na importao:"}),t.jsxs("ul",{className:"space-y-1 text-red-600 text-sm dark:text-red-400",children:[r.results.filter(n=>!n.success).slice(0,10).map((n,i)=>t.jsxs("li",{children:["Linha ",n.rowNumber,": ",n.error]},i)),r.failureCount>10&&t.jsxs("li",{className:"font-medium",children:["... e mais ",r.failureCount-10," erros"]})]})]}),t.jsxs(oe,{className:"gap-2",onClick:a,variant:"outline",children:[t.jsx(xs,{className:"h-4 w-4"}),"Baixar log de erros"]})]})]}):null}function kB({step:e,isProcessing:r,canProceed:a,selectedSheet:n,parsedDataRowCount:i,resetState:o,handleSheetSelect:u,handleHeaderSelect:d,handleImport:h,setStep:m,setOpen:p}){switch(e){case"sheet-select":return t.jsxs(t.Fragment,{children:[t.jsx(oe,{onClick:o,variant:"outline",children:"Cancelar"}),t.jsx(oe,{disabled:r||!n,onClick:u,children:r?t.jsxs(t.Fragment,{children:[t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}),"Processando..."]}):"Continuar"})]});case"header-select":return t.jsxs(t.Fragment,{children:[t.jsx(oe,{onClick:o,variant:"outline",children:"Cancelar"}),t.jsx(oe,{disabled:r,onClick:d,children:r?t.jsxs(t.Fragment,{children:[t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}),"Processando..."]}):"Confirmar e Continuar"})]});case"mapping":return t.jsxs(t.Fragment,{children:[t.jsx(oe,{onClick:o,variant:"outline",children:"Cancelar"}),t.jsx(oe,{disabled:!a,onClick:()=>m("preview"),children:"Pr-visualizar"})]});case"preview":return t.jsxs(t.Fragment,{children:[t.jsx(oe,{onClick:()=>m("mapping"),variant:"outline",children:"Voltar"}),t.jsx(oe,{disabled:r,onClick:h,children:r?t.jsxs(t.Fragment,{children:[t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}),"Importando..."]}):t.jsxs(t.Fragment,{children:["Importar ",i," alunos"]})})]});case"results":return t.jsx(oe,{onClick:()=>p(!1),children:"Fechar"});default:return null}}function DB(){const[e,r]=C.useState(!1),[a,n]=C.useState("upload"),[i,o]=C.useState(null),[u,d]=C.useState(null),[h,m]=C.useState({}),[p,v]=C.useState(!1),[y,N]=C.useState(0),[j,b]=C.useState(null),[w,T]=C.useState(""),[D,_]=C.useState(!0),[R,z]=C.useState([]),[O,A]=C.useState(""),[k,E]=C.useState(null),[L,H]=C.useState(null),[I,re]=C.useState(0),[ne,ge]=C.useState(!1),[W,ee]=C.useState(""),[je,Z]=C.useState(null),[De,he]=C.useState(void 0),P=et.students.create.useMutation(),q=C.useId(),J=C.useId(),K=S_(),xe=C.useCallback(()=>{n("upload"),o(null),d(null),m({}),v(!1),N(0),b(null),T(""),_(!0),z([]),A(""),E(null),H(null),re(0),ge(!1),ee(""),Z(null),he(void 0)},[]),Fe=C.useCallback(async ze=>{const vt=jB(ze);if(!vt.valid){Ie.error("Arquivo invlido",{description:vt.error});return}o(ze),v(!0);try{const tt=ze.name.endsWith(".xlsx")||ze.name.endsWith(".xls");if(tt){const Qe=await mB(ze);if(Qe.length>1){z(Qe),A(Qe[0]),n("sheet-select"),v(!1);return}}if(tt){const Qe=await Sx(ze);if(E(Qe.headerDetection),H(Qe.rawData),re(Qe.headerDetection.headerRowIndex),Qe.headerDetection.confidence<.7&&Qe.headerDetection.candidates.length>1){Z(ze),n("header-select"),v(!1);return}d(Qe.data),m(tu(Qe.data.headers,Qe.data.rows))}else{const Qe=await gB(ze);d(Qe),m(tu(Qe.headers,Qe.rows))}n("mapping")}catch(tt){if(tt instanceof Fr){if(tt.code==="PASSWORD_PROTECTED"){Z(ze),ge(!0),v(!1);return}Ie.error("Erro ao processar arquivo XLSX",{description:tt.message})}else Ie.error("Erro ao processar arquivo",{description:"Verifique se o formato do arquivo est correto e tente novamente."})}finally{v(!1)}},[]),Ae=C.useCallback(async()=>{if(i&&O){v(!0);try{const ze=await Sx(i,O);if(E(ze.headerDetection),H(ze.rawData),re(ze.headerDetection.headerRowIndex),ze.headerDetection.confidence<.7&&ze.headerDetection.candidates.length>1){he(O),n("header-select"),v(!1);return}d(ze.data),m(tu(ze.data.headers,ze.data.rows)),n("mapping")}catch(ze){ze instanceof Fr?Ie.error("Erro ao processar planilha",{description:ze.message}):Ie.error("Erro ao processar arquivo")}finally{v(!1)}}},[i,O]),Ee=C.useCallback(()=>{if(L){v(!0);try{const ze=vg(L,I);d({headers:ze.headers,rows:ze.dataRows}),m(tu(ze.headers,ze.dataRows)),n("mapping")}catch{Ie.error("Erro ao processar cabealhos",{description:"No foi possvel extrair os dados com o cabealho selecionado."})}finally{v(!1)}}},[L,I]),we=C.useCallback(async()=>{if(je&&W){v(!0),ge(!1);try{const ze=await Sx(je,De??void 0,W);if(E(ze.headerDetection),H(ze.rawData),re(ze.headerDetection.headerRowIndex),ze.headerDetection.confidence<.7&&ze.headerDetection.candidates.length>1){n("header-select"),v(!1);return}d(ze.data),m(tu(ze.data.headers,ze.data.rows)),n("mapping")}catch(ze){ze instanceof Fr?ze.code==="WRONG_PASSWORD"?(Ie.error("Senha incorreta",{description:"A senha fornecida no est correta. Tente novamente."}),ge(!0)):Ie.error("Erro ao processar arquivo XLSX",{description:ze.message}):Ie.error("Erro ao processar arquivo")}finally{v(!1),ee("")}}},[je,De,W]),Ge=C.useCallback(ze=>{ze.preventDefault();const vt=ze.dataTransfer.files[0];vt&&Fe(vt)},[Fe]),X=C.useCallback(ze=>{const vt=ze.target.files?.[0];vt&&Fe(vt)},[Fe]),ht=C.useCallback((ze,vt)=>{m(tt=>({...tt,[ze]:vt}))},[]),Ye=C.useCallback(ze=>{const vt={};for(const[tt,Qe]of Object.entries(h)){if(Qe==="_skip"||!Qe)continue;const ot=ze[tt],Ut=(bB[Qe]||NB)(ot,Qe);Ut!==void 0&&(vt[Qe]=Ut)}return vt.hasClinic||(vt.hasClinic=!1),vt.status||(vt.status="ativo"),vt.profession||(vt.profession="outro"),vt},[h]),Je=C.useCallback(()=>{if(!u)return{valid:0,invalid:0,errors:[]};let ze=0,vt=0;const tt=[];for(let Qe=0;Qe<Math.min(5,u.rows.length);Qe++){const ot=u.rows[Qe],bt=iB(ot,Qe+2,h);bt.isValid?ze++:(vt++,tt.push(...bt.errors))}return{valid:ze,invalid:vt,errors:tt}},[u,h]),qe=C.useCallback(async()=>{if(u&&i){if(!w){Ie.error("Produto no selecionado",{description:"Selecione um produto antes de importar os alunos."});return}n("importing"),v(!0),N(0);try{const ze=u.rows.map(Qe=>Ye(Qe)),vt={totalRows:ze.length,successCount:0,failureCount:0,results:[]};for(let Qe=0;Qe<ze.length;Qe++){const ot=ze[Qe];try{const bt=await P.mutateAsync({name:String(ot.name||"Sem nome"),phone:String(ot.phone||""),email:ot.email?String(ot.email):void 0,cpf:ot.cpf?String(ot.cpf):void 0,profession:ot.profession?String(ot.profession):void 0,professionalId:ot.professionalId?String(ot.professionalId):void 0,hasClinic:typeof ot.hasClinic=="boolean"?ot.hasClinic:void 0,products:w?[w]:void 0});vt.successCount++,vt.results.push({rowNumber:Qe+1,success:!0,studentId:String(bt.id)})}catch(bt){vt.failureCount++,vt.results.push({rowNumber:Qe+1,success:!1,error:bt instanceof Error?bt.message:"Erro desconhecido"})}N(Math.round((Qe+1)/ze.length*100))}b(vt),n("results")}catch{Ie.error("Erro na importao",{description:"Verifique os dados e tente novamente."})}finally{v(!1)}}},[u,i,w,P,Ye]),Be=C.useCallback(()=>{if(!j)return;const ze=j.results.filter(bt=>!bt.success),vt=Iw.unparse(ze.map(bt=>({Linha:bt.rowNumber,Erro:bt.error,Avisos:bt.warnings?.join("; ")||""}))),tt=new Blob([vt],{type:"text/csv;charset=utf-8;"}),Qe=URL.createObjectURL(tt),ot=document.createElement("a");ot.href=Qe,ot.download=`erros_importacao_${new Date().toISOString().split("T")[0]}.csv`,ot.click(),URL.revokeObjectURL(Qe)},[j]),$e=Je(),Jt=["name","phone"].filter(ze=>!Object.values(h).includes(ze)),fa=Jt.length===0;return t.jsxs(t.Fragment,{children:[t.jsx(_r,{onOpenChange:ge,open:ne,children:t.jsxs(fr,{className:"sm:max-w-md",children:[t.jsxs(hr,{children:[t.jsx(mr,{children:"Arquivo Protegido"}),t.jsx(ts,{children:"Este arquivo XLSX est protegido por senha. Digite a senha para continuar."})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(yt,{htmlFor:J,children:"Senha"}),t.jsx(dt,{id:J,onChange:ze=>ee(ze.target.value),onKeyDown:ze=>ze.key==="Enter"&&we(),placeholder:"Digite a senha do arquivo",type:"password",value:W})]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx(oe,{onClick:()=>ge(!1),variant:"outline",children:"Cancelar"}),t.jsx(oe,{disabled:!W||p,onClick:we,children:p?"Verificando...":"Confirmar"})]})]})]})}),t.jsxs(_r,{onOpenChange:ze=>{r(ze),ze||xe()},open:e,children:[t.jsx(Qi,{asChild:!0,children:t.jsxs(oe,{className:"gap-2",variant:"outline",children:[t.jsx(N0,{className:"h-4 w-4"}),"Importar CSV"]})}),t.jsxs(fr,{className:"max-h-[90vh] max-w-4xl overflow-y-auto",children:[t.jsxs(hr,{children:[t.jsxs(mr,{className:"flex items-center gap-2",children:[t.jsx(_p,{className:"h-5 w-5 text-purple-500"}),"Importar Alunos"]}),t.jsxs(ts,{children:[a==="upload"&&"Faa upload de um arquivo CSV ou XLSX com os dados dos alunos.",a==="sheet-select"&&"Selecione a planilha para importar.",a==="header-select"&&"Confirme qual linha contm os cabealhos das colunas.",a==="mapping"&&"Mapeie as colunas do arquivo para os campos do sistema.",a==="preview"&&"Revise os dados antes de importar.",a==="importing"&&"Importando alunos...",a==="results"&&"Resultado da importao."]})]}),a==="upload"&&wB({selectedProduct:w,setSelectedProduct:T,isProcessing:p,fileInputId:q,handleDrop:Ge,handleFileSelect:X}),a==="sheet-select"&&SB({fileName:i?.name,availableSheets:R,selectedSheet:O,setSelectedSheet:A}),a==="header-select"&&_B({headerDetection:k,selectedHeaderRow:I,setSelectedHeaderRow:re,rawXLSXData:L}),a==="mapping"&&u&&EB({fileName:i?.name,parsedData:u,columnMapping:h,handleMappingChange:ht,schemaFields:K,canProceed:fa,missingFields:Jt,upsertMode:D,setUpsertMode:_}),a==="preview"&&u&&TB({parsedData:u,previewValidation:$e,columnMapping:h,schemaFields:K,transformRowData:Ye}),a==="importing"&&CB({parsedData:u??void 0,importProgress:y}),a==="results"&&j&&AB({importResults:j,downloadErrorLog:Be}),t.jsx(di,{children:t.jsx(kB,{canProceed:fa,handleHeaderSelect:Ee,handleImport:qe,handleSheetSelect:Ae,isProcessing:p,parsedDataRowCount:u?.rows.length||0,resetState:xe,selectedSheet:O,setOpen:r,setStep:n,step:a})})]})]})]})}function OB(){return t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"flex items-center gap-2 font-bold text-2xl",children:[t.jsx(Xi,{className:"h-6 w-6 text-purple-500"}),"Alunos"]}),t.jsx("p",{className:"text-muted-foreground",children:"Gerencie seus alunos e matrculas"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(OR,{}),t.jsx(DB,{}),t.jsx(Dw,{})]})]})}function RB({isFiltering:e,search:r}){const a=e?"Nenhum aluno encontrado":"Nenhum aluno cadastrado",n=()=>e?r?`Nenhum aluno encontrado para "${r}"`:"Tente ajustar os filtros para ver resultados":"Adicione novos alunos para v-los aqui";return t.jsxs("div",{className:"py-12 text-center text-muted-foreground",children:[t.jsx(Xi,{className:"mx-auto mb-4 h-16 w-16 opacity-30"}),t.jsx("h2",{className:"font-medium text-lg",children:a}),t.jsx("p",{className:"mt-2 text-sm",children:n()})]})}function MB({page:e,totalPages:r,totalStudents:a,pageSize:n,onPageChange:i}){return t.jsxs("div",{className:"flex items-center justify-between border-t pt-4",children:[t.jsxs("p",{className:"text-muted-foreground text-sm",children:["Mostrando ",(e-1)*n+1,"-",Math.min(e*n,a)," de"," ",a," alunos"]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs(oe,{disabled:e===1,onClick:()=>i(e-1),size:"sm",variant:"outline",children:[t.jsx(td,{className:"mr-1 h-4 w-4"}),"Anterior"]}),t.jsxs("span",{className:"text-muted-foreground text-sm",children:[e," / ",r]}),t.jsxs(oe,{disabled:e===r,onClick:()=>i(e+1),size:"sm",variant:"outline",children:["Prximo",t.jsx(Sn,{className:"ml-1 h-4 w-4"})]})]})]})}function FB({totalStudents:e,activeStudents:r,highRiskStudents:a}){return t.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Total de Alunos"}),t.jsx(ya,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsx(Ce,{children:t.jsx("div",{className:"font-bold text-2xl",children:e})})]}),t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Alunos Ativos"}),t.jsx(Xi,{className:"h-4 w-4 text-green-500"})]}),t.jsx(Ce,{children:t.jsx("div",{className:"font-bold text-2xl text-green-600",children:r})})]}),t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Risco de Churn"}),t.jsx(ya,{className:"h-4 w-4 text-red-500"})]}),t.jsx(Ce,{children:t.jsx("div",{className:"font-bold text-2xl text-red-600",children:a})})]})]})}function IB({students:e,onStudentClick:r}){const[a,n]=C.useState({field:"name",direction:"asc"}),i=d=>{n(h=>({field:d,direction:h.field===d&&h.direction==="asc"?"desc":"asc"}))},o=[...e].sort((d,h)=>{const{field:m,direction:p}=a;let v,y;switch(m){case"name":v=d.name.toLowerCase(),y=h.name.toLowerCase();break;case"status":v=d.status,y=h.status;break;case"churnRisk":{const N={baixo:1,medio:2,alto:3};v=N[d.churnRisk]||0,y=N[h.churnRisk]||0;break}case"createdAt":v=d.createdAt||0,y=h.createdAt||0;break;default:return 0}return v<y?p==="asc"?-1:1:v>y?p==="asc"?1:-1:0}),u=d=>a.field!==d?null:a.direction==="asc"?t.jsx($u,{className:"ml-1 h-4 w-4"}):t.jsx(Il,{className:"ml-1 h-4 w-4"});return t.jsx("div",{className:"rounded-md border",children:t.jsxs(Ya,{children:[t.jsx(Xa,{children:t.jsxs(Tt,{children:[t.jsx(He,{children:t.jsxs("button",{"aria-label":"Ordenar por nome",className:"flex items-center rounded font-medium transition-colors hover:text-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2",onClick:()=>i("name"),type:"button",children:["Aluno",u("name")]})}),t.jsx(He,{children:"Produto"}),t.jsx(He,{children:t.jsxs("button",{"aria-label":"Ordenar por status",className:"flex items-center rounded font-medium transition-colors hover:text-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2",onClick:()=>i("status"),type:"button",children:["Status",u("status")]})}),t.jsx(He,{children:t.jsxs("button",{"aria-label":"Ordenar por risco de churn",className:"flex items-center rounded font-medium transition-colors hover:text-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2",onClick:()=>i("churnRisk"),type:"button",children:["Risco",u("churnRisk")]})}),t.jsx(He,{className:"w-10"})]})}),t.jsx($a,{children:o.map(d=>t.jsxs(Tt,{"aria-label":`Ver detalhes de ${d.name}`,className:"cursor-pointer transition-colors hover:bg-muted/50",onClick:()=>r(d.id),onKeyDown:h=>{(h.key==="Enter"||h.key===" ")&&(h.preventDefault(),r(d.id))},role:"button",tabIndex:0,children:[t.jsx(Pe,{children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-linear-to-br from-purple-500 to-indigo-500",children:t.jsx(li,{className:"h-4 w-4 text-white"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-sm",children:d.name}),t.jsx("p",{className:"text-muted-foreground text-xs",children:d.profession})]})]})}),t.jsx(Pe,{children:d.mainProduct?t.jsx(Ve,{variant:"outline",children:Ol[d.mainProduct]||d.mainProduct}):t.jsx("span",{className:"text-muted-foreground text-sm",children:"-"})}),t.jsx(Pe,{children:t.jsx(Ve,{variant:Aw[d.status??"ativo"],children:Cw[d.status??"ativo"]})}),t.jsx(Pe,{children:d.churnRisk!=="baixo"?t.jsxs("div",{className:me("flex items-center gap-1",RO[d.churnRisk]),children:[t.jsx(Ll,{className:"h-3 w-3"}),t.jsx("span",{className:"font-medium text-xs capitalize",children:d.churnRisk})]}):t.jsx("span",{className:"font-medium text-green-500 text-xs",children:"Baixo"})}),t.jsx(Pe,{children:t.jsx(Sn,{className:"h-4 w-4 text-muted-foreground"})})]},d.id))})]})})}const Uf=12;function LB(e){const r=hi(),{search:a,status:n,churnRisk:i,product:o,view:u,page:d}=e.useSearch(),{isSignedIn:h}=j2();C.useEffect(()=>{new URLSearchParams(window.location.search).toString().length>0||r({to:"/students",search:{view:"grid",page:1,search:"",status:"all",churnRisk:"all",product:"all",studentId:void 0}})},[r]);const{data:m}=et.students.list.useQuery({search:a||void 0,status:n==="all"?void 0:n},{enabled:!!h}),p=m?.data??[],v=Xe.useMemo(()=>{if(!p.length)return;const I=new Map;for(const re of p){const ne="sem_produto";I.has(ne)||I.set(ne,[]),I.get(ne)?.push(re)}return Array.from(I.entries()).map(([re,ne])=>({id:re,students:ne,count:ne.length}))},[p]),y=()=>{r({to:"/students",search:{view:"grid",page:1,search:"",status:"all",churnRisk:"all",product:"all",studentId:void 0}})},N=p.length,j=p.filter(I=>I.status==="ativo").length,b=p.filter(I=>I.churnRisk==="alto").length,w=Math.ceil(N/Uf),T=p.slice((d-1)*Uf,d*Uf),D=(I,re)=>{r({to:"/students",search:{search:a,status:n,churnRisk:i,product:o,view:u,page:d,studentId:void 0,[I]:re,page:1}})},_=I=>{r({to:"/students/$studentId",params:{studentId:String(I)},search:{page:d,search:a,status:n,churnRisk:i,product:o,view:u,studentId:void 0}})},[R,z]=Xe.useState({trintae3:!0,otb:!0,black_neon:!0,comunidade:!0,auriculo:!0,na_mesa_certa:!0,sem_produto:!0}),O=I=>{z(re=>({...re,[I]:!re[I]}))},A=()=>{const I=Object.keys(R).reduce((re,ne)=>(re[ne]=!0,re),{});z(I)},k=()=>{const I=Object.keys(R).reduce((re,ne)=>(re[ne]=!1,re),{});z(I)},E=Xe.useMemo(()=>{if(!v)return{};const I={};for(const re of v)I[re.id]=re.students;return I},[v]),L=Xe.useMemo(()=>v?v.map(I=>I.id):[],[v]),H=Xe.useMemo(()=>v?v.some(I=>I.count>0):!1,[v]);return{search:a,status:n,churnRisk:i,product:o,view:u,page:d,students:p,paginatedStudents:T,groupedStudents:E,groupedStudentsData:v,productKeys:L,hasAnyStudentsInGroups:H,expandedSections:R,totalStudents:N,activeStudents:j,highRiskStudents:b,totalPages:w,PAGE_SIZE:Uf,clearFilters:y,handleFilterChange:D,navigateToStudent:_,toggleSection:O,expandAll:A,collapseAll:k,navigate:r}}const cp=jt("/_authenticated/students")({validateSearch:e=>({search:e.search||"",status:e.status||"all",churnRisk:e.churnRisk||"all",product:e.product||"all",view:(e.view||"grid")==="table"?"table":"grid",page:Math.max(1,Number(e.page)||1),studentId:e.studentId||void 0}),component:PB});function PB(){const{search:e,status:r,churnRisk:a,product:n,view:i,page:o,students:u,paginatedStudents:d,groupedStudents:h,groupedStudentsData:m,productKeys:p,hasAnyStudentsInGroups:v,expandedSections:y,totalStudents:N,activeStudents:j,highRiskStudents:b,totalPages:w,clearFilters:T,handleFilterChange:D,toggleSection:_,navigate:R,PAGE_SIZE:z}=LB(cp),O=cp.useSearch(),A=e||r!=="all"||a!=="all"||n!=="all",k=W=>{R({to:"/students",search:{...O,page:W}})},E=W=>{R({to:"/students",search:{...O,studentId:W}})},L=()=>{R({to:"/students",search:{...O,studentId:void 0}})},re=i==="grid"&&!m||i==="table"&&!u,ne=i==="grid"?v:u&&u.length>0,ge=()=>re?t.jsx("div",{className:"space-y-4",children:[1,2].map(W=>t.jsx(gR,{},W))}):!ne&&A?t.jsx(RB,{isFiltering:!0,search:e}):i==="table"?t.jsx(IB,{onStudentClick:E,students:d}):t.jsx("div",{className:"space-y-2",children:p.map(W=>{const ee=h[W]??[];return t.jsx(pR,{count:ee.length,isExpanded:!!y[W],onStudentClick:E,onToggle:()=>_(W),productId:W,searchTerm:e,students:ee},W)})});return t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsx(OB,{}),t.jsx(FB,{activeStudents:j,highRiskStudents:b,totalStudents:N}),t.jsx(CR,{churnRisk:a||"all",onChurnRiskChange:W=>D("churnRisk",W),onClear:T,onProductChange:W=>D("product",W),onSearchChange:W=>D("search",W),onStatusChange:W=>D("status",W),product:n||"all",search:e||"",status:r||"all"}),ge(),i==="table"&&u&&u.length>z&&t.jsx(MB,{onPageChange:k,page:o,pageSize:z,totalPages:w,totalStudents:N}),t.jsx(Mw,{onClose:L,studentId:O.studentId??null})]})}const BB=jt("/_authenticated/settings")({component:UB});function UB(){return t.jsx(Yc,{})}const zB=C.lazy(()=>Tr(()=>import("./leads-over-time-chart-1m4TaCR2.js"),__vite__mapDeps([9,1,6,2,3,4,5]))),VB=C.lazy(()=>Tr(()=>import("./messages-over-time-chart-0yAuZuPG.js"),__vite__mapDeps([10,1,6,2,3,4,5]))),HB=jt("/_authenticated/reports")({component:GB});function GB(){const[e,r]=C.useState("30d"),{data:a}=et.metrics.daily.useQuery({period:e}),n=a;return t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"flex items-center gap-2 font-bold text-2xl",children:[t.jsx(Al,{className:"h-6 w-6 text-primary"}),"Relatrios"]}),t.jsx("p",{className:"text-muted-foreground",children:"Mtricas e anlises do seu negcio"})]}),t.jsxs(Rt,{onValueChange:i=>r(i),value:e,children:[t.jsx(At,{className:"w-[180px]",children:t.jsx(Mt,{placeholder:"Perodo"})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"7d",children:"ltimos 7 dias"}),t.jsx(ye,{value:"30d",children:"ltimos 30 dias"}),t.jsx(ye,{value:"90d",children:"ltimos 90 dias"}),t.jsx(ye,{value:"year",children:"Este ano"})]})]})]}),t.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[t.jsx(Br,{to:"/reports/sales",children:t.jsxs(Te,{className:"cursor-pointer transition-all hover:border-primary/20 hover:shadow-md",children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between pb-2",children:[t.jsx(Le,{className:"font-medium text-base",children:"Relatrio de Vendas"}),t.jsx($i,{className:"h-5 w-5 text-green-500"})]}),t.jsx(Ce,{children:t.jsx("p",{className:"text-muted-foreground text-sm",children:"Anlise detalhada de receita, converses e performance de vendas"})})]})}),t.jsx(Br,{to:"/reports/team",children:t.jsxs(Te,{className:"cursor-pointer transition-all hover:border-primary/20 hover:shadow-md",children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between pb-2",children:[t.jsx(Le,{className:"font-medium text-base",children:"Relatrio de Equipe"}),t.jsx(ya,{className:"h-5 w-5 text-primary"})]}),t.jsx(Ce,{children:t.jsx("p",{className:"text-muted-foreground text-sm",children:"Performance individual e mtricas por membro da equipe"})})]})})]}),t.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-5",children:[t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Total de Leads"}),t.jsx(ya,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl",children:n?.totalLeads??0}),t.jsx("p",{className:"text-muted-foreground text-xs",children:"no perodo selecionado"})]})]}),t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Converses"}),t.jsx(tn,{className:"h-4 w-4 text-green-500"})]}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl text-green-600",children:n?.funnel?.fechado_ganho??0}),t.jsx("p",{className:"text-muted-foreground text-xs",children:"Leads convertidos"})]})]}),t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Mensagens"}),t.jsx(an,{className:"h-4 w-4 text-primary"})]}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl text-primary",children:n?.totalMessages??0}),t.jsx("p",{className:"text-muted-foreground text-xs",children:"Total de mensagens"})]})]}),t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Conversas"}),t.jsx(an,{className:"h-4 w-4 text-primary"})]}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl text-primary",children:Math.round((n?.conversionRate??0)*(n?.totalLeads??1)/100)}),t.jsx("p",{className:"text-muted-foreground text-xs",children:"Total de conversas"})]})]}),t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Taxa de Converso"}),t.jsx(tn,{className:"h-4 w-4 text-primary"})]}),t.jsxs(Ce,{children:[t.jsxs("div",{className:"font-bold text-2xl text-primary",children:[n?.conversionRate??0,"%"]}),t.jsx("p",{className:"text-muted-foreground text-xs",children:"Lead  Cliente"})]})]})]}),t.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[t.jsxs(Te,{children:[t.jsx(Me,{children:t.jsxs(Le,{className:"flex items-center gap-2",children:[t.jsx($i,{className:"h-5 w-5 text-green-500"}),"Receita Estimada"]})}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-3xl text-green-600",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(n?.revenue??0)}),t.jsx("p",{className:"mt-2 text-muted-foreground text-sm",children:"Baseado em converses"})]})]}),t.jsxs(Te,{children:[t.jsx(Me,{children:t.jsxs(Le,{className:"flex items-center gap-2",children:[t.jsx(Al,{className:"h-5 w-5 text-primary"}),"Leads por Estgio"]})}),t.jsx(Ce,{children:t.jsx("div",{className:"space-y-3",children:n?.funnel&&Object.entries(n.funnel).map(([i,o])=>{const u=n.totalLeads||1,d=Math.round(o/u*100);return t.jsx("div",{className:"flex items-center gap-3",children:t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"mb-1 flex items-center justify-between",children:[t.jsx("span",{className:"font-medium text-sm capitalize",children:i.replace(/_/g," ")}),t.jsxs("span",{className:"text-muted-foreground text-xs",children:[o," (",d,"%)"]})]}),t.jsx("div",{className:"h-2 overflow-hidden rounded-full bg-muted",children:t.jsx("div",{className:"h-full rounded-lg bg-linear-to-r from-primary to-primary/70",style:{width:`${d}%`}})})]})},i)})})})]})]}),n?.dailyMetrics&&n.dailyMetrics.length>0&&t.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[t.jsx(C.Suspense,{fallback:t.jsx(gt,{className:"h-[380px] w-full rounded-lg"}),children:t.jsx(zB,{data:n.dailyMetrics})}),t.jsx(C.Suspense,{fallback:t.jsx(gt,{className:"h-[380px] w-full rounded-lg"}),children:t.jsx(VB,{data:n.dailyMetrics})})]}),t.jsxs(Te,{children:[t.jsx(Me,{children:t.jsx(Le,{children:"Interesse por Produto"})}),t.jsx(Ce,{children:n?.leadsByProduct&&Object.keys(n.leadsByProduct).length>0?t.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:Object.entries(n.leadsByProduct).map(([i,o])=>t.jsxs("div",{className:"rounded-lg border p-4",children:[t.jsx("p",{className:"font-medium text-sm capitalize",children:i.replace(/_/g," ")}),t.jsx("p",{className:"font-bold text-2xl text-primary",children:o}),t.jsx("p",{className:"text-muted-foreground text-xs",children:"leads interessados"})]},i))}):t.jsxs("div",{className:"py-8 text-center text-muted-foreground",children:[t.jsx(Al,{className:"mx-auto mb-4 h-12 w-12 opacity-30"}),t.jsx("p",{children:"Nenhum dado de produto disponvel"})]})})]})]})}const qB=jt("/_authenticated/marketing")({component:WB});function WB(){const{pathname:e}=v2(),r=[{label:"Dashboard",href:"/marketing/dashboard",icon:T2,active:e.includes("/marketing/dashboard")},{label:"Campanhas",href:"/marketing/campanhas",icon:rr,active:e.includes("/marketing/campanhas")||e.includes("/marketing/nova")||e.includes("/marketing/")&&!e.includes("contatos")&&!e.includes("templates")&&!e.includes("dashboard")},{label:"Contatos",href:"/marketing/contatos",icon:ya,active:e.includes("/marketing/contatos")},{label:"Templates",href:"/marketing/templates",icon:J2,active:e.includes("/marketing/templates")}];return t.jsxs("div",{className:"flex h-full flex-col bg-background",children:[t.jsx("div",{className:"border-b",children:t.jsx("div",{className:"flex h-12 items-center gap-6 overflow-x-auto px-4",children:r.map(a=>t.jsxs(Br,{className:me("flex items-center gap-2 whitespace-nowrap border-transparent border-b-2 py-3 font-medium text-sm transition-colors hover:text-primary",a.active?"border-primary text-primary":"text-muted-foreground"),to:a.href,children:[t.jsx(a.icon,{className:"h-4 w-4"}),a.label]},a.href))})}),t.jsx("div",{className:"flex-1 overflow-auto",children:t.jsx(Yc,{})})]})}function T_(){const[e,r]=C.useState("all");return t.jsxs("div",{className:"flex h-64 flex-col items-center justify-center text-muted-foreground",children:[t.jsx("p",{children:"Mdulo financeiro em implementao"}),t.jsx("p",{className:"text-xs",children:"As cobranas aparecero aqui quando o backend estiver conectado."})]})}const zf=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e);function C_(){const e=new Date,[r,a]=C.useState(e.getMonth()),[n,i]=C.useState(e.getFullYear()),{data:o}=et.financial.metrics.useQuery({month:r,year:n});if(o===void 0)return t.jsx("div",{className:"grid gap-4 md:grid-cols-4",children:[1,2,3,4].map(d=>t.jsxs(Te,{children:[t.jsx(Me,{children:t.jsx(gt,{className:"h-4 w-24"})}),t.jsx(Ce,{children:t.jsx(gt,{className:"h-8 w-32"})})]},d))});const u=[{title:"Pendente",value:zf(o?.pendingThisMonth),count:o?.pendingCount,icon:rn,color:"text-yellow-500"},{title:"Recebido",value:zf(o?.paidThisMonth),count:o?.paidCount,icon:ci,color:"text-green-500"},{title:"Vencido",value:zf(o?.overdueTotal),count:o?.overdueCount,icon:Ll,color:"text-red-500"},{title:"Projeo (3 meses)",value:zf(o?.futureProjection.reduce((d,h)=>d+h.amount,0)),count:o?.futureProjection.reduce((d,h)=>d+h.count,0),icon:tn,color:"text-blue-500"}];return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h2",{className:"font-semibold text-lg",children:"Resumo Mensal"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(Rt,{onValueChange:d=>a(Number(d)),value:String(r),children:[t.jsx(At,{className:"w-[140px]",children:t.jsx(Mt,{})}),t.jsx(kt,{children:Array.from({length:12},(d,h)=>t.jsx(ye,{value:String(h),children:new Date(2024,h).toLocaleDateString("pt-BR",{month:"long"})},h))})]}),t.jsxs(Rt,{onValueChange:d=>i(Number(d)),value:String(n),children:[t.jsx(At,{className:"w-[100px]",children:t.jsx(Mt,{})}),t.jsx(kt,{children:[2024,2025,2026].map(d=>t.jsx(ye,{value:String(d),children:d},d))})]})]})]}),t.jsx("div",{className:"grid gap-4 md:grid-cols-4",children:u.map(d=>t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:d.title}),t.jsx(d.icon,{className:`h-4 w-4 ${d.color}`})]}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl",children:d.value}),t.jsxs("p",{className:"text-muted-foreground text-xs",children:[d.count," cobranas"]})]})]},d.title))})]})}function YB(e,r,a="long"){return new Intl.DateTimeFormat("en-US",{hour:"numeric",timeZone:e,timeZoneName:a}).format(r).split(/\s/g).slice(2).join(" ")}const XB={},hu={};function Cl(e,r){try{const n=(XB[e]||=new Intl.DateTimeFormat("en-US",{timeZone:e,timeZoneName:"longOffset"}).format)(r).split("GMT")[1];return n in hu?hu[n]:Jb(n,n.split(":"))}catch{if(e in hu)return hu[e];const a=e?.match($B);return a?Jb(e,a.slice(1)):NaN}}const $B=/([+-]\d\d):?(\d\d)?/;function Jb(e,r){const a=+(r[0]||0),n=+(r[1]||0),i=+(r[2]||0)/60;return hu[e]=a*60+n>0?a*60+n+i:a*60-n-i}class jn extends Date{constructor(...r){super(),r.length>1&&typeof r[r.length-1]=="string"&&(this.timeZone=r.pop()),this.internal=new Date,isNaN(Cl(this.timeZone,this))?this.setTime(NaN):r.length?typeof r[0]=="number"&&(r.length===1||r.length===2&&typeof r[1]!="number")?this.setTime(r[0]):typeof r[0]=="string"?this.setTime(+new Date(r[0])):r[0]instanceof Date?this.setTime(+r[0]):(this.setTime(+new Date(...r)),A_(this),op(this)):this.setTime(Date.now())}static tz(r,...a){return a.length?new jn(...a,r):new jn(Date.now(),r)}withTimeZone(r){return new jn(+this,r)}getTimezoneOffset(){const r=-Cl(this.timeZone,this);return r>0?Math.floor(r):Math.ceil(r)}setTime(r){return Date.prototype.setTime.apply(this,arguments),op(this),+this}[Symbol.for("constructDateFrom")](r){return new jn(+new Date(r),this.timeZone)}}const e2=/^(get|set)(?!UTC)/;Object.getOwnPropertyNames(Date.prototype).forEach(e=>{if(!e2.test(e))return;const r=e.replace(e2,"$1UTC");jn.prototype[r]&&(e.startsWith("get")?jn.prototype[e]=function(){return this.internal[r]()}:(jn.prototype[e]=function(){return Date.prototype[r].apply(this.internal,arguments),KB(this),+this},jn.prototype[r]=function(){return Date.prototype[r].apply(this,arguments),op(this),+this}))});function op(e){e.internal.setTime(+e),e.internal.setUTCSeconds(e.internal.getUTCSeconds()-Math.round(-Cl(e.timeZone,e)*60))}function KB(e){Date.prototype.setFullYear.call(e,e.internal.getUTCFullYear(),e.internal.getUTCMonth(),e.internal.getUTCDate()),Date.prototype.setHours.call(e,e.internal.getUTCHours(),e.internal.getUTCMinutes(),e.internal.getUTCSeconds(),e.internal.getUTCMilliseconds()),A_(e)}function A_(e){const r=Cl(e.timeZone,e),a=r>0?Math.floor(r):Math.ceil(r),n=new Date(+e);n.setUTCHours(n.getUTCHours()-1);const i=-new Date(+e).getTimezoneOffset(),o=-new Date(+n).getTimezoneOffset(),u=i-o,d=Date.prototype.getHours.apply(e)!==e.internal.getUTCHours();u&&d&&e.internal.setUTCMinutes(e.internal.getUTCMinutes()+u);const h=i-a;h&&Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+h);const m=new Date(+e);m.setUTCSeconds(0);const p=i>0?m.getSeconds():(m.getSeconds()-60)%60,v=Math.round(-(Cl(e.timeZone,e)*60))%60;(v||p)&&(e.internal.setUTCSeconds(e.internal.getUTCSeconds()+v),Date.prototype.setUTCSeconds.call(e,Date.prototype.getUTCSeconds.call(e)+v+p));const y=Cl(e.timeZone,e),N=y>0?Math.floor(y):Math.ceil(y),b=-new Date(+e).getTimezoneOffset()-N,w=N!==a,T=b-h;if(w&&T){Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+T);const D=Cl(e.timeZone,e),_=D>0?Math.floor(D):Math.ceil(D),R=N-_;R&&(e.internal.setUTCMinutes(e.internal.getUTCMinutes()+R),Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+R))}}class yr extends jn{static tz(r,...a){return a.length?new yr(...a,r):new yr(Date.now(),r)}toISOString(){const[r,a,n]=this.tzComponents(),i=`${r}${a}:${n}`;return this.internal.toISOString().slice(0,-1)+i}toString(){return`${this.toDateString()} ${this.toTimeString()}`}toDateString(){const[r,a,n,i]=this.internal.toUTCString().split(" ");return`${r?.slice(0,-1)} ${n} ${a} ${i}`}toTimeString(){const r=this.internal.toUTCString().split(" ")[4],[a,n,i]=this.tzComponents();return`${r} GMT${a}${n}${i} (${YB(this.timeZone,this)})`}toLocaleString(r,a){return Date.prototype.toLocaleString.call(this,r,{...a,timeZone:a?.timeZone||this.timeZone})}toLocaleDateString(r,a){return Date.prototype.toLocaleDateString.call(this,r,{...a,timeZone:a?.timeZone||this.timeZone})}toLocaleTimeString(r,a){return Date.prototype.toLocaleTimeString.call(this,r,{...a,timeZone:a?.timeZone||this.timeZone})}tzComponents(){const r=this.getTimezoneOffset(),a=r>0?"-":"+",n=String(Math.floor(Math.abs(r)/60)).padStart(2,"0"),i=String(Math.abs(r)%60).padStart(2,"0");return[a,n,i]}withTimeZone(r){return new yr(+this,r)}[Symbol.for("constructDateFrom")](r){return new yr(+new Date(r),this.timeZone)}}const t2=5,QB=4;function ZB(e,r){const a=r.startOfMonth(e),n=a.getDay()>0?a.getDay():7,i=r.addDays(e,-n+1),o=r.addDays(i,t2*7-1);return r.getMonth(e)===r.getMonth(o)?t2:QB}function k_(e,r){const a=r.startOfMonth(e),n=a.getDay();return n===1?a:n===0?r.addDays(a,-6):r.addDays(a,-1*(n-1))}function JB(e,r){const a=k_(e,r),n=ZB(e,r);return r.addDays(a,n*7-1)}const D_={...Zo,labels:{labelDayButton:(e,r,a,n)=>{let i;n&&typeof n.format=="function"?i=n.format.bind(n):i=(u,d)=>Jn(u,d,{locale:Zo,...a});let o=i(e,"PPPP");return r.today&&(o=`Today, ${o}`),r.selected&&(o=`${o}, selected`),o},labelMonthDropdown:"Choose the Month",labelNext:"Go to the Next Month",labelPrevious:"Go to the Previous Month",labelWeekNumber:e=>`Week ${e}`,labelYearDropdown:"Choose the Year",labelGrid:(e,r,a)=>{let n;return a&&typeof a.format=="function"?n=a.format.bind(a):n=(i,o)=>Jn(i,o,{locale:Zo,...r}),n(e,"LLLL yyyy")},labelGridcell:(e,r,a,n)=>{let i;n&&typeof n.format=="function"?i=n.format.bind(n):i=(u,d)=>Jn(u,d,{locale:Zo,...a});let o=i(e,"PPPP");return r?.today&&(o=`Today, ${o}`),o},labelNav:"Navigation bar",labelWeekNumberHeader:"Week Number",labelWeekday:(e,r,a)=>{let n;return a&&typeof a.format=="function"?n=a.format.bind(a):n=(i,o)=>Jn(i,o,{locale:Zo,...r}),n(e,"cccc")}}};class ys{constructor(r,a){this.Date=Date,this.today=()=>this.overrides?.today?this.overrides.today():this.options.timeZone?yr.tz(this.options.timeZone):new this.Date,this.newDate=(n,i,o)=>this.overrides?.newDate?this.overrides.newDate(n,i,o):this.options.timeZone?new yr(n,i,o,this.options.timeZone):new Date(n,i,o),this.addDays=(n,i)=>this.overrides?.addDays?this.overrides.addDays(n,i):cA(n,i),this.addMonths=(n,i)=>this.overrides?.addMonths?this.overrides.addMonths(n,i):oA(n,i),this.addWeeks=(n,i)=>this.overrides?.addWeeks?this.overrides.addWeeks(n,i):uA(n,i),this.addYears=(n,i)=>this.overrides?.addYears?this.overrides.addYears(n,i):dA(n,i),this.differenceInCalendarDays=(n,i)=>this.overrides?.differenceInCalendarDays?this.overrides.differenceInCalendarDays(n,i):eN(n,i),this.differenceInCalendarMonths=(n,i)=>this.overrides?.differenceInCalendarMonths?this.overrides.differenceInCalendarMonths(n,i):tN(n,i),this.eachMonthOfInterval=n=>this.overrides?.eachMonthOfInterval?this.overrides.eachMonthOfInterval(n):fA(n),this.eachYearOfInterval=n=>{const i=this.overrides?.eachYearOfInterval?this.overrides.eachYearOfInterval(n):hA(n),o=new Set(i.map(d=>this.getYear(d)));if(o.size===i.length)return i;const u=[];return o.forEach(d=>{u.push(new Date(d,0,1))}),u},this.endOfBroadcastWeek=n=>this.overrides?.endOfBroadcastWeek?this.overrides.endOfBroadcastWeek(n):JB(n,this),this.endOfISOWeek=n=>this.overrides?.endOfISOWeek?this.overrides.endOfISOWeek(n):mA(n),this.endOfMonth=n=>this.overrides?.endOfMonth?this.overrides.endOfMonth(n):xA(n),this.endOfWeek=(n,i)=>this.overrides?.endOfWeek?this.overrides.endOfWeek(n,i):pA(n,this.options),this.endOfYear=n=>this.overrides?.endOfYear?this.overrides.endOfYear(n):gA(n),this.format=(n,i,o)=>{const u=this.overrides?.format?this.overrides.format(n,i,this.options):Jn(n,i,this.options);return this.options.numerals&&this.options.numerals!=="latn"?this.replaceDigits(u):u},this.getISOWeek=n=>this.overrides?.getISOWeek?this.overrides.getISOWeek(n):aN(n),this.getMonth=(n,i)=>this.overrides?.getMonth?this.overrides.getMonth(n,this.options):vA(n,this.options),this.getYear=(n,i)=>this.overrides?.getYear?this.overrides.getYear(n,this.options):yA(n,this.options),this.getWeek=(n,i)=>this.overrides?.getWeek?this.overrides.getWeek(n,this.options):rN(n,this.options),this.isAfter=(n,i)=>this.overrides?.isAfter?this.overrides.isAfter(n,i):jA(n,i),this.isBefore=(n,i)=>this.overrides?.isBefore?this.overrides.isBefore(n,i):bA(n,i),this.isDate=n=>this.overrides?.isDate?this.overrides.isDate(n):NA(n),this.isSameDay=(n,i)=>this.overrides?.isSameDay?this.overrides.isSameDay(n,i):wA(n,i),this.isSameMonth=(n,i)=>this.overrides?.isSameMonth?this.overrides.isSameMonth(n,i):SA(n,i),this.isSameYear=(n,i)=>this.overrides?.isSameYear?this.overrides.isSameYear(n,i):_A(n,i),this.max=n=>this.overrides?.max?this.overrides.max(n):EA(n),this.min=n=>this.overrides?.min?this.overrides.min(n):TA(n),this.setMonth=(n,i)=>this.overrides?.setMonth?this.overrides.setMonth(n,i):CA(n,i),this.setYear=(n,i)=>this.overrides?.setYear?this.overrides.setYear(n,i):AA(n,i),this.startOfBroadcastWeek=(n,i)=>this.overrides?.startOfBroadcastWeek?this.overrides.startOfBroadcastWeek(n,this):k_(n,this),this.startOfDay=n=>this.overrides?.startOfDay?this.overrides.startOfDay(n):kA(n),this.startOfISOWeek=n=>this.overrides?.startOfISOWeek?this.overrides.startOfISOWeek(n):DA(n),this.startOfMonth=n=>this.overrides?.startOfMonth?this.overrides.startOfMonth(n):Ux(n),this.startOfWeek=(n,i)=>this.overrides?.startOfWeek?this.overrides.startOfWeek(n,this.options):OA(n,this.options),this.startOfYear=n=>this.overrides?.startOfYear?this.overrides.startOfYear(n):RA(n),this.options={locale:D_,...r},this.overrides=a}getDigitMap(){const{numerals:r="latn"}=this.options,a=new Intl.NumberFormat("en-US",{numberingSystem:r}),n={};for(let i=0;i<10;i++)n[i.toString()]=a.format(i);return n}replaceDigits(r){const a=this.getDigitMap();return r.replace(/\d/g,n=>a[n]||n)}formatNumber(r){return this.replaceDigits(r.toString())}getMonthYearOrder(){const r=this.options.locale?.code;return r&&ys.yearFirstLocales.has(r)?"year-first":"month-first"}formatMonthYear(r){const{locale:a,timeZone:n,numerals:i}=this.options,o=a?.code;if(o&&ys.yearFirstLocales.has(o))try{return new Intl.DateTimeFormat(o,{month:"long",year:"numeric",timeZone:n,numberingSystem:i}).format(r)}catch{}const u=this.getMonthYearOrder()==="year-first"?"y LLLL":"LLLL y";return this.format(r,u)}}ys.yearFirstLocales=new Set(["eu","hu","ja","ja-Hira","ja-JP","ko","ko-KR","lt","lt-LT","lv","lv-LV","mn","mn-MN","zh","zh-CN","zh-HK","zh-TW"]);const kn=new ys;class O_{constructor(r,a,n=kn){this.date=r,this.displayMonth=a,this.outside=!!(a&&!n.isSameMonth(r,a)),this.dateLib=n,this.isoDate=n.format(r,"yyyy-MM-dd"),this.displayMonthId=n.format(a,"yyyy-MM"),this.dateMonthId=n.format(r,"yyyy-MM")}isEqualTo(r){return this.dateLib.isSameDay(r.date,this.date)&&this.dateLib.isSameMonth(r.displayMonth,this.displayMonth)}}class e7{constructor(r,a){this.date=r,this.weeks=a}}class t7{constructor(r,a){this.days=a,this.weekNumber=r}}function a7(e){return Xe.createElement("button",{...e})}function r7(e){return Xe.createElement("span",{...e})}function s7(e){const{size:r=24,orientation:a="left",className:n}=e;return Xe.createElement("svg",{className:n,width:r,height:r,viewBox:"0 0 24 24"},a==="up"&&Xe.createElement("polygon",{points:"6.77 17 12.5 11.43 18.24 17 20 15.28 12.5 8 5 15.28"}),a==="down"&&Xe.createElement("polygon",{points:"6.77 8 12.5 13.57 18.24 8 20 9.72 12.5 17 5 9.72"}),a==="left"&&Xe.createElement("polygon",{points:"16 18.112 9.81111111 12 16 5.87733333 14.0888889 4 6 12 14.0888889 20"}),a==="right"&&Xe.createElement("polygon",{points:"8 18.112 14.18888889 12 8 5.87733333 9.91111111 4 18 12 9.91111111 20"}))}function n7(e){const{day:r,modifiers:a,...n}=e;return Xe.createElement("td",{...n})}function i7(e){const{day:r,modifiers:a,...n}=e,i=Xe.useRef(null);return Xe.useEffect(()=>{a.focused&&i.current?.focus()},[a.focused]),Xe.createElement("button",{ref:i,...n})}var ft;(function(e){e.Root="root",e.Chevron="chevron",e.Day="day",e.DayButton="day_button",e.CaptionLabel="caption_label",e.Dropdowns="dropdowns",e.Dropdown="dropdown",e.DropdownRoot="dropdown_root",e.Footer="footer",e.MonthGrid="month_grid",e.MonthCaption="month_caption",e.MonthsDropdown="months_dropdown",e.Month="month",e.Months="months",e.Nav="nav",e.NextMonthButton="button_next",e.PreviousMonthButton="button_previous",e.Week="week",e.Weeks="weeks",e.Weekday="weekday",e.Weekdays="weekdays",e.WeekNumber="week_number",e.WeekNumberHeader="week_number_header",e.YearsDropdown="years_dropdown"})(ft||(ft={}));var Aa;(function(e){e.disabled="disabled",e.hidden="hidden",e.outside="outside",e.focused="focused",e.today="today"})(Aa||(Aa={}));var Js;(function(e){e.range_end="range_end",e.range_middle="range_middle",e.range_start="range_start",e.selected="selected"})(Js||(Js={}));var fs;(function(e){e.weeks_before_enter="weeks_before_enter",e.weeks_before_exit="weeks_before_exit",e.weeks_after_enter="weeks_after_enter",e.weeks_after_exit="weeks_after_exit",e.caption_after_enter="caption_after_enter",e.caption_after_exit="caption_after_exit",e.caption_before_enter="caption_before_enter",e.caption_before_exit="caption_before_exit"})(fs||(fs={}));function l7(e){const{options:r,className:a,components:n,classNames:i,...o}=e,u=[i[ft.Dropdown],a].join(" "),d=r?.find(({value:h})=>h===o.value);return Xe.createElement("span",{"data-disabled":o.disabled,className:i[ft.DropdownRoot]},Xe.createElement(n.Select,{className:u,...o},r?.map(({value:h,label:m,disabled:p})=>Xe.createElement(n.Option,{key:h,value:h,disabled:p},m))),Xe.createElement("span",{className:i[ft.CaptionLabel],"aria-hidden":!0},d?.label,Xe.createElement(n.Chevron,{orientation:"down",size:18,className:i[ft.Chevron]})))}function c7(e){return Xe.createElement("div",{...e})}function o7(e){return Xe.createElement("div",{...e})}function u7(e){const{calendarMonth:r,displayIndex:a,...n}=e;return Xe.createElement("div",{...n},e.children)}function d7(e){const{calendarMonth:r,displayIndex:a,...n}=e;return Xe.createElement("div",{...n})}function f7(e){return Xe.createElement("table",{...e})}function h7(e){return Xe.createElement("div",{...e})}const R_=C.createContext(void 0);function fd(){const e=C.useContext(R_);if(e===void 0)throw new Error("useDayPicker() must be used within a custom component.");return e}function m7(e){const{components:r}=fd();return Xe.createElement(r.Dropdown,{...e})}function x7(e){const{onPreviousClick:r,onNextClick:a,previousMonth:n,nextMonth:i,...o}=e,{components:u,classNames:d,labels:{labelPrevious:h,labelNext:m}}=fd(),p=C.useCallback(y=>{i&&a?.(y)},[i,a]),v=C.useCallback(y=>{n&&r?.(y)},[n,r]);return Xe.createElement("nav",{...o},Xe.createElement(u.PreviousMonthButton,{type:"button",className:d[ft.PreviousMonthButton],tabIndex:n?void 0:-1,"aria-disabled":n?void 0:!0,"aria-label":h(n),onClick:v},Xe.createElement(u.Chevron,{disabled:n?void 0:!0,className:d[ft.Chevron],orientation:"left"})),Xe.createElement(u.NextMonthButton,{type:"button",className:d[ft.NextMonthButton],tabIndex:i?void 0:-1,"aria-disabled":i?void 0:!0,"aria-label":m(i),onClick:p},Xe.createElement(u.Chevron,{disabled:i?void 0:!0,orientation:"right",className:d[ft.Chevron]})))}function p7(e){const{components:r}=fd();return Xe.createElement(r.Button,{...e})}function g7(e){return Xe.createElement("option",{...e})}function v7(e){const{components:r}=fd();return Xe.createElement(r.Button,{...e})}function y7(e){const{rootRef:r,...a}=e;return Xe.createElement("div",{...a,ref:r})}function j7(e){return Xe.createElement("select",{...e})}function b7(e){const{week:r,...a}=e;return Xe.createElement("tr",{...a})}function N7(e){return Xe.createElement("th",{...e})}function w7(e){return Xe.createElement("thead",{"aria-hidden":!0},Xe.createElement("tr",{...e}))}function S7(e){const{week:r,...a}=e;return Xe.createElement("th",{...a})}function _7(e){return Xe.createElement("th",{...e})}function E7(e){return Xe.createElement("tbody",{...e})}function T7(e){const{components:r}=fd();return Xe.createElement(r.Dropdown,{...e})}const C7=Object.freeze(Object.defineProperty({__proto__:null,Button:a7,CaptionLabel:r7,Chevron:s7,Day:n7,DayButton:i7,Dropdown:l7,DropdownNav:c7,Footer:o7,Month:u7,MonthCaption:d7,MonthGrid:f7,Months:h7,MonthsDropdown:m7,Nav:x7,NextMonthButton:p7,Option:g7,PreviousMonthButton:v7,Root:y7,Select:j7,Week:b7,WeekNumber:S7,WeekNumberHeader:_7,Weekday:N7,Weekdays:w7,Weeks:E7,YearsDropdown:T7},Symbol.toStringTag,{value:"Module"}));function ri(e,r,a=!1,n=kn){let{from:i,to:o}=e;const{differenceInCalendarDays:u,isSameDay:d}=n;return i&&o?(u(o,i)<0&&([i,o]=[o,i]),u(r,i)>=(a?1:0)&&u(o,r)>=(a?1:0)):!a&&o?d(o,r):!a&&i?d(i,r):!1}function yg(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function V0(e){return!!(e&&typeof e=="object"&&"from"in e)}function jg(e){return!!(e&&typeof e=="object"&&"after"in e)}function bg(e){return!!(e&&typeof e=="object"&&"before"in e)}function M_(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function F_(e,r){return Array.isArray(e)&&e.every(r.isDate)}function si(e,r,a=kn){const n=Array.isArray(r)?r:[r],{isSameDay:i,differenceInCalendarDays:o,isAfter:u}=a;return n.some(d=>{if(typeof d=="boolean")return d;if(a.isDate(d))return i(e,d);if(F_(d,a))return d.some(h=>i(e,h));if(V0(d))return ri(d,e,!1,a);if(M_(d))return Array.isArray(d.dayOfWeek)?d.dayOfWeek.includes(e.getDay()):d.dayOfWeek===e.getDay();if(yg(d)){const h=o(d.before,e),m=o(d.after,e),p=h>0,v=m<0;return u(d.before,d.after)?v&&p:p||v}return jg(d)?o(e,d.after)>0:bg(d)?o(d.before,e)>0:typeof d=="function"?d(e):!1})}function A7(e,r,a,n,i){const{disabled:o,hidden:u,modifiers:d,showOutsideDays:h,broadcastCalendar:m,today:p=i.today()}=r,{isSameDay:v,isSameMonth:y,startOfMonth:N,isBefore:j,endOfMonth:b,isAfter:w}=i,T=a&&N(a),D=n&&b(n),_={[Aa.focused]:[],[Aa.outside]:[],[Aa.disabled]:[],[Aa.hidden]:[],[Aa.today]:[]},R={};for(const z of e){const{date:O,displayMonth:A}=z,k=!!(A&&!y(O,A)),E=!!(T&&j(O,T)),L=!!(D&&w(O,D)),H=!!(o&&si(O,o,i)),I=!!(u&&si(O,u,i))||E||L||!m&&!h&&k||m&&h===!1&&k,re=v(O,p);k&&_.outside.push(z),H&&_.disabled.push(z),I&&_.hidden.push(z),re&&_.today.push(z),d&&Object.keys(d).forEach(ne=>{const ge=d?.[ne];ge&&si(O,ge,i)&&(R[ne]?R[ne].push(z):R[ne]=[z])})}return z=>{const O={[Aa.focused]:!1,[Aa.disabled]:!1,[Aa.hidden]:!1,[Aa.outside]:!1,[Aa.today]:!1},A={};for(const k in _){const E=_[k];O[k]=E.some(L=>L===z)}for(const k in R)A[k]=R[k].some(E=>E===z);return{...O,...A}}}function k7(e,r,a={}){return Object.entries(e).filter(([,i])=>i===!0).reduce((i,[o])=>(a[o]?i.push(a[o]):r[Aa[o]]?i.push(r[Aa[o]]):r[Js[o]]&&i.push(r[Js[o]]),i),[r[ft.Day]])}function D7(e){return{...C7,...e}}function O7(e){const r={"data-mode":e.mode??void 0,"data-required":"required"in e?e.required:void 0,"data-multiple-months":e.numberOfMonths&&e.numberOfMonths>1||void 0,"data-week-numbers":e.showWeekNumber||void 0,"data-broadcast-calendar":e.broadcastCalendar||void 0,"data-nav-layout":e.navLayout||void 0};return Object.entries(e).forEach(([a,n])=>{a.startsWith("data-")&&(r[a]=n)}),r}function Ng(){const e={};for(const r in ft)e[ft[r]]=`rdp-${ft[r]}`;for(const r in Aa)e[Aa[r]]=`rdp-${Aa[r]}`;for(const r in Js)e[Js[r]]=`rdp-${Js[r]}`;for(const r in fs)e[fs[r]]=`rdp-${fs[r]}`;return e}function I_(e,r,a){return(a??new ys(r)).formatMonthYear(e)}const R7=I_;function M7(e,r,a){return(a??new ys(r)).format(e,"d")}function F7(e,r=kn){return r.format(e,"LLLL")}function I7(e,r,a){return(a??new ys(r)).format(e,"cccccc")}function L7(e,r=kn){return e<10?r.formatNumber(`0${e.toLocaleString()}`):r.formatNumber(`${e.toLocaleString()}`)}function P7(){return""}function L_(e,r=kn){return r.format(e,"yyyy")}const B7=L_,U7=Object.freeze(Object.defineProperty({__proto__:null,formatCaption:I_,formatDay:M7,formatMonthCaption:R7,formatMonthDropdown:F7,formatWeekNumber:L7,formatWeekNumberHeader:P7,formatWeekdayName:I7,formatYearCaption:B7,formatYearDropdown:L_},Symbol.toStringTag,{value:"Module"}));function z7(e){return e?.formatMonthCaption&&!e.formatCaption&&(e.formatCaption=e.formatMonthCaption),e?.formatYearCaption&&!e.formatYearDropdown&&(e.formatYearDropdown=e.formatYearCaption),{...U7,...e}}function wg(e,r,a,n){let i=(n??new ys(a)).format(e,"PPPP");return r.today&&(i=`Today, ${i}`),r.selected&&(i=`${i}, selected`),i}const V7=wg;function Sg(e,r,a){return(a??new ys(r)).formatMonthYear(e)}const H7=Sg;function P_(e,r,a,n){let i=(n??new ys(a)).format(e,"PPPP");return r?.today&&(i=`Today, ${i}`),i}function B_(e){return"Choose the Month"}function U_(){return""}const G7="Go to the Next Month";function z_(e,r){return G7}function V_(e){return"Go to the Previous Month"}function H_(e,r,a){return(a??new ys(r)).format(e,"cccc")}function G_(e,r){return`Week ${e}`}function q_(e){return"Week Number"}function W_(e){return"Choose the Year"}const q7=Object.freeze(Object.defineProperty({__proto__:null,labelCaption:H7,labelDay:V7,labelDayButton:wg,labelGrid:Sg,labelGridcell:P_,labelMonthDropdown:B_,labelNav:U_,labelNext:z_,labelPrevious:V_,labelWeekNumber:G_,labelWeekNumberHeader:q_,labelWeekday:H_,labelYearDropdown:W_},Symbol.toStringTag,{value:"Module"})),Ys=(e,r,a)=>r||(a?typeof a=="function"?a:(...n)=>a:e);function W7(e,r){const a=r.locale?.labels??{};return{...q7,...e??{},labelDayButton:Ys(wg,e?.labelDayButton,a.labelDayButton),labelMonthDropdown:Ys(B_,e?.labelMonthDropdown,a.labelMonthDropdown),labelNext:Ys(z_,e?.labelNext,a.labelNext),labelPrevious:Ys(V_,e?.labelPrevious,a.labelPrevious),labelWeekNumber:Ys(G_,e?.labelWeekNumber,a.labelWeekNumber),labelYearDropdown:Ys(W_,e?.labelYearDropdown,a.labelYearDropdown),labelGrid:Ys(Sg,e?.labelGrid,a.labelGrid),labelGridcell:Ys(P_,e?.labelGridcell,a.labelGridcell),labelNav:Ys(U_,e?.labelNav,a.labelNav),labelWeekNumberHeader:Ys(q_,e?.labelWeekNumberHeader,a.labelWeekNumberHeader),labelWeekday:Ys(H_,e?.labelWeekday,a.labelWeekday)}}function Y7(e,r,a,n,i){const{startOfMonth:o,startOfYear:u,endOfYear:d,eachMonthOfInterval:h,getMonth:m}=i;return h({start:u(e),end:d(e)}).map(y=>{const N=n.formatMonthDropdown(y,i),j=m(y),b=r&&y<o(r)||a&&y>o(a)||!1;return{value:j,label:N,disabled:b}})}function X7(e,r={},a={}){let n={...r?.[ft.Day]};return Object.entries(e).filter(([,i])=>i===!0).forEach(([i])=>{n={...n,...a?.[i]}}),n}function $7(e,r,a,n){const i=n??e.today(),o=a?e.startOfBroadcastWeek(i,e):r?e.startOfISOWeek(i):e.startOfWeek(i),u=[];for(let d=0;d<7;d++){const h=e.addDays(o,d);u.push(h)}return u}function K7(e,r,a,n,i=!1){if(!e||!r)return;const{startOfYear:o,endOfYear:u,eachYearOfInterval:d,getYear:h}=n,m=o(e),p=u(r),v=d({start:m,end:p});return i&&v.reverse(),v.map(y=>{const N=a.formatYearDropdown(y,n);return{value:h(y),label:N,disabled:!1}})}function Q7(e,r={}){const{weekStartsOn:a,locale:n}=r,i=a??n?.options?.weekStartsOn??0,o=d=>{const h=typeof d=="number"||typeof d=="string"?new Date(d):d;return new yr(h.getFullYear(),h.getMonth(),h.getDate(),12,0,0,e)},u=d=>{const h=o(d);return new Date(h.getFullYear(),h.getMonth(),h.getDate(),0,0,0,0)};return{today:()=>o(yr.tz(e)),newDate:(d,h,m)=>new yr(d,h,m,12,0,0,e),startOfDay:d=>o(d),startOfWeek:(d,h)=>{const m=o(d),p=h?.weekStartsOn??i,v=(m.getDay()-p+7)%7;return m.setDate(m.getDate()-v),m},startOfISOWeek:d=>{const h=o(d),m=(h.getDay()-1+7)%7;return h.setDate(h.getDate()-m),h},startOfMonth:d=>{const h=o(d);return h.setDate(1),h},startOfYear:d=>{const h=o(d);return h.setMonth(0,1),h},endOfWeek:(d,h)=>{const m=o(d),y=(((h?.weekStartsOn??i)+6)%7-m.getDay()+7)%7;return m.setDate(m.getDate()+y),m},endOfISOWeek:d=>{const h=o(d),m=(7-h.getDay())%7;return h.setDate(h.getDate()+m),h},endOfMonth:d=>{const h=o(d);return h.setMonth(h.getMonth()+1,0),h},endOfYear:d=>{const h=o(d);return h.setMonth(11,31),h},eachMonthOfInterval:d=>{const h=o(d.start),m=o(d.end),p=[],v=new yr(h.getFullYear(),h.getMonth(),1,12,0,0,e),y=m.getFullYear()*12+m.getMonth();for(;v.getFullYear()*12+v.getMonth()<=y;)p.push(new yr(v,e)),v.setMonth(v.getMonth()+1,1);return p},addDays:(d,h)=>{const m=o(d);return m.setDate(m.getDate()+h),m},addWeeks:(d,h)=>{const m=o(d);return m.setDate(m.getDate()+h*7),m},addMonths:(d,h)=>{const m=o(d);return m.setMonth(m.getMonth()+h),m},addYears:(d,h)=>{const m=o(d);return m.setFullYear(m.getFullYear()+h),m},eachYearOfInterval:d=>{const h=o(d.start),m=o(d.end),p=[],v=new yr(h.getFullYear(),0,1,12,0,0,e);for(;v.getFullYear()<=m.getFullYear();)p.push(new yr(v,e)),v.setFullYear(v.getFullYear()+1,0,1);return p},getWeek:(d,h)=>{const m=u(d);return rN(m,{weekStartsOn:h?.weekStartsOn??i,firstWeekContainsDate:h?.firstWeekContainsDate??n?.options?.firstWeekContainsDate??1})},getISOWeek:d=>{const h=u(d);return aN(h)},differenceInCalendarDays:(d,h)=>{const m=u(d),p=u(h);return eN(m,p)},differenceInCalendarMonths:(d,h)=>{const m=u(d),p=u(h);return tN(m,p)}}}const hd=e=>e instanceof HTMLElement?e:null,_x=e=>[...e.querySelectorAll("[data-animated-month]")??[]],Z7=e=>hd(e.querySelector("[data-animated-month]")),Ex=e=>hd(e.querySelector("[data-animated-caption]")),Tx=e=>hd(e.querySelector("[data-animated-weeks]")),J7=e=>hd(e.querySelector("[data-animated-nav]")),eU=e=>hd(e.querySelector("[data-animated-weekdays]"));function tU(e,r,{classNames:a,months:n,focused:i,dateLib:o}){const u=C.useRef(null),d=C.useRef(n),h=C.useRef(!1);C.useLayoutEffect(()=>{const m=d.current;if(d.current=n,!r||!e.current||!(e.current instanceof HTMLElement)||n.length===0||m.length===0||n.length!==m.length)return;const p=o.isSameMonth(n[0].date,m[0].date),v=o.isAfter(n[0].date,m[0].date),y=v?a[fs.caption_after_enter]:a[fs.caption_before_enter],N=v?a[fs.weeks_after_enter]:a[fs.weeks_before_enter],j=u.current,b=e.current.cloneNode(!0);if(b instanceof HTMLElement?(_x(b).forEach(_=>{if(!(_ instanceof HTMLElement))return;const R=Z7(_);R&&_.contains(R)&&_.removeChild(R);const z=Ex(_);z&&z.classList.remove(y);const O=Tx(_);O&&O.classList.remove(N)}),u.current=b):u.current=null,h.current||p||i)return;const w=j instanceof HTMLElement?_x(j):[],T=_x(e.current);if(T?.every(D=>D instanceof HTMLElement)&&w&&w.every(D=>D instanceof HTMLElement)){h.current=!0,e.current.style.isolation="isolate";const D=J7(e.current);D&&(D.style.zIndex="1"),T.forEach((_,R)=>{const z=w[R];if(!z)return;_.style.position="relative",_.style.overflow="hidden";const O=Ex(_);O&&O.classList.add(y);const A=Tx(_);A&&A.classList.add(N);const k=()=>{h.current=!1,e.current&&(e.current.style.isolation=""),D&&(D.style.zIndex=""),O&&O.classList.remove(y),A&&A.classList.remove(N),_.style.position="",_.style.overflow="",_.contains(z)&&_.removeChild(z)};z.style.pointerEvents="none",z.style.position="absolute",z.style.overflow="hidden",z.setAttribute("aria-hidden","true");const E=eU(z);E&&(E.style.opacity="0");const L=Ex(z);L&&(L.classList.add(v?a[fs.caption_before_exit]:a[fs.caption_after_exit]),L.addEventListener("animationend",k));const H=Tx(z);H&&H.classList.add(v?a[fs.weeks_before_exit]:a[fs.weeks_after_exit]),_.insertBefore(z,_.firstChild)})}})}function aU(e,r,a,n){const i=e[0],o=e[e.length-1],{ISOWeek:u,fixedWeeks:d,broadcastCalendar:h}=a??{},{addDays:m,differenceInCalendarDays:p,differenceInCalendarMonths:v,endOfBroadcastWeek:y,endOfISOWeek:N,endOfMonth:j,endOfWeek:b,isAfter:w,startOfBroadcastWeek:T,startOfISOWeek:D,startOfWeek:_}=n,R=h?T(i,n):u?D(i):_(i),z=h?y(o):u?N(j(o)):b(j(o)),O=r&&(h?y(r):u?N(r):b(r)),A=O&&w(z,O)?O:z,k=p(A,R),E=v(o,i)+1,L=[];for(let re=0;re<=k;re++){const ne=m(R,re);L.push(ne)}const I=(h?35:42)*E;if(d&&L.length<I){const re=I-L.length;for(let ne=0;ne<re;ne++){const ge=m(L[L.length-1],1);L.push(ge)}}return L}function rU(e){const r=[];return e.reduce((a,n)=>{const i=n.weeks.reduce((o,u)=>o.concat(u.days.slice()),r.slice());return a.concat(i.slice())},r.slice())}function sU(e,r,a,n){const{numberOfMonths:i=1}=a,o=[];for(let u=0;u<i;u++){const d=n.addMonths(e,u);if(r&&d>r)break;o.push(d)}return o}function a2(e,r,a,n){const{month:i,defaultMonth:o,today:u=n.today(),numberOfMonths:d=1}=e;let h=i||o||u;const{differenceInCalendarMonths:m,addMonths:p,startOfMonth:v}=n;if(a&&m(a,h)<d-1){const y=-1*(d-1);h=p(a,y)}return r&&m(h,r)<0&&(h=r),v(h)}function nU(e,r,a,n){const{addDays:i,endOfBroadcastWeek:o,endOfISOWeek:u,endOfMonth:d,endOfWeek:h,getISOWeek:m,getWeek:p,startOfBroadcastWeek:v,startOfISOWeek:y,startOfWeek:N}=n,j=e.reduce((b,w)=>{const T=a.broadcastCalendar?v(w,n):a.ISOWeek?y(w):N(w),D=a.broadcastCalendar?o(w):a.ISOWeek?u(d(w)):h(d(w)),_=r.filter(A=>A>=T&&A<=D),R=a.broadcastCalendar?35:42;if(a.fixedWeeks&&_.length<R){const A=r.filter(k=>{const E=R-_.length;return k>D&&k<=i(D,E)});_.push(...A)}const z=_.reduce((A,k)=>{const E=a.ISOWeek?m(k):p(k),L=A.find(I=>I.weekNumber===E),H=new O_(k,w,n);return L?L.days.push(H):A.push(new t7(E,[H])),A},[]),O=new e7(w,z);return b.push(O),b},[]);return a.reverseMonths?j.reverse():j}function iU(e,r){let{startMonth:a,endMonth:n}=e;const{startOfYear:i,startOfDay:o,startOfMonth:u,endOfMonth:d,addYears:h,endOfYear:m,newDate:p,today:v}=r,{fromYear:y,toYear:N,fromMonth:j,toMonth:b}=e;!a&&j&&(a=j),!a&&y&&(a=r.newDate(y,0,1)),!n&&b&&(n=b),!n&&N&&(n=p(N,11,31));const w=e.captionLayout==="dropdown"||e.captionLayout==="dropdown-years";return a?a=u(a):y?a=p(y,0,1):!a&&w&&(a=i(h(e.today??v(),-100))),n?n=d(n):N?n=p(N,11,31):!n&&w&&(n=m(e.today??v())),[a&&o(a),n&&o(n)]}function lU(e,r,a,n){if(a.disableNavigation)return;const{pagedNavigation:i,numberOfMonths:o=1}=a,{startOfMonth:u,addMonths:d,differenceInCalendarMonths:h}=n,m=i?o:1,p=u(e);if(!r)return d(p,m);if(!(h(r,e)<o))return d(p,m)}function cU(e,r,a,n){if(a.disableNavigation)return;const{pagedNavigation:i,numberOfMonths:o}=a,{startOfMonth:u,addMonths:d,differenceInCalendarMonths:h}=n,m=i?o??1:1,p=u(e);if(!r)return d(p,-m);if(!(h(p,r)<=0))return d(p,-m)}function oU(e){const r=[];return e.reduce((a,n)=>a.concat(n.weeks.slice()),r.slice())}function H0(e,r){const[a,n]=C.useState(e);return[r===void 0?a:r,n]}function uU(e,r){const[a,n]=iU(e,r),{startOfMonth:i,endOfMonth:o}=r,u=a2(e,a,n,r),[d,h]=H0(u,e.month?u:void 0);C.useEffect(()=>{const R=a2(e,a,n,r);h(R)},[e.timeZone]);const{months:m,weeks:p,days:v,previousMonth:y,nextMonth:N}=C.useMemo(()=>{const R=sU(d,n,{numberOfMonths:e.numberOfMonths},r),z=aU(R,e.endMonth?o(e.endMonth):void 0,{ISOWeek:e.ISOWeek,fixedWeeks:e.fixedWeeks,broadcastCalendar:e.broadcastCalendar},r),O=nU(R,z,{broadcastCalendar:e.broadcastCalendar,fixedWeeks:e.fixedWeeks,ISOWeek:e.ISOWeek,reverseMonths:e.reverseMonths},r),A=oU(O),k=rU(O),E=cU(d,a,e,r),L=lU(d,n,e,r);return{months:O,weeks:A,days:k,previousMonth:E,nextMonth:L}},[r,d.getTime(),n?.getTime(),a?.getTime(),e.disableNavigation,e.broadcastCalendar,e.endMonth?.getTime(),e.fixedWeeks,e.ISOWeek,e.numberOfMonths,e.pagedNavigation,e.reverseMonths]),{disableNavigation:j,onMonthChange:b}=e,w=R=>p.some(z=>z.days.some(O=>O.isEqualTo(R))),T=R=>{if(j)return;let z=i(R);a&&z<i(a)&&(z=i(a)),n&&z>i(n)&&(z=i(n)),h(z),b?.(z)};return{months:m,weeks:p,days:v,navStart:a,navEnd:n,previousMonth:y,nextMonth:N,goToMonth:T,goToDay:R=>{w(R)||T(R.date)}}}var gn;(function(e){e[e.Today=0]="Today",e[e.Selected=1]="Selected",e[e.LastFocused=2]="LastFocused",e[e.FocusedModifier=3]="FocusedModifier"})(gn||(gn={}));function r2(e){return!e[Aa.disabled]&&!e[Aa.hidden]&&!e[Aa.outside]}function dU(e,r,a,n){let i,o=-1;for(const u of e){const d=r(u);r2(d)&&(d[Aa.focused]&&o<gn.FocusedModifier?(i=u,o=gn.FocusedModifier):n?.isEqualTo(u)&&o<gn.LastFocused?(i=u,o=gn.LastFocused):a(u.date)&&o<gn.Selected?(i=u,o=gn.Selected):d[Aa.today]&&o<gn.Today&&(i=u,o=gn.Today))}return i||(i=e.find(u=>r2(r(u)))),i}function fU(e,r,a,n,i,o,u){const{ISOWeek:d,broadcastCalendar:h}=o,{addDays:m,addMonths:p,addWeeks:v,addYears:y,endOfBroadcastWeek:N,endOfISOWeek:j,endOfWeek:b,max:w,min:T,startOfBroadcastWeek:D,startOfISOWeek:_,startOfWeek:R}=u;let O={day:m,week:v,month:p,year:y,startOfWeek:A=>h?D(A,u):d?_(A):R(A),endOfWeek:A=>h?N(A):d?j(A):b(A)}[e](a,r==="after"?1:-1);return r==="before"&&n?O=w([n,O]):r==="after"&&i&&(O=T([i,O])),O}function Y_(e,r,a,n,i,o,u,d=0){if(d>365)return;const h=fU(e,r,a.date,n,i,o,u),m=!!(o.disabled&&si(h,o.disabled,u)),p=!!(o.hidden&&si(h,o.hidden,u)),v=h,y=new O_(h,v,u);return!m&&!p?y:Y_(e,r,y,n,i,o,u,d+1)}function hU(e,r,a,n,i){const{autoFocus:o}=e,[u,d]=C.useState(),h=dU(r.days,a,n||(()=>!1),u),[m,p]=C.useState(o?h:void 0);return{isFocusTarget:b=>!!h?.isEqualTo(b),setFocused:p,focused:m,blur:()=>{d(m),p(void 0)},moveFocus:(b,w)=>{if(!m)return;const T=Y_(b,w,m,r.navStart,r.navEnd,e,i);T&&(e.disableNavigation&&!r.days.some(_=>_.isEqualTo(T))||(r.goToDay(T),p(T)))}}}function mU(e,r){const{selected:a,required:n,onSelect:i}=e,[o,u]=H0(a,i?a:void 0),d=i?a:o,{isSameDay:h}=r,m=N=>d?.some(j=>h(j,N))??!1,{min:p,max:v}=e;return{selected:d,select:(N,j,b)=>{let w=[...d??[]];if(m(N)){if(d?.length===p||n&&d?.length===1)return;w=d?.filter(T=>!h(T,N))}else d?.length===v?w=[N]:w=[...w,N];return i||u(w),i?.(w,N,j,b),w},isSelected:m}}function xU(e,r,a=0,n=0,i=!1,o=kn){const{from:u,to:d}=r||{},{isSameDay:h,isAfter:m,isBefore:p}=o;let v;if(!u&&!d)v={from:e,to:a>0?void 0:e};else if(u&&!d)h(u,e)?a===0?v={from:u,to:e}:i?v={from:u,to:void 0}:v=void 0:p(e,u)?v={from:e,to:u}:v={from:u,to:e};else if(u&&d)if(h(u,e)&&h(d,e))i?v={from:u,to:d}:v=void 0;else if(h(u,e))v={from:u,to:a>0?void 0:e};else if(h(d,e))v={from:e,to:a>0?void 0:e};else if(p(e,u))v={from:e,to:d};else if(m(e,u))v={from:u,to:e};else if(m(e,d))v={from:u,to:e};else throw new Error("Invalid range");if(v?.from&&v?.to){const y=o.differenceInCalendarDays(v.to,v.from);n>0&&y>n?v={from:e,to:void 0}:a>1&&y<a&&(v={from:e,to:void 0})}return v}function pU(e,r,a=kn){const n=Array.isArray(r)?r:[r];let i=e.from;const o=a.differenceInCalendarDays(e.to,e.from),u=Math.min(o,6);for(let d=0;d<=u;d++){if(n.includes(i.getDay()))return!0;i=a.addDays(i,1)}return!1}function s2(e,r,a=kn){return ri(e,r.from,!1,a)||ri(e,r.to,!1,a)||ri(r,e.from,!1,a)||ri(r,e.to,!1,a)}function gU(e,r,a=kn){const n=Array.isArray(r)?r:[r];if(n.filter(d=>typeof d!="function").some(d=>typeof d=="boolean"?d:a.isDate(d)?ri(e,d,!1,a):F_(d,a)?d.some(h=>ri(e,h,!1,a)):V0(d)?d.from&&d.to?s2(e,{from:d.from,to:d.to},a):!1:M_(d)?pU(e,d.dayOfWeek,a):yg(d)?a.isAfter(d.before,d.after)?s2(e,{from:a.addDays(d.after,1),to:a.addDays(d.before,-1)},a):si(e.from,d,a)||si(e.to,d,a):jg(d)||bg(d)?si(e.from,d,a)||si(e.to,d,a):!1))return!0;const u=n.filter(d=>typeof d=="function");if(u.length){let d=e.from;const h=a.differenceInCalendarDays(e.to,e.from);for(let m=0;m<=h;m++){if(u.some(p=>p(d)))return!0;d=a.addDays(d,1)}}return!1}function vU(e,r){const{disabled:a,excludeDisabled:n,selected:i,required:o,onSelect:u}=e,[d,h]=H0(i,u?i:void 0),m=u?i:d;return{selected:m,select:(y,N,j)=>{const{min:b,max:w}=e,T=y?xU(y,m,b,w,o,r):void 0;return n&&a&&T?.from&&T.to&&gU({from:T.from,to:T.to},a,r)&&(T.from=y,T.to=void 0),u||h(T),u?.(T,y,N,j),T},isSelected:y=>m&&ri(m,y,!1,r)}}function yU(e,r){const{selected:a,required:n,onSelect:i}=e,[o,u]=H0(a,i?a:void 0),d=i?a:o,{isSameDay:h}=r;return{selected:d,select:(v,y,N)=>{let j=v;return!n&&d&&d&&h(v,d)&&(j=void 0),i||u(j),i?.(j,v,y,N),j},isSelected:v=>d?h(d,v):!1}}function jU(e,r){const a=yU(e,r),n=mU(e,r),i=vU(e,r);switch(e.mode){case"single":return a;case"multiple":return n;case"range":return i;default:return}}function Rs(e,r){return e instanceof yr&&e.timeZone===r?e:new yr(e,r)}function Dc(e,r,a){return Rs(e,r)}function n2(e,r,a){return typeof e=="boolean"||typeof e=="function"?e:e instanceof Date?Dc(e,r):Array.isArray(e)?e.map(n=>n instanceof Date?Dc(n,r):n):V0(e)?{...e,from:e.from?Rs(e.from,r):e.from,to:e.to?Rs(e.to,r):e.to}:yg(e)?{before:Dc(e.before,r),after:Dc(e.after,r)}:jg(e)?{after:Dc(e.after,r)}:bg(e)?{before:Dc(e.before,r)}:e}function Cx(e,r,a){return e&&(Array.isArray(e)?e.map(n=>n2(n,r)):n2(e,r))}function bU(e){let r=e;const a=r.timeZone;if(a&&(r={...e,timeZone:a},r.today&&(r.today=Rs(r.today,a)),r.month&&(r.month=Rs(r.month,a)),r.defaultMonth&&(r.defaultMonth=Rs(r.defaultMonth,a)),r.startMonth&&(r.startMonth=Rs(r.startMonth,a)),r.endMonth&&(r.endMonth=Rs(r.endMonth,a)),r.mode==="single"&&r.selected?r.selected=Rs(r.selected,a):r.mode==="multiple"&&r.selected?r.selected=r.selected?.map(_t=>Rs(_t,a)):r.mode==="range"&&r.selected&&(r.selected={from:r.selected.from?Rs(r.selected.from,a):r.selected.from,to:r.selected.to?Rs(r.selected.to,a):r.selected.to}),r.disabled!==void 0&&(r.disabled=Cx(r.disabled,a)),r.hidden!==void 0&&(r.hidden=Cx(r.hidden,a)),r.modifiers)){const _t={};Object.keys(r.modifiers).forEach(Dt=>{_t[Dt]=Cx(r.modifiers?.[Dt],a)}),r.modifiers=_t}const{components:n,formatters:i,labels:o,dateLib:u,locale:d,classNames:h}=C.useMemo(()=>{const _t={...D_,...r.locale},Dt=r.broadcastCalendar?1:r.weekStartsOn,ut=r.noonSafe&&r.timeZone?Q7(r.timeZone,{weekStartsOn:Dt,locale:_t}):void 0,Bt=r.dateLib&&ut?{...ut,...r.dateLib}:r.dateLib??ut,aa=new ys({locale:_t,weekStartsOn:Dt,firstWeekContainsDate:r.firstWeekContainsDate,useAdditionalWeekYearTokens:r.useAdditionalWeekYearTokens,useAdditionalDayOfYearTokens:r.useAdditionalDayOfYearTokens,timeZone:r.timeZone,numerals:r.numerals},Bt);return{dateLib:aa,components:D7(r.components),formatters:z7(r.formatters),labels:W7(r.labels,aa.options),locale:_t,classNames:{...Ng(),...r.classNames}}},[r.locale,r.broadcastCalendar,r.weekStartsOn,r.firstWeekContainsDate,r.useAdditionalWeekYearTokens,r.useAdditionalDayOfYearTokens,r.timeZone,r.numerals,r.dateLib,r.noonSafe,r.components,r.formatters,r.labels,r.classNames]);r.today||(r={...r,today:u.today()});const{captionLayout:m,mode:p,navLayout:v,numberOfMonths:y=1,onDayBlur:N,onDayClick:j,onDayFocus:b,onDayKeyDown:w,onDayMouseEnter:T,onDayMouseLeave:D,onNextClick:_,onPrevClick:R,showWeekNumber:z,styles:O}=r,{formatCaption:A,formatDay:k,formatMonthDropdown:E,formatWeekNumber:L,formatWeekNumberHeader:H,formatWeekdayName:I,formatYearDropdown:re}=i,ne=uU(r,u),{days:ge,months:W,navStart:ee,navEnd:je,previousMonth:Z,nextMonth:De,goToMonth:he}=ne,P=A7(ge,r,ee,je,u),{isSelected:q,select:J,selected:K}=jU(r,u)??{},{blur:xe,focused:Fe,isFocusTarget:Ae,moveFocus:Ee,setFocused:we}=hU(r,ne,P,q??(()=>!1),u),{labelDayButton:Ge,labelGridcell:X,labelGrid:ht,labelMonthDropdown:Ye,labelNav:Je,labelPrevious:qe,labelNext:Be,labelWeekday:$e,labelWeekNumber:St,labelWeekNumberHeader:Jt,labelYearDropdown:fa}=o,ze=C.useMemo(()=>$7(u,r.ISOWeek,r.broadcastCalendar,r.today),[u,r.ISOWeek,r.broadcastCalendar,r.today]),vt=p!==void 0||j!==void 0,tt=C.useCallback(()=>{Z&&(he(Z),R?.(Z))},[Z,he,R]),Qe=C.useCallback(()=>{De&&(he(De),_?.(De))},[he,De,_]),ot=C.useCallback((_t,Dt)=>ut=>{ut.preventDefault(),ut.stopPropagation(),we(_t),!Dt.disabled&&(J?.(_t.date,Dt,ut),j?.(_t.date,Dt,ut))},[J,j,we]),bt=C.useCallback((_t,Dt)=>ut=>{we(_t),b?.(_t.date,Dt,ut)},[b,we]),Ut=C.useCallback((_t,Dt)=>ut=>{xe(),N?.(_t.date,Dt,ut)},[xe,N]),Ma=C.useCallback((_t,Dt)=>ut=>{const Bt={ArrowLeft:[ut.shiftKey?"month":"day",r.dir==="rtl"?"after":"before"],ArrowRight:[ut.shiftKey?"month":"day",r.dir==="rtl"?"before":"after"],ArrowDown:[ut.shiftKey?"year":"week","after"],ArrowUp:[ut.shiftKey?"year":"week","before"],PageUp:[ut.shiftKey?"year":"month","before"],PageDown:[ut.shiftKey?"year":"month","after"],Home:["startOfWeek","before"],End:["endOfWeek","after"]};if(Bt[ut.key]){ut.preventDefault(),ut.stopPropagation();const[aa,Ot]=Bt[ut.key];Ee(aa,Ot)}w?.(_t.date,Dt,ut)},[Ee,w,r.dir]),wt=C.useCallback((_t,Dt)=>ut=>{T?.(_t.date,Dt,ut)},[T]),qt=C.useCallback((_t,Dt)=>ut=>{D?.(_t.date,Dt,ut)},[D]),oa=C.useCallback(_t=>Dt=>{const ut=Number(Dt.target.value),Bt=u.setMonth(u.startOfMonth(_t),ut);he(Bt)},[u,he]),zt=C.useCallback(_t=>Dt=>{const ut=Number(Dt.target.value),Bt=u.setYear(u.startOfMonth(_t),ut);he(Bt)},[u,he]),{className:ia,style:Ca}=C.useMemo(()=>({className:[h[ft.Root],r.className].filter(Boolean).join(" "),style:{...O?.[ft.Root],...r.style}}),[h,r.className,r.style,O]),_a=O7(r),nn=C.useRef(null);tU(nn,!!r.animate,{classNames:h,months:W,focused:Fe,dateLib:u});const ln={dayPickerProps:r,selected:K,select:J,isSelected:q,months:W,nextMonth:De,previousMonth:Z,goToMonth:he,getModifiers:P,components:n,classNames:h,styles:O,labels:o,formatters:i};return Xe.createElement(R_.Provider,{value:ln},Xe.createElement(n.Root,{rootRef:r.animate?nn:void 0,className:ia,style:Ca,dir:r.dir,id:r.id,lang:r.lang,nonce:r.nonce,title:r.title,role:r.role,"aria-label":r["aria-label"],"aria-labelledby":r["aria-labelledby"],..._a},Xe.createElement(n.Months,{className:h[ft.Months],style:O?.[ft.Months]},!r.hideNavigation&&!v&&Xe.createElement(n.Nav,{"data-animated-nav":r.animate?"true":void 0,className:h[ft.Nav],style:O?.[ft.Nav],"aria-label":Je(),onPreviousClick:tt,onNextClick:Qe,previousMonth:Z,nextMonth:De}),W.map((_t,Dt)=>Xe.createElement(n.Month,{"data-animated-month":r.animate?"true":void 0,className:h[ft.Month],style:O?.[ft.Month],key:Dt,displayIndex:Dt,calendarMonth:_t},v==="around"&&!r.hideNavigation&&Dt===0&&Xe.createElement(n.PreviousMonthButton,{type:"button",className:h[ft.PreviousMonthButton],tabIndex:Z?void 0:-1,"aria-disabled":Z?void 0:!0,"aria-label":qe(Z),onClick:tt,"data-animated-button":r.animate?"true":void 0},Xe.createElement(n.Chevron,{disabled:Z?void 0:!0,className:h[ft.Chevron],orientation:r.dir==="rtl"?"right":"left"})),Xe.createElement(n.MonthCaption,{"data-animated-caption":r.animate?"true":void 0,className:h[ft.MonthCaption],style:O?.[ft.MonthCaption],calendarMonth:_t,displayIndex:Dt},m?.startsWith("dropdown")?Xe.createElement(n.DropdownNav,{className:h[ft.Dropdowns],style:O?.[ft.Dropdowns]},(()=>{const ut=m==="dropdown"||m==="dropdown-months"?Xe.createElement(n.MonthsDropdown,{key:"month",className:h[ft.MonthsDropdown],"aria-label":Ye(),classNames:h,components:n,disabled:!!r.disableNavigation,onChange:oa(_t.date),options:Y7(_t.date,ee,je,i,u),style:O?.[ft.Dropdown],value:u.getMonth(_t.date)}):Xe.createElement("span",{key:"month"},E(_t.date,u)),Bt=m==="dropdown"||m==="dropdown-years"?Xe.createElement(n.YearsDropdown,{key:"year",className:h[ft.YearsDropdown],"aria-label":fa(u.options),classNames:h,components:n,disabled:!!r.disableNavigation,onChange:zt(_t.date),options:K7(ee,je,i,u,!!r.reverseYears),style:O?.[ft.Dropdown],value:u.getYear(_t.date)}):Xe.createElement("span",{key:"year"},re(_t.date,u));return u.getMonthYearOrder()==="year-first"?[Bt,ut]:[ut,Bt]})(),Xe.createElement("span",{role:"status","aria-live":"polite",style:{border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap",wordWrap:"normal"}},A(_t.date,u.options,u))):Xe.createElement(n.CaptionLabel,{className:h[ft.CaptionLabel],role:"status","aria-live":"polite"},A(_t.date,u.options,u))),v==="around"&&!r.hideNavigation&&Dt===y-1&&Xe.createElement(n.NextMonthButton,{type:"button",className:h[ft.NextMonthButton],tabIndex:De?void 0:-1,"aria-disabled":De?void 0:!0,"aria-label":Be(De),onClick:Qe,"data-animated-button":r.animate?"true":void 0},Xe.createElement(n.Chevron,{disabled:De?void 0:!0,className:h[ft.Chevron],orientation:r.dir==="rtl"?"left":"right"})),Dt===y-1&&v==="after"&&!r.hideNavigation&&Xe.createElement(n.Nav,{"data-animated-nav":r.animate?"true":void 0,className:h[ft.Nav],style:O?.[ft.Nav],"aria-label":Je(),onPreviousClick:tt,onNextClick:Qe,previousMonth:Z,nextMonth:De}),Xe.createElement(n.MonthGrid,{role:"grid","aria-multiselectable":p==="multiple"||p==="range","aria-label":ht(_t.date,u.options,u)||void 0,className:h[ft.MonthGrid],style:O?.[ft.MonthGrid]},!r.hideWeekdays&&Xe.createElement(n.Weekdays,{"data-animated-weekdays":r.animate?"true":void 0,className:h[ft.Weekdays],style:O?.[ft.Weekdays]},z&&Xe.createElement(n.WeekNumberHeader,{"aria-label":Jt(u.options),className:h[ft.WeekNumberHeader],style:O?.[ft.WeekNumberHeader],scope:"col"},H()),ze.map(ut=>Xe.createElement(n.Weekday,{"aria-label":$e(ut,u.options,u),className:h[ft.Weekday],key:String(ut),style:O?.[ft.Weekday],scope:"col"},I(ut,u.options,u)))),Xe.createElement(n.Weeks,{"data-animated-weeks":r.animate?"true":void 0,className:h[ft.Weeks],style:O?.[ft.Weeks]},_t.weeks.map(ut=>Xe.createElement(n.Week,{className:h[ft.Week],key:ut.weekNumber,style:O?.[ft.Week],week:ut},z&&Xe.createElement(n.WeekNumber,{week:ut,style:O?.[ft.WeekNumber],"aria-label":St(ut.weekNumber,{locale:d}),className:h[ft.WeekNumber],scope:"row",role:"rowheader"},L(ut.weekNumber,u)),ut.days.map(Bt=>{const{date:aa}=Bt,Ot=P(Bt);if(Ot[Aa.focused]=!Ot.hidden&&!!Fe?.isEqualTo(Bt),Ot[Js.selected]=q?.(aa)||Ot.selected,V0(K)){const{from:Us,to:Hr}=K;Ot[Js.range_start]=!!(Us&&Hr&&u.isSameDay(aa,Us)),Ot[Js.range_end]=!!(Us&&Hr&&u.isSameDay(aa,Hr)),Ot[Js.range_middle]=ri(K,aa,!0,u)}const Bs=X7(Ot,O,r.modifiersStyles),ja=k7(Ot,h,r.modifiersClassNames),as=!vt&&!Ot.hidden?X(aa,Ot,u.options,u):void 0;return Xe.createElement(n.Day,{key:`${Bt.isoDate}_${Bt.displayMonthId}`,day:Bt,modifiers:Ot,className:ja.join(" "),style:Bs,role:"gridcell","aria-selected":Ot.selected||void 0,"aria-label":as,"data-day":Bt.isoDate,"data-month":Bt.outside?Bt.dateMonthId:void 0,"data-selected":Ot.selected||void 0,"data-disabled":Ot.disabled||void 0,"data-hidden":Ot.hidden||void 0,"data-outside":Bt.outside||void 0,"data-focused":Ot.focused||void 0,"data-today":Ot.today||void 0},!Ot.hidden&&vt?Xe.createElement(n.DayButton,{className:h[ft.DayButton],style:O?.[ft.DayButton],type:"button",day:Bt,modifiers:Ot,disabled:!Ot.focused&&Ot.disabled||void 0,"aria-disabled":Ot.focused&&Ot.disabled||void 0,tabIndex:Ae(Bt)?0:-1,"aria-label":Ge(aa,Ot,u.options,u),onClick:ot(Bt,Ot),onBlur:Ut(Bt,Ot),onFocus:bt(Bt,Ot),onKeyDown:Ma(Bt,Ot),onMouseEnter:wt(Bt,Ot),onMouseLeave:qt(Bt,Ot)},k(aa,u.options,u)):!Ot.hidden&&k(Bt.date,u.options,u))})))))))),r.footer&&Xe.createElement(n.Footer,{className:h[ft.Footer],style:O?.[ft.Footer],role:"status","aria-live":"polite"},r.footer)))}function X_({className:e,classNames:r,showOutsideDays:a=!0,captionLayout:n="label",buttonVariant:i="ghost",formatters:o,components:u,...d}){const h=Ng();return t.jsx(bU,{captionLayout:n,className:me("group/calendar bg-background p-3 [--cell-size:2rem] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw`rtl:**:[.rdp-button\_next>svg]:rotate-180`,String.raw`rtl:**:[.rdp-button\_previous>svg]:rotate-180`,e),classNames:{root:me("w-fit",h.root),months:me("relative flex flex-col gap-4 md:flex-row",h.months),month:me("flex w-full flex-col gap-4",h.month),nav:me("absolute inset-x-0 top-0 flex w-full items-center justify-between gap-1",h.nav),button_previous:me(Ru({variant:i}),"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50",h.button_previous),button_next:me(Ru({variant:i}),"h-[--cell-size] w-[--cell-size] select-none p-0 aria-disabled:opacity-50",h.button_next),month_caption:me("flex h-[--cell-size] w-full items-center justify-center px-[--cell-size]",h.month_caption),dropdowns:me("flex h-[--cell-size] w-full items-center justify-center gap-1.5 font-medium text-sm",h.dropdowns),dropdown_root:me("relative rounded-md border border-input shadow-xs has-focus:border-ring has-focus:ring-[3px] has-focus:ring-ring/50",h.dropdown_root),dropdown:me("absolute inset-0 bg-popover opacity-0",h.dropdown),caption_label:me("select-none font-medium",n==="label"?"text-sm":"flex h-8 items-center gap-1 rounded-md pr-1 pl-2 text-sm [&>svg]:size-3.5 [&>svg]:text-muted-foreground",h.caption_label),table:"w-full border-collapse",weekdays:me("flex",h.weekdays),weekday:me("flex-1 select-none rounded-md font-normal text-[0.8rem] text-muted-foreground",h.weekday),week:me("mt-2 flex w-full",h.week),week_number_header:me("w-[--cell-size] select-none",h.week_number_header),week_number:me("select-none text-[0.8rem] text-muted-foreground",h.week_number),day:me("group/day relative aspect-square h-full w-full select-none p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md",h.day),range_start:me("rounded-l-md bg-accent",h.range_start),range_middle:me("rounded-none",h.range_middle),range_end:me("rounded-r-md bg-accent",h.range_end),today:me("rounded-md bg-accent text-accent-foreground data-[selected=true]:rounded-none",h.today),outside:me("text-muted-foreground aria-selected:text-muted-foreground",h.outside),disabled:me("text-muted-foreground opacity-50",h.disabled),hidden:me("invisible",h.hidden),...r},components:{Root:({className:m,rootRef:p,...v})=>t.jsx("div",{className:me(m),"data-slot":"calendar",ref:p,...v}),Chevron:({className:m,orientation:p,...v})=>p==="left"?t.jsx(td,{className:me("size-4",m),...v}):p==="right"?t.jsx(Sn,{className:me("size-4",m),...v}):t.jsx(Il,{className:me("size-4",m),...v}),DayButton:NU,WeekNumber:({children:m,...p})=>t.jsx("td",{...p,children:t.jsx("div",{className:"flex size-[--cell-size] items-center justify-center text-center",children:m})}),...u},formatters:{formatMonthDropdown:m=>m.toLocaleString("default",{month:"short"}),...o},showOutsideDays:a,...d})}function NU({className:e,day:r,modifiers:a,...n}){const i=Ng(),o=C.useRef(null);return C.useEffect(()=>{a.focused&&o.current?.focus()},[a.focused]),t.jsx(oe,{className:me("flex aspect-square h-auto w-full min-w-[--cell-size] flex-col gap-1 font-normal leading-none data-[range-end=true]:rounded-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md data-[range-end=true]:bg-primary data-[range-middle=true]:bg-accent data-[range-start=true]:bg-primary data-[selected-single=true]:bg-primary data-[range-end=true]:text-primary-foreground data-[range-middle=true]:text-accent-foreground data-[range-start=true]:text-primary-foreground data-[selected-single=true]:text-primary-foreground group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-[3px] group-data-[focused=true]/day:ring-ring/50 [&>span]:text-xs [&>span]:opacity-70",i.day,e),"data-day":r.date.toLocaleDateString(),"data-range-end":a.range_end,"data-range-middle":a.range_middle,"data-range-start":a.range_start,"data-selected-single":a.selected&&!a.range_start&&!a.range_end&&!a.range_middle,ref:o,size:"icon",variant:"ghost",...n})}const Vf=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),i2={PENDING:{label:"Pendente",color:"bg-yellow-500"},RECEIVED:{label:"Recebido",color:"bg-green-500"},CONFIRMED:{label:"Confirmado",color:"bg-green-500"},RECEIVED_IN_CASH:{label:"Recebido em Dinheiro",color:"bg-green-500"},OVERDUE:{label:"Vencido",color:"bg-red-500"},REFUNDED:{label:"Reembolsado",color:"bg-purple-500"},CANCELLED:{label:"Cancelado",color:"bg-gray-500"}};function $_(){const e=new Date,[r,a]=C.useState(e.getMonth()),[n,i]=C.useState(e.getFullYear()),[o,u]=C.useState(null),[d,h]=C.useState(!1),{data:m}=et.financial.metrics.useQuery({month:r,year:n}),p=C.useMemo(()=>{if(!m)return new Map;const D=new Map;for(const _ of m)D.set(_.date,_);return D},[m]),v=C.useMemo(()=>new Set(p.keys()),[p]),y=o?p.get(o):null,N=new Date(n,r,1),j=()=>{r===0?(a(11),i(D=>D-1)):a(D=>D-1)},b=()=>{r===11?(a(0),i(D=>D+1)):a(D=>D+1)},w=D=>{const _=D.toISOString().split("T")[0];p.has(_)&&(u(_),h(!0))},T=D=>{const _=D.toISOString().split("T")[0],R=p.get(_);if(!R)return null;const z=R.totals.overdue>0,O=R.totals.pending>0,A=R.totals.paid>0;return t.jsxs("div",{className:"absolute bottom-0.5 left-1/2 flex -translate-x-1/2 gap-0.5",children:[A&&t.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-green-500"}),O&&t.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-yellow-500"}),z&&t.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-red-500"})]})};return m===void 0?t.jsxs(Te,{children:[t.jsx(Me,{children:t.jsx(Le,{children:"Calendrio de Pagamentos"})}),t.jsx(Ce,{children:t.jsx(gt,{className:"h-75 w-full"})})]}):t.jsxs(t.Fragment,{children:[t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(Le,{children:"Calendrio de Pagamentos"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(oe,{onClick:j,size:"icon",variant:"outline",children:t.jsx(td,{className:"h-4 w-4"})}),t.jsx("span",{className:"min-w-35 text-center font-medium",children:N.toLocaleDateString("pt-BR",{month:"long",year:"numeric"})}),t.jsx(oe,{onClick:b,size:"icon",variant:"outline",children:t.jsx(Sn,{className:"h-4 w-4"})})]})]}),t.jsxs(Ce,{children:[t.jsx(X_,{className:"rounded-md border p-3",components:{DayButton:({day:D,modifiers:_})=>{const R=D.date.toISOString().split("T")[0],z=v.has(R);return t.jsxs("button",{className:`relative flex h-9 w-9 flex-col items-center justify-center rounded-md text-sm ${z?"cursor-pointer font-semibold hover:bg-accent":"cursor-default"} ${_.today?"bg-accent":""} ${_.outside?"text-muted-foreground opacity-50":""}`,onClick:O=>{O.preventDefault(),z&&w(D.date)},type:"button",children:[D.date.getDate(),T(D.date)]})}},mode:"single",modifiers:{hasPayments:D=>v.has(D.toISOString().split("T")[0])},modifiersClassNames:{hasPayments:"relative cursor-pointer hover:bg-accent"},month:N,onDayClick:w,onMonthChange:D=>{a(D.getMonth()),i(D.getFullYear())}}),t.jsxs("div",{className:"mt-4 flex items-center justify-center gap-4 text-muted-foreground text-xs",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"h-2.5 w-2.5 rounded-full bg-green-500"}),t.jsx("span",{children:"Pago"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"h-2.5 w-2.5 rounded-full bg-yellow-500"}),t.jsx("span",{children:"Pendente"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"h-2.5 w-2.5 rounded-full bg-red-500"}),t.jsx("span",{children:"Vencido"})]})]})]})]}),t.jsx(Vp,{onOpenChange:h,open:d,children:t.jsxs(M0,{className:"sm:max-w-lg",children:[t.jsxs(F0,{children:[t.jsxs(I0,{children:["Pagamentos -"," ",o?new Date(`${o}T12:00:00`).toLocaleDateString("pt-BR",{weekday:"long",day:"numeric",month:"long"}):""]}),t.jsx(Hp,{children:y?t.jsxs(t.Fragment,{children:["Total: ",y.payments.length," cobranas |"," ",t.jsxs("span",{className:"text-green-600",children:["Pago: ",Vf(y.totals.paid)]})," ","|"," ",t.jsxs("span",{className:"text-yellow-600",children:["Pendente: ",Vf(y.totals.pending)]}),y.totals.overdue>0&&t.jsxs(t.Fragment,{children:[" ","|"," ",t.jsxs("span",{className:"text-red-600",children:["Vencido: ",Vf(y.totals.overdue)]})]})]}):"Nenhum pagamento encontrado"})]}),t.jsx("div",{className:"mt-6",children:y&&y.payments.length>0?t.jsxs(Ya,{children:[t.jsx(Xa,{children:t.jsxs(Tt,{children:[t.jsx(He,{children:"Descrio"}),t.jsx(He,{className:"text-right",children:"Valor"}),t.jsx(He,{children:"Status"})]})}),t.jsx($a,{children:y.payments.map(D=>D&&t.jsxs(Tt,{children:[t.jsx(Pe,{className:"max-w-37.5 truncate",children:D?.description||"Cobrana"}),t.jsx(Pe,{className:"text-right",children:Vf(D.value??0)}),t.jsx(Pe,{children:t.jsx(Ve,{className:i2[D.status]?.color,children:i2[D.status]?.label||D.status})})]},D.id))})]}):t.jsx("p",{className:"text-center text-muted-foreground",children:"Nenhum pagamento nesta data."})})]})})]})}const wU=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e);function K_(){const e=new Date,{data:r}=et.financial.metrics.useQuery({month:e.getMonth(),year:e.getFullYear()});if(!r)return t.jsx("div",{children:"Carregando grfico..."});const a=[{month:"Atual",received:r.paidThisMonth,projected:r.pendingThisMonth},...r.futureProjection.map(n=>({month:n.month,received:0,projected:n.amount}))];return t.jsxs(Te,{children:[t.jsx(Me,{children:t.jsx(Le,{children:"Receita: Recebido vs Projetado"})}),t.jsx(Ce,{children:t.jsx(a0,{height:300,minWidth:0,width:"100%",children:t.jsxs(kp,{data:a,children:[t.jsx(r0,{strokeDasharray:"3 3"}),t.jsx(s0,{dataKey:"month"}),t.jsx(n0,{}),t.jsx(i0,{formatter:n=>typeof n=="number"?wU(n):n}),t.jsx(Ic,{dataKey:"received",name:"Recebido",stroke:"#10b981",type:"monotone"}),t.jsx(Ic,{dataKey:"projected",name:"Projetado",stroke:"#3b82f6",strokeDasharray:"5 5",type:"monotone"})]})})})]})}const SU=jt("/_authenticated/financial")({component:_U});function _U(){const[e,r]=C.useState(!1),a=et.settings.set.useMutation(),n=async()=>{r(!0);try{Ie.info("Sincronizando pagamentos...");const i=await a({initiatedBy:"manual_dashboard_sync"});i?.success&&Ie.success("Sincronizao concluda!",{description:`${i.recordsCreated} novos, ${i.recordsUpdated} atualizados`})}catch(i){Ie.error("Falha na sincronizao",{description:i instanceof Error?i.message:"Erro desconhecido"})}finally{r(!1)}};return t.jsxs("div",{className:"flex-1 space-y-6 p-8 pt-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"font-bold text-3xl tracking-tight",children:"Financeiro"}),t.jsx("p",{className:"text-muted-foreground",children:"Acompanhe cobranas, receitas e pagamentos"})]}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsxs(oe,{className:"gap-2",disabled:e,onClick:n,size:"sm",variant:"outline",children:[t.jsx(tl,{className:`h-4 w-4 ${e?"animate-spin":""}`}),e?"Sincronizando...":"Sincronizar"]})})]}),t.jsx(C_,{}),t.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[t.jsx(K_,{}),t.jsx($_,{})]}),t.jsxs(Te,{children:[t.jsxs(Me,{children:[t.jsx(Le,{children:"Cobranas do Ms"}),t.jsx(ta,{children:"Lista de cobranas com filtros por status"})]}),t.jsx(Ce,{children:t.jsx(T_,{})})]})]})}function Hf({title:e,value:r,description:a,icon:n,trend:i,className:o}){return t.jsxs(Te,{className:me("stats-card transition-all duration-300 ease-out hover:-translate-y-1 hover:shadow-[0_20px_40px_-12px_hsl(var(--primary)/0.3)]",o),variant:"glass",children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(Le,{className:"font-medium text-muted-foreground text-sm",children:e}),t.jsx(n,{className:"stats-card-icon h-4 w-4 text-muted-foreground transition-transform duration-300 ease-out hover:rotate-6 hover:scale-110"})]}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold font-display text-3xl tabular-nums",children:r}),t.jsxs("svg",{"aria-label":"Sparkline chart",className:"mt-2 h-8 w-full opacity-30",preserveAspectRatio:"none",viewBox:"0 0 100 20",children:[t.jsx("title",{children:"Sparkline chart"}),t.jsx("polyline",{className:"sparkline-path",fill:"none",points:"0,15 20,12 40,8 60,10 80,5 100,8",stroke:"hsl(var(--primary))",strokeWidth:"1.5",style:{strokeDasharray:120,strokeDashoffset:120,animation:"sparkline-draw 1s ease-out forwards"},vectorEffect:"non-scaling-stroke"})]}),t.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[i&&t.jsxs("span",{className:me("flex items-center font-medium text-xs",i.isPositive?"text-green-500":"text-red-500"),children:[i.isPositive?t.jsx(tn,{className:"mr-1 h-3 w-3"}):t.jsx(MA,{className:"mr-1 h-3 w-3"}),i.value,"%"]}),a&&t.jsx("p",{className:"text-muted-foreground text-xs",children:a})]})]})]})}const EU=C.lazy(()=>Tr(()=>import("./churn-alerts-DZ--RuMV.js"),__vite__mapDeps([11,1,2,3,4,5,6])).then(e=>({default:e.ChurnAlerts}))),TU=C.lazy(()=>Tr(()=>import("./funnel-chart-BA0QYxCY.js"),__vite__mapDeps([12,1,6,2,3,4,5])).then(e=>({default:e.FunnelChart}))),CU=C.lazy(()=>Tr(()=>import("./leads-by-product-C8Iv48CZ.js"),__vite__mapDeps([13,1,3,2,4,5,6])).then(e=>({default:e.LeadsByProduct}))),AU=C.lazy(()=>Tr(()=>import("./leads-vs-conversions-BW7vPy7p.js"),__vite__mapDeps([14,1,6,2,3,4,5])).then(e=>({default:e.LeadsVsConversions}))),kU=C.lazy(()=>Tr(()=>import("./recent-leads-Dd_kyXoX.js"),__vite__mapDeps([15,1,2,3,4,5,6])).then(e=>({default:e.RecentLeads}))),DU=C.lazy(()=>Tr(()=>import("./response-time-uVhdl-cl.js"),__vite__mapDeps([16,1,3,2,4,5,6])).then(e=>({default:e.ResponseTime}))),OU=C.lazy(()=>Tr(()=>import("./team-performance-zwS6KPLH.js"),__vite__mapDeps([17,1,3,2,4,5,6])).then(e=>({default:e.TeamPerformance}))),RU=jt("/_authenticated/dashboard")({component:IU});function MU(e,r){return e?"Dashboard":"Meu Dashboard"}function FU({metrics:e,formatCurrency:r}){return e?t.jsxs(t.Fragment,{children:[t.jsx(Hf,{description:"vs. perodo anterior",icon:ya,title:"Leads este ms",trend:{value:e.leadsTrend||0,isPositive:(e.leadsTrend||0)>0},value:e.totalLeads||0}),t.jsx(Hf,{description:"vs. perodo anterior",icon:tn,title:"Taxa de Converso",trend:{value:e.conversionTrend||0,isPositive:(e.conversionTrend||0)>0},value:`${e.conversionRate.toFixed(1)}%`}),t.jsx(Hf,{description:"vs. perodo anterior",icon:$i,title:"Faturamento",trend:{value:e.revenueTrend||0,isPositive:(e.revenueTrend||0)>0},value:r(e.revenue)}),t.jsx(Hf,{description:"ltimas 24h",icon:an,title:"Mensagens",value:e.totalMessages?.toString()||"0"})]}):t.jsxs(t.Fragment,{children:[t.jsx(gt,{className:"h-32 w-full"}),t.jsx(gt,{className:"h-32 w-full"}),t.jsx(gt,{className:"h-32 w-full"}),t.jsx(gt,{className:"h-32 w-full"})]})}function IU(){const[e,r]=C.useState("30d"),[a,n]=C.useState(null),{data:i}=et.users.me.useQuery(),o=void 0,u=i&&["manager","admin","owner"].includes(i.role),d=o?.find(b=>b.id===a),h=void 0,m=void 0,p=void 0,v=void 0,y=m,N=b=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",maximumFractionDigits:0}).format(b),j=MU(!!u);return t.jsx(LU,{children:t.jsxs("div",{className:"space-y-6",children:[t.jsx(Sl,{children:t.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("h1",{className:"font-bold font-display text-4xl tracking-tight md:text-5xl",children:j}),d,!u&&i&&t.jsx(Ve,{variant:"outline",children:"Visualizao Individual"})]}),t.jsx("p",{className:"font-sans text-base text-muted-foreground",children:"Viso geral do Grupo US em tempo real"})]}),t.jsxs("div",{className:"flex gap-2",children:[u&&t.jsxs(Rt,{onValueChange:b=>n(b==="all"?null:b),value:a||"all",children:[t.jsx(At,{className:"w-[200px]",children:t.jsx(Mt,{placeholder:"Todos os Vendedores"})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"all",children:"Todos os Vendedores"}),o?.map(b=>t.jsx(ye,{value:b.id,children:b.name},b.id))]})]}),t.jsxs(Rt,{onValueChange:b=>r(b),value:e,children:[t.jsx(At,{className:"w-[180px]",children:t.jsx(Mt,{placeholder:"Perodo"})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"7d",children:"ltimos 7 dias"}),t.jsx(ye,{value:"30d",children:"ltimos 30 dias"}),t.jsx(ye,{value:"90d",children:"ltimos 90 dias"}),t.jsx(ye,{value:"year",children:"Este ano"})]})]})]})]})}),t.jsx(Sl,{children:t.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 xl:grid-cols-4",children:t.jsx(FU,{formatCurrency:N,metrics:h})})}),t.jsxs(Sl,{className:"grid gap-4 md:grid-cols-2",stagger:100,children:[t.jsx(C.Suspense,{fallback:t.jsx(gt,{className:"h-80 w-full rounded-lg"}),children:t.jsx(AU,{data:h?.dailyMetrics})}),t.jsx(C.Suspense,{fallback:t.jsx(gt,{className:"h-80 w-full rounded-lg"}),children:t.jsx(CU,{data:h?.leadsByProduct})})]}),t.jsxs(Sl,{className:"grid gap-4 md:grid-cols-2",stagger:100,children:[t.jsx(C.Suspense,{fallback:t.jsx(gt,{className:"h-80 w-full rounded-lg"}),children:t.jsx(TU,{data:h?.funnel})}),t.jsx(C.Suspense,{fallback:t.jsx(gt,{className:"h-80 w-full rounded-lg"}),children:t.jsx(DU,{avgResponseTime:h?.avgResponseTime,trend:h?.responseTimeTrend})})]}),t.jsxs(Sl,{className:"grid gap-4 md:grid-cols-2",stagger:100,children:[t.jsx(C.Suspense,{fallback:t.jsx(gt,{className:"h-80 w-full rounded-lg"}),children:t.jsx(OU,{data:y})}),t.jsx(C.Suspense,{fallback:t.jsx(gt,{className:"h-80 w-full rounded-lg"}),children:t.jsx(EU,{data:p})})]}),t.jsx(Sl,{children:t.jsx(C.Suspense,{fallback:t.jsx(gt,{className:"h-64 w-full rounded-lg"}),children:t.jsx(kU,{data:v})})})]})})}class LU extends C.Component{constructor(r){super(r),this.state={hasError:!1,error:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}render(){return this.state.hasError?t.jsxs("div",{className:"fade-in zoom-in-95 flex min-h-[50vh] animate-in flex-col items-center justify-center gap-4 rounded-lg border border-dashed bg-background p-8 text-center",children:[t.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-destructive/10",children:t.jsx(Ll,{className:"h-6 w-6 text-destructive"})}),t.jsxs("div",{className:"space-y-1",children:[t.jsx("h3",{className:"font-semibold text-lg",children:"Erro ao carregar dashboard"}),t.jsx("p",{className:"max-w-xs text-muted-foreground text-sm",children:this.state.error?.message||"Ocorreu um erro inesperado."})]}),t.jsx(oe,{onClick:()=>window.location.reload(),children:"Tentar novamente"})]}):this.props.children}}const _g=IA,Eg=LA,G0=C.forwardRef(({className:e,align:r="center",sideOffset:a=4,...n},i)=>t.jsx(FA,{children:t.jsx(sN,{align:r,className:me("data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-[--radix-popover-content-transform-origin] rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=closed]:animate-out data-[state=open]:animate-in",e),ref:i,sideOffset:a,...n})}));G0.displayName=sN.displayName;function PU({onFiltersChange:e}){const{data:r}=et.tags.list.useQuery(),[a,n]=C.useState({search:"",stages:[],temperature:[],products:[],source:[],tags:[]});C.useEffect(()=>{const h=setTimeout(()=>{e(a)},300);return()=>clearTimeout(h)},[a,e]);const i=h=>{n(m=>({...m,search:h.target.value}))},o=(h,m)=>{n(p=>{const v=p[h],y=v.includes(m)?v.filter(N=>N!==m):[...v,m];return{...p,[h]:y}})},u=()=>{n({search:"",stages:[],temperature:[],products:[],source:[],tags:[]})},d=a.stages.length+a.temperature.length+a.products.length+a.source.length+a.tags.length;return t.jsxs("div",{className:"flex w-full flex-col gap-3 rounded-lg border border-border/50 bg-card/50 p-2 sm:flex-row",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx(Ms,{className:"absolute top-2.5 left-2.5 h-4 w-4 text-muted-foreground"}),t.jsx(dt,{className:"border-border/50 bg-background/50 pl-9",onChange:i,placeholder:"Buscar leads...",value:a.search})]}),t.jsxs(_g,{children:[t.jsx(Eg,{asChild:!0,children:t.jsxs(oe,{className:"relative gap-2 border-border/50 bg-background/50",variant:"outline",children:[t.jsx(nN,{className:"h-4 w-4"}),"Filtros",d>0&&t.jsx(Ve,{className:"ml-1 flex h-5 w-5 items-center justify-center rounded-full bg-primary p-0 text-[10px] text-primary-foreground",variant:"secondary",children:d})]})}),t.jsx(G0,{align:"end",className:"w-80 p-4",children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h4",{className:"font-medium leading-none",children:"Filtros"}),t.jsx(oe,{className:"h-auto p-0 text-muted-foreground text-xs hover:text-foreground",onClick:u,size:"sm",variant:"ghost",children:"Limpar"})]}),t.jsx(Sa,{}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("h5",{className:"font-medium text-muted-foreground text-sm",children:"Temperatura"}),t.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{id:"frio",label:" Frio"},{id:"morno",label:" Morno"},{id:"quente",label:" Quente"}].map(h=>t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(jr,{checked:a.temperature.includes(h.id),id:`temp-${h.id}`,onCheckedChange:()=>o("temperature",h.id)}),t.jsx(yt,{className:"font-normal text-sm",htmlFor:`temp-${h.id}`,children:h.label})]},h.id))})]}),t.jsx(Sa,{}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("h5",{className:"font-medium text-muted-foreground text-sm",children:"Produtos"}),t.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{id:"trintae3",label:"TrintaE3"},{id:"otb",label:"OTB"},{id:"black_neon",label:"Black Neon"},{id:"comunidade",label:"Comunidade"}].map(h=>t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(jr,{checked:a.products.includes(h.id),id:`prod-${h.id}`,onCheckedChange:()=>o("products",h.id)}),t.jsx(yt,{className:"font-normal text-sm",htmlFor:`prod-${h.id}`,children:h.label})]},h.id))})]}),t.jsx(Sa,{}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("h5",{className:"font-medium text-muted-foreground text-sm",children:"Estgio"}),t.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{id:"novo",label:"Novo"},{id:"primeiro_contato",label:"Primeiro Contato"},{id:"qualificado",label:"Qualificado"},{id:"proposta",label:"Proposta"},{id:"negociacao",label:"Negociao"},{id:"fechado_ganho",label:"Fechado Ganho"},{id:"fechado_perdido",label:"Fechado Perdido"}].map(h=>t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(jr,{checked:a.stages.includes(h.id),id:`stage-${h.id}`,onCheckedChange:()=>o("stages",h.id)}),t.jsx(yt,{className:"font-normal text-sm",htmlFor:`stage-${h.id}`,children:h.label})]},h.id))})]}),t.jsx(Sa,{}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("h5",{className:"font-medium text-muted-foreground text-sm",children:"Origem"}),t.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{id:"instagram",label:"Instagram"},{id:"whatsapp",label:"WhatsApp"},{id:"trafego_pago",label:"Trfego"},{id:"landing_page",label:"Site"}].map(h=>t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(jr,{checked:a.source.includes(h.id),id:`src-${h.id}`,onCheckedChange:()=>o("source",h.id)}),t.jsx(yt,{className:"font-normal text-sm",htmlFor:`src-${h.id}`,children:h.label})]},h.id))})]}),t.jsx(Sa,{}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("h5",{className:"font-medium text-muted-foreground text-sm",children:"Etiquetas"}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r?.map(h=>t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(jr,{checked:a.tags?.includes(h.id),id:`tag-${h.id}`,onCheckedChange:()=>o("tags",h.id)}),t.jsxs(yt,{className:"flex items-center gap-2 font-normal text-sm",htmlFor:`tag-${h.id}`,children:[t.jsx("div",{className:"h-2 w-2 rounded-full",style:{backgroundColor:h.color||"#ccc"}}),h.displayName||h.name]})]},h.id)),(!r||r.length===0)&&t.jsx("p",{className:"col-span-2 text-muted-foreground text-xs italic",children:"Nenhuma etiqueta encontrada."})]})]})]})})]}),d>0&&t.jsx(oe,{onClick:u,size:"icon",title:"Limpar filtros",variant:"ghost",children:t.jsx(ga,{className:"h-4 w-4 text-muted-foreground"})})]})}const BU=C.lazy(()=>Tr(()=>import("./lead-detail-oXUcdKcG.js"),__vite__mapDeps([18,1,2,5,19,3,4,6])).then(e=>({default:e.LeadDetail}))),UU=C.lazy(()=>Tr(()=>import("./pipeline-kanban-Bk8HDh5w.js"),__vite__mapDeps([20,1,2,4,5,19,3,6])).then(e=>({default:e.PipelineKanban}))),zU=C.lazy(()=>Tr(()=>import("./lead-import-dialog-eHveCG7k.js"),__vite__mapDeps([21,1,2,3,4,5,6])).then(e=>({default:e.LeadImportDialog}))),VU=C.lazy(()=>Tr(()=>import("./admin-user-selector-96Z04T6f.js"),__vite__mapDeps([22,1,19,2,3,4,5,6])).then(e=>({default:e.AdminUserSelector}))),up=jt("/_authenticated/crm")({validateSearch:Pa({product:Ke().optional().catch("all")}),component:HU});function HU(){const e=up.useNavigate(),{product:r}=up.useSearch(),[a,n]=C.useState(r||"all"),[i,o]=C.useState({search:"",stages:[],temperature:[],products:[],source:[],tags:[]}),[u,d]=C.useState(null),[h,m]=C.useState(!1),[p,v]=C.useState(null),y=O=>{n(O),e({search:{product:O}})};let N;a!=="all"?N=[a]:i.products.length>0&&(N=i.products);const{data:j}=et.leads.list.useQuery({}),b=j?.data??[],w=b,T=N?b.filter(O=>N.includes(O.interestedProduct)):b,D=et.leads.updateStage.useMutation(),_=async(O,A)=>{try{await D.mutateAsync({leadId:Number(O),newStage:A}),Ie.success("Lead atualizado")}catch{Ie.error("Erro ao atualizar lead")}},R=T.map(O=>({...O,stage:O.stage,temperature:O.temperature})),z={all:w.length,otb:w.filter(O=>O.interestedProduct==="otb").length,black_neon:w.filter(O=>O.interestedProduct==="black_neon").length,trintae3:w.filter(O=>O.interestedProduct==="trintae3").length};return t.jsxs("div",{className:"flex h-[calc(100vh-4rem)] flex-col space-y-4",children:[t.jsxs("div",{className:"flex animate-fade-in-up flex-col gap-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"font-bold font-display text-4xl tracking-tight md:text-5xl",children:"Pipeline de Vendas"}),t.jsx("p",{className:"font-sans text-base text-muted-foreground",children:"Gerencie seus leads e oportunidades"})]}),t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(C.Suspense,{fallback:null,children:t.jsx(VU,{onUserSelect:v,selectedUserId:p})}),t.jsxs(oe,{className:"gap-2",onClick:()=>m(!0),variant:"outline",children:[t.jsx(N0,{className:"h-4 w-4"}),"Importar Leads"]})]})]}),t.jsx(Kc,{onValueChange:y,value:a,children:t.jsxs(Ul,{children:[t.jsxs(Nr,{value:"all",children:["Todos"," ",t.jsx(Ve,{className:"ml-2",variant:"secondary",children:z.all})]}),t.jsxs(Nr,{value:"otb",children:["OTB 2025"," ",t.jsx(Ve,{className:"ml-2",variant:"secondary",children:z.otb})]}),t.jsxs(Nr,{value:"black_neon",children:["NEON"," ",t.jsx(Ve,{className:"ml-2",variant:"secondary",children:z.black_neon})]}),t.jsxs(Nr,{value:"trintae3",children:["TRINTAE3"," ",t.jsx(Ve,{className:"ml-2",variant:"secondary",children:z.trintae3})]})]})}),t.jsx(C.Suspense,{fallback:t.jsx("div",{children:"Carregando filtros..."}),children:t.jsx(PU,{onFiltersChange:O=>o(A=>({...A,...O}))})})]}),t.jsx("div",{className:"flex-1 overflow-hidden",children:j===void 0?t.jsx("div",{className:"flex h-full items-center justify-center text-muted-foreground",children:"Carregando pipeline..."}):t.jsx(C.Suspense,{fallback:t.jsx("div",{children:"Carregando pipeline..."}),children:t.jsx(UU,{leads:R,onDragEnd:_,onLeadClick:O=>d(O)})})}),t.jsx(C.Suspense,{fallback:t.jsx("div",{children:"Carregando detalhes..."}),children:t.jsx(BU,{leadId:u,onClose:()=>d(null)})}),t.jsx(C.Suspense,{fallback:null,children:t.jsx(zU,{onOpenChange:m,open:h})})]})}function GU(){const[e,r]=C.useState([]),[a]=C.useState(!1),[n,i]=C.useState(null),o=C.useCallback(d=>{if(!d.trim())return;const h={role:"user",content:d,timestamp:new Date};r(p=>[...p,h]),Ie.info("Integrao Dify ser migrada em breve");const m={role:"assistant",content:"Integrao com Dify ser migrada para tRPC em breve.",timestamp:new Date};return r(p=>[...p,m]),m.content},[]),u=C.useCallback(()=>{r([]),i(null)},[]);return{messages:e,sendMessage:o,isLoading:a,clearMessages:u}}function qU({conversationId:e,onInsertResponse:r}){const[a,n]=C.useState(!0),[i,o]=C.useState(""),{messages:u,sendMessage:d,isLoading:h}=GU(),{setPendingMessage:m}=Tg(),p=async()=>{if(!i.trim()||h)return;const N=i;o("");const j=await d(N);j&&(r&&r(j),m(j))},v=N=>{let j="";switch(N){case"generate":j="Gere uma resposta profissional para a ltima mensagem do cliente";break;case"summarize":j="Resuma esta conversa em 3 pontos principais";break;case"template":j="Sugira um template de mensagem adequado para esta situao";break;default:j="";break}o(j)},y=N=>{N.key==="Enter"&&!N.shiftKey&&(N.preventDefault(),p())};return t.jsx("div",{className:"border-border border-t bg-background/95 backdrop-blur supports-backdrop-filter:bg-background/60",children:t.jsxs(Bp,{className:"w-full",onOpenChange:n,open:a,children:[t.jsx(Up,{asChild:!0,children:t.jsxs("div",{className:"flex cursor-pointer items-center justify-between border-border/50 border-b bg-gradient-to-r from-primary/10 to-accent/10 px-4 py-2 hover:bg-muted/50",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"rounded-full bg-gradient-to-br from-primary to-accent p-1 shadow-sm",children:t.jsx(zc,{className:"h-3 w-3 text-primary-foreground"})}),t.jsx("span",{className:"font-medium text-foreground text-sm",children:"Assistente IA (Dify)"})]}),a?t.jsx(Il,{className:"h-4 w-4 text-muted-foreground"}):t.jsx($u,{className:"h-4 w-4 text-muted-foreground"})]})}),t.jsx(zp,{children:t.jsxs("div",{className:"space-y-4 p-4",children:[t.jsx(sd,{className:"h-[200px] w-full pr-4",children:t.jsxs("div",{className:"space-y-4",children:[u.length===0?t.jsxs("div",{className:"py-8 text-center text-muted-foreground text-xs",children:[t.jsx("p",{className:"mb-2",children:" Ol! Sou a assistente do Grupo US."}),t.jsx("p",{children:"Como posso ajudar voc com este atendimento hoje?"})]}):u.map((N,j)=>t.jsxs("div",{className:me("flex max-w-[85%] flex-col text-sm",N.role==="user"?"ml-auto items-end":"mr-auto items-start"),children:[t.jsx("div",{className:me("rounded-lg px-3 py-2",N.role==="user"?"bg-gradient-to-br from-primary to-accent text-primary-foreground":"bg-muted text-foreground"),children:N.content}),t.jsx("span",{className:"mt-1 text-[10px] text-muted-foreground",children:N.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},j)),h&&t.jsxs("div",{className:"mr-auto flex items-center gap-1.5 p-2",children:[t.jsx("div",{className:"h-1.5 w-1.5 animate-bounce rounded-full bg-primary [animation-delay:-0.3s]"}),t.jsx("div",{className:"h-1.5 w-1.5 animate-bounce rounded-full bg-primary [animation-delay:-0.15s]"}),t.jsx("div",{className:"h-1.5 w-1.5 animate-bounce rounded-full bg-primary"})]})]})}),t.jsxs("div",{className:"flex flex-wrap gap-2 border-border/50 border-t pt-2",children:[t.jsxs(oe,{className:"h-7 gap-1.5 bg-background/50 text-xs transition-colors hover:border-primary/50 hover:bg-primary/5 hover:text-primary",onClick:()=>v("generate"),size:"sm",variant:"outline",children:[t.jsx(PA,{className:"h-3 w-3"}),"Gerar resposta"]}),t.jsxs(oe,{className:"h-7 gap-1.5 bg-background/50 text-xs transition-colors hover:border-primary/50 hover:bg-primary/5 hover:text-primary",onClick:()=>v("summarize"),size:"sm",variant:"outline",children:[t.jsx(Xc,{className:"h-3 w-3"}),"Resumir conversa"]}),t.jsxs(oe,{className:"h-7 gap-1.5 bg-background/50 text-xs transition-colors hover:border-primary/50 hover:bg-primary/5 hover:text-primary",onClick:()=>v("template"),size:"sm",variant:"outline",children:[t.jsx(an,{className:"h-3 w-3"}),"Sugerir template"]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(dt,{className:"h-9 flex-1 text-sm focus-visible:ring-primary",disabled:h,onChange:N=>o(N.target.value),onKeyDown:y,placeholder:"Digite sua pergunta para a IA de vendas...",value:i}),t.jsxs(oe,{className:me("h-9 w-9 bg-gradient-to-br from-primary to-accent p-0 transition-all hover:from-primary/90 hover:to-accent/90",h&&"cursor-not-allowed opacity-50"),disabled:h,onClick:p,size:"sm",children:[t.jsx(Nn,{className:"h-4 w-4 text-primary-foreground"}),t.jsx("span",{className:"sr-only",children:"Enviar"})]})]})]})})]})})}const Q_=C.createContext(null);function Tg(){const e=C.useContext(Q_);if(!e)throw new Error("useChatContext must be used within ChatPage");return e}const WU=jt("/_authenticated/chat")({component:XU}),YU=[{id:"vendas",label:"Vendas"},{id:"cs",label:"CS"},{id:"suporte",label:"Suporte"}];function XU(){const[e,r]=C.useState("all"),[a,n]=C.useState(""),[i,o]=C.useState(""),u=C.useId(),d=jC(),m=d.find(y=>y.params&&"department"in y.params)?.params?.department||"vendas",v=d.find(y=>y.params&&"id"in y.params)?.params?.id||null;return t.jsx(Q_.Provider,{value:{search:a,statusFilter:e,setSearch:n,setStatusFilter:r,portalTargetId:u,pendingMessage:i,setPendingMessage:o},children:t.jsxs("div",{className:"flex h-[calc(100vh-64px)] flex-col",children:[t.jsxs("div",{className:"flex min-h-0 flex-1",children:[t.jsxs("div",{className:"flex w-80 flex-col border-r bg-background/50",children:[t.jsxs("div",{className:"space-y-3 border-b p-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("h1",{className:"flex items-center gap-2 font-bold text-lg",children:[t.jsx(an,{className:"h-5 w-5 text-purple-500"}),"Chat"]}),t.jsx(oe,{size:"icon",variant:"ghost",children:t.jsx(Tu,{className:"h-4 w-4"})})]}),t.jsx(Kc,{value:m,children:t.jsx(Ul,{className:"grid w-full grid-cols-3",children:YU.map(y=>t.jsx(Nr,{asChild:!0,value:y.id,children:t.jsx(Br,{className:me("data-[state=active]:bg-background"),params:{department:y.id},to:"/chat/$department",children:y.label})},y.id))})}),t.jsxs("div",{className:"relative",children:[t.jsx(Ms,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),t.jsx(dt,{className:"pl-9",onChange:y=>n(y.target.value),placeholder:"Buscar conversas...",value:a})]}),t.jsxs(Rt,{onValueChange:r,value:e,children:[t.jsx(At,{children:t.jsx(Mt,{placeholder:"Filtrar por status"})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"all",children:"Todos"}),t.jsx(ye,{value:"aguardando_atendente",children:"Abertos"}),t.jsx(ye,{value:"em_atendimento",children:"Em Atendimento"}),t.jsx(ye,{value:"aguardando_cliente",children:"Aguardando Cliente"}),t.jsx(ye,{value:"resolvido",children:"Resolvidos"}),t.jsx(ye,{value:"bot_ativo",children:"Bot Ativo"})]})]})]}),t.jsx("div",{className:"min-h-0 flex-1",id:u})]}),t.jsx("div",{className:"flex-1",children:t.jsx(Yc,{})})]}),v&&t.jsx(qU,{conversationId:Number(v),onInsertResponse:y=>{o(y)}})]})})}const $U=jt("/_authenticated/settings/")({component:QU}),Z_={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5,ease:"easeOut"}}},KU={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.1}}};function mn({Icon:e,title:r,description:a,href:n,onClick:i,colorClass:o="from-purple-500/20 to-indigo-500/20",iconColorClass:u="text-purple-500"}){const d=t.jsxs(at.button,{className:me("flex w-full cursor-pointer flex-col items-center gap-3 rounded-xl border p-5 transition-all","bg-background/60 backdrop-blur-sm","hover:border-primary/30 hover:shadow-lg","group"),onClick:i,type:"button",variants:Z_,whileHover:{scale:1.02,y:-2},whileTap:{scale:.98},children:[t.jsx("div",{className:me("flex h-14 w-14 items-center justify-center rounded-full transition-transform group-hover:scale-110",`bg-linear-to-br ${o}`),children:t.jsx(e,{className:me("h-7 w-7",u)})}),t.jsxs("div",{className:"text-center",children:[t.jsx("h3",{className:"mb-1 font-semibold text-sm transition-colors group-hover:text-primary",children:r}),t.jsx("p",{className:"line-clamp-2 text-muted-foreground text-xs",children:a})]}),t.jsx(Sn,{className:"absolute top-3 right-3 h-4 w-4 text-muted-foreground opacity-0 transition-opacity group-hover:opacity-100"})]});return n?t.jsx(Br,{className:"relative block",to:n,children:d}):t.jsx("div",{className:"relative",children:d})}function Gf({title:e,Icon:r,colorClass:a,children:n,className:i}){return t.jsxs(at.div,{className:me("rounded-2xl border p-5 transition-all duration-300","bg-linear-to-b from-card/80 via-card/60 to-card/40","backdrop-blur-sm","hover:border-primary/20 hover:shadow-xl","shadow-[0_4px_20px_rgb(0,0,0,0.04)] dark:shadow-[0_4px_20px_rgb(0,0,0,0.2)]",i),transition:{type:"spring",stiffness:300,damping:25},variants:Z_,whileHover:{y:-4},children:[t.jsxs("div",{className:"mb-5 flex items-center gap-3",children:[t.jsx("div",{className:me("flex h-10 w-10 items-center justify-center rounded-lg",`bg-linear-to-br ${a}`),children:t.jsx(r,{className:"h-5 w-5 text-white"})}),t.jsx("h2",{className:"font-semibold text-lg",children:e})]}),t.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:n})]})}function QU(){return t.jsxs("div",{className:"w-full p-4 sm:p-6 lg:p-8",children:[t.jsxs(at.div,{animate:{opacity:1,y:0},className:"mb-8",initial:{opacity:0,y:-20},children:[t.jsxs("h1",{className:"flex items-center gap-3 font-bold text-2xl sm:text-3xl",children:[t.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-linear-to-br from-purple-500 to-indigo-500",children:t.jsx(Tu,{className:"h-5 w-5 text-white"})}),"Configuraes"]}),t.jsx("p",{className:"mt-2 text-muted-foreground",children:"Gerencie as configuraes do sistema"})]}),t.jsxs(at.div,{animate:"visible",className:"grid grid-cols-1 gap-6 lg:grid-cols-2",initial:"hidden",variants:KU,children:[t.jsxs(Gf,{className:"lg:col-span-2",colorClass:"from-purple-500 to-purple-600",Icon:li,title:"Conta",children:[t.jsx(mn,{colorClass:"from-purple-500/20 to-purple-600/20",description:"Gerencie suas informaes pessoais",href:"/settings/profile",Icon:li,iconColorClass:"text-purple-500",title:"Perfil"}),t.jsx(mn,{colorClass:"from-purple-500/20 to-purple-600/20",description:"Autenticao e controle de acesso",href:"/settings/security",Icon:iN,iconColorClass:"text-purple-500",title:"Segurana"}),t.jsx(mn,{colorClass:"from-purple-500/20 to-purple-600/20",description:"Configure alertas e preferncias",href:"/settings/notifications",Icon:lN,iconColorClass:"text-purple-500",title:"Notificaes"})]}),t.jsxs(Gf,{colorClass:"from-blue-500 to-blue-600",Icon:ya,title:"Equipe",children:[t.jsx(mn,{colorClass:"from-blue-500/20 to-blue-600/20",description:"Gerencie usurios e permisses",href:"/settings/team",Icon:ya,iconColorClass:"text-blue-500",title:"Membros"}),t.jsx(mn,{colorClass:"from-blue-500/20 to-blue-600/20",description:"Configure nveis de acesso",href:"/settings/roles",Icon:S0,iconColorClass:"text-blue-500",title:"Funes e Permisses"})]}),t.jsxs(Gf,{colorClass:"from-green-500 to-green-600",Icon:Tu,title:"Sistema",children:[t.jsx(mn,{colorClass:"from-green-500/20 to-green-600/20",description:"Gerencie etiquetas para leads",href:"/settings/tags",Icon:cN,iconColorClass:"text-green-500",title:"Etiquetas"}),t.jsx(mn,{colorClass:"from-green-500/20 to-green-600/20",description:"Gerencie templates para chat",href:"/settings/templates",Icon:Xc,iconColorClass:"text-green-500",title:"Templates de Mensagem"}),t.jsx(mn,{colorClass:"from-green-500/20 to-green-600/20",description:"Personalize a interface",href:"/settings/appearance",Icon:oN,iconColorClass:"text-green-500",title:"Aparncia"}),t.jsx(mn,{colorClass:"from-green-500/20 to-green-600/20",description:"Configure campos customizados",href:"/settings/custom-fields",Icon:BA,iconColorClass:"text-green-500",title:"Campos Personalizados"})]}),t.jsx(Gf,{className:"lg:col-span-2",colorClass:"from-orange-500 to-orange-600",Icon:jj,title:"Integraes",children:t.jsx(mn,{colorClass:"from-orange-500/20 to-orange-600/20",description:"WhatsApp, Instagram e outros canais",href:"/settings/integrations",Icon:jj,iconColorClass:"text-orange-500",title:"Integraes"})})]})]})}const ZU=jt("/_authenticated/marketing/")({beforeLoad:()=>{throw Gu({to:"/marketing/dashboard"})}}),JU=jt("/_authenticated/chat/")({beforeLoad:()=>{throw Gu({to:"/chat/$department",params:{department:"vendas"}})}}),dp=jt("/_authenticated/students/$studentId")({validateSearch:e=>({search:e.search||"",status:e.status||"all",churnRisk:e.churnRisk||"all",product:e.product||"all",view:(e.view||"grid")==="table"?"table":"grid",page:Math.max(1,Number(e.page)||1),studentId:e||void 0}),component:ez});function ez(){const{studentId:e}=dp.useParams(),r=dp.useNavigate(),a=()=>{r({to:"/students",search:n=>n})};return t.jsx(Mw,{onClose:a,studentId:Number(e)})}var tz=Symbol("radix.slottable");function az(e){const r=({children:a})=>t.jsx(t.Fragment,{children:a});return r.displayName=`${e}.Slottable`,r.__radixId=tz,r}var J_="AlertDialog",[rz]=jp(J_,[uN]),gi=uN(),eE=e=>{const{__scopeAlertDialog:r,...a}=e,n=gi(r);return t.jsx(Sp,{...n,...a,modal:!0})};eE.displayName=J_;var sz="AlertDialogTrigger",tE=C.forwardRef((e,r)=>{const{__scopeAlertDialog:a,...n}=e,i=gi(a);return t.jsx(H2,{...i,...n,ref:r})});tE.displayName=sz;var nz="AlertDialogPortal",aE=e=>{const{__scopeAlertDialog:r,...a}=e,n=gi(r);return t.jsx(wp,{...n,...a})};aE.displayName=nz;var iz="AlertDialogOverlay",rE=C.forwardRef((e,r)=>{const{__scopeAlertDialog:a,...n}=e,i=gi(a);return t.jsx(Ku,{...i,...n,ref:r})});rE.displayName=iz;var Uc="AlertDialogContent",[lz,cz]=rz(Uc),oz=az("AlertDialogContent"),sE=C.forwardRef((e,r)=>{const{__scopeAlertDialog:a,children:n,...i}=e,o=gi(a),u=C.useRef(null),d=Wu(r,u),h=C.useRef(null);return t.jsx(UA,{contentName:Uc,titleName:nE,docsSlug:"alert-dialog",children:t.jsx(lz,{scope:a,cancelRef:h,children:t.jsxs(Qu,{role:"alertdialog",...o,...i,ref:d,onOpenAutoFocus:bp(i.onOpenAutoFocus,m=>{m.preventDefault(),h.current?.focus({preventScroll:!0})}),onPointerDownOutside:m=>m.preventDefault(),onInteractOutside:m=>m.preventDefault(),children:[t.jsx(oz,{children:n}),t.jsx(dz,{contentRef:u})]})})})});sE.displayName=Uc;var nE="AlertDialogTitle",iE=C.forwardRef((e,r)=>{const{__scopeAlertDialog:a,...n}=e,i=gi(a);return t.jsx(Zu,{...i,...n,ref:r})});iE.displayName=nE;var lE="AlertDialogDescription",cE=C.forwardRef((e,r)=>{const{__scopeAlertDialog:a,...n}=e,i=gi(a);return t.jsx(Ju,{...i,...n,ref:r})});cE.displayName=lE;var uz="AlertDialogAction",oE=C.forwardRef((e,r)=>{const{__scopeAlertDialog:a,...n}=e,i=gi(a);return t.jsx(b0,{...i,...n,ref:r})});oE.displayName=uz;var uE="AlertDialogCancel",dE=C.forwardRef((e,r)=>{const{__scopeAlertDialog:a,...n}=e,{cancelRef:i}=cz(uE,a),o=gi(a),u=Wu(r,i);return t.jsx(b0,{...o,...n,ref:u})});dE.displayName=uE;var dz=({contentRef:e})=>{const r=`\`${Uc}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Uc}\` by passing a \`${lE}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Uc}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return C.useEffect(()=>{document.getElementById(e.current?.getAttribute("aria-describedby"))||console.warn(r)},[r,e]),null},fz=eE,hz=tE,mz=aE,fE=rE,hE=sE,mE=oE,xE=dE,pE=iE,gE=cE;const md=fz,xd=hz,xz=mz,vE=C.forwardRef(({className:e,...r},a)=>t.jsx(fE,{className:me("data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80 data-[state=closed]:animate-out data-[state=open]:animate-in",e),...r,ref:a}));vE.displayName=fE.displayName;const eo=C.forwardRef(({className:e,...r},a)=>t.jsxs(xz,{children:[t.jsx(vE,{}),t.jsx(hE,{className:me("data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] fixed top-[50%] left-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=closed]:animate-out data-[state=open]:animate-in sm:rounded-lg",e),ref:a,...r})]}));eo.displayName=hE.displayName;const to=({className:e,...r})=>t.jsx("div",{className:me("flex flex-col space-y-2 text-center sm:text-left",e),...r});to.displayName="AlertDialogHeader";const ao=({className:e,...r})=>t.jsx("div",{className:me("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...r});ao.displayName="AlertDialogFooter";const ro=C.forwardRef(({className:e,...r},a)=>t.jsx(pE,{className:me("font-semibold text-lg",e),ref:a,...r}));ro.displayName=pE.displayName;const so=C.forwardRef(({className:e,...r},a)=>t.jsx(gE,{className:me("text-muted-foreground text-sm",e),ref:a,...r}));so.displayName=gE.displayName;const no=C.forwardRef(({className:e,...r},a)=>t.jsx(mE,{className:me(Ru(),e),ref:a,...r}));no.displayName=mE.displayName;const io=C.forwardRef(({className:e,...r},a)=>t.jsx(xE,{className:me(Ru({variant:"outline"}),"mt-2 sm:mt-0",e),ref:a,...r}));io.displayName=xE.displayName;const q0=zA,W0=VA,pz=C.forwardRef(({className:e,inset:r,children:a,...n},i)=>t.jsxs(mN,{className:me("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",e),ref:i,...n,children:[a,t.jsx(Sn,{className:"ml-auto"})]}));pz.displayName=mN.displayName;const gz=C.forwardRef(({className:e,...r},a)=>t.jsx(xN,{className:me("data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[8rem] origin-[--radix-dropdown-menu-content-transform-origin] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=closed]:animate-out data-[state=open]:animate-in",e),ref:a,...r}));gz.displayName=xN.displayName;const pd=C.forwardRef(({className:e,sideOffset:r=4,...a},n)=>t.jsx(HA,{children:t.jsx(dN,{className:me("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin] data-[state=closed]:animate-out data-[state=open]:animate-in",e),ref:n,sideOffset:r,...a})}));pd.displayName=dN.displayName;const gs=C.forwardRef(({className:e,inset:r,...a},n)=>t.jsx(fN,{className:me("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",r&&"pl-8",e),ref:n,...a}));gs.displayName=fN.displayName;const vz=C.forwardRef(({className:e,children:r,checked:a,...n},i)=>t.jsxs(pN,{checked:a,className:me("relative flex cursor-default select-none items-center rounded-sm py-1.5 pr-2 pl-8 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),ref:i,...n,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:t.jsx(gN,{children:t.jsx(Xu,{className:"h-4 w-4"})})}),r]}));vz.displayName=pN.displayName;const yz=C.forwardRef(({className:e,children:r,...a},n)=>t.jsxs(vN,{className:me("relative flex cursor-default select-none items-center rounded-sm py-1.5 pr-2 pl-8 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),ref:n,...a,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:t.jsx(gN,{children:t.jsx(Z2,{className:"h-2 w-2 fill-current"})})}),r]}));yz.displayName=vN.displayName;const jz=C.forwardRef(({className:e,inset:r,...a},n)=>t.jsx(yN,{className:me("px-2 py-1.5 font-semibold text-sm",r&&"pl-8",e),ref:n,...a}));jz.displayName=yN.displayName;const yE=C.forwardRef(({className:e,...r},a)=>t.jsx(hN,{className:me("-mx-1 my-1 h-px bg-muted",e),ref:a,...r}));yE.displayName=hN.displayName;const bz=jt("/_authenticated/settings/templates")({component:wz}),Nz=Pa({name:Ke().min(2,"Nome deve ter pelo menos 2 caracteres"),category:ui(["abertura","qualificacao","apresentacao","objecao_preco","objecao_tempo","objecao_outros_cursos","follow_up","fechamento","pos_venda","suporte"]),product:ui(["trintae3","otb","black_neon","comunidade","auriculo","na_mesa_certa","geral"]).optional(),content:Ke().min(10,"Contedo deve ter pelo menos 10 caracteres")}),fp={abertura:"Abertura",qualificacao:"Qualificao",apresentacao:"Apresentao",objecao_preco:"Objeo: Preo",objecao_tempo:"Objeo: Tempo",objecao_outros_cursos:"Objeo: Outros Cursos",follow_up:"Follow-up",fechamento:"Fechamento",pos_venda:"Ps-venda",suporte:"Suporte"};function jE(e){Ie.info(`Funcionalidade "${e}" ser implementada em breve.`)}function wz(){const{data:e}=et.templates.list.useQuery(),[r,a]=C.useState(!1),[n,i]=C.useState("all"),o=e?.filter(u=>n==="all"||u.category===n);return t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"flex items-center gap-2 font-bold text-2xl",children:[t.jsx(Xc,{className:"h-6 w-6 text-green-500"}),"Templates de Mensagem"]}),t.jsx("p",{className:"text-muted-foreground",children:"Gerencie respostas rpidas para chat"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs(Rt,{onValueChange:i,value:n,children:[t.jsx(At,{className:"w-[180px]",children:t.jsx(Mt,{placeholder:"Categoria"})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"all",children:"Todas"}),Object.entries(fp).map(([u,d])=>t.jsx(ye,{value:u,children:d},u))]})]}),t.jsxs(_r,{onOpenChange:a,open:r,children:[t.jsx(Qi,{asChild:!0,children:t.jsxs(oe,{className:"gap-2",children:[t.jsx(_n,{className:"h-4 w-4"}),"Novo Template"]})}),t.jsxs(fr,{className:"sm:max-w-[600px]",children:[t.jsx(hr,{children:t.jsx(mr,{children:"Novo Template"})}),t.jsx(l2,{onSuccess:()=>a(!1)})]})]})]})]}),t.jsxs(Ya,{children:[t.jsx(Xa,{children:t.jsxs(Tt,{children:[t.jsx(He,{children:"Nome"}),t.jsx(He,{children:"Categoria"}),t.jsx(He,{children:"Produto"}),t.jsx(He,{children:"Uso"}),t.jsx(He,{children:"Status"}),t.jsx(He,{className:"w-12"})]})}),t.jsx($a,{children:o?.map(u=>t.jsxs(Tt,{children:[t.jsx(Pe,{className:"font-medium",children:u.title}),t.jsx(Pe,{children:t.jsx(Ve,{variant:"outline",children:fp[u.category]})}),t.jsx(Pe,{className:"text-muted-foreground",children:u.product?Ol[u.product]||u.product:"Geral"}),t.jsxs(Pe,{className:"text-muted-foreground",children:[u.usageCount||0,"x"]}),t.jsx(Pe,{children:t.jsx(Ve,{variant:u.isActive?"default":"secondary",children:u.isActive?"Ativo":"Inativo"})}),t.jsx(Pe,{children:t.jsxs(q0,{children:[t.jsx(W0,{asChild:!0,children:t.jsx(oe,{size:"icon",variant:"ghost",children:t.jsx(Ep,{className:"h-4 w-4"})})}),t.jsxs(pd,{align:"end",children:[t.jsxs(_r,{children:[t.jsx(Qi,{asChild:!0,children:t.jsx(gs,{onSelect:d=>d.preventDefault(),children:"Editar"})}),t.jsxs(fr,{className:"sm:max-w-[600px]",children:[t.jsx(hr,{children:t.jsx(mr,{children:"Editar Template"})}),t.jsx(l2,{initialData:{name:u.title,category:u.category,content:u.content,product:u.product??void 0},templateId:u.id})]})]}),t.jsxs(md,{children:[t.jsx(xd,{asChild:!0,children:t.jsxs(gs,{className:"text-destructive",onSelect:d=>d.preventDefault(),children:[t.jsx(al,{className:"mr-2 h-4 w-4"}),"Excluir"]})}),t.jsxs(eo,{children:[t.jsxs(to,{children:[t.jsx(ro,{children:"Excluir template?"}),t.jsxs(so,{children:['Tem certeza que deseja excluir o template "',u.title,'"? Essa ao no pode ser desfeita.']})]}),t.jsxs(ao,{children:[t.jsx(io,{children:"Cancelar"}),t.jsx(no,{className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",onClick:()=>{jE("deleteTemplate")},children:"Excluir"})]})]})]})]})]})})]},u.id))})]})]})}function l2({templateId:e,initialData:r,onSuccess:a}){const n=et.templates.create.useMutation(),i=Zr({resolver:Jr(Nz),defaultValues:r||{name:"",category:"abertura",product:void 0,content:""}}),o=async d=>{try{e?jE("updateTemplate"):(await n.mutateAsync({title:d.name,content:d.content,category:d.category}),Ie.success("Template criado!")),a?.(),i.reset()}catch{Ie.error("Erro ao salvar template")}},u=()=>i.formState.isSubmitting?t.jsxs(t.Fragment,{children:[t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}),"Salvando..."]}):e?"Atualizar":"Criar Template";return t.jsx(es,{...i,children:t.jsxs("form",{className:"space-y-4",onSubmit:i.handleSubmit(o),children:[t.jsx(nt,{control:i.control,name:"name",render:({field:d})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Nome do Template"}),t.jsx(it,{children:t.jsx(dt,{placeholder:"Ex: Abertura Padro",...d})}),t.jsx(xt,{})]})}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(nt,{control:i.control,name:"category",render:({field:d})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Categoria"}),t.jsxs(Rt,{defaultValue:d.value,onValueChange:d.onChange,children:[t.jsx(it,{children:t.jsx(At,{children:t.jsx(Mt,{})})}),t.jsx(kt,{children:Object.entries(fp).map(([h,m])=>t.jsx(ye,{value:h,children:m},h))})]}),t.jsx(xt,{})]})}),t.jsx(nt,{control:i.control,name:"product",render:({field:d})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Produto (Opcional)"}),t.jsxs(Rt,{defaultValue:d.value,onValueChange:d.onChange,children:[t.jsx(it,{children:t.jsx(At,{children:t.jsx(Mt,{placeholder:"Geral"})})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"geral",children:"Geral"}),Object.entries(Ol).map(([h,m])=>t.jsx(ye,{value:h,children:m},h))]})]}),t.jsx(xt,{})]})})]}),t.jsx(nt,{control:i.control,name:"content",render:({field:d})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Contedo"}),t.jsx(it,{children:t.jsx(xi,{className:"min-h-[150px] resize-none",placeholder:"Digite o contedo do template... Use {{nome}}, {{produto}} para variveis.",...d})}),t.jsx(xt,{})]})}),t.jsx("div",{className:"flex justify-end pt-4",children:t.jsx(oe,{disabled:i.formState.isSubmitting,type:"submit",children:u()})})]})})}function Sz(e,r,a,n){var i=this,o=C.useRef(null),u=C.useRef(0),d=C.useRef(0),h=C.useRef(null),m=C.useRef([]),p=C.useRef(),v=C.useRef(),y=C.useRef(e),N=C.useRef(!0),j=C.useRef(),b=C.useRef();y.current=e;var w=typeof window<"u",T=!r&&r!==0&&w;if(typeof e!="function")throw new TypeError("Expected a function");r=+r||0;var D=!!(a=a||{}).leading,_=!("trailing"in a)||!!a.trailing,R=!!a.flushOnExit&&_,z="maxWait"in a,O="debounceOnServer"in a&&!!a.debounceOnServer,A=z?Math.max(+a.maxWait||0,r):null,k=C.useMemo(function(){var E=function(W){var ee=m.current,je=p.current;return m.current=p.current=null,u.current=W,d.current=d.current||W,v.current=y.current.apply(je,ee)},L=function(W,ee){T&&cancelAnimationFrame(h.current),h.current=T?requestAnimationFrame(W):setTimeout(W,ee)},H=function(W){if(!N.current)return!1;var ee=W-o.current;return!o.current||ee>=r||ee<0||z&&W-u.current>=A},I=function(W){return h.current=null,_&&m.current?E(W):(m.current=p.current=null,v.current)},re=function W(){var ee=Date.now();if(D&&d.current===u.current&&ne(),H(ee))return I(ee);if(N.current){var je=r-(ee-o.current),Z=z?Math.min(je,A-(ee-u.current)):je;L(W,Z)}},ne=function(){n&&n({})},ge=function(){if(w||O){var W,ee=Date.now(),je=H(ee);if(m.current=[].slice.call(arguments),p.current=i,o.current=ee,R&&!j.current&&(j.current=function(){var Z;((Z=global.document)==null?void 0:Z.visibilityState)==="hidden"&&b.current.flush()},(W=global.document)==null||W.addEventListener==null||W.addEventListener("visibilitychange",j.current)),je){if(!h.current&&N.current)return u.current=o.current,L(re,r),D?E(o.current):v.current;if(z)return L(re,r),E(o.current)}return h.current||L(re,r),v.current}};return ge.cancel=function(){var W=h.current;W&&(T?cancelAnimationFrame(h.current):clearTimeout(h.current)),u.current=0,m.current=o.current=p.current=h.current=null,W&&n&&n({})},ge.isPending=function(){return!!h.current},ge.flush=function(){return h.current?I(Date.now()):v.current},ge},[D,z,r,A,_,R,T,w,O,n]);return b.current=k,C.useEffect(function(){return N.current=!0,function(){var E;R&&b.current.flush(),j.current&&((E=global.document)==null||E.removeEventListener==null||E.removeEventListener("visibilitychange",j.current),j.current=null),N.current=!1}},[R]),k}function _z(e,r){return e===r}function Ez(e,r,a){var n=_z,i=C.useRef(e),o=C.useState({})[1],u=Sz(C.useCallback(function(h){i.current=h,o({})},[o]),r,a,o),d=C.useRef(e);return n(d.current,e)||(u(e),d.current=e),[i.current,u]}const Tz=Pa({role:ui(["admin","manager","member","sdr","cs","support"]),reason:Ke().optional()});function Cz({open:e,onOpenChange:r,user:a}){const n=et.users.update.useMutation(),i=Zr({resolver:Jr(Tz),defaultValues:{role:a.role,reason:""}}),o=async u=>{try{await n.mutateAsync({userId:Number(a.id),patch:{role:u.role}}),Ie.success("Funo atualizada com sucesso"),r(!1)}catch(d){Ie.error(d.message||"Erro ao atualizar funo")}};return t.jsx(_r,{onOpenChange:r,open:e,children:t.jsxs(fr,{children:[t.jsxs(hr,{children:[t.jsx(mr,{children:"Alterar Funo"}),t.jsxs(ts,{children:["Alterando funo de ",t.jsx("strong",{children:a.name})]})]}),t.jsx(es,{...i,children:t.jsxs("form",{className:"space-y-4",onSubmit:i.handleSubmit(o),children:[t.jsx(nt,{control:i.control,name:"role",render:({field:u})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Nova Funo"}),t.jsxs(Rt,{defaultValue:u.value,onValueChange:u.onChange,children:[t.jsx(it,{children:t.jsx(At,{children:t.jsx(Mt,{})})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"admin",children:"Admin"}),t.jsx(ye,{value:"manager",children:"Gerente"}),t.jsx(ye,{value:"member",children:"Membro"}),t.jsx(ye,{value:"sdr",children:"SDR (Legado)"}),t.jsx(ye,{value:"cs",children:"CS (Legado)"})]})]}),t.jsx(xt,{})]})}),t.jsx(nt,{control:i.control,name:"reason",render:({field:u})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Motivo (Opcional)"}),t.jsx(it,{children:t.jsx(xi,{className:"resize-none",placeholder:"Justificativa para auditoria...",...u})}),t.jsx(xt,{})]})}),t.jsxs(di,{children:[t.jsx(oe,{onClick:()=>r(!1),type:"button",variant:"outline",children:"Cancelar"}),t.jsxs(oe,{disabled:i.formState.isSubmitting,type:"submit",children:[i.formState.isSubmitting&&t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}),"Salvar Alteraes"]})]})]})})]})})}const Az=Pa({email:Ke().email("Email invlido"),role:ui(["admin","manager","member"])});function kz(){const[e,r]=C.useState(!1),a=o=>{throw new Error("Convite de membros via tRPC ainda no implementado")},n=Zr({resolver:Jr(Az),defaultValues:{email:"",role:"member"}}),i=async o=>{try{await a({email:o.email,role:o.role,redirectUrl:`${window.location.origin}/sign-up`}),Ie.success(`Convite enviado para ${o.email}`),r(!1),n.reset()}catch(u){Ie.error(u instanceof Error?u.message:"Erro ao enviar convite")}};return t.jsxs(_r,{onOpenChange:r,open:e,children:[t.jsx(Qi,{asChild:!0,children:t.jsxs(oe,{className:"gap-2",children:[t.jsx(_n,{className:"h-4 w-4"}),"Convidar Membro"]})}),t.jsxs(fr,{children:[t.jsx(hr,{children:t.jsx(mr,{children:"Convidar Membro"})}),t.jsx(es,{...n,children:t.jsxs("form",{className:"space-y-4",onSubmit:n.handleSubmit(i),children:[t.jsx(nt,{control:n.control,name:"email",render:({field:o})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Email"}),t.jsx(it,{children:t.jsx(dt,{placeholder:"email@exemplo.com",...o})}),t.jsx(xt,{})]})}),t.jsx(nt,{control:n.control,name:"role",render:({field:o})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Funo"}),t.jsxs(Rt,{defaultValue:o.value,onValueChange:o.onChange,children:[t.jsx(it,{children:t.jsx(At,{children:t.jsx(Mt,{})})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"admin",children:"Admin"}),t.jsx(ye,{value:"manager",children:"Gerente"}),t.jsx(ye,{value:"member",children:"Membro"})]})]}),t.jsx(xt,{})]})}),t.jsx("div",{className:"flex justify-end pt-4",children:t.jsx(oe,{disabled:n.formState.isSubmitting,type:"submit",children:n.formState.isSubmitting?t.jsxs(t.Fragment,{children:[t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}),"Enviando..."]}):"Enviar Convite"})})]})})]})]})}const Dz=Pa({reason:Ke().min(5,"Motivo  obrigatrio (min 5 caracteres)"),confirmation:oi().refine(e=>e===!0,{message:"Voc deve confirmar que entende as consequncias"})});function Oz({open:e,onOpenChange:r,user:a}){const n=et.users.delete.useMutation(),i=Zr({resolver:Jr(Dz),defaultValues:{reason:"",confirmation:!1}}),o=async u=>{try{await n.mutateAsync({userId:Number(a.id)}),Ie.success("Membro removido com sucesso"),r(!1)}catch(d){Ie.error(d.message||"Erro ao remover membro")}};return t.jsx(_r,{onOpenChange:r,open:e,children:t.jsxs(fr,{className:"border-destructive/50",children:[t.jsxs(hr,{children:[t.jsxs(mr,{className:"flex items-center gap-2 text-destructive",children:[t.jsx(Ll,{className:"h-5 w-5"}),"Remover Membro"]}),t.jsxs(ts,{children:["Esta ao remover ",t.jsx("strong",{children:a.name})," (",a.email,") da equipe. O acesso ser revogado imediatamente."]})]}),t.jsx(es,{...i,children:t.jsxs("form",{className:"space-y-4",onSubmit:i.handleSubmit(o),children:[t.jsx(nt,{control:i.control,name:"reason",render:({field:u})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Motivo da remoo (Auditoria)"}),t.jsx(it,{children:t.jsx(dt,{placeholder:"Ex: Saiu da empresa",...u})}),t.jsx(xt,{})]})}),t.jsx(nt,{control:i.control,name:"confirmation",render:({field:u})=>t.jsxs(st,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[t.jsx(it,{children:t.jsx(jr,{checked:u.value,onCheckedChange:u.onChange})}),t.jsx("div",{className:"space-y-1 leading-none",children:t.jsx(ct,{children:"Entendo que esta ao desativa o usurio"})}),t.jsx(xt,{})]})}),t.jsxs(di,{children:[t.jsx(oe,{onClick:()=>r(!1),type:"button",variant:"outline",children:"Cancelar"}),t.jsxs(oe,{disabled:i.formState.isSubmitting,type:"submit",variant:"destructive",children:[i.formState.isSubmitting&&t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}),"Confirmar Remoo"]})]})]})})]})})}const qc=C.forwardRef(({className:e,...r},a)=>t.jsx(jN,{className:me("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),ref:a,...r}));qc.displayName=jN.displayName;const bE=C.forwardRef(({className:e,...r},a)=>t.jsx(NN,{className:me("aspect-square h-full w-full",e),ref:a,...r}));bE.displayName=NN.displayName;const Wc=C.forwardRef(({className:e,...r},a)=>t.jsx(bN,{className:me("flex h-full w-full items-center justify-center rounded-full bg-muted",e),ref:a,...r}));Wc.displayName=bN.displayName;function Rz({user:e,onClose:r,onEditRole:a,onRemove:n}){return e?t.jsx(Vp,{onOpenChange:i=>!i&&r(),open:!!e,children:t.jsxs(M0,{className:"w-[400px] sm:w-[540px]",children:[t.jsx(F0,{className:"mb-6",children:t.jsx(I0,{children:"Detalhes do Membro"})}),t.jsxs("div",{className:"mb-8 flex flex-col items-center",children:[t.jsx(qc,{className:"mb-4 h-24 w-24",children:t.jsx(Wc,{className:"text-2xl",children:String(e.name).slice(0,2).toUpperCase()})}),t.jsx("h2",{className:"font-bold text-xl",children:e.name}),t.jsx("p",{className:"text-muted-foreground",children:e.email}),t.jsxs("div",{className:"mt-3 flex gap-2",children:[t.jsx(Ve,{variant:"outline",children:e.role}),t.jsx(Ve,{variant:e.isActive?"default":"secondary",children:e.isActive?"Ativo":"Inativo"})]})]}),t.jsxs(Kc,{defaultValue:"info",children:[t.jsxs(Ul,{className:"mb-4 w-full",children:[t.jsx(Nr,{className:"flex-1",value:"info",children:"Informaes"}),t.jsx(Nr,{className:"flex-1",value:"audit",children:"Auditoria"})]}),t.jsxs(ei,{className:"space-y-6",value:"info",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsxs("span",{className:"flex items-center gap-1 text-muted-foreground text-xs",children:[t.jsx(rn,{className:"h-3 w-3"}),"Criado em"]}),t.jsx("p",{className:"font-medium",children:new Date(e.createdAt).toLocaleDateString()})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsxs("span",{className:"flex items-center gap-1 text-muted-foreground text-xs",children:[t.jsx(S0,{className:"h-3 w-3"}),"ID do Sistema"]}),t.jsx("p",{className:"truncate font-mono text-xs",title:String(e.id),children:e.id})]})]}),t.jsxs("div",{className:"space-y-3 border-t pt-4",children:[t.jsx("h3",{className:"mb-2 font-semibold",children:"Aes"}),t.jsxs(oe,{className:"w-full justify-start gap-2",onClick:()=>a(e),variant:"outline",children:[t.jsx(Tp,{className:"h-4 w-4"}),"Alterar Funo"]}),t.jsxs(oe,{className:"w-full justify-start gap-2",onClick:()=>n(e),variant:"destructive",children:[t.jsx(al,{className:"h-4 w-4"}),"Remover Membro"]})]})]}),t.jsx(ei,{value:"audit",children:t.jsxs("div",{className:"rounded-md border bg-muted/50 p-4 text-center text-muted-foreground text-sm",children:["Histrico de auditoria disponvel no painel global.",t.jsx("br",{}),"(Funcionalidade de log especfico em breve)"]})})]})]})}):null}const Mz={owner:"Proprietrio",admin:"Admin",manager:"Gerente",member:"Membro",sdr:"SDR",cs:"CS",support:"Suporte"},Fz={owner:"default",admin:"default",manager:"default",member:"outline",sdr:"secondary",cs:"outline",support:"outline"};function Iz({users:e,isLoading:r,onEdit:a,onRemove:n,onView:i}){return r?t.jsx("div",{className:"space-y-2",children:Array.from({length:5}).map((o,u)=>t.jsx("div",{className:"h-16 w-full animate-pulse rounded-md bg-muted"},u))}):e.length===0?t.jsx("div",{className:"py-12 text-center text-muted-foreground",children:"Nenhum membro encontrado."}):t.jsxs(Ya,{children:[t.jsx(Xa,{children:t.jsxs(Tt,{children:[t.jsx(He,{children:"Membro"}),t.jsx(He,{children:"Email"}),t.jsx(He,{children:"Funo"}),t.jsx(He,{children:"Status"}),t.jsx(He,{className:"w-12"})]})}),t.jsx($a,{children:e.map(o=>t.jsxs(Tt,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>i(o),children:[t.jsx(Pe,{children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(qc,{className:"h-9 w-9",children:t.jsx(Wc,{className:"bg-primary/10 text-primary text-xs",children:o.name?o.name.split(" ").map(u=>u[0]).join("").slice(0,2).toUpperCase():"U"})}),t.jsx("span",{className:"font-medium",children:o.name})]})}),t.jsx(Pe,{className:"text-muted-foreground",children:o.email}),t.jsx(Pe,{children:t.jsx(Ve,{variant:Fz[o.role]||"outline",children:Mz[o.role]||o.role})}),t.jsx(Pe,{children:t.jsx(Ve,{variant:o.inviteStatus==="pending"?"secondary":o.isActive?"default":"secondary",children:o.inviteStatus==="pending"?"Pendente":o.isActive?"Ativo":"Inativo"})}),t.jsx(Pe,{onClick:u=>u.stopPropagation(),children:t.jsxs(q0,{children:[t.jsx(W0,{asChild:!0,children:t.jsx(oe,{size:"icon",variant:"ghost",children:t.jsx(Ep,{className:"h-4 w-4"})})}),t.jsxs(pd,{align:"end",children:[t.jsxs(gs,{onClick:()=>i(o),children:[t.jsx($c,{className:"mr-2 h-4 w-4"}),"Detalhes"]}),t.jsxs(gs,{onClick:()=>a(o),children:[t.jsx(Tp,{className:"mr-2 h-4 w-4"}),"Editar Funo"]}),t.jsxs(gs,{className:"text-destructive",onClick:()=>n(o),children:[t.jsx(al,{className:"mr-2 h-4 w-4"}),"Remover"]})]})]})})]},o.id))})]})}const Lz=jt("/_authenticated/settings/team")({beforeLoad:({context:e})=>{const r=e.auth?.isLoaded,a=e.auth?.orgRole,n=a==="org:admin"||a==="org:owner"||a==="admin"||a==="owner",i=e.auth?.has?.({permission:"team:manage"});if(r&&!n&&!i)throw Ie.error("Voc no tem permisso para acessar o gerenciamento de equipe."),Gu({to:"/settings"})},component:Pz});function Pz(){const[e,r]=C.useState(""),[a]=Ez(e,300),{data:n,isLoading:i}=et.users.list.useQuery(),o=(n??[]).filter(b=>{if(!a)return!0;const w=a.toLowerCase();return b.name?.toLowerCase().includes(w)||b.email?.toLowerCase().includes(w)}),[u,d]=C.useState(null),[h,m]=C.useState(!1),[p,v]=C.useState(!1),y=b=>{d(b),m(!0)},N=b=>{d(b),v(!0)},j=b=>{d(b)};return t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"flex items-center gap-2 font-bold text-2xl",children:[t.jsx(Tp,{className:"h-6 w-6 text-purple-500"}),"Gerenciar Equipe"]}),t.jsx("p",{className:"text-muted-foreground",children:"Adicione e gerencie membros da equipe"})]}),t.jsx(kz,{})]}),t.jsx("div",{className:"flex items-center gap-4",children:t.jsxs("div",{className:"relative max-w-sm flex-1",children:[t.jsx(Ms,{className:"absolute top-2.5 left-2.5 h-4 w-4 text-muted-foreground"}),t.jsx(dt,{className:"pl-8",onChange:b=>r(b.target.value),placeholder:"Buscar por nome ou email...",value:e})]})}),t.jsx(Iz,{isLoading:i,onEdit:y,onRemove:N,onView:j,users:o}),u&&t.jsx(Rz,{onClose:()=>d(null),onEditRole:b=>{d(b),m(!0)},onRemove:b=>{d(b),v(!0)},user:u}),u&&t.jsxs(t.Fragment,{children:[t.jsx(Cz,{onOpenChange:b=>{m(b),b||d(null)},open:h,user:{id:u.id,clerkId:u.clerkId,name:u.name,role:u.role}}),t.jsx(Oz,{onOpenChange:b=>{v(b),b||d(null)},open:p,user:{id:u.id,clerkId:u.clerkId,name:u.name,email:u.email}})]})]})}const Bz=jt("/_authenticated/settings/tags")({component:Uz});function Uz(){const{data:e}=et.tags.list.useQuery(),r=et.useUtils(),a=et.tags.create.useMutation({onSuccess:()=>{r.tags.list.invalidate()}}),n=et.tags.delete.useMutation({onSuccess:()=>{r.tags.list.invalidate()}}),[i,o]=C.useState(!1),[u,d]=C.useState(!1),[h,m]=C.useState(null),[p,v]=C.useState(""),[y,N]=C.useState("#6366f1"),j=C.useId(),b=C.useId(),w=async()=>{if(!p.trim()){Ie.error("O nome da tag  obrigatrio");return}try{await a.mutateAsync({name:p,color:y}),Ie.success("Tag criada com sucesso"),o(!1),v(""),N("#6366f1")}catch(_){Ie.error("Erro ao criar tag. Verifique se j existe."),console.error(_)}},T=async()=>{if(h)try{await n.mutateAsync({tagId:h.id}),Ie.success("Tag removida com sucesso"),d(!1),m(null)}catch(_){Ie.error("Erro ao remover tag. Voc tem permisso de administrador?"),console.error(_)}},D=_=>{m(_),d(!0)};return t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"flex items-center gap-2 font-bold text-2xl",children:[t.jsx(cN,{className:"h-6 w-6 text-green-500"}),"Etiquetas"]}),t.jsx("p",{className:"text-muted-foreground",children:"Gerencie as etiquetas para categorizar seus leads"})]}),t.jsxs(oe,{onClick:()=>o(!0),children:[t.jsx(_n,{className:"mr-2 h-4 w-4"}),"Nova Tag"]})]}),t.jsx("div",{className:"rounded-md border",children:t.jsxs(Ya,{children:[t.jsx(Xa,{children:t.jsxs(Tt,{children:[t.jsx(He,{children:"Cor"}),t.jsx(He,{children:"Nome"}),t.jsx(He,{className:"text-right",children:"Aes"})]})}),t.jsx($a,{children:e&&e.length>0?e.map(_=>t.jsxs(Tt,{children:[t.jsx(Pe,{children:t.jsx("div",{className:"h-6 w-6 rounded-full border",style:{backgroundColor:_.color||"#ccc"}})}),t.jsx(Pe,{className:"font-medium",children:_.name}),t.jsx(Pe,{className:"text-right",children:t.jsx(oe,{className:"text-red-500 hover:bg-red-50 hover:text-red-600",onClick:()=>D(_),size:"icon",variant:"ghost",children:t.jsx(al,{className:"h-4 w-4"})})})]},_.id)):t.jsx(Tt,{children:t.jsx(Pe,{className:"h-24 text-center",colSpan:3,children:e?"Nenhuma tag encontrada.":"Carregando..."})})})]})}),t.jsx(_r,{onOpenChange:o,open:i,children:t.jsxs(fr,{children:[t.jsxs(hr,{children:[t.jsx(mr,{children:"Nova Tag"}),t.jsx(ts,{children:"Crie uma nova etiqueta para organizar seus leads."})]}),t.jsxs("div",{className:"grid gap-4 py-4",children:[t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(yt,{className:"text-right",htmlFor:j,children:"Nome"}),t.jsx(dt,{className:"col-span-3",id:j,onChange:_=>v(_.target.value),placeholder:"Ex: Cliente VIP",value:p})]}),t.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[t.jsx(yt,{className:"text-right",htmlFor:b,children:"Cor"}),t.jsxs("div",{className:"col-span-3 flex items-center gap-2",children:[t.jsx(dt,{className:"h-10 w-20 p-1",id:b,onChange:_=>N(_.target.value),type:"color",value:y}),t.jsx("span",{className:"text-muted-foreground text-sm",children:y})]})]})]}),t.jsxs(di,{children:[t.jsx(oe,{onClick:()=>o(!1),variant:"outline",children:"Cancelar"}),t.jsx(oe,{onClick:w,children:"Criar Tag"})]})]})}),t.jsx(_r,{onOpenChange:d,open:u,children:t.jsxs(fr,{children:[t.jsxs(hr,{children:[t.jsx(mr,{children:"Remover Tag"}),t.jsxs(ts,{children:['Tem certeza que deseja remover a tag "',h?.name,'"? Esta ao remover a tag de todos os leads associados.']})]}),t.jsxs(di,{children:[t.jsx(oe,{onClick:()=>d(!1),variant:"outline",children:"Cancelar"}),t.jsx(oe,{onClick:T,variant:"destructive",children:"Remover"})]})]})})]})}const zz=jt("/_authenticated/settings/security")({component:Vz});function Vz(){const{user:e}=j0(),{signOut:r}=wC(),a=()=>{const n=document.querySelector(".clerk-user-button-trigger");n&&n.click()};return t.jsxs("div",{className:"max-w-4xl space-y-6 p-6",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"flex items-center gap-2 font-bold text-2xl",children:[t.jsx(S0,{className:"h-6 w-6 text-purple-500"}),"Segurana da Conta"]}),t.jsx("p",{className:"text-muted-foreground",children:"Gerencie sua senha e mtodos de autenticao"})]}),t.jsxs(Te,{children:[t.jsxs(Me,{children:[t.jsxs(Le,{className:"flex items-center gap-2",children:[t.jsx(iN,{className:"h-5 w-5 text-purple-500"}),"Autenticao"]}),t.jsx(ta,{children:"Informaes sobre como voc acessa sua conta."})]}),t.jsxs(Ce,{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx("p",{className:"font-medium",children:"Senha"}),t.jsx("p",{className:"text-muted-foreground text-sm",children:"Sua senha  gerenciada de forma segura pelo nosso provedor de identidade."})]}),t.jsx(oe,{onClick:a,variant:"outline",children:"Mudar Senha"})]}),t.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx("p",{className:"font-medium",children:"Multi-Fator de Autenticao (MFA)"}),t.jsx("p",{className:"text-muted-foreground text-sm",children:"Adicione uma camada extra de segurana."})]}),t.jsx(Ve,{variant:e?.twoFactorEnabled?"default":"secondary",children:e?.twoFactorEnabled?"Ativado":"Desativado"})]})]})]}),t.jsxs(Te,{children:[t.jsxs(Me,{children:[t.jsxs(Le,{className:"flex items-center gap-2",children:[t.jsx(GA,{className:"h-5 w-5 text-purple-500"}),"Sesses Ativas"]}),t.jsx(ta,{children:"Dispositivos conectados  sua conta."})]}),t.jsx(Ce,{className:"space-y-4",children:t.jsxs("div",{className:"flex items-center justify-between rounded-lg border bg-muted/20 p-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-green-100 dark:bg-green-900",children:t.jsx("div",{className:"h-3 w-3 animate-pulse rounded-full bg-green-500"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:"Sesso Atual"}),t.jsxs("p",{className:"flex items-center gap-1 text-muted-foreground text-xs",children:[t.jsx(rn,{className:"h-3 w-3"})," Agora"]})]})]}),t.jsx(oe,{className:"text-destructive hover:bg-destructive/10 hover:text-destructive",onClick:()=>r(),variant:"ghost",children:"Sair"})]})})]})]})}const Hz=jt("/_authenticated/settings/roles")({component:qz}),Gz=[{role:"admin",label:"Administrador",description:"Acesso total a todas as funcionalidades e configuraes.",permissions:["all"]},{role:"sdr",label:"SDR (Vendas)",description:"Focado em gesto de leads, CRM e conversas de vendas.",permissions:["leads:read","leads:write","conversations:read","conversations:write","students:read"]},{role:"cs",label:"Customer Success",description:"Gesto de alunos, monitoramento de progresso e suporte.",permissions:["students:read","students:write","conversations:read","conversations:write","reports:read"]},{role:"support",label:"Suporte",description:"Atendimento de tickets e resoluo de problemas tcnicos.",permissions:["conversations:read","conversations:write","tickets:read","tickets:write","students:read"]}];function qz(){const{data:e}=et.users.me.useQuery(),r=e?.role==="admin";return t.jsxs("div",{className:"max-w-4xl space-y-6 p-6",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"flex items-center gap-2 font-bold text-2xl",children:[t.jsx(S0,{className:"h-6 w-6 text-purple-500"}),"Funes e Permisses"]}),t.jsx("p",{className:"text-muted-foreground",children:"Visualize os nveis de acesso do sistema"})]}),!r&&t.jsxs("div",{className:"flex items-center gap-2 rounded-lg border border-yellow-500/20 bg-yellow-500/10 p-4 text-yellow-700 dark:text-yellow-400",children:[t.jsx(qA,{className:"h-4 w-4"}),t.jsx("p",{className:"text-sm",children:"Voc est visualizando em modo leitura. Apenas administradores podem editar permisses."})]}),t.jsxs(Te,{children:[t.jsxs(Me,{children:[t.jsx(Le,{children:"Nveis de Acesso"}),t.jsx(ta,{children:"Definio de cada papel dentro da organizao."})]}),t.jsx(Ce,{children:t.jsxs(Ya,{children:[t.jsx(Xa,{children:t.jsxs(Tt,{children:[t.jsx(He,{children:"Funo"}),t.jsx(He,{children:"Descrio"}),t.jsx(He,{children:"Permisses Principais"})]})}),t.jsx($a,{children:Gz.map(a=>t.jsxs(Tt,{children:[t.jsx(Pe,{className:"font-medium",children:t.jsx(Ve,{variant:a.role==="admin"?"default":"outline",children:a.label})}),t.jsx(Pe,{className:"text-muted-foreground",children:a.description}),t.jsx(Pe,{children:t.jsx("div",{className:"flex flex-wrap gap-1",children:a.permissions.map(n=>t.jsx(Ve,{className:"font-normal text-xs",variant:"secondary",children:n},n))})})]},a.role))})]})})]})]})}const Wz=jt("/_authenticated/settings/profile")({component:Xz}),Yz=Pa({name:Ke().min(2,"Nome deve ter pelo menos 2 caracteres"),email:Ke().email()});function Xz(){const{user:e}=j0(),{data:r}=et.users.me.useQuery(),a=et.users.updateProfile.useMutation(),n=Zr({resolver:Jr(Yz),values:{name:r?.name||e?.fullName||"",email:r?.email||e?.primaryEmailAddress?.emailAddress||""}}),i=async o=>{try{await a.mutateAsync({name:o.name}),Ie.success("Perfil atualizado com sucesso!")}catch{Ie.error("Erro ao atualizar perfil")}};return r?t.jsxs("div",{className:"max-w-4xl space-y-6 p-6",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"flex items-center gap-2 font-bold text-2xl",children:[t.jsx(li,{className:"h-6 w-6 text-purple-500"}),"Meu Perfil"]}),t.jsx("p",{className:"text-muted-foreground",children:"Gerencie suas informaes pessoais"})]}),t.jsxs(Te,{children:[t.jsxs(Me,{children:[t.jsx(Le,{children:"Informaes Bsicas"}),t.jsx(ta,{children:"Seus dados de identificao no portal."})]}),t.jsxs(Ce,{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center gap-6",children:[t.jsxs(qc,{className:"h-20 w-20 border-2 border-purple-100",children:[t.jsx(bE,{src:e?.imageUrl}),t.jsx(Wc,{className:"text-xl",children:r.name?.slice(0,2).toUpperCase()})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsx("h3",{className:"font-medium",children:"Foto de Perfil"}),t.jsx("p",{className:"max-w-xs text-muted-foreground text-sm",children:"Sua foto  gerenciada pela sua conta Clerk."})]})]}),t.jsx(es,{...n,children:t.jsxs("form",{className:"space-y-4",onSubmit:n.handleSubmit(i),children:[t.jsx(nt,{control:n.control,name:"name",render:({field:o})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Nome Completo"}),t.jsx(it,{children:t.jsx(dt,{...o})}),t.jsx(xt,{})]})}),t.jsx(nt,{control:n.control,name:"email",render:({field:o})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Email"}),t.jsx(it,{children:t.jsx(dt,{...o,disabled:!0})}),t.jsx(ps,{children:"O email  gerenciado pelo provedor de autenticao."}),t.jsx(xt,{})]})}),t.jsx("div",{className:"flex justify-end",children:t.jsx(oe,{disabled:n.formState.isSubmitting,type:"submit",children:n.formState.isSubmitting?t.jsxs(t.Fragment,{children:[t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}),"Salvando..."]}):"Salvar Alteraes"})})]})})]})]})]}):t.jsx("div",{className:"flex justify-center p-12",children:t.jsx(pt,{className:"h-8 w-8 animate-spin text-purple-500"})})}var Y0="Switch",[$z]=jp(Y0),[Kz,Qz]=$z(Y0),NE=C.forwardRef((e,r)=>{const{__scopeSwitch:a,name:n,checked:i,defaultChecked:o,required:u,disabled:d,value:h="on",onCheckedChange:m,form:p,...v}=e,[y,N]=C.useState(null),j=Wu(r,_=>N(_)),b=C.useRef(!1),w=y?p||!!y.closest("form"):!0,[T,D]=C2({prop:i,defaultProp:o??!1,onChange:m,caller:Y0});return t.jsxs(Kz,{scope:a,checked:T,disabled:d,children:[t.jsx(qu.button,{type:"button",role:"switch","aria-checked":T,"aria-required":u,"data-state":EE(T),"data-disabled":d?"":void 0,disabled:d,value:h,...v,ref:j,onClick:bp(e.onClick,_=>{D(R=>!R),w&&(b.current=_.isPropagationStopped(),b.current||_.stopPropagation())})}),w&&t.jsx(_E,{control:y,bubbles:!b.current,name:n,value:h,checked:T,required:u,disabled:d,form:p,style:{transform:"translateX(-100%)"}})]})});NE.displayName=Y0;var wE="SwitchThumb",SE=C.forwardRef((e,r)=>{const{__scopeSwitch:a,...n}=e,i=Qz(wE,a);return t.jsx(qu.span,{"data-state":EE(i.checked),"data-disabled":i.disabled?"":void 0,...n,ref:r})});SE.displayName=wE;var Zz="SwitchBubbleInput",_E=C.forwardRef(({__scopeSwitch:e,control:r,checked:a,bubbles:n=!0,...i},o)=>{const u=C.useRef(null),d=Wu(u,o),h=WA(a),m=YA(r);return C.useEffect(()=>{const p=u.current;if(!p)return;const v=window.HTMLInputElement.prototype,N=Object.getOwnPropertyDescriptor(v,"checked").set;if(h!==a&&N){const j=new Event("click",{bubbles:n});N.call(p,a),p.dispatchEvent(j)}},[h,a,n]),t.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a,...i,tabIndex:-1,ref:d,style:{...i.style,...m,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});_E.displayName=Zz;function EE(e){return e?"checked":"unchecked"}var TE=NE,Jz=SE;const Ks=C.forwardRef(({className:e,...r},a)=>t.jsx(TE,{className:me("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...r,ref:a,children:t.jsx(Jz,{className:me("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));Ks.displayName=TE.displayName;const eV=jt("/_authenticated/settings/notifications")({component:tV});function tV(){const{data:e}=et.users.me.useQuery(),r=et.users.updateProfile.useMutation(),a=C.useId(),n=C.useId(),i=C.useId(),o=C.useId(),u=C.useId(),h={...{email_leads:!0,email_conversions:!0,chat_alerts:!0,churn_alerts:!0,weekly_digest:!1},...e?.preferences},m=async(p,v)=>{if(e)try{await r({preferences:{...h,[p]:v}})}catch{Ie.error("Erro ao salvar preferncia")}};return t.jsxs("div",{className:"max-w-4xl space-y-6 p-6",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"flex items-center gap-2 font-bold text-2xl",children:[t.jsx(lN,{className:"h-6 w-6 text-purple-500"}),"Notificaes"]}),t.jsx("p",{className:"text-muted-foreground",children:"Escolha como voc quer ser notificado"})]}),t.jsxs(Te,{children:[t.jsxs(Me,{children:[t.jsxs(Le,{className:"flex items-center gap-2",children:[t.jsx(rr,{className:"h-5 w-5 text-purple-500"}),"Notificaes por Email"]}),t.jsx(ta,{children:"Receba atualizaes importantes diretamente na sua caixa de entrada."})]}),t.jsxs(Ce,{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between space-y-0",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx(yt,{className:"font-medium text-base",htmlFor:a,children:"Novos Leads"}),t.jsx("p",{className:"text-muted-foreground text-sm",children:"Seja notificado quando um novo lead for atribudo a voc."})]}),t.jsx(Ks,{checked:h.email_leads,id:a,onCheckedChange:p=>m("email_leads",p)})]}),t.jsx(Sa,{}),t.jsxs("div",{className:"flex items-center justify-between space-y-0",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx(yt,{className:"font-medium text-base",htmlFor:n,children:"Converses (Vendas)"}),t.jsx("p",{className:"text-muted-foreground text-sm",children:"Alerta instantneo quando uma venda for confirmada."})]}),t.jsx(Ks,{checked:h.email_conversions,id:n,onCheckedChange:p=>m("email_conversions",p)})]}),t.jsx(Sa,{}),t.jsxs("div",{className:"flex items-center justify-between space-y-0",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx(yt,{className:"font-medium text-base",htmlFor:i,children:"Resumo Semanal"}),t.jsx("p",{className:"text-muted-foreground text-sm",children:"Receba um relatrio de desempenho toda segunda-feira."})]}),t.jsx(Ks,{checked:h.weekly_digest,id:i,onCheckedChange:p=>m("weekly_digest",p)})]})]})]}),t.jsxs(Te,{children:[t.jsxs(Me,{children:[t.jsxs(Le,{className:"flex items-center gap-2",children:[t.jsx(an,{className:"h-5 w-5 text-purple-500"}),"Alertas em Tempo Real"]}),t.jsx(ta,{children:"Notificaes dentro da plataforma."})]}),t.jsxs(Ce,{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between space-y-0",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx(yt,{className:"font-medium text-base",htmlFor:o,children:"Mensagens de Chat"}),t.jsx("p",{className:"text-muted-foreground text-sm",children:"Som e popup quando chegar uma nova mensagem de cliente."})]}),t.jsx(Ks,{checked:h.chat_alerts,id:o,onCheckedChange:p=>m("chat_alerts",p)})]}),t.jsx(Sa,{}),t.jsxs("div",{className:"flex items-center justify-between space-y-0",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx(yt,{className:"font-medium text-base",htmlFor:u,children:"Risco de Churn"}),t.jsx("p",{className:"text-muted-foreground text-sm",children:"Alertar quando um aluno apresentar alto risco de cancelamento."})]}),t.jsx(Ks,{checked:h.churn_alerts,id:u,onCheckedChange:p=>m("churn_alerts",p)})]})]})]})]})}function aV(){const{data:e}=et.financial.sync.getAutoSyncConfig.useQuery(),r=et.financial.sync.saveAutoSyncConfig.useMutation(),{data:a}=et.financial.sync.getSyncLogs.useQuery({syncType:"customers",limit:1}),[n,i]=C.useState(!1),[o,u]=C.useState(1),[d,h]=C.useState(!0),[m,p]=C.useState(!1),v=C.useId(),y=C.useId(),N=C.useId();C.useEffect(()=>{e&&(i(e.enabled),u(e.intervalHours),h(e.updateExisting))},[e]);const j=async()=>{p(!0);try{await r.mutateAsync({enabled:n,intervalHours:Number(o),updateExisting:d}),Ie.success("Configuraes de sincronizao salvas")}catch{Ie.error("Erro ao salvar configuraes")}finally{p(!1)}},b=a?.[0],w=D=>D==="completed"?"text-green-500":D==="failed"?"text-red-500":"text-blue-500",T=D=>D==="completed"?"Sucesso":D==="failed"?"Falha":"Em andamento";return e===void 0?t.jsx("div",{className:"flex items-center justify-center p-8",children:t.jsx(pt,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):t.jsxs(Te,{children:[t.jsxs(Me,{children:[t.jsxs(Le,{className:"flex items-center gap-2",children:[t.jsx(tl,{className:"h-5 w-5"}),"Sincronizao Automtica"]}),t.jsx(ta,{children:"Configure a importao automtica de alunos do Asaas."})]}),t.jsxs(Ce,{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between space-x-2",children:[t.jsxs(yt,{className:"flex flex-col space-y-1",htmlFor:v,children:[t.jsx("span",{children:"Habilitar Sincronizao Automtica"}),t.jsx("span",{className:"font-normal text-muted-foreground text-xs",children:"O sistema ir buscar novos alunos automaticamente."})]}),t.jsx(Ks,{checked:n,id:v,onCheckedChange:i})]}),t.jsxs("div",{className:"grid gap-2",children:[t.jsx(yt,{htmlFor:y,children:"Intervalo (horas)"}),t.jsx(dt,{className:"max-w-[120px]",disabled:!n,id:y,max:"24",min:"1",onChange:D=>u(Number(D.target.value)),type:"number",value:o}),t.jsx("p",{className:"text-muted-foreground text-xs",children:"Defina a frequncia da sincronizao (mnimo 1 hora)."})]}),t.jsxs("div",{className:"flex items-center justify-between space-x-2",children:[t.jsxs(yt,{className:"flex flex-col space-y-1",htmlFor:N,children:[t.jsx("span",{children:"Atualizar Alunos Existentes"}),t.jsx("span",{className:"font-normal text-muted-foreground text-xs",children:"Se ativado, dados de alunos j cadastrados sero atualizados."})]}),t.jsx(Ks,{checked:d,disabled:!n,id:N,onCheckedChange:h})]}),b&&t.jsxs("div",{className:"rounded-md bg-muted p-3 text-sm",children:[t.jsx("p",{className:"mb-1 font-medium",children:"ltima sincronizao:"}),t.jsxs("div",{className:"flex items-center justify-between text-muted-foreground",children:[t.jsx("span",{children:new Date(b.completedAt||b.startedAt).toLocaleString()}),t.jsx("span",{className:w(b.status),children:T(b.status)})]}),b.status==="completed"&&t.jsxs("p",{className:"mt-1 text-muted-foreground text-xs",children:[b.recordsCreated||0," criados, ",b.recordsUpdated||0," atualizados"]})]})]}),t.jsx(dw,{children:t.jsxs(oe,{className:"ml-auto",disabled:m,onClick:j,children:[m&&t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}),"Salvar Configuraes"]})})]})}function rV(){const[e,r]=C.useState({}),a=n=>{r({...e,[n]:!0});try{Ie.info(`Iniciando sincronizao de ${n}...`),Ie.info("Sincronizao Asaas em implementao via tRPC"),Ie.success("Sincronizao concluda!")}catch(i){Ie.error("Erro na sincronizao",{description:i instanceof Error?i.message:"Erro desconhecido"})}finally{r({...e,[n]:!1})}};return t.jsxs(Te,{children:[t.jsxs(Me,{children:[t.jsx(Le,{children:"Sincronizao Manual"}),t.jsx(ta,{children:"Importe dados do Asaas manualmente"})]}),t.jsx(Ce,{children:t.jsxs("div",{className:"grid gap-2 md:grid-cols-2",children:[t.jsxs(oe,{disabled:e.customers,onClick:()=>a("customers"),variant:"outline",children:[e.customers?t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}):t.jsx(xs,{className:"mr-2 h-4 w-4"}),"Sincronizar Clientes"]}),t.jsxs(oe,{disabled:e.payments,onClick:()=>a("payments"),variant:"outline",children:[e.payments?t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}):t.jsx(xs,{className:"mr-2 h-4 w-4"}),"Sincronizar Pagamentos"]}),t.jsxs(oe,{disabled:e.subscriptions,onClick:()=>a("subscriptions"),variant:"outline",children:[e.subscriptions?t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}):t.jsx(xs,{className:"mr-2 h-4 w-4"}),"Sincronizar Assinaturas"]}),t.jsxs(oe,{disabled:e.all,onClick:()=>a("all"),children:[e.all?t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}):t.jsx(xs,{className:"mr-2 h-4 w-4"}),"Sincronizar Tudo"]})]})})]})}function sV(){return t.jsx("div",{children:"Carregando histrico..."})}function nV(){const e=`${window.location.origin}/asaas/webhook`,r=()=>{navigator.clipboard.writeText(e),Ie.success("URL copiada para a rea de transferncia!")};return t.jsxs(Te,{children:[t.jsxs(Me,{children:[t.jsx(Le,{children:"Configurao de Webhook"}),t.jsx(ta,{children:"Configure webhooks no painel do Asaas"})]}),t.jsxs(Ce,{className:"space-y-4",children:[t.jsxs("div",{className:"flex gap-2",children:[t.jsx(dt,{readOnly:!0,value:e}),t.jsx(oe,{onClick:r,size:"icon",children:t.jsx(wN,{className:"h-4 w-4"})})]}),t.jsxs("div",{className:"rounded-lg bg-muted p-4 text-sm",children:[t.jsx("p",{className:"mb-2 font-medium",children:"Eventos para habilitar no Asaas:"}),t.jsxs("ul",{className:"list-disc space-y-1 pl-4 text-muted-foreground",children:[t.jsx("li",{children:"PAYMENT_CREATED"}),t.jsx("li",{children:"PAYMENT_UPDATED"}),t.jsx("li",{children:"PAYMENT_CONFIRMED"}),t.jsx("li",{children:"PAYMENT_RECEIVED"}),t.jsx("li",{children:"PAYMENT_OVERDUE"}),t.jsx("li",{children:"PAYMENT_DELETED"})]})]})]})]})}function Cg(e){return e&&(e.includes("")||e.startsWith("****"))}function iV(e){if(Cg(e.apiKey))throw new Error("A chave API parece estar mascarada. Por favor, insira a chave completa para testar.");if(!(e.apiKey&&e.baseUrl))throw new Error("Configurao incompleta");return{apiKey:e.apiKey,baseUrl:e.baseUrl}}function lV(e){if(Cg(e.apiKey))throw new Error("A chave API parece estar mascarada. Por favor, insira a chave completa para testar.");if(!(e.apiKey&&e.url&&e.instanceName))throw new Error("Configurao incompleta");return{apiKey:e.apiKey,apiUrl:e.url,instanceName:e.instanceName}}function cV(e){if(Cg(e.apiKey))throw new Error("A chave API parece estar mascarada. Por favor, insira a chave completa para testar.");if(!(e.apiKey&&e.url&&e.appId))throw new Error("Configurao incompleta");return{apiKey:e.apiKey,apiUrl:e.url,appId:e.appId}}function Ax(e){const[r,a]=C.useState(!1),[n,i]=C.useState(null),{data:o}=et.settings.list.useQuery(),u=o?o.find(v=>v.key===`integration_${e}`)?.value:void 0,d=C.useCallback(p=>(Ie.success(`Configuraes de ${e} salvas com sucesso`),!0),[e]),h=C.useCallback(p=>{a(!0),i(null);try{switch(e){case"asaas":iV(p);break;case"evolution":lV(p);break;case"dify":cV(p);break;default:throw new Error("Tipo de integrao invlido")}return Ie.info("Teste de conexo ser implementado em breve"),i({success:!0,message:"Validao local OK"}),{success:!0,message:"Validao local OK"}}catch(v){const N=v.message||"Erro ao testar conexo";return Ie.error(N),i({success:!1,message:N}),{success:!1,message:N}}finally{a(!1)}},[e]),m=C.useCallback(()=>o===void 0?"loading":u?.apiKey?"active":"inactive",[o,u]);return{settings:u||{},loading:o===void 0,saveSettings:d,testConnection:h,isTesting:r,lastTestResult:n,getIntegrationStatus:m}}const CE=jt("/_authenticated/settings/integrations")({component:fV}),oV=Pa({url:Ke().url("URL invlida").min(1,"URL  obrigatria"),apiKey:Ke().min(1,"API Key  obrigatria"),instanceName:Ke().min(1,"Nome da instncia  obrigatrio")}),uV=Pa({url:Ke().url("URL invlida").min(1,"URL  obrigatria"),apiKey:Ke().min(1,"API Key  obrigatria"),appId:Ke().min(1,"App ID  obrigatrio")}),dV=Pa({baseUrl:Ke().url("URL invlida").min(1,"URL  obrigatria"),apiKey:Ke().min(1,"API Key  obrigatria"),environment:ui(["production","sandbox"]),webhookSecret:Ke().optional()});function fV(){const r=CE.useRouteContext().auth?.orgRole,a=r==="org:admin"||r==="org:owner"||r==="admin"||r==="owner",n=Ax("evolution"),i=Zr({resolver:Jr(oV),defaultValues:{url:"",apiKey:"",instanceName:""}});C.useEffect(()=>{n.settings&&!n.loading&&i.reset({url:n.settings.url||"",apiKey:n.settings.apiKey||"",instanceName:n.settings.instanceName||""})},[n.settings,n.loading,i]);const o=Ax("dify"),u=Zr({resolver:Jr(uV),defaultValues:{url:"",apiKey:"",appId:""}});C.useEffect(()=>{o.settings&&!o.loading&&u.reset({url:o.settings.url||"",apiKey:o.settings.apiKey||"",appId:o.settings.appId||""})},[o.settings,o.loading,u]);const d=Ax("asaas"),h=Zr({resolver:Jr(dV),defaultValues:{baseUrl:"https://api.asaas.com/v3",apiKey:"",environment:"production",webhookSecret:""}});C.useEffect(()=>{d.settings&&!d.loading&&h.reset({baseUrl:d.settings.baseUrl||"https://api.asaas.com/v3",apiKey:d.settings.apiKey||"",environment:d.settings.environment||"production",webhookSecret:d.settings.webhookSecret||""})},[d.settings,d.loading,h]);const m=async T=>{if(!a)return Ie.error("Permisso negada");await n.saveSettings(T)},p=async()=>{const T=i.getValues();await n.testConnection(T)},v=async T=>{if(!a)return Ie.error("Permisso negada");await o.saveSettings(T)},y=async()=>{const T=u.getValues();await o.testConnection(T)},N=async T=>{if(!a)return Ie.error("Permisso negada");await d.saveSettings(T)},j=async()=>{const T=h.getValues();await d.testConnection(T)},b=(T,D)=>{if(D?.success)return t.jsxs(Ve,{className:"flex items-center gap-1 border-green-600 text-green-600",variant:"outline",children:[t.jsx(Np,{className:"h-3 w-3"}),"Ativo"]});if(D&&!D.success)return t.jsxs(Ve,{className:"flex items-center gap-1 border-red-600 text-red-600",variant:"outline",children:[t.jsx(w0,{className:"h-3 w-3"}),"Erro"]});switch(T){case"active":return t.jsx(Ve,{className:"border-green-600 text-green-600",variant:"outline",children:"Configurado"});default:return t.jsx(Ve,{className:"border-yellow-600 text-yellow-600",variant:"outline",children:"Em Configurao"})}},w=({status:T,lastResult:D})=>{let _="bg-gray-300";return D?.success?_="bg-green-500":D&&!D.success?_="bg-red-500":T==="active"&&(_="bg-yellow-500"),t.jsx("div",{className:`h-2.5 w-2.5 rounded-full ${_}`})};return a?t.jsxs("div",{className:"max-w-4xl space-y-6 p-6",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"flex items-center gap-2 font-bold text-2xl",children:[t.jsx(Tu,{className:"h-6 w-6 text-purple-500"}),"Integraes"]}),t.jsx("p",{className:"text-muted-foreground",children:"Configure conexes com servios externos"})]}),t.jsxs(Te,{children:[t.jsx(Me,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-green-500/10",children:t.jsx(an,{className:"h-6 w-6 text-green-500"})}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Le,{children:"WhatsApp Business"}),t.jsx(w,{lastResult:n.lastTestResult,status:n.getIntegrationStatus()})]}),t.jsx(ta,{children:"Conecte via Evolution API"})]})]}),b(n.getIntegrationStatus(),n.lastTestResult)]})}),t.jsx(Ce,{className:"space-y-4",children:t.jsx(es,{...i,children:t.jsxs("form",{className:"space-y-4",onSubmit:i.handleSubmit(T=>m(T)),children:[t.jsx(nt,{control:i.control,name:"url",render:({field:T})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Evolution API URL"}),t.jsx(it,{children:t.jsx(dt,{placeholder:"https://api.evolution.com.br",...T})}),t.jsx(xt,{})]})}),t.jsx(nt,{control:i.control,name:"apiKey",render:({field:T})=>t.jsxs(st,{children:[t.jsx(ct,{children:"API Key"}),t.jsx(it,{children:t.jsx(dt,{placeholder:"",type:"password",...T})}),t.jsx(xt,{})]})}),t.jsx(nt,{control:i.control,name:"instanceName",render:({field:T})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Nome da Instncia"}),t.jsx(it,{children:t.jsx(dt,{placeholder:"grupo-us-prod",...T})}),t.jsx(xt,{})]})}),t.jsxs("div",{className:"flex items-center justify-between pt-4",children:[t.jsxs(oe,{disabled:n.isTesting,onClick:p,type:"button",variant:"outline",children:[n.isTesting?t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Testar Conexo"]}),t.jsxs(oe,{disabled:i.formState.isSubmitting,type:"submit",children:[i.formState.isSubmitting&&t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}),"Salvar"]})]})]})})})]}),t.jsxs(Te,{children:[t.jsx(Me,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-purple-500/10",children:t.jsx(lu,{className:"h-6 w-6 text-purple-500"})}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Le,{children:"Dify AI"}),t.jsx(w,{lastResult:o.lastTestResult,status:o.getIntegrationStatus()})]}),t.jsx(ta,{children:"Assistente de IA para atendimento"})]})]}),b(o.getIntegrationStatus(),o.lastTestResult)]})}),t.jsx(Ce,{className:"space-y-4",children:t.jsx(es,{...u,children:t.jsxs("form",{className:"space-y-4",onSubmit:u.handleSubmit(T=>v(T)),children:[t.jsx(nt,{control:u.control,name:"url",render:({field:T})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Dify API URL"}),t.jsx(it,{children:t.jsx(dt,{placeholder:"https://api.dify.ai/v1",...T})}),t.jsx(xt,{})]})}),t.jsx(nt,{control:u.control,name:"apiKey",render:({field:T})=>t.jsxs(st,{children:[t.jsx(ct,{children:"API Key"}),t.jsx(it,{children:t.jsx(dt,{placeholder:"app-",type:"password",...T})}),t.jsx(xt,{})]})}),t.jsx(nt,{control:u.control,name:"appId",render:({field:T})=>t.jsxs(st,{children:[t.jsx(ct,{children:"App ID"}),t.jsx(it,{children:t.jsx(dt,{placeholder:"app-id-here",...T})}),t.jsx(xt,{})]})}),t.jsxs("div",{className:"flex items-center justify-between pt-4",children:[t.jsxs(oe,{disabled:o.isTesting,onClick:y,type:"button",variant:"outline",children:[o.isTesting?t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Testar Conexo"]}),t.jsxs(oe,{disabled:u.formState.isSubmitting,type:"submit",children:[u.formState.isSubmitting&&t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}),"Salvar"]})]})]})})})]}),t.jsxs(Te,{children:[t.jsx(Me,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-lg bg-blue-500/10",children:t.jsx(Bx,{className:"h-6 w-6 text-blue-500"})}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Le,{children:"Asaas Pagamentos"}),t.jsx(w,{lastResult:d.lastTestResult,status:d.getIntegrationStatus()})]}),t.jsx(ta,{children:"Gateway de pagamento brasileiro"})]})]}),b(d.getIntegrationStatus(),d.lastTestResult)]})}),t.jsxs(Ce,{className:"space-y-4",children:[t.jsx(es,{...h,children:t.jsxs("form",{className:"space-y-4",onSubmit:h.handleSubmit(T=>N(T)),children:[t.jsx(nt,{control:h.control,name:"environment",render:({field:T})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Ambiente"}),t.jsxs(Rt,{defaultValue:T.value,onValueChange:T.onChange,children:[t.jsx(it,{children:t.jsx(At,{children:t.jsx(Mt,{placeholder:"Selecione o ambiente"})})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"production",children:"Produo"}),t.jsx(ye,{value:"sandbox",children:"Sandbox"})]})]}),t.jsx(ps,{children:"Use Sandbox para testes sem transaes reais."}),t.jsx(xt,{})]})}),t.jsx(nt,{control:h.control,name:"baseUrl",render:({field:T})=>t.jsxs(st,{children:[t.jsx(ct,{children:"URL Base"}),t.jsx(it,{children:t.jsx(dt,{placeholder:"https://api.asaas.com/v3",...T})}),t.jsx(xt,{})]})}),t.jsx(nt,{control:h.control,name:"apiKey",render:({field:T})=>t.jsxs(st,{children:[t.jsx(ct,{children:"API Key"}),t.jsx(it,{children:t.jsx(dt,{placeholder:"",type:"password",...T})}),t.jsx(ps,{children:'Sua chave de API do Asaas (comea com "$aact...").'}),t.jsx(xt,{})]})}),t.jsx(nt,{control:h.control,name:"webhookSecret",render:({field:T})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Webhook Secret (Opcional)"}),t.jsx(it,{children:t.jsx(dt,{placeholder:"",type:"password",...T})}),t.jsx(xt,{})]})}),t.jsxs("div",{className:"flex items-center justify-between pt-4",children:[t.jsxs(oe,{disabled:d.isTesting,onClick:j,type:"button",variant:"outline",children:[d.isTesting?t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Testar Conexo"]}),t.jsxs(oe,{disabled:h.formState.isSubmitting,type:"submit",children:[h.formState.isSubmitting&&t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}),"Salvar"]})]})]})}),t.jsx("div",{className:"mt-4 rounded-lg bg-muted/50 p-4",children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx(XA,{className:"mt-0.5 h-5 w-5 text-blue-500"}),t.jsxs("div",{className:"text-muted-foreground text-sm",children:[t.jsx("p",{className:"mb-1 font-medium text-foreground",children:"Funcionalidades Suportadas:"}),t.jsxs("ul",{className:"list-disc space-y-1 pl-4",children:[t.jsx("li",{children:"Pagamentos via PIX, Boleto e Carto de Crdito"}),t.jsx("li",{children:"Gesto de Assinaturas Recorrentes"}),t.jsx("li",{children:"Webhooks automticos para atualizao de status"})]})]})]})}),t.jsxs("div",{className:"mt-6 space-y-6 border-t pt-6",children:[t.jsx(rV,{}),t.jsx(Sa,{}),t.jsx(nV,{}),t.jsx(Sa,{}),t.jsx(aV,{}),t.jsx(Sa,{}),t.jsx(sV,{})]})]})]}),t.jsxs(Te,{children:[t.jsx(Me,{children:t.jsx(Le,{children:"Documentao"})}),t.jsxs(Ce,{className:"space-y-2",children:[t.jsx(oe,{asChild:!0,className:"w-full justify-start",variant:"ghost",children:t.jsxs("a",{href:"https://doc.evolution-api.com",rel:"noopener noreferrer",target:"_blank",children:[t.jsx(Fc,{className:"mr-2 h-4 w-4"}),"Evolution API Docs"]})}),t.jsx(oe,{asChild:!0,className:"w-full justify-start",variant:"ghost",children:t.jsxs("a",{href:"https://docs.dify.ai",rel:"noopener noreferrer",target:"_blank",children:[t.jsx(Fc,{className:"mr-2 h-4 w-4"}),"Dify AI Docs"]})}),t.jsx(oe,{asChild:!0,className:"w-full justify-start",variant:"ghost",children:t.jsxs("a",{href:"https://docs.asaas.com",rel:"noopener noreferrer",target:"_blank",children:[t.jsx(Fc,{className:"mr-2 h-4 w-4"}),"Asaas API Docs"]})})]})]})]}):t.jsx("div",{className:"mx-auto max-w-4xl space-y-6 p-6",children:t.jsx(Te,{className:"border-yellow-500/50 bg-yellow-500/10",children:t.jsx(Ce,{className:"pt-6",children:t.jsx("p",{className:"text-muted-foreground text-sm",children:"Voc precisa ser administrador para configurar integraes."})})})})}const hV=Pa({name:Ke().min(2,{message:"Nome deve ter pelo menos 2 caracteres"}),fieldType:ui(["text","number","date","select","multiselect","boolean"]),entityType:ui(["lead","student"]),required:oi().default(!1),options:Ke().optional()});function mV({open:e,onOpenChange:r,initialData:a}){const n=!!a,i={mutateAsync:async y=>{Ie.info("Campos customizados ainda no implementados no novo backend")}},o={mutateAsync:async y=>{Ie.info("Campos customizados ainda no implementados no novo backend")}},u=i.mutateAsync,d=o.mutateAsync,h=Zr({resolver:Jr(hV),defaultValues:{name:a?.name||"",fieldType:a?.fieldType||"text",entityType:a?.entityType||"lead",required:a?.isRequired??!1,options:a?.options?a.options.join(`
`):""}});C.useEffect(()=>{e&&h.reset({name:a?.name||"",fieldType:a?.fieldType||"text",entityType:a?.entityType||"lead",required:a?.isRequired??!1,options:a?.options?a.options.join(`
`):""})},[a,e,h]);const m=h.watch("fieldType"),p=m==="select"||m==="multiselect";async function v(y){try{const N=y.options?y.options.split(`
`).map(j=>j.trim()).filter(j=>j.length>0):void 0;if((y.fieldType==="select"||y.fieldType==="multiselect")&&(!N||N.length===0)){h.setError("options",{message:"Defina pelo menos uma opo"});return}n&&a?(await d({id:a.id,name:y.name,required:y.isRequired,options:N}),Ie.success("Campo atualizado com sucesso")):(await u({name:y.name,fieldType:y.fieldType,entityType:y.entityType,required:y.isRequired,options:N}),Ie.success("Campo criado com sucesso")),r(!1),h.reset()}catch{Ie.error("Erro ao salvar campo")}}return t.jsx(_r,{onOpenChange:r,open:e,children:t.jsxs(fr,{className:"sm:max-w-[500px]",children:[t.jsxs(hr,{children:[t.jsx(mr,{children:n?"Editar Campo Personalizado":"Novo Campo Personalizado"}),t.jsx(ts,{children:"Configure os detalhes do campo abaixo."})]}),t.jsx(es,{...h,children:t.jsxs("form",{className:"space-y-4",onSubmit:h.handleSubmit(v),children:[t.jsx(nt,{control:h.control,name:"name",render:({field:y})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Nome do Campo"}),t.jsx(it,{children:t.jsx(dt,{placeholder:"Ex: Oramento Estimado",...y})}),t.jsx(xt,{})]})}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(nt,{control:h.control,name:"fieldType",render:({field:y})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Tipo de Dado"}),t.jsxs(Rt,{defaultValue:y.value,disabled:n,onValueChange:y.onChange,children:[t.jsx(it,{children:t.jsx(At,{children:t.jsx(Mt,{placeholder:"Selecione o tipo"})})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"text",children:"Texto"}),t.jsx(ye,{value:"number",children:"Nmero"}),t.jsx(ye,{value:"date",children:"Data"}),t.jsx(ye,{value:"boolean",children:"Sim/No"}),t.jsx(ye,{value:"select",children:"Seleo nica"}),t.jsx(ye,{value:"multiselect",children:"Seleo Mltipla"})]})]}),t.jsx(xt,{})]})}),t.jsx(nt,{control:h.control,name:"entityType",render:({field:y})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Entidade"}),t.jsxs(Rt,{defaultValue:y.value,disabled:n,onValueChange:y.onChange,children:[t.jsx(it,{children:t.jsx(At,{children:t.jsx(Mt,{placeholder:"Selecione..."})})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"lead",children:"Lead"}),t.jsx(ye,{value:"student",children:"Aluno"})]})]}),t.jsx(xt,{})]})})]}),p&&t.jsx(nt,{control:h.control,name:"options",render:({field:y})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Opes (uma por linha)"}),t.jsx(it,{children:t.jsx(xi,{className:"min-h-[100px]",placeholder:`Opo 1
Opo 2
Opo 3`,...y})}),t.jsx(ps,{children:"Digite as opes disponveis para seleo, separadas por quebra de linha."}),t.jsx(xt,{})]})}),t.jsx(nt,{control:h.control,name:"required",render:({field:y})=>t.jsxs(st,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[t.jsx(it,{children:t.jsx(jr,{checked:y.value,onCheckedChange:y.onChange})}),t.jsxs("div",{className:"space-y-1 leading-none",children:[t.jsx(ct,{children:"Campo Obrigatrio"}),t.jsx(ps,{children:"Se marcado, o usurio ser obrigado a preencher este campo."})]})]})}),t.jsxs(di,{children:[t.jsx(oe,{onClick:()=>r(!1),type:"button",variant:"outline",children:"Cancelar"}),t.jsx(oe,{type:"submit",children:"Salvar"})]})]})})]})})}function xV(){const[e,r]=C.useState("lead"),[a,n]=C.useState(!1),[i,o]=C.useState(null),{data:u}=et.customFields.list.useQuery({entityType:e}),d=et.customFields.delete.useMutation(),h=y=>{o(y),n(!0)},m=()=>{o(null),n(!0)},p=async y=>{try{await d({id:y}),Ie.success("Campo excludo com sucesso")}catch{Ie.error("Erro ao excluir campo")}},v=y=>({text:"Texto",number:"Nmero",date:"Data",select:"Seleo nica",multiselect:"Seleo Mltipla",boolean:"Sim/No"})[y]||y;return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"font-bold text-2xl tracking-tight",children:"Campos Personalizados"}),t.jsx("p",{className:"text-muted-foreground",children:"Gerencie os campos adicionais para seus leads e alunos."})]}),t.jsxs(oe,{onClick:m,children:[t.jsx(_n,{className:"mr-2 h-4 w-4"}),"Novo Campo"]})]}),t.jsx(mV,{initialData:i,onOpenChange:n,open:a}),t.jsxs(Kc,{className:"space-y-4",defaultValue:"lead",onValueChange:y=>r(y),value:e,children:[t.jsxs(Ul,{children:[t.jsx(Nr,{value:"lead",children:"Leads"}),t.jsx(Nr,{value:"student",children:"Alunos"})]}),t.jsxs(Te,{children:[t.jsxs(Me,{children:[t.jsxs(Le,{children:["Campos de ",e==="lead"?"Leads":"Alunos"]}),t.jsx(ta,{children:"Campos personalizados ativos para este tipo de entidade."})]}),t.jsxs(Ce,{children:[u&&u.length===0&&t.jsxs("div",{className:"flex flex-col items-center justify-center py-10 text-center text-muted-foreground",children:[t.jsx(Cu,{className:"mb-4 h-10 w-10 opacity-20"}),t.jsx("p",{children:"Nenhum campo personalizado encontrado."}),t.jsx(oe,{onClick:m,variant:"link",children:"Criar o primeiro campo"})]}),u&&u.length>0&&t.jsxs(Ya,{children:[t.jsx(Xa,{children:t.jsxs(Tt,{children:[t.jsx(He,{children:"Nome"}),t.jsx(He,{children:"Tipo"}),t.jsx(He,{children:"Obrigatrio"}),t.jsx(He,{children:"Opes"}),t.jsx(He,{className:"text-right",children:"Aes"})]})}),t.jsx($a,{children:u.map(y=>t.jsxs(Tt,{children:[t.jsx(Pe,{className:"font-medium",children:y.name}),t.jsx(Pe,{children:t.jsx(Ve,{variant:"outline",children:v(y.fieldType)})}),t.jsx(Pe,{children:y.isRequired?t.jsx(Ve,{className:"text-xs",variant:"destructive",children:"Sim"}):t.jsx("span",{className:"text-muted-foreground text-sm",children:"No"})}),t.jsx(Pe,{children:y.options?t.jsxs("span",{className:"text-muted-foreground text-xs",children:[y.options.length," opes"]}):"-"}),t.jsxs(Pe,{className:"space-x-2 text-right",children:[t.jsx(oe,{onClick:()=>h(y),size:"icon",variant:"ghost",children:t.jsx(SN,{className:"h-4 w-4"})}),t.jsxs(md,{children:[t.jsx(xd,{asChild:!0,children:t.jsx(oe,{className:"text-destructive",size:"icon",variant:"ghost",children:t.jsx(al,{className:"h-4 w-4"})})}),t.jsxs(eo,{children:[t.jsxs(to,{children:[t.jsx(ro,{children:"Excluir campo personalizado?"}),t.jsx(so,{children:"Tem certeza que deseja excluir este campo? Os dados existentes sero preservados mas o campo ficar oculto."})]}),t.jsxs(ao,{children:[t.jsx(io,{children:"Cancelar"}),t.jsx(no,{onClick:()=>p(y.id),children:"Excluir"})]})]})]})]})]},y.id))})]}),!u&&t.jsxs("div",{className:"space-y-2",children:[t.jsx(gt,{className:"h-10 w-full"}),t.jsx(gt,{className:"h-10 w-full"}),t.jsx(gt,{className:"h-10 w-full"})]})]})]})]})]})}const pV=jt("/_authenticated/settings/custom-fields")({beforeLoad:({context:e})=>{const r=e.auth?.isLoaded,a=e.auth?.orgRole;if(r&&!(a==="org:admin"||a==="org:owner"||a==="admin"||a==="owner"))throw Ie.error("Voc no tem permisso para acessar campos personalizados."),Gu({to:"/settings"})},component:xV}),gV=jt("/_authenticated/settings/appearance")({component:vV});function vV(){const{theme:e,setTheme:r}=Mp();return t.jsxs("div",{className:"max-w-4xl space-y-6 p-6",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"flex items-center gap-2 font-bold text-2xl",children:[t.jsx(oN,{className:"h-6 w-6 text-purple-500"}),"Aparncia"]}),t.jsx("p",{className:"text-muted-foreground",children:"Personalize a interface do sistema"})]}),t.jsxs(Te,{children:[t.jsxs(Me,{children:[t.jsx(Le,{children:"Tema"}),t.jsx(ta,{children:"Escolha como o sistema deve ser exibido."})]}),t.jsx(Ce,{children:t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("button",{className:me("flex flex-col items-center justify-center rounded-xl border-2 p-4 transition-all",e==="light"?"border-purple-500 bg-purple-50/50 dark:bg-purple-900/10":"border-transparent bg-muted/20 hover:bg-muted/40"),onClick:()=>r("light"),type:"button",children:[t.jsx("div",{className:"mb-4 flex h-24 w-full items-center justify-center rounded-lg border bg-white shadow-sm",children:t.jsx(_2,{className:"h-8 w-8 text-orange-500"})}),t.jsx("span",{className:"font-medium",children:"Claro"})]}),t.jsxs("button",{className:me("flex flex-col items-center justify-center rounded-xl border-2 p-4 transition-all",e==="dark"?"border-purple-500 bg-purple-50/50 dark:bg-purple-900/10":"border-transparent bg-muted/20 hover:bg-muted/40"),onClick:()=>r("dark"),type:"button",children:[t.jsx("div",{className:"mb-4 flex h-24 w-full items-center justify-center rounded-lg border border-slate-800 bg-slate-950 shadow-sm",children:t.jsx(E2,{className:"h-8 w-8 text-blue-400"})}),t.jsx("span",{className:"font-medium",children:"Escuro"})]}),t.jsxs("button",{className:me("flex flex-col items-center justify-center rounded-xl border-2 p-4 transition-all",e==="system"?"border-purple-500 bg-purple-50/50 dark:bg-purple-900/10":"border-transparent bg-muted/20 hover:bg-muted/40"),onClick:()=>r("system"),type:"button",children:[t.jsx("div",{className:"mb-4 flex h-24 w-full items-center justify-center rounded-lg border bg-linear-to-r from-white to-slate-950 shadow-sm",children:t.jsx($A,{className:"h-8 w-8 text-slate-500"})}),t.jsx("span",{className:"font-medium",children:"Sistema"})]})]})})]})]})}const yV=jt("/_authenticated/reports/team")({component:jV}),c2={admin:"Admin",sdr:"SDR",cs:"CS",support:"Suporte"};function jV(){const[e,r]=C.useState("30d"),{data:a}=et.metrics.daily.useQuery({period:e}),n=a,{data:i}=et.users.list.useQuery(),o=i;return t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"flex items-center gap-2 font-bold text-2xl",children:[t.jsx(ya,{className:"h-6 w-6 text-primary"}),"Performance da Equipe"]}),t.jsx("p",{className:"text-muted-foreground",children:"Mtricas individuais e rankings"})]}),t.jsxs(Rt,{onValueChange:u=>r(u),value:e,children:[t.jsx(At,{className:"w-[180px]",children:t.jsx(Mt,{})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"7d",children:"ltimos 7 dias"}),t.jsx(ye,{value:"30d",children:"ltimos 30 dias"}),t.jsx(ye,{value:"90d",children:"ltimos 90 dias"}),t.jsx(ye,{value:"year",children:"Este ano"})]})]})]}),t.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:n?.slice(0,3).map((u,d)=>t.jsxs(Te,{className:d===0?"border-yellow-500/50":"",children:[t.jsx(Me,{className:"pb-3",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(Ve,{variant:d===0?"default":"secondary",children:d===0?" Top 1":`#${d+1}`}),t.jsx(KA,{className:`h-5 w-5 ${d===0?"text-yellow-500":"text-muted-foreground"}`})]})}),t.jsxs(Ce,{children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(qc,{className:"h-12 w-12",children:t.jsx(Wc,{className:"bg-primary/10 text-primary",children:u.name.split(" ").map(h=>h[0]).join("").slice(0,2)})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium",children:u.name}),t.jsx("p",{className:"text-muted-foreground text-xs",children:c2[u.role]})]})]}),t.jsxs("div",{className:"mt-4",children:[t.jsx("p",{className:"font-bold text-2xl text-primary",children:u.metric}),t.jsx("p",{className:"text-muted-foreground text-xs",children:u.metricLabel})]})]})]},u.id))}),t.jsxs(Te,{children:[t.jsx(Me,{children:t.jsx(Le,{children:"Ranking Completo"})}),t.jsx(Ce,{children:t.jsxs(Ya,{children:[t.jsx(Xa,{children:t.jsxs(Tt,{children:[t.jsx(He,{className:"w-12",children:"#"}),t.jsx(He,{children:"Membro"}),t.jsx(He,{children:"Funo"}),t.jsx(He,{className:"text-right",children:"Converses"}),t.jsx(He,{className:"text-right",children:"Status"})]})}),t.jsx($a,{children:n?.map((u,d)=>t.jsxs(Tt,{children:[t.jsx(Pe,{className:"font-medium",children:d+1}),t.jsx(Pe,{children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(qc,{className:"h-8 w-8",children:t.jsx(Wc,{className:"bg-primary/10 text-primary text-xs",children:u.name.split(" ").map(h=>h[0]).join("").slice(0,2)})}),t.jsx("span",{children:u.name})]})}),t.jsx(Pe,{children:t.jsx(Ve,{variant:"outline",children:c2[u.role]})}),t.jsx(Pe,{className:"text-right",children:t.jsxs("div",{className:"flex items-center justify-end gap-1",children:[t.jsx(tn,{className:"h-3 w-3 text-green-500"}),t.jsx("span",{className:"font-medium",children:u.metric})]})}),t.jsx(Pe,{className:"text-right",children:t.jsx(Ve,{variant:"default",children:"Ativo"})})]},u.id))})]})})]}),t.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[t.jsxs(Te,{children:[t.jsx(Me,{className:"pb-2",children:t.jsx(Le,{className:"font-medium text-sm",children:"Total de Membros"})}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl",children:o?.length??0}),t.jsx("p",{className:"text-muted-foreground text-xs",children:"Usurios ativos"})]})]}),t.jsxs(Te,{children:[t.jsx(Me,{className:"pb-2",children:t.jsx(Le,{className:"font-medium text-sm",children:"SDRs"})}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl",children:o?.filter(u=>u.role==="sdr").length??0}),t.jsx("p",{className:"text-muted-foreground text-xs",children:"Vendas"})]})]}),t.jsxs(Te,{children:[t.jsx(Me,{className:"pb-2",children:t.jsx(Le,{className:"font-medium text-sm",children:"CS"})}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl",children:o?.filter(u=>u.role==="cs").length??0}),t.jsx("p",{className:"text-muted-foreground text-xs",children:"Customer Success"})]})]})]})]})}const bV=jt("/_authenticated/reports/sales")({component:NV});function NV(){const[e,r]=C.useState("30d"),{data:a}=et.metrics.daily.useQuery({period:e}),n=a;return t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"flex items-center gap-2 font-bold text-2xl",children:[t.jsx($i,{className:"h-6 w-6 text-green-500"}),"Relatrio de Vendas"]}),t.jsx("p",{className:"text-muted-foreground",children:"Anlise detalhada de converses e receita"})]}),t.jsxs(Rt,{onValueChange:i=>r(i),value:e,children:[t.jsx(At,{className:"w-[180px]",children:t.jsx(Mt,{})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"7d",children:"ltimos 7 dias"}),t.jsx(ye,{value:"30d",children:"ltimos 30 dias"}),t.jsx(ye,{value:"90d",children:"ltimos 90 dias"}),t.jsx(ye,{value:"year",children:"Este ano"})]})]})]}),t.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Receita Total"}),t.jsx($i,{className:"h-4 w-4 text-green-500"})]}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl text-green-600",children:cu(n?.revenue??0)}),t.jsxs("p",{className:"text-muted-foreground text-xs",children:[n?.revenueTrend&&n.revenueTrend>0?"+":"",n?.revenueTrend?.toFixed(1),"% vs perodo anterior"]})]})]}),t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Converses"}),t.jsx(tn,{className:"h-4 w-4 text-primary"})]}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl",children:n?.funnel?.fechado_ganho??0}),t.jsxs("p",{className:"text-muted-foreground text-xs",children:["Taxa: ",n?.conversionRate?.toFixed(1),"%"]})]})]}),t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Ticket Mdio"}),t.jsx(z2,{className:"h-4 w-4 text-primary"})]}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl",children:cu((n?.revenue??0)/Math.max(n?.funnel?.fechado_ganho??1,1))}),t.jsx("p",{className:"text-muted-foreground text-xs",children:"Por converso"})]})]}),t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Leads Ativos"}),t.jsx(ya,{className:"h-4 w-4 text-primary"})]}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl",children:n?.totalLeads??0}),t.jsx("p",{className:"text-muted-foreground text-xs",children:"No pipeline"})]})]})]}),t.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[t.jsxs(Te,{children:[t.jsx(Me,{children:t.jsx(Le,{children:"Receita ao Longo do Tempo"})}),t.jsx(Ce,{children:n?.dailyMetrics&&n.dailyMetrics.length>0?t.jsx(a0,{height:300,minWidth:0,width:"100%",children:t.jsxs(kp,{data:n.dailyMetrics,children:[t.jsx(r0,{strokeDasharray:"3 3"}),t.jsx(s0,{dataKey:"date",tickFormatter:i=>{const[,o,u]=i.split("-");return`${u}/${o}`}}),t.jsx(n0,{}),t.jsx(i0,{formatter:i=>cu(Number(i??0)),labelFormatter:i=>`Data: ${i}`}),t.jsx(Ic,{dataKey:"conversionValue",name:"Receita",stroke:"hsl(var(--chart-2))",strokeWidth:2,type:"monotone"})]})}):t.jsx("div",{className:"flex h-[300px] items-center justify-center text-muted-foreground",children:"Sem dados disponveis"})})]}),t.jsxs(Te,{children:[t.jsx(Me,{children:t.jsx(Le,{children:"Converses por Produto"})}),t.jsx(Ce,{children:n?.leadsByProduct&&Object.keys(n.leadsByProduct).length>0?t.jsx(a0,{height:300,minWidth:0,width:"100%",children:t.jsxs(pk,{data:Object.entries(n.leadsByProduct).map(([i,o])=>({name:Ol[i]||i,value:o})),children:[t.jsx(r0,{strokeDasharray:"3 3"}),t.jsx(s0,{dataKey:"name"}),t.jsx(n0,{}),t.jsx(i0,{}),t.jsx(gk,{dataKey:"value",fill:"hsl(var(--primary))",name:"Leads"})]})}):t.jsx("div",{className:"flex h-[300px] items-center justify-center text-muted-foreground",children:"Sem dados disponveis"})})]})]}),t.jsxs(Te,{children:[t.jsx(Me,{children:t.jsx(Le,{children:"Desempenho por Produto"})}),t.jsx(Ce,{children:t.jsxs(Ya,{children:[t.jsx(Xa,{children:t.jsxs(Tt,{children:[t.jsx(He,{children:"Produto"}),t.jsx(He,{className:"text-right",children:"Leads"}),t.jsx(He,{className:"text-right",children:"Converses"}),t.jsx(He,{className:"text-right",children:"Taxa"}),t.jsx(He,{className:"text-right",children:"Receita Est."})]})}),t.jsx($a,{children:n?.leadsByProduct&&Object.entries(n.leadsByProduct).map(([i,o])=>{const u=Math.round(o*(n.conversionRate/100)),d=u*18e3;return t.jsxs(Tt,{children:[t.jsx(Pe,{className:"font-medium",children:Ol[i]||i}),t.jsx(Pe,{className:"text-right",children:o}),t.jsx(Pe,{className:"text-right",children:u}),t.jsxs(Pe,{className:"text-right",children:[n.conversionRate.toFixed(1),"%"]}),t.jsx(Pe,{className:"text-right",children:cu(d)})]},i)})})]})})]})]})}const wV={newsletter:"Newsletter",promocional:"Promocional",transacional:"Transacional",boas_vindas:"Boas-vindas",outro:"Outro"};function SV({template:e,onEdit:r,onDelete:a,onSync:n}){return t.jsxs(Te,{className:"group relative overflow-hidden transition-all hover:shadow-md",children:[t.jsx(Me,{className:"pb-3",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"shrink-0 rounded-lg bg-primary/10 p-2",children:t.jsx(J2,{className:"h-5 w-5 text-primary"})}),t.jsxs("div",{className:"min-w-0",children:[t.jsx(Le,{className:"truncate text-base",children:e.name}),t.jsx(ta,{className:"truncate text-xs",children:e.subject})]})]}),t.jsxs(q0,{children:[t.jsx(W0,{asChild:!0,children:t.jsxs(oe,{className:"h-8 w-8",size:"icon",variant:"ghost",children:[t.jsx("span",{className:"sr-only",children:"Abrir menu"}),t.jsxs("svg",{"aria-label":"Menu de opes",fill:"none",height:"16",role:"img",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",width:"16",xmlns:"http://www.w3.org/2000/svg",children:[t.jsx("circle",{cx:"12",cy:"12",r:"1"}),t.jsx("circle",{cx:"12",cy:"5",r:"1"}),t.jsx("circle",{cx:"12",cy:"19",r:"1"})]})]})}),t.jsxs(pd,{align:"end",children:[t.jsxs(gs,{onClick:()=>r(e.id),children:[t.jsx(ed,{className:"mr-2 h-4 w-4"}),"Editar"]}),t.jsxs(gs,{onClick:()=>n(e.id),children:[t.jsx(tl,{className:"mr-2 h-4 w-4"}),"Sincronizar com Brevo"]}),t.jsx(yE,{}),t.jsxs(gs,{className:"text-destructive focus:text-destructive",onClick:()=>a(e.id),children:[t.jsx(al,{className:"mr-2 h-4 w-4"}),"Excluir"]})]})]})]})}),t.jsxs(Ce,{className:"space-y-3",children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.category&&t.jsx(Ve,{className:"text-xs",variant:"secondary",children:wV[e.category]||e.category}),t.jsx(Ve,{className:`text-xs ${e.isActive?"bg-green-500/10 text-green-600 hover:bg-green-500/20":""}`,variant:e.isActive?"default":"outline",children:e.isActive?t.jsxs(t.Fragment,{children:[t.jsx(ci,{className:"mr-1 h-3 w-3"}),"Ativo"]}):t.jsxs(t.Fragment,{children:[t.jsx(el,{className:"mr-1 h-3 w-3"}),"Inativo"]})}),e.brevoTemplateId&&t.jsx(Ve,{className:"border-blue-300 text-blue-600 text-xs",variant:"outline",children:"Brevo"})]}),t.jsxs("p",{className:"text-muted-foreground text-xs",children:["Atualizado ",bn(e.updatedAt,{addSuffix:!0,locale:Ir})]})]})]})}function Ag(e){const r=hi(),a=e?.useSearch?.(),n=a?.search??"",i=a?.category??"all",{data:o}=et.emailMarketing.templates.list.useQuery(),u=et.emailMarketing.templates.create.useMutation();return{templates:C.useMemo(()=>{if(!o)return;let N=[...o];if(n){const j=n.toLowerCase();N=N.filter(b=>b.name.toLowerCase().includes(j)||b.subject.toLowerCase().includes(j))}return i&&i!=="all"&&(N=N.filter(j=>j.category===i)),N},[o,n,i]),isLoading:o===void 0,filters:{search:n,category:i},handleCreateTemplate:async N=>{try{const j=await u.mutateAsync(N);return Ie.success("Template criado com sucesso"),r({to:"/marketing/templates",search:{search:"",category:"all"}}),j}catch(j){throw Ie.error("Falha ao criar template"),j}},handleUpdateTemplate:(N,j)=>{Ie.info("Atualizao de template em breve")},handleDeleteTemplate:N=>{Ie.info("Excluso de template em breve")},handleSyncTemplate:N=>{Ie.info("Sincronizao com Brevo em breve")},handleFilterChange:(N,j)=>{r({to:"/marketing/templates",search:{search:N==="search"?j:n,category:N==="category"?j:i}})}}}const _V=Pa({search:Ke().catch(""),category:Ke().catch("all")}),AE=jt("/_authenticated/marketing/templates")({component:EV,validateSearch:_V});function EV(){const e=hi(),{templates:r,isLoading:a,filters:n,handleFilterChange:i,handleDeleteTemplate:o,handleSyncTemplate:u}=Ag(AE);return t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"font-bold text-2xl tracking-tight",children:"Templates de Email"}),t.jsx("p",{className:"text-muted-foreground",children:"Gerencie seus modelos de email reutilizveis."})]}),t.jsx(Br,{search:{search:"",category:"all"},to:"/marketing/templates/novo",children:t.jsxs(oe,{children:[t.jsx(_n,{className:"mr-2 h-4 w-4"}),"Novo Template"]})})]}),t.jsxs("div",{className:"flex flex-col items-center gap-4 sm:flex-row",children:[t.jsxs("div",{className:"relative w-full sm:w-72",children:[t.jsx(Ms,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),t.jsx(dt,{className:"pl-9",onChange:d=>i("search",d.target.value),placeholder:"Buscar templates...",value:n.search})]}),t.jsxs(Rt,{onValueChange:d=>i("category",d),value:n.category,children:[t.jsx(At,{className:"w-full sm:w-[180px]",children:t.jsx(Mt,{placeholder:"Categoria"})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"all",children:"Todas"}),t.jsx(ye,{value:"newsletter",children:"Newsletter"}),t.jsx(ye,{value:"promocional",children:"Promocional"}),t.jsx(ye,{value:"transacional",children:"Transacional"}),t.jsx(ye,{value:"boas_vindas",children:"Boas-vindas"}),t.jsx(ye,{value:"outro",children:"Outro"})]})]})]}),a?t.jsx("div",{className:"flex h-64 items-center justify-center",children:t.jsx(pt,{className:"h-8 w-8 animate-spin text-primary"})}):t.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:[r?.map(d=>t.jsx(SV,{onDelete:o,onEdit:h=>{e({to:"/marketing/templates/$templateId",params:{templateId:h},search:{search:"",category:"all"}})},onSync:u,template:d},d.id)),r?.length===0&&t.jsxs("div",{className:"col-span-full rounded-lg border-2 border-dashed bg-muted/50 py-12 text-center",children:[t.jsx("h3",{className:"font-medium text-lg text-muted-foreground",children:"Nenhum template encontrado"}),t.jsx("p",{className:"mt-2 text-muted-foreground text-sm",children:"Crie seu primeiro template para comear."}),t.jsx(Br,{className:"mt-4 inline-block",search:{search:"",category:"all"},to:"/marketing/templates/novo",children:t.jsx(oe,{variant:"outline",children:"Criar Template"})})]})]})]})}const kE=jt("/_authenticated/marketing/nova")({component:CV}),TV=Pa({name:Ke().min(3,{message:"Nome deve ter pelo menos 3 caracteres"}).max(100,{message:"Nome deve ter no mximo 100 caracteres"}),subject:Ke().min(5,{message:"Assunto deve ter pelo menos 5 caracteres"}).max(150,{message:"Assunto deve ter no mximo 150 caracteres"}),htmlContent:Ke().optional(),templateId:Ke().optional(),listIds:kN(Ke()).min(1,{message:"Selecione pelo menos uma lista de destinatrios"})});function CV(){const e=kE.useNavigate(),{data:r}=et.emailMarketing.lists.list.useQuery(),{data:a}=et.emailMarketing.templates.list.useQuery(),n=et.emailMarketing.campaigns.create.useMutation(),i=Zr({resolver:Jr(TV),defaultValues:{name:"",subject:"",htmlContent:"",templateId:void 0,listIds:[]}}),o=i.formState.isSubmitting,u=i.watch("listIds"),d=i.watch("templateId");let h=null,m=null;const p=r?.filter(j=>u.includes(String(j.id))).reduce((j,b)=>j+(b.contactCount??0),0)??0,v=j=>{if(i.setValue("templateId",j==="none"?void 0:j),j&&j!=="none"){const b=a?.find(w=>String(w.id)===j);b?.subject&&!i.getValues("subject")&&i.setValue("subject",b.subject)}};a===void 0?h=t.jsx(ye,{disabled:!0,value:"loading",children:"Carregando templates..."}):a.length===0?h=t.jsx(ye,{disabled:!0,value:"empty",children:"Nenhum template disponvel"}):h=a.map(j=>t.jsxs(ye,{value:String(j.id),children:[j.name,j.category&&t.jsxs("span",{className:"ml-2 text-muted-foreground",children:["(",j.category,")"]})]},j.id)),r===void 0?m=t.jsx("div",{className:"space-y-3",children:[1,2,3].map(j=>t.jsx(gt,{className:"h-10 w-full"},j))}):r.length===0?m=t.jsx("div",{className:"rounded-lg border border-dashed p-4 text-center text-muted-foreground",children:t.jsx("p",{className:"text-sm",children:"Nenhuma lista disponvel"})}):m=r.map(j=>t.jsx(nt,{control:i.control,name:"listIds",render:({field:b})=>{const w=b.value?.includes(String(j.id));return t.jsxs(st,{className:"flex items-center space-x-3 space-y-0",children:[t.jsx(it,{children:t.jsx(jr,{checked:w,onCheckedChange:T=>{const D=b.value||[],_=T?[...D,String(j.id)]:D.filter(R=>R!==String(j.id));b.onChange(_)}})}),t.jsxs("div",{className:"space-y-1 leading-none",children:[t.jsx(ct,{className:"font-medium",children:j.name}),t.jsxs("p",{className:"text-muted-foreground text-sm",children:[j.contactCount??0," contatos"]})]})]})}},j.id));const y=async j=>{try{const b=await n.mutateAsync({name:j.name,subject:j.subject,htmlContent:j.htmlContent||void 0,templateId:j.templateId?Number(j.templateId):void 0,listIds:j.listIds.map(Number)});Ie.success("Campanha criada com sucesso!",{description:"Sua campanha foi salva como rascunho."}),e({to:"/marketing/$campaignId",params:{campaignId:String(b)},search:{search:"",status:"all",view:"grid",page:1}})}catch(b){Ie.error("Erro ao criar campanha",{description:b instanceof Error?b.message:"Ocorreu um erro inesperado. Tente novamente."})}},N=()=>{e({to:"/marketing",search:{search:"",status:"all",view:"grid",page:1}})};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(oe,{onClick:N,size:"icon",variant:"ghost",children:t.jsx(mi,{className:"h-4 w-4"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"font-bold text-2xl tracking-tight",children:"Nova Campanha"}),t.jsx("p",{className:"text-muted-foreground",children:"Crie uma nova campanha de email marketing"})]})]}),t.jsx(es,{...i,children:t.jsx("form",{className:"space-y-6",onSubmit:i.handleSubmit(y),children:t.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[t.jsxs("div",{className:"space-y-6 lg:col-span-2",children:[t.jsxs(Te,{children:[t.jsxs(Me,{children:[t.jsxs(Le,{className:"flex items-center gap-2",children:[t.jsx(rr,{className:"h-5 w-5"}),"Informaes Bsicas"]}),t.jsx(ta,{children:"Configure o nome e assunto da sua campanha"})]}),t.jsxs(Ce,{className:"space-y-4",children:[t.jsx(nt,{control:i.control,name:"name",render:({field:j})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Nome da Campanha *"}),t.jsx(it,{children:t.jsx(dt,{placeholder:"Ex: Newsletter Dezembro 2024",...j})}),t.jsx(ps,{children:"Nome interno para identificar a campanha"}),t.jsx(xt,{})]})}),t.jsx(nt,{control:i.control,name:"subject",render:({field:j})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Assunto do Email *"}),t.jsx(it,{children:t.jsx(dt,{placeholder:"Ex:  Novidades exclusivas para voc!",...j})}),t.jsx(ps,{children:"Este texto aparecer na caixa de entrada do destinatrio"}),t.jsx(xt,{})]})})]})]}),t.jsxs(Te,{children:[t.jsxs(Me,{children:[t.jsxs(Le,{className:"flex items-center gap-2",children:[t.jsx(zc,{className:"h-5 w-5"}),"Contedo"]}),t.jsx(ta,{children:"Escreva o contedo do email ou selecione um template"})]}),t.jsxs(Ce,{className:"space-y-4",children:[t.jsx(nt,{control:i.control,name:"templateId",render:({field:j})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Template (Opcional)"}),t.jsxs(Rt,{onValueChange:v,value:j.value||"none",children:[t.jsx(it,{children:t.jsx(At,{children:t.jsx(Mt,{placeholder:"Selecione um template"})})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"none",children:"Sem template - criar do zero"}),h]})]}),t.jsx(ps,{children:"Use um template existente para agilizar a criao"}),t.jsx(xt,{})]})}),(!d||d==="none")&&t.jsx(nt,{control:i.control,name:"htmlContent",render:({field:j})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Contedo do Email"}),t.jsx(it,{children:t.jsx(xi,{className:"min-h-[200px] font-mono text-sm",placeholder:`Escreva o contedo do seu email aqui...

Voc pode usar HTML para formatao avanada.`,...j})}),t.jsx(ps,{children:"Suporta HTML bsico para formatao"}),t.jsx(xt,{})]})}),d&&d!=="none"&&t.jsxs("div",{className:"rounded-lg border border-dashed p-4 text-center text-muted-foreground",children:[t.jsx(zc,{className:"mx-auto mb-2 h-8 w-8"}),t.jsx("p",{className:"font-medium",children:"Template selecionado"}),t.jsx("p",{className:"text-sm",children:"O contedo do template ser usado no envio."})]})]})]})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs(Te,{children:[t.jsxs(Me,{children:[t.jsxs(Le,{className:"flex items-center gap-2",children:[t.jsx(Cp,{className:"h-5 w-5"}),"Destinatrios *"]}),t.jsx(ta,{children:"Selecione as listas que recebero esta campanha"})]}),t.jsxs(Ce,{children:[t.jsx(nt,{control:i.control,name:"listIds",render:()=>t.jsxs(st,{children:[m,t.jsx(xt,{})]})}),u.length>0&&t.jsxs(t.Fragment,{children:[t.jsx(Sa,{className:"my-4"}),t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsxs("span",{className:"text-muted-foreground",children:[u.length," lista",u.length!==1?"s":""," selecionada",u.length!==1?"s":""]}),t.jsxs(Ve,{variant:"secondary",children:[p," contatos"]})]})]})]})]}),t.jsxs(Te,{children:[t.jsx(Me,{children:t.jsx(Le,{children:"Aes"})}),t.jsxs(Ce,{className:"space-y-3",children:[t.jsx(oe,{className:"w-full",disabled:o,type:"submit",children:o?t.jsxs(t.Fragment,{children:[t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}),"Salvando..."]}):t.jsxs(t.Fragment,{children:[t.jsx(_N,{className:"mr-2 h-4 w-4"}),"Salvar como Rascunho"]})}),t.jsx(oe,{className:"w-full",disabled:o,onClick:N,type:"button",variant:"outline",children:"Cancelar"})]})]}),t.jsx(Te,{className:"border-primary/20 bg-primary/5",children:t.jsx(Ce,{className:"pt-6",children:t.jsxs("p",{className:"text-muted-foreground text-sm",children:[t.jsx("strong",{children:"Dica:"})," Aps salvar, voc poder revisar e enviar a campanha na pgina de detalhes."]})})})]})]})})})]})}const AV=[{value:"trintae3",label:"Trinta e 3"},{value:"otb",label:"OTB"},{value:"black_neon",label:"Black Neon"},{value:"comunidade",label:"Comunidade"},{value:"auriculo",label:"Aurculo"},{value:"na_mesa_certa",label:"Na Mesa Certa"}],kV=Pa({name:Ke().min(3,"Nome deve ter pelo menos 3 caracteres"),description:Ke().optional(),sourceType:ui(["students","leads","both"]),products:kN(Ke()),activeOnly:oi(),qualifiedOnly:oi()});function kg({onSuccess:e}){const[r,a]=C.useState(!1),n=et.emailMarketing.lists.create.useMutation(),i=Zr({resolver:Jr(kV),defaultValues:{name:"",description:"",products:[],activeOnly:!0,qualifiedOnly:!1}}),o=C.useId(),u=C.useId(),d=C.useId(),h=i.watch("sourceType"),m=i.watch("products"),p=i.formState.isSubmitting,v=r?{count:0}:void 0,y=j=>{const b=i.getValues("products");b.includes(j)?i.setValue("products",b.filter(w=>w!==j)):i.setValue("products",[...b,j])};async function N(j){try{const b=await n.mutateAsync({name:j.name,description:j.description||void 0,products:j.products,filters:{activeOnly:j.activeOnly,qualifiedOnly:j.qualifiedOnly}});Ie.success(`Lista criada com ${b.contactCount} contatos!`,{description:"A sincronizao com o Brevo ser iniciada automaticamente."}),a(!1),i.reset(),e?.()}catch(b){Ie.error("Erro ao criar lista",{description:b instanceof Error?b.message:"Tente novamente."})}}return C.useEffect(()=>{r||i.reset()},[r,i]),t.jsxs(_r,{onOpenChange:a,open:r,children:[t.jsx(Qi,{asChild:!0,children:t.jsxs(oe,{className:"gap-2",children:[t.jsx(_n,{className:"h-4 w-4"}),"Nova Lista"]})}),t.jsxs(fr,{className:"sm:max-w-[500px]",children:[t.jsxs(hr,{children:[t.jsx(mr,{children:"Criar Nova Lista"}),t.jsx(ts,{children:"Crie uma lista de contatos baseada em filtros de alunos e/ou leads. A lista ser sincronizada automaticamente com o Brevo."})]}),t.jsx(es,{...i,children:t.jsxs("form",{className:"space-y-4",onSubmit:i.handleSubmit(N),children:[t.jsx(nt,{control:i.control,name:"name",render:({field:j})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Nome da Lista *"}),t.jsx(it,{children:t.jsx(dt,{placeholder:"Ex: Alunos TRINTAE3 Ativos",...j})}),t.jsx(xt,{})]})}),t.jsx(nt,{control:i.control,name:"description",render:({field:j})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Descrio (opcional)"}),t.jsx(it,{children:t.jsx(xi,{className:"resize-none",placeholder:"Descreva o propsito desta lista...",rows:2,...j})}),t.jsx(xt,{})]})}),t.jsx(nt,{control:i.control,name:"sourceType",render:({field:j})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Origem dos Contatos"}),t.jsx(it,{children:t.jsxs(z0,{className:"flex gap-4",defaultValue:j.value,onValueChange:j.onChange,children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(ai,{id:o,value:"students"}),t.jsx(yt,{htmlFor:o,children:"Alunos"})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(ai,{id:u,value:"leads"}),t.jsx(yt,{htmlFor:u,children:"Leads"})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(ai,{id:d,value:"both"}),t.jsx(yt,{htmlFor:d,children:"Ambos"})]})]})}),t.jsx(xt,{})]})}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(yt,{children:"Produtos (selecione um ou mais)"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:AV.map(j=>t.jsx(Ve,{className:"cursor-pointer transition-colors hover:bg-primary/80",onClick:()=>y(j.value),variant:m.includes(j.value)?"default":"outline",children:j.label},j.value))}),t.jsx("p",{className:"text-muted-foreground text-xs",children:m.length===0?"Nenhum produto selecionado (todos sero includos)":`${m.length} produto(s) selecionado(s)`})]}),t.jsxs("div",{className:"space-y-3 rounded-lg border p-3",children:[t.jsx(yt,{className:"font-semibold",children:"Filtros Adicionais"}),(h==="students"||h==="both")&&t.jsx(nt,{control:i.control,name:"activeOnly",render:({field:j})=>t.jsxs(st,{className:"flex items-center gap-2 space-y-0",children:[t.jsx(it,{children:t.jsx(jr,{checked:j.value,onCheckedChange:j.onChange})}),t.jsx(ct,{className:"font-normal",children:"Apenas alunos ativos"})]})}),(h==="leads"||h==="both")&&t.jsx(nt,{control:i.control,name:"qualifiedOnly",render:({field:j})=>t.jsxs(st,{className:"flex items-center gap-2 space-y-0",children:[t.jsx(it,{children:t.jsx(jr,{checked:j.value,onCheckedChange:j.onChange})}),t.jsx(ct,{className:"font-normal",children:"Apenas leads qualificados"})]})})]}),t.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-muted/50 p-3",children:[t.jsx(ya,{className:"h-5 w-5 text-muted-foreground"}),t.jsx("span",{className:"text-sm",children:v===void 0?t.jsx(pt,{className:"inline h-4 w-4 animate-spin"}):t.jsxs(t.Fragment,{children:[t.jsx("strong",{children:v.count})," contatos sero adicionados  lista"]})})]}),t.jsxs(di,{children:[t.jsx(oe,{onClick:()=>a(!1),type:"button",variant:"outline",children:"Cancelar"}),t.jsxs(oe,{disabled:p||v?.count===0,type:"submit",children:[p&&t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}),"Criar Lista"]})]})]})})]})]})}const DE=jt("/_authenticated/marketing/listas")({component:MV});function DV(){return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx(gt,{className:"h-10 w-48"}),t.jsx(gt,{className:"h-10 w-32"})]}),t.jsx(gt,{className:"h-10 w-full max-w-sm"}),t.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[1,2,3,4,5,6].map(e=>t.jsx(gt,{className:"h-40"},e))})]})}function OV(){return t.jsx(Te,{children:t.jsxs(Ce,{className:"flex flex-col items-center justify-center py-12",children:[t.jsx(Cu,{className:"mb-4 h-12 w-12 text-muted-foreground"}),t.jsx("h2",{className:"font-semibold text-lg",children:"Nenhuma lista encontrada"}),t.jsx("p",{className:"mt-2 text-center text-muted-foreground text-sm",children:"Crie sua primeira lista de contatos para comear a segmentar seus destinatrios."}),t.jsx("div",{className:"mt-6",children:t.jsx(kg,{})})]})})}function RV({status:e}){switch(e){case"synced":return t.jsxs(Ve,{className:"gap-1 text-green-600",variant:"outline",children:[t.jsx(TN,{className:"h-3 w-3"}),"Sincronizada"]});case"syncing":return t.jsxs(Ve,{className:"gap-1",variant:"outline",children:[t.jsx(pt,{className:"h-3 w-3 animate-spin"}),"Sincronizando"]});case"error":return t.jsxs(Ve,{className:"gap-1",variant:"destructive",children:[t.jsx(EN,{className:"h-3 w-3"}),"Erro"]});case"pending":return t.jsx(Ve,{className:"gap-1",variant:"secondary",children:"Pendente"});default:return null}}function MV(){const e=DE.useNavigate(),[r,a]=C.useState(""),{data:n}=et.emailMarketing.lists.list.useQuery(),i=n?.filter(h=>(h.name??"").toLowerCase().includes(r.toLowerCase())||(h.description?.toLowerCase().includes(r.toLowerCase())??!1))??[],o=r?t.jsx(Te,{children:t.jsxs(Ce,{className:"flex flex-col items-center justify-center py-12",children:[t.jsx(Ms,{className:"mb-4 h-12 w-12 text-muted-foreground"}),t.jsx("h2",{className:"font-semibold text-lg",children:"Nenhum resultado"}),t.jsxs("p",{className:"mt-2 text-center text-muted-foreground text-sm",children:['No encontramos listas com "',r,'". Tente outro termo.']}),t.jsx(oe,{className:"mt-4",onClick:()=>a(""),variant:"outline",children:"Limpar busca"})]})}):t.jsx(OV,{}),u=()=>{e({to:"/marketing",search:{search:"",status:"all",view:"grid",page:1}})},d=h=>{e({to:"/marketing/listas/$listId",params:{listId:String(h)},search:{search:"",status:"all",view:"grid",page:1}})};return n===void 0?t.jsx(DV,{}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(oe,{onClick:u,size:"icon",variant:"ghost",children:t.jsx(mi,{className:"h-4 w-4"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"font-bold text-2xl tracking-tight",children:"Listas de Contatos"}),t.jsx("p",{className:"text-muted-foreground",children:"Gerencie suas listas de segmentao para campanhas"})]})]}),t.jsx(kg,{})]}),t.jsxs("div",{className:"relative max-w-sm",children:[t.jsx(Ms,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),t.jsx(dt,{className:"pl-9",onChange:h=>a(h.target.value),placeholder:"Buscar listas...",value:r})]}),i.length===0?o:t.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:i.map(h=>t.jsxs(Te,{className:"cursor-pointer transition-colors hover:bg-muted/50",onClick:()=>d(h.id),children:[t.jsxs(Me,{className:"pb-3",children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Cu,{className:"h-5 w-5 text-muted-foreground"}),t.jsx(Le,{className:"text-lg",children:h.name})]}),t.jsx(Ve,{variant:h.isActive?"default":"secondary",children:h.isActive?"Ativa":"Inativa"})]}),h.description&&t.jsx(ta,{className:"line-clamp-2",children:h.description})]}),t.jsx(Ce,{children:t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[t.jsx(ya,{className:"h-4 w-4"}),t.jsxs("span",{children:[h.contactCount??0," contato",(h.contactCount??0)!==1?"s":""]})]}),t.jsx(RV,{status:h.syncStatus})]})})]},h.id))}),n.length>0&&t.jsxs("div",{className:"flex items-center justify-between text-muted-foreground text-sm",children:[t.jsxs("span",{children:[i.length," de ",n.length," lista",n.length!==1?"s":""]}),t.jsxs("span",{children:["Total:"," ",n.reduce((h,m)=>h+(m.contactCount??0),0)," ","contatos"]})]})]})}function FV({className:e,date:r,setDate:a}){let n;return r?.from?r.to?n=t.jsxs(t.Fragment,{children:[Jn(r.from,"dd/MM/yyyy",{locale:Ir})," -"," ",Jn(r.to,"dd/MM/yyyy",{locale:Ir})]}):n=Jn(r.from,"dd/MM/yyyy",{locale:Ir}):n=t.jsx("span",{children:"Selecione uma data"}),t.jsx("div",{className:me("grid gap-2",e),children:t.jsxs(_g,{children:[t.jsx(Eg,{asChild:!0,children:t.jsxs(oe,{className:me("box-border w-[260px] justify-start text-left font-normal",!r&&"text-muted-foreground"),variant:"outline",children:[t.jsx(t0,{className:"mr-2 h-4 w-4"}),n]})}),t.jsx(G0,{align:"start",className:"w-auto p-0",children:t.jsx(X_,{defaultMonth:r?.from,initialFocus:!0,locale:Ir,mode:"range",numberOfMonths:2,onSelect:a,selected:r})})]})})}function IV({search:e,onSearchChange:r,status:a,onStatusChange:n,interest:i,onInterestChange:o,source:u,onSourceChange:d,landingPage:h,onLandingPageChange:m,date:p,onDateChange:v,onClear:y,sourceOptions:N,landingPageOptions:j}){const b=e||a!=="all"||i!=="all"||u!=="all"||h!=="all"||p?.from;return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx(Ms,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),t.jsx(dt,{className:"pl-9",onChange:w=>r(w.target.value),placeholder:"Buscar por nome, email ou telefone...",value:e})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[t.jsx(FV,{date:p,setDate:v}),t.jsxs(Rt,{onValueChange:n,value:a,children:[t.jsx(At,{className:"w-[160px]",children:t.jsx(Mt,{placeholder:"Status"})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"all",children:"Todos Status"}),Object.entries(c0).map(([w,T])=>t.jsx(ye,{value:w,children:T},w))]})]}),t.jsxs(Rt,{onValueChange:o,value:i,children:[t.jsx(At,{className:"w-[180px]",children:t.jsx(Mt,{placeholder:"Interesse"})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"all",children:"Todos Interesses"}),Object.entries(zj).map(([w,T])=>t.jsx(ye,{value:w,children:T},w))]})]}),t.jsxs(Rt,{onValueChange:d,value:u,children:[t.jsx(At,{className:"w-[180px]",children:t.jsx(Mt,{placeholder:"Origem"})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"all",children:"Todas Origens"}),N.map(w=>t.jsx(ye,{value:w,children:w},w))]})]}),t.jsxs(Rt,{onValueChange:m,value:h,children:[t.jsx(At,{className:"w-[180px]",children:t.jsx(Mt,{placeholder:"Landing Page"})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"all",children:"Todas LP's"}),j.map(w=>t.jsx(ye,{value:w,children:w},w))]})]}),b&&t.jsxs(oe,{className:"gap-1",onClick:y,size:"sm",variant:"ghost",children:[t.jsx(ga,{className:"h-4 w-4"}),"Limpar"]})]}),b&&t.jsxs("div",{className:"flex flex-wrap gap-2",children:[e&&t.jsxs(Ve,{className:"gap-1",variant:"secondary",children:['Busca: "',e,'"',t.jsx("button",{className:"ml-1 hover:text-destructive",onClick:()=>r(""),type:"button",children:t.jsx(ga,{className:"h-3 w-3"})})]}),p?.from&&t.jsxs(Ve,{className:"gap-1",variant:"secondary",children:["Perodo: ",p.from.toLocaleDateString("pt-BR"),p.to?` - ${p.to.toLocaleDateString("pt-BR")}`:"",t.jsx("button",{className:"ml-1 hover:text-destructive",onClick:()=>v(void 0),type:"button",children:t.jsx(ga,{className:"h-3 w-3"})})]}),a!=="all"&&t.jsxs(Ve,{className:"gap-1",variant:"secondary",children:["Status: ",c0[a]||a,t.jsx("button",{className:"ml-1 hover:text-destructive",onClick:()=>n("all"),type:"button",children:t.jsx(ga,{className:"h-3 w-3"})})]}),i!=="all"&&t.jsxs(Ve,{className:"gap-1",variant:"secondary",children:["Interesse: ",zj[i]||i,t.jsx("button",{className:"ml-1 hover:text-destructive",onClick:()=>o("all"),type:"button",children:t.jsx(ga,{className:"h-3 w-3"})})]}),u!=="all"&&t.jsxs(Ve,{className:"gap-1",variant:"secondary",children:["Origem: ",u,t.jsx("button",{className:"ml-1 hover:text-destructive",onClick:()=>d("all"),type:"button",children:t.jsx(ga,{className:"h-3 w-3"})})]}),h!=="all"&&t.jsxs(Ve,{className:"gap-1",variant:"secondary",children:["Landing Page: ",h,t.jsx("button",{className:"ml-1 hover:text-destructive",onClick:()=>m("all"),type:"button",children:t.jsx(ga,{className:"h-3 w-3"})})]})]})]})}function LV({stats:e,landingPageStats:r=[]}){return e?t.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Total de Leads"}),t.jsx(ya,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl",children:e.total}),t.jsx("p",{className:"text-muted-foreground text-xs",children:"+180% em relao ao ms anterior (mock)"})]})]}),t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Novos"}),t.jsx(yp,{className:"h-4 w-4 text-blue-500"})]}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl",children:e.new}),t.jsx("p",{className:"text-muted-foreground text-xs",children:"Aguardando contato"})]})]}),t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Contatados"}),t.jsx(an,{className:"h-4 w-4 text-yellow-500"})]}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl",children:e.contacted}),t.jsx("p",{className:"text-muted-foreground text-xs",children:"Em negociao"})]})]}),t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Convertidos"}),t.jsx(ci,{className:"h-4 w-4 text-green-500"})]}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl",children:e.converted}),t.jsxs("p",{className:"text-muted-foreground text-xs",children:["Taxa de converso: ",e.conversionRate,"%"]})]})]}),r.length>0&&t.jsxs(Te,{className:"col-span-full mt-4",children:[t.jsx(Me,{children:t.jsx(Le,{className:"font-medium text-sm",children:"Top Landing Pages"})}),t.jsx(Ce,{children:t.jsx("div",{className:"space-y-4",children:r.slice(0,5).map(a=>t.jsxs("div",{className:"flex items-center",children:[t.jsxs("div",{className:"ml-4 space-y-1",children:[t.jsx("p",{className:"font-medium text-sm leading-none",children:a.name}),t.jsxs("p",{className:"text-muted-foreground text-xs",children:[a.converted," converses (",a.conversionRate.toFixed(1),"%)"]})]}),t.jsx("div",{className:"ml-auto font-medium",children:a.total})]},a.name))})})]})]}):null}function PV(e){const r=MO[e]||"secondary";return t.jsx(Ve,{variant:r,children:c0[e]||e})}function BV({leads:e,onStatusUpdate:r}){return t.jsx("div",{className:"rounded-md border",children:t.jsxs(Ya,{children:[t.jsx(Xa,{children:t.jsxs(Tt,{children:[t.jsx(He,{children:"Contato"}),t.jsx(He,{children:"Interesse"}),t.jsx(He,{children:"Status"}),t.jsx(He,{children:"Origem (UTM)"}),t.jsx(He,{children:"Landing Page"}),t.jsx(He,{children:"Data"}),t.jsx(He,{className:"text-right",children:"Aes"})]})}),t.jsxs($a,{children:[e.map(a=>t.jsxs(Tt,{children:[t.jsx(Pe,{children:t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"font-medium",children:a.name}),t.jsxs("div",{className:"mt-1 flex items-center gap-2 text-muted-foreground text-xs",children:[t.jsx(rr,{className:"h-3 w-3"}),a.email]}),t.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-xs",children:[t.jsx(Yu,{className:"h-3 w-3"}),a.phone]})]})}),t.jsx(Pe,{children:t.jsx(Ve,{variant:"outline",children:a.interest})}),t.jsx(Pe,{children:PV(a.status)}),t.jsx(Pe,{children:t.jsx("span",{className:"text-muted-foreground text-sm",children:a.utmSource||"-"})}),t.jsx(Pe,{children:t.jsx(Ve,{className:"font-mono text-xs",variant:"outline",children:a.landingPage||"-"})}),t.jsx(Pe,{children:t.jsxs("div",{className:"flex flex-col text-muted-foreground text-sm",children:[t.jsx("span",{children:bn(a.createdAt,{addSuffix:!0,locale:Ir})}),a.lgpdConsent&&t.jsxs("span",{className:"flex items-center gap-1 text-[10px] text-green-600",children:[t.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-green-500"}),"LGPD"]})]})}),t.jsx(Pe,{className:"text-right",children:t.jsxs(Rt,{onValueChange:n=>r(a.id,n),value:a.status,children:[t.jsx(At,{className:"ml-auto h-8 w-[140px] text-xs",children:t.jsx(Mt,{placeholder:"Alterar Status"})}),t.jsx(kt,{children:Object.entries(c0).map(([n,i])=>t.jsx(ye,{value:n,children:i},n))})]})})]},a.id)),e.length===0&&t.jsx(Tt,{children:t.jsx(Pe,{className:"h-24 text-center",colSpan:6,children:"Nenhum lead encontrado. Ajuste os filtros ou aguarde novos cadastros."})})]})]})})}function UV(e){const r=hi(),a=e.useSearch(),[n,i]=C.useState(a.search||""),[o,u]=C.useState(a.status||"all"),[d,h]=C.useState(a.interest||"all"),[m,p]=C.useState(a.source||"all"),[v,y]=C.useState(a.landingPage||"all"),[N,j]=C.useState(()=>{if(a.startDate)return{from:new Date(a.startDate),to:a.endDate?new Date(a.endDate):void 0}}),{data:b,isLoading:w}=et.leads.list.useQuery({search:n||void 0,limit:100}),T=b?.data??[],D=(()=>{if(!T||T.length===0)return null;const ne=T.length,ge=T.filter(Z=>Z.stage==="novo").length,W=T.filter(Z=>Z.stage==="contato_feito").length,ee=T.filter(Z=>Z.stage==="cliente").length,je=ne>0?ee/ne*100:0;return{total:ne,new:ge,contacted:W,converted:ee,unsubscribed:0,conversionRate:je.toFixed(1)}})(),_=(ne,ge)=>{Ie.info("Atualizao de status em breve")},R=ne=>{r({to:"/marketing/leads",search:{...a,...ne,page:1}})};return{leads:T,stats:D,landingPageStats:[],isLoading:w,canLoadMore:!1,paginationStatus:"Exhausted",filters:{search:n,status:o,interest:d,source:m,landingPage:v,date:N},options:{sources:[],landingPages:[]},handlers:{onStatusUpdate:_,onSearchChange:ne=>{i(ne),R({search:ne})},onStatusChange:ne=>{u(ne),R({status:ne})},onInterestChange:ne=>{h(ne),R({interest:ne})},onSourceChange:ne=>{p(ne),R({source:ne})},onLandingPageChange:ne=>{y(ne),R({landingPage:ne})},onDateChange:ne=>{j(ne),R({startDate:ne?.from?ne.from.toISOString().split("T")[0]:void 0,endDate:ne?.to?ne.to.toISOString().split("T")[0]:void 0})},onClearFilters:()=>{i(""),u("all"),h("all"),p("all"),y("all"),j(void 0),r({to:"/marketing/leads",search:{page:1,search:void 0,status:void 0,interest:void 0,source:void 0,landingPage:void 0,startDate:void 0,endDate:void 0}})},onExport:()=>{Ie.info("Exportao CSV em breve")},onLoadMore:()=>{}}}}const zV=Pa({page:Ap().catch(1),search:Ke().catch(""),status:Ke().catch("all"),interest:Ke().catch("all"),source:Ke().catch("all"),landingPage:Ke().catch("all"),startDate:Ke().optional(),endDate:Ke().optional()}),OE=jt("/_authenticated/marketing/leads")({component:VV,validateSearch:zV});function VV(){const{leads:e,stats:r,landingPageStats:a,isLoading:n,canLoadMore:i,filters:o,options:u,handlers:d}=UV(OE);return t.jsxs("div",{className:"flex flex-col gap-6 p-6",children:[t.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"font-bold text-2xl tracking-tight",children:"Leads de Captura"}),t.jsx("p",{className:"text-muted-foreground",children:"Gerencie os leads capturados atravs do formulrio pblico."})]}),t.jsxs(oe,{className:"gap-2",onClick:d.onExport,variant:"outline",children:[t.jsx(xs,{className:"h-4 w-4"}),"Exportar CSV"]})]}),t.jsx(LV,{landingPageStats:a,stats:r}),t.jsx("div",{className:"flex flex-col gap-4",children:t.jsx(IV,{date:o.date,interest:o.interest,landingPage:o.landingPage,landingPageOptions:u.landingPages,onClear:d.onClearFilters,onDateChange:d.onDateChange,onInterestChange:d.onInterestChange,onLandingPageChange:d.onLandingPageChange,onSearchChange:d.onSearchChange,onSourceChange:d.onSourceChange,onStatusChange:d.onStatusChange,search:o.search,source:o.source,sourceOptions:u.sources,status:o.status})}),t.jsxs("div",{className:"space-y-4",children:[t.jsx(BV,{leads:e,onStatusUpdate:d.onStatusUpdate}),n&&e.length===0&&t.jsx("div",{className:"flex justify-center py-10",children:t.jsx(pt,{className:"h-8 w-8 animate-spin text-muted-foreground"})}),t.jsx("div",{className:"flex justify-center",children:i})]})]})}function HV({data:e}){return t.jsxs(Te,{className:"col-span-4",children:[t.jsx(Me,{children:t.jsx(Le,{children:"Performance de Envios (ltimos 6 Meses)"})}),t.jsx(Ce,{className:"pl-2",children:t.jsx("div",{className:"h-[300px] w-full",children:t.jsx(a0,{height:"100%",minWidth:0,width:"100%",children:t.jsxs(kp,{data:e,margin:{top:5,right:10,left:10,bottom:0},children:[t.jsx(r0,{stroke:"hsl(var(--border))",strokeDasharray:"3 3",vertical:!1}),t.jsx(s0,{axisLine:!1,dataKey:"name",fontSize:12,stroke:"#888888",tickLine:!1}),t.jsx(n0,{axisLine:!1,fontSize:12,stroke:"#888888",tickFormatter:r=>`${r}`,tickLine:!1}),t.jsx(i0,{contentStyle:{backgroundColor:"hsl(var(--background))",borderColor:"hsl(var(--border))",borderRadius:"var(--radius)"},labelStyle:{color:"hsl(var(--foreground))"}}),t.jsx(vk,{}),t.jsx(Ic,{activeDot:{r:4},dataKey:"enviados",name:"Enviados",stroke:"#3b82f6",strokeWidth:2,type:"monotone"}),t.jsx(Ic,{activeDot:{r:4},dataKey:"abertos",name:"Abertos",stroke:"#22c55e",strokeWidth:2,type:"monotone"}),t.jsx(Ic,{activeDot:{r:4},dataKey:"cliques",name:"Cliques",stroke:"#eab308",strokeWidth:2,type:"monotone"})]})})})})]})}function GV({campaigns:e}){return t.jsxs(Te,{className:"col-span-3",children:[t.jsx(Me,{children:t.jsx(Le,{children:"Top Campanhas (Taxa de Abertura)"})}),t.jsx(Ce,{children:t.jsxs(Ya,{children:[t.jsx(Xa,{children:t.jsxs(Tt,{children:[t.jsx(He,{children:"Campanha"}),t.jsx(He,{className:"text-right",children:"Enviados"}),t.jsx(He,{className:"text-right",children:"Taxa Abertura"}),t.jsx(He,{className:"text-right",children:"Taxa Cliques"})]})}),t.jsxs($a,{children:[e.map(r=>{const a=r.stats?.delivered||0,n=r.stats?.opened||0,i=r.stats?.clicked||0,o=a>0?n/a*100:0,u=n>0?i/n*100:0;return t.jsxs(Tt,{children:[t.jsx(Pe,{className:"font-medium",children:t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"max-w-[200px] truncate",title:r.name,children:r.name}),t.jsx("span",{className:"max-w-[200px] truncate text-muted-foreground text-xs",children:r.subject})]})}),t.jsx(Pe,{className:"text-right",children:t.jsxs("div",{className:"flex items-center justify-end gap-1",children:[t.jsx(Nn,{className:"h-3 w-3 text-muted-foreground"}),r.stats?.sent||0]})}),t.jsx(Pe,{className:"text-right",children:t.jsxs(Ve,{className:"bg-green-500/10 text-green-500 hover:bg-green-500/20",variant:"outline",children:[t.jsx($c,{className:"mr-1 h-3 w-3"}),o.toFixed(1),"%"]})}),t.jsx(Pe,{className:"text-right",children:t.jsxs("div",{className:"flex items-center justify-end gap-1 text-sm",children:[t.jsx(_0,{className:"h-3 w-3 text-yellow-500"}),u.toFixed(1),"%"]})})]},r.id)}),e.length===0&&t.jsx(Tt,{children:t.jsx(Pe,{className:"h-24 text-center text-muted-foreground",colSpan:4,children:"Nenhuma campanha enviada ainda."})})]})]})})]})}function qV(){const{data:e}=et.emailMarketing.campaigns.list.useQuery(),{data:r}=et.emailMarketing.contacts.list.useQuery(),a=C.useMemo(()=>{if(!(e&&r))return{totalSent:0,avgOpenRate:0,avgClickRate:0,bounceRate:0,totalContacts:0,contactGrowth:0};const o=e.filter(w=>w.status==="sent");let u=0,d=0,h=0,m=0,p=0;for(const w of o)w.stats&&(u+=w.stats.sent,d+=w.stats.delivered,h+=w.stats.opened,m+=w.stats.clicked,p+=w.stats.bounced);const v=d>0?h/d*100:0,y=h>0?m/h*100:0,N=u>0?p/u*100:0,j=Date.now()-720*60*60*1e3,b=r.filter(w=>w.createdAt?new Date(w.createdAt).getTime()>j:!1).length;return{totalSent:u,avgOpenRate:v.toFixed(1),avgClickRate:y.toFixed(1),bounceRate:N.toFixed(1),totalContacts:r.length,contactGrowth:b}},[e,r]),n=C.useMemo(()=>{if(!e)return[];const o=e.filter(d=>d.status==="sent"),u=Array.from({length:6},(d,h)=>{const m=QA(new Date,h);return{name:Jn(m,"MMM",{locale:Ir}),date:Ux(m).getTime(),enviados:0,abertos:0,cliques:0}}).reverse();for(const d of o){if(!(d.sentAt&&d.stats))continue;const h=new Date(d.sentAt),m=Ux(h).getTime(),p=u.find(v=>v.date===m);p&&(p.enviados+=d.stats.sent,p.abertos+=d.stats.opened,p.cliques+=d.stats.clicked)}return u},[e]),i=C.useMemo(()=>e?[...e].filter(o=>o.status==="sent").sort((o,u)=>{const d=o.stats&&o.stats.delivered>0?o.stats.opened/o.stats.delivered:0;return(u.stats&&u.stats.delivered>0?u.stats.opened/u.stats.delivered:0)-d}).slice(0,5):[],[e]);return{metrics:a,chartData:n,topCampaigns:i,isLoading:!(e&&r)}}const WV=jt("/_authenticated/marketing/dashboard")({component:YV});function YV(){const{metrics:e,chartData:r,topCampaigns:a,isLoading:n}=qV();return n?t.jsx("div",{className:"flex h-[80vh] items-center justify-center",children:t.jsx(pt,{className:"h-8 w-8 animate-spin text-primary"})}):t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"font-bold text-2xl tracking-tight",children:"Dashboard de Marketing"}),t.jsx("p",{className:"text-muted-foreground",children:"Viso geral da performance de suas campanhas de email."})]}),t.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Emails Enviados"}),t.jsx(rr,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl",children:e.totalSent.toLocaleString()}),t.jsx("p",{className:"text-muted-foreground text-xs",children:"Total acumulado"})]})]}),t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Taxa de Abertura"}),t.jsx(ya,{className:"h-4 w-4 text-green-500"})]}),t.jsxs(Ce,{children:[t.jsxs("div",{className:"font-bold text-2xl",children:[e.avgOpenRate,"%"]}),t.jsx("p",{className:"text-muted-foreground text-xs",children:"Mdia geral"})]})]}),t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Taxa de Cliques"}),t.jsx(_0,{className:"h-4 w-4 text-yellow-500"})]}),t.jsxs(Ce,{children:[t.jsxs("div",{className:"font-bold text-2xl",children:[e.avgClickRate,"%"]}),t.jsx("p",{className:"text-muted-foreground text-xs",children:"Mdia geral"})]})]}),t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Total Contatos"}),t.jsx(tn,{className:"h-4 w-4 text-blue-500"})]}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl",children:e.totalContacts.toLocaleString()}),t.jsxs("p",{className:"text-muted-foreground text-xs",children:["+",e.contactGrowth," novos (30 dias)"]})]})]})]}),t.jsxs("div",{className:"grid gap-4 md:grid-cols-1 lg:grid-cols-7",children:[t.jsx(HV,{data:r}),t.jsx(GV,{campaigns:a})]})]})}const XV={all:"Todos Status",subscribed:"Inscrito",unsubscribed:"Cancelado",pending:"Pendente"},$V={all:"Todos os Tipos",lead:"Lead",student:"Aluno"};function KV({search:e,onSearchChange:r,status:a,onStatusChange:n,sourceType:i,onSourceTypeChange:o,onClear:u}){const d=e||a!=="all"||i!=="all";return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx(Ms,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),t.jsx(dt,{className:"pl-9",onChange:h=>r(h.target.value),placeholder:"Buscar por email ou nome...",value:e})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[t.jsxs(Rt,{onValueChange:n,value:a,children:[t.jsx(At,{className:"w-[160px]",children:t.jsx(Mt,{placeholder:"Status"})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"all",children:"Todos Status"}),t.jsx(ye,{value:"subscribed",children:"Inscrito"}),t.jsx(ye,{value:"unsubscribed",children:"Cancelado"}),t.jsx(ye,{value:"pending",children:"Pendente"})]})]}),t.jsxs(Rt,{onValueChange:o,value:i,children:[t.jsx(At,{className:"w-[160px]",children:t.jsx(Mt,{placeholder:"Tipo"})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"all",children:"Todos os Tipos"}),t.jsx(ye,{value:"lead",children:"Lead"}),t.jsx(ye,{value:"student",children:"Aluno"})]})]}),d&&t.jsxs(oe,{className:"gap-1",onClick:u,size:"sm",variant:"ghost",children:[t.jsx(ga,{className:"h-4 w-4"}),"Limpar"]})]}),d&&t.jsxs("div",{className:"flex flex-wrap gap-2",children:[e&&t.jsxs(Ve,{className:"gap-1",variant:"secondary",children:['Busca: "',e,'"',t.jsx("button",{className:"ml-1 hover:text-destructive",onClick:()=>r(""),type:"button",children:t.jsx(ga,{className:"h-3 w-3"})})]}),a!=="all"&&t.jsxs(Ve,{className:"gap-1",variant:"secondary",children:["Status: ",XV[a]||a,t.jsx("button",{className:"ml-1 hover:text-destructive",onClick:()=>n("all"),type:"button",children:t.jsx(ga,{className:"h-3 w-3"})})]}),i!=="all"&&t.jsxs(Ve,{className:"gap-1",variant:"secondary",children:["Tipo: ",$V[i]||i,t.jsx("button",{className:"ml-1 hover:text-destructive",onClick:()=>o("all"),type:"button",children:t.jsx(ga,{className:"h-3 w-3"})})]})]})]})}function QV({stats:e}){return e?t.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Total de Contatos"}),t.jsx(ya,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl",children:e.total}),t.jsx("p",{className:"text-muted-foreground text-xs",children:"Base completa de contatos"})]})]}),t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Inscritos Ativos"}),t.jsx(ZA,{className:"h-4 w-4 text-green-500"})]}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl",children:e.subscribed}),t.jsx("p",{className:"text-muted-foreground text-xs",children:"Recebem comunicaes"})]})]}),t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"No Inscritos"}),t.jsx(JA,{className:"h-4 w-4 text-red-500"})]}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl",children:e.unsubscribed}),t.jsxs("p",{className:"text-muted-foreground text-xs",children:["Taxa de cancelamento: ",e.unsubscribeRate,"%"]})]})]}),t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Pendentes"}),t.jsx(Eu,{className:"h-4 w-4 text-yellow-500"})]}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl",children:e.pending}),t.jsx("p",{className:"text-muted-foreground text-xs",children:"Aguardando confirmao"})]})]})]}):null}function ZV(e){switch(e){case"subscribed":return t.jsx(Ve,{className:"bg-green-500/10 text-green-600",children:"Inscrito"});case"unsubscribed":return t.jsx(Ve,{variant:"destructive",children:"Cancelado"});case"pending":return t.jsx(Ve,{variant:"outline",children:"Pendente"});default:return t.jsx(Ve,{variant:"secondary",children:e})}}function JV(e){switch(e){case"lead":return t.jsx(Ve,{variant:"outline",children:"Lead"});case"student":return t.jsx(Ve,{className:"bg-blue-500/10 text-blue-600",children:"Aluno"});default:return t.jsx(Ve,{variant:"secondary",children:e})}}function eH({contacts:e,onSync:r}){return t.jsx("div",{className:"rounded-md border",children:t.jsxs(Ya,{children:[t.jsx(Xa,{children:t.jsxs(Tt,{children:[t.jsx(He,{children:"Contato"}),t.jsx(He,{children:"Tipo"}),t.jsx(He,{children:"Status"}),t.jsx(He,{children:"ltima Sincronizao"}),t.jsx(He,{className:"text-right",children:"Aes"})]})}),t.jsxs($a,{children:[e.map(a=>t.jsxs(Tt,{children:[t.jsx(Pe,{children:t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("div",{className:"flex items-center gap-2 font-medium",children:[t.jsx(li,{className:"h-3 w-3 text-muted-foreground"}),t.jsx("span",{children:a.firstName?`${a.firstName} ${a.lastName||""}`:"Sem Nome"})]}),t.jsxs("div",{className:"mt-1 flex items-center gap-2 text-muted-foreground text-xs",children:[t.jsx(rr,{className:"h-3 w-3"}),a.email]})]})}),t.jsx(Pe,{children:JV(a.sourceType)}),t.jsx(Pe,{children:ZV(a.subscriptionStatus)}),t.jsxs(Pe,{children:[t.jsx("div",{className:"text-muted-foreground text-sm",children:a.lastSyncedAt?bn(a.lastSyncedAt,{addSuffix:!0,locale:Ir}):"Nunca"}),a.brevoId&&t.jsxs("div",{className:"mt-1 flex items-center gap-1 text-green-600 text-xs",children:[t.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-green-500"}),"Sincronizado"]})]}),t.jsx(Pe,{className:"text-right",children:t.jsx(oe,{onClick:()=>r(a.id),size:"sm",title:"Sincronizar com Brevo",variant:"ghost",children:t.jsx(tl,{className:"h-4 w-4"})})})]},a.id)),e.length===0&&t.jsx(Tt,{children:t.jsx(Pe,{className:"h-24 text-center",colSpan:5,children:"Nenhum contato encontrado."})})]})]})})}function tH(e){const r=hi(),a=e.useSearch(),{search:n,status:i,sourceType:o}=a,{data:u,isLoading:d}=et.emailMarketing.contacts.list.useQuery(),h=(()=>{if(!u||u.length===0)return null;const b=u.length,w=u.filter(R=>R.subscriptionStatus==="subscribed").length,T=u.filter(R=>R.subscriptionStatus==="pending").length,D=u.filter(R=>R.subscriptionStatus==="unsubscribed").length,_=b>0?D/b*100:0;return{total:b,subscribed:w,pending:T,unsubscribed:D,unsubscribeRate:_.toFixed(1)}})(),m=(()=>{if(!u)return[];let b=[...u];if(i&&i!=="all"&&(b=b.filter(w=>w.subscriptionStatus===i)),n){const w=n.toLowerCase();b=b.filter(T=>T.email?.toLowerCase().includes(w)||T.firstName?.toLowerCase().includes(w)||T.lastName?.toLowerCase().includes(w))}return b})(),p=b=>{Ie.info("Sincronizao com Brevo em breve")},v=(b,w)=>{Ie.info("Atualizao de inscrio em breve")},y=(b,w)=>{r({to:"/marketing/contatos",search:{...a,[b]:w,page:1}})},N=()=>{},j=()=>{r({to:"/marketing/contatos",search:{page:1,search:"",status:"all",sourceType:"all"}})};return{contacts:m,stats:h,isLoading:d,canLoadMore:!1,paginationStatus:"Exhausted",totalContacts:m.length,filters:{search:n,status:i,sourceType:o},handleSyncContact:p,handleUpdateSubscription:v,handleFilterChange:y,handleLoadMore:N,clearFilters:j}}const aH=Pa({page:Ap().catch(1),search:Ke().catch(""),status:Ke().catch("all"),sourceType:Ke().catch("all")}),RE=jt("/_authenticated/marketing/contatos")({component:rH,validateSearch:aH});function rH(){const{contacts:e,stats:r,isLoading:a,canLoadMore:n,filters:i,handleSyncContact:o,handleFilterChange:u,clearFilters:d}=tH(RE);return t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"font-bold text-2xl tracking-tight",children:"Contatos de Email"}),t.jsx("p",{className:"text-muted-foreground",children:"Gerencie seus contatos e sincronize com o Brevo."})]}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsx(kg,{})})]}),t.jsx(QV,{stats:r}),t.jsxs("div",{className:"space-y-4",children:[t.jsx(KV,{onClear:d,onSearchChange:h=>u("search",h),onSourceTypeChange:h=>u("sourceType",h),onStatusChange:h=>u("status",h),search:i.search,sourceType:i.sourceType,status:i.status}),t.jsx(eH,{contacts:e,onSync:o}),n,a&&e.length===0&&t.jsx("div",{className:"flex h-32 items-center justify-center",children:t.jsx(pt,{className:"h-8 w-8 animate-spin text-primary"})})]})]})}const sH={draft:"Rascunho",scheduled:"Agendada",sending:"Enviando",sent:"Enviada",failed:"Falhou"},nH={draft:"secondary",scheduled:"outline",sending:"default",sent:"default",failed:"destructive"};function iH({campaign:e,onClick:r}){const a=e.stats&&e.stats.delivered>0?e.stats.opened/e.stats.delivered*100:0,n=e.stats&&e.stats.opened>0?e.stats.clicked/e.stats.opened*100:0;return t.jsxs(Te,{className:me("cursor-pointer transition-all hover:shadow-md",r&&"hover:border-primary/50"),onClick:r,children:[t.jsx(Me,{className:"pb-2",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-linear-to-br from-primary to-primary/70",children:t.jsx(rr,{className:"h-5 w-5 text-white"})}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsx("h3",{className:"truncate font-semibold text-sm",children:e.name}),t.jsx("p",{className:"truncate text-muted-foreground text-xs",children:e.subject})]})]}),t.jsx(Ve,{variant:nH[e.status],children:sH[e.status]})]})}),t.jsxs(Ce,{className:"space-y-3",children:[e.stats&&e.status==="sent"&&t.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[t.jsxs("div",{className:"flex flex-col items-center gap-1",children:[t.jsx(ya,{className:"h-4 w-4 text-muted-foreground"}),t.jsx("span",{className:"font-medium text-sm",children:e.stats.delivered}),t.jsx("span",{className:"text-muted-foreground text-xs",children:"Entregues"})]}),t.jsxs("div",{className:"flex flex-col items-center gap-1",children:[t.jsx($c,{className:"h-4 w-4 text-primary"}),t.jsxs("span",{className:"font-medium text-primary text-sm",children:[a.toFixed(1),"%"]}),t.jsx("span",{className:"text-muted-foreground text-xs",children:"Abertos"})]}),t.jsxs("div",{className:"flex flex-col items-center gap-1",children:[t.jsx(_0,{className:"h-4 w-4 text-green-500"}),t.jsxs("span",{className:"font-medium text-green-600 text-sm",children:[n.toFixed(1),"%"]}),t.jsx("span",{className:"text-muted-foreground text-xs",children:"Cliques"})]})]}),t.jsx("div",{className:"flex items-center justify-between border-t pt-2",children:t.jsx("div",{className:"flex items-center gap-2 text-muted-foreground text-xs",children:e.status==="sent"&&e.sentAt?t.jsxs(t.Fragment,{children:[t.jsx(Nn,{className:"h-3 w-3"}),t.jsxs("span",{children:["Enviada ",bn(e.sentAt,{locale:Ir})," atrs"]})]}):e.status==="scheduled"&&e.scheduledAt?t.jsxs(t.Fragment,{children:[t.jsx(t0,{className:"h-3 w-3"}),t.jsxs("span",{children:["Agendada para ",bn(e.scheduledAt,{locale:Ir})]})]}):t.jsxs(t.Fragment,{children:[t.jsx(t0,{className:"h-3 w-3"}),t.jsxs("span",{children:["Criada ",bn(e.createdAt,{locale:Ir})," atrs"]})]})})})]})]})}const lH={all:"Todos Status",draft:"Rascunho",scheduled:"Agendada",sending:"Enviando",sent:"Enviada",failed:"Falhou"};function cH({search:e,onSearchChange:r,status:a,onStatusChange:n,onClear:i}){const o=e||a!=="all";return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx(Ms,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),t.jsx(dt,{className:"pl-9",onChange:u=>r(u.target.value),placeholder:"Buscar por nome ou assunto...",value:e})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[t.jsxs(Rt,{onValueChange:n,value:a,children:[t.jsx(At,{className:"w-[150px]",children:t.jsx(Mt,{placeholder:"Status"})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"all",children:"Todos Status"}),t.jsx(ye,{value:"draft",children:"Rascunho"}),t.jsx(ye,{value:"scheduled",children:"Agendada"}),t.jsx(ye,{value:"sending",children:"Enviando"}),t.jsx(ye,{value:"sent",children:"Enviada"}),t.jsx(ye,{value:"failed",children:"Falhou"})]})]}),o&&t.jsxs(oe,{className:"gap-1",onClick:i,size:"sm",variant:"ghost",children:[t.jsx(ga,{className:"h-4 w-4"}),"Limpar"]})]}),o&&t.jsxs("div",{className:"flex flex-wrap gap-2",children:[e&&t.jsxs(Ve,{className:"gap-1",variant:"secondary",children:['Busca: "',e,'"',t.jsx("button",{className:"ml-1 hover:text-destructive",onClick:()=>r(""),type:"button",children:t.jsx(ga,{className:"h-3 w-3"})})]}),a!=="all"&&t.jsxs(Ve,{className:"gap-1",variant:"secondary",children:["Status: ",lH[a]||a,t.jsx("button",{className:"ml-1 hover:text-destructive",onClick:()=>n("all"),type:"button",children:t.jsx(ga,{className:"h-3 w-3"})})]})]})]})}function oH({totalCampaigns:e,draftCount:r,sentCount:a,avgOpenRate:n}){return t.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Total de Campanhas"}),t.jsx(rr,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsx(Ce,{children:t.jsx("div",{className:"font-bold text-2xl",children:e})})]}),t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Rascunhos"}),t.jsx(ek,{className:"h-4 w-4 text-yellow-500"})]}),t.jsx(Ce,{children:t.jsx("div",{className:"font-bold text-2xl text-yellow-600",children:r})})]}),t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Enviadas"}),t.jsx(Nn,{className:"h-4 w-4 text-green-500"})]}),t.jsx(Ce,{children:t.jsx("div",{className:"font-bold text-2xl text-green-600",children:a})})]}),t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Taxa de Abertura"}),t.jsx($c,{className:"h-4 w-4 text-primary"})]}),t.jsx(Ce,{children:t.jsxs("div",{className:"font-bold text-2xl text-primary",children:[n.toFixed(1),"%"]})})]})]})}const uH={draft:"Rascunho",scheduled:"Agendada",sending:"Enviando",sent:"Enviada",failed:"Falhou"},dH={draft:"secondary",scheduled:"outline",sending:"default",sent:"default",failed:"destructive"};function kx(e){return!e.stats||e.stats.delivered===0?0:e.stats.opened/e.stats.delivered*100}function fH({campaigns:e,onCampaignClick:r}){const[a,n]=C.useState({field:"createdAt",direction:"desc"}),i=d=>{n(h=>({field:d,direction:h.field===d&&h.direction==="asc"?"desc":"asc"}))},o=[...e].sort((d,h)=>{const{field:m,direction:p}=a;let v,y;switch(m){case"name":v=d.name.toLowerCase(),y=h.name.toLowerCase();break;case"status":v=d.status,y=h.status;break;case"openRate":v=kx(d),y=kx(h);break;case"createdAt":v=d.createdAt||0,y=h.createdAt||0;break;default:return 0}return v<y?p==="asc"?-1:1:v>y?p==="asc"?1:-1:0}),u=d=>a.field!==d?null:a.direction==="asc"?t.jsx($u,{className:"ml-1 h-4 w-4"}):t.jsx(Il,{className:"ml-1 h-4 w-4"});return t.jsx("div",{className:"rounded-md border",children:t.jsxs(Ya,{children:[t.jsx(Xa,{children:t.jsxs(Tt,{children:[t.jsx(He,{children:t.jsxs("button",{"aria-label":"Ordenar por nome",className:"flex items-center rounded font-medium transition-colors hover:text-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2",onClick:()=>i("name"),type:"button",children:["Campanha",u("name")]})}),t.jsx(He,{children:t.jsxs("button",{"aria-label":"Ordenar por status",className:"flex items-center rounded font-medium transition-colors hover:text-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2",onClick:()=>i("status"),type:"button",children:["Status",u("status")]})}),t.jsx(He,{children:t.jsxs("button",{"aria-label":"Ordenar por taxa de abertura",className:"flex items-center rounded font-medium transition-colors hover:text-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2",onClick:()=>i("openRate"),type:"button",children:["Abertura",u("openRate")]})}),t.jsx(He,{children:t.jsxs("button",{"aria-label":"Ordenar por data",className:"flex items-center rounded font-medium transition-colors hover:text-foreground focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2",onClick:()=>i("createdAt"),type:"button",children:["Data",u("createdAt")]})}),t.jsx(He,{className:"w-10"})]})}),t.jsx($a,{children:o.map(d=>{const h=kx(d);let m=t.jsx("span",{className:"text-muted-foreground text-sm",children:"-"});if(d.status==="sent"){let p="text-red-600";h>=30?p="text-green-600":h>=15&&(p="text-yellow-600"),m=t.jsxs("span",{className:me("font-medium",p),children:[h.toFixed(1),"%"]})}return t.jsxs(Tt,{"aria-label":`Ver detalhes de ${d.name}`,className:"cursor-pointer transition-colors hover:bg-muted/50",onClick:()=>r(d.id),onKeyDown:p=>{(p.key==="Enter"||p.key===" ")&&(p.preventDefault(),r(d.id))},role:"button",tabIndex:0,children:[t.jsx(Pe,{children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-linear-to-br from-purple-500 to-indigo-500",children:t.jsx(rr,{className:"h-4 w-4 text-white"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-sm",children:d.name}),t.jsx("p",{className:"max-w-[200px] truncate text-muted-foreground text-xs",children:d.subject})]})]})}),t.jsx(Pe,{children:t.jsx(Ve,{variant:dH[d.status],children:uH[d.status]})}),t.jsx(Pe,{children:m}),t.jsx(Pe,{className:"text-muted-foreground text-sm",children:bn(d.createdAt,{locale:Ir,addSuffix:!0})}),t.jsx(Pe,{children:t.jsx(Sn,{className:"h-4 w-4 text-muted-foreground"})})]},d.id)})})]})})}const qf=12;function hH(e){const r=hi(),{search:a,status:n,view:i,page:o}=e.useSearch();C.useEffect(()=>{new URLSearchParams(window.location.search).toString().length>0||r({to:"/marketing",search:{view:"grid",page:1,search:"",status:"all"}})},[r]);const{data:u}=et.emailMarketing.campaigns.list.useQuery(),d=C.useMemo(()=>{if(!u)return;let D=[...u];if(n&&n!=="all"&&(D=D.filter(_=>_.status===n)),a){const _=a.toLowerCase();D=D.filter(R=>R.name.toLowerCase().includes(_)||R.subject.toLowerCase().includes(_))}return D},[u,n,a]),h=()=>{r({to:"/marketing",search:{view:"grid",page:1,search:"",status:"all"}})},m=d?.length??0,p=d?.filter(D=>D.status==="draft").length??0,v=d?.filter(D=>D.status==="sent").length??0,y=C.useMemo(()=>{if(!d)return 0;const D=d.filter(R=>R.status==="sent"&&R.stats&&R.stats.delivered>0);return D.length===0?0:D.reduce((R,z)=>{const O=z.stats?z.stats.opened/z.stats.delivered*100:0;return R+O},0)/D.length},[d]),N=Math.ceil(m/qf),j=C.useMemo(()=>d?d.slice((o-1)*qf,o*qf):[],[d,o]);return{search:a,status:n,view:i,page:o,campaigns:d,paginatedCampaigns:j,totalCampaigns:m,draftCount:p,sentCount:v,avgOpenRate:y,totalPages:N,PAGE_SIZE:qf,clearFilters:h,handleFilterChange:(D,_)=>{r({to:"/marketing",search:{search:a,status:n,view:i,page:o,[D]:_,page:1}})},navigateToCampaign:D=>{r({to:"/marketing/$campaignId",params:{campaignId:String(D)},search:{page:o,search:a,status:n,view:i}})},navigateToNewCampaign:()=>{r({to:"/marketing/nova",search:{search:"",status:"all",view:i||"grid",page:1}})},navigate:r}}const ME=jt("/_authenticated/marketing/campanhas")({validateSearch:e=>({search:e.search||"",status:e.status||"all",view:(e.view||"grid")==="table"?"table":"grid",page:Math.max(1,Number(e.page)||1)}),component:mH});function mH(){const{search:e,status:r,view:a,page:n,campaigns:i,paginatedCampaigns:o,totalCampaigns:u,draftCount:d,sentCount:h,avgOpenRate:m,totalPages:p,clearFilters:v,handleFilterChange:y,navigateToCampaign:N,navigate:j,PAGE_SIZE:b}=hH(ME);let w;return i?i.length===0?w=t.jsxs("div",{className:"py-12 text-center text-muted-foreground",children:[t.jsx(rr,{className:"mx-auto mb-4 h-16 w-16 opacity-30"}),t.jsx("h2",{className:"font-medium text-lg",children:"Nenhuma campanha encontrada"}),t.jsx("p",{className:"text-sm",children:"Crie uma nova campanha para comear"})]}):a==="table"?w=t.jsx(fH,{campaigns:o,onCampaignClick:N}):w=t.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:o.map(T=>t.jsx(iH,{campaign:T,onClick:()=>N(T.id)},T.id))}):w=t.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:Array.from({length:6}).map((T,D)=>t.jsx("div",{className:"h-40 animate-pulse rounded-lg bg-muted"},D))}),t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"font-bold text-2xl tracking-tight",children:"Campanhas"}),t.jsx("p",{className:"text-muted-foreground",children:"Gerencie suas campanhas de email marketing."})]}),t.jsx(Br,{to:"/marketing/nova",children:t.jsxs(oe,{children:[t.jsx(_n,{className:"mr-2 h-4 w-4"}),"Nova Campanha"]})})]}),t.jsx(oH,{avgOpenRate:m,draftCount:d,sentCount:h,totalCampaigns:u}),t.jsx(cH,{onClear:v,onSearchChange:T=>y("search",T),onStatusChange:T=>y("status",T),search:e||"",status:r||"all"}),w,i&&i.length>b&&t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("p",{className:"text-muted-foreground text-sm",children:["Mostrando ",(n-1)*b+1,"-",Math.min(n*b,u)," de"," ",u," campanhas"]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs(oe,{disabled:n===1,onClick:()=>{j({to:"/marketing/campanhas",search:{search:e,status:r,view:a,page:n-1}})},size:"sm",variant:"outline",children:[t.jsx(td,{className:"mr-1 h-4 w-4"}),"Anterior"]}),t.jsxs("span",{className:"text-muted-foreground text-sm",children:[n," / ",p]}),t.jsxs(oe,{disabled:n===p,onClick:()=>{j({to:"/marketing/campanhas",search:{search:e,status:r,view:a,page:n+1}})},size:"sm",variant:"outline",children:["Prximo",t.jsx(Sn,{className:"ml-1 h-4 w-4"})]})]})]})]})}const{entries:FE,setPrototypeOf:o2,isFrozen:xH,getPrototypeOf:pH,getOwnPropertyDescriptor:gH}=Object;let{freeze:zr,seal:Is,create:hp}=Object,{apply:mp,construct:xp}=typeof Reflect<"u"&&Reflect;zr||(zr=function(r){return r});Is||(Is=function(r){return r});mp||(mp=function(r,a){for(var n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];return r.apply(a,i)});xp||(xp=function(r){for(var a=arguments.length,n=new Array(a>1?a-1:0),i=1;i<a;i++)n[i-1]=arguments[i];return new r(...n)});const Wf=Vr(Array.prototype.forEach),vH=Vr(Array.prototype.lastIndexOf),u2=Vr(Array.prototype.pop),au=Vr(Array.prototype.push),yH=Vr(Array.prototype.splice),e0=Vr(String.prototype.toLowerCase),Dx=Vr(String.prototype.toString),Ox=Vr(String.prototype.match),ru=Vr(String.prototype.replace),jH=Vr(String.prototype.indexOf),bH=Vr(String.prototype.trim),Xs=Vr(Object.prototype.hasOwnProperty),kr=Vr(RegExp.prototype.test),su=NH(TypeError);function Vr(e){return function(r){r instanceof RegExp&&(r.lastIndex=0);for(var a=arguments.length,n=new Array(a>1?a-1:0),i=1;i<a;i++)n[i-1]=arguments[i];return mp(e,r,n)}}function NH(e){return function(){for(var r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];return xp(e,a)}}function Vt(e,r){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e0;o2&&o2(e,null);let n=r.length;for(;n--;){let i=r[n];if(typeof i=="string"){const o=a(i);o!==i&&(xH(r)||(r[n]=o),i=o)}e[i]=!0}return e}function wH(e){for(let r=0;r<e.length;r++)Xs(e,r)||(e[r]=null);return e}function pn(e){const r=hp(null);for(const[a,n]of FE(e))Xs(e,a)&&(Array.isArray(n)?r[a]=wH(n):n&&typeof n=="object"&&n.constructor===Object?r[a]=pn(n):r[a]=n);return r}function nu(e,r){for(;e!==null;){const n=gH(e,r);if(n){if(n.get)return Vr(n.get);if(typeof n.value=="function")return Vr(n.value)}e=pH(e)}function a(){return null}return a}const d2=zr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Rx=zr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Mx=zr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),SH=zr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Fx=zr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),_H=zr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),f2=zr(["#text"]),h2=zr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Ix=zr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),m2=zr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Yf=zr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),EH=Is(/\{\{[\w\W]*|[\w\W]*\}\}/gm),TH=Is(/<%[\w\W]*|[\w\W]*%>/gm),CH=Is(/\$\{[\w\W]*/gm),AH=Is(/^data-[\-\w.\u00B7-\uFFFF]+$/),kH=Is(/^aria-[\-\w]+$/),IE=Is(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),DH=Is(/^(?:\w+script|data):/i),OH=Is(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),LE=Is(/^html$/i),RH=Is(/^[a-z][.\w]*(-[.\w]+)+$/i);var x2=Object.freeze({__proto__:null,ARIA_ATTR:kH,ATTR_WHITESPACE:OH,CUSTOM_ELEMENT:RH,DATA_ATTR:AH,DOCTYPE_NAME:LE,ERB_EXPR:TH,IS_ALLOWED_URI:IE,IS_SCRIPT_OR_DATA:DH,MUSTACHE_EXPR:EH,TMPLIT_EXPR:CH});const iu={element:1,text:3,progressingInstruction:7,comment:8,document:9},MH=function(){return typeof window>"u"?null:window},FH=function(r,a){if(typeof r!="object"||typeof r.createPolicy!="function")return null;let n=null;const i="data-tt-policy-suffix";a&&a.hasAttribute(i)&&(n=a.getAttribute(i));const o="dompurify"+(n?"#"+n:"");try{return r.createPolicy(o,{createHTML(u){return u},createScriptURL(u){return u}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},p2=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function PE(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:MH();const r=ae=>PE(ae);if(r.version="3.3.1",r.removed=[],!e||!e.document||e.document.nodeType!==iu.document||!e.Element)return r.isSupported=!1,r;let{document:a}=e;const n=a,i=n.currentScript,{DocumentFragment:o,HTMLTemplateElement:u,Node:d,Element:h,NodeFilter:m,NamedNodeMap:p=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:v,DOMParser:y,trustedTypes:N}=e,j=h.prototype,b=nu(j,"cloneNode"),w=nu(j,"remove"),T=nu(j,"nextSibling"),D=nu(j,"childNodes"),_=nu(j,"parentNode");if(typeof u=="function"){const ae=a.createElement("template");ae.content&&ae.content.ownerDocument&&(a=ae.content.ownerDocument)}let R,z="";const{implementation:O,createNodeIterator:A,createDocumentFragment:k,getElementsByTagName:E}=a,{importNode:L}=n;let H=p2();r.isSupported=typeof FE=="function"&&typeof _=="function"&&O&&O.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:I,ERB_EXPR:re,TMPLIT_EXPR:ne,DATA_ATTR:ge,ARIA_ATTR:W,IS_SCRIPT_OR_DATA:ee,ATTR_WHITESPACE:je,CUSTOM_ELEMENT:Z}=x2;let{IS_ALLOWED_URI:De}=x2,he=null;const P=Vt({},[...d2,...Rx,...Mx,...Fx,...f2]);let q=null;const J=Vt({},[...h2,...Ix,...m2,...Yf]);let K=Object.seal(hp(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),xe=null,Fe=null;const Ae=Object.seal(hp(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let Ee=!0,we=!0,Ge=!1,X=!0,ht=!1,Ye=!0,Je=!1,qe=!1,Be=!1,$e=!1,St=!1,Jt=!1,fa=!0,ze=!1;const vt="user-content-";let tt=!0,Qe=!1,ot={},bt=null;const Ut=Vt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ma=null;const wt=Vt({},["audio","video","img","source","image","track"]);let qt=null;const oa=Vt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),zt="http://www.w3.org/1998/Math/MathML",ia="http://www.w3.org/2000/svg",Ca="http://www.w3.org/1999/xhtml";let _a=Ca,nn=!1,ln=null;const _t=Vt({},[zt,ia,Ca],Dx);let Dt=Vt({},["mi","mo","mn","ms","mtext"]),ut=Vt({},["annotation-xml"]);const Bt=Vt({},["title","style","font","a","script"]);let aa=null;const Ot=["application/xhtml+xml","text/html"],Bs="text/html";let ja=null,as=null;const Us=a.createElement("form"),Hr=function(V){return V instanceof RegExp||V instanceof Function},nl=function(){let V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(as&&as===V)){if((!V||typeof V!="object")&&(V={}),V=pn(V),aa=Ot.indexOf(V.PARSER_MEDIA_TYPE)===-1?Bs:V.PARSER_MEDIA_TYPE,ja=aa==="application/xhtml+xml"?Dx:e0,he=Xs(V,"ALLOWED_TAGS")?Vt({},V.ALLOWED_TAGS,ja):P,q=Xs(V,"ALLOWED_ATTR")?Vt({},V.ALLOWED_ATTR,ja):J,ln=Xs(V,"ALLOWED_NAMESPACES")?Vt({},V.ALLOWED_NAMESPACES,Dx):_t,qt=Xs(V,"ADD_URI_SAFE_ATTR")?Vt(pn(oa),V.ADD_URI_SAFE_ATTR,ja):oa,Ma=Xs(V,"ADD_DATA_URI_TAGS")?Vt(pn(wt),V.ADD_DATA_URI_TAGS,ja):wt,bt=Xs(V,"FORBID_CONTENTS")?Vt({},V.FORBID_CONTENTS,ja):Ut,xe=Xs(V,"FORBID_TAGS")?Vt({},V.FORBID_TAGS,ja):pn({}),Fe=Xs(V,"FORBID_ATTR")?Vt({},V.FORBID_ATTR,ja):pn({}),ot=Xs(V,"USE_PROFILES")?V.USE_PROFILES:!1,Ee=V.ALLOW_ARIA_ATTR!==!1,we=V.ALLOW_DATA_ATTR!==!1,Ge=V.ALLOW_UNKNOWN_PROTOCOLS||!1,X=V.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ht=V.SAFE_FOR_TEMPLATES||!1,Ye=V.SAFE_FOR_XML!==!1,Je=V.WHOLE_DOCUMENT||!1,$e=V.RETURN_DOM||!1,St=V.RETURN_DOM_FRAGMENT||!1,Jt=V.RETURN_TRUSTED_TYPE||!1,Be=V.FORCE_BODY||!1,fa=V.SANITIZE_DOM!==!1,ze=V.SANITIZE_NAMED_PROPS||!1,tt=V.KEEP_CONTENT!==!1,Qe=V.IN_PLACE||!1,De=V.ALLOWED_URI_REGEXP||IE,_a=V.NAMESPACE||Ca,Dt=V.MATHML_TEXT_INTEGRATION_POINTS||Dt,ut=V.HTML_INTEGRATION_POINTS||ut,K=V.CUSTOM_ELEMENT_HANDLING||{},V.CUSTOM_ELEMENT_HANDLING&&Hr(V.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(K.tagNameCheck=V.CUSTOM_ELEMENT_HANDLING.tagNameCheck),V.CUSTOM_ELEMENT_HANDLING&&Hr(V.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(K.attributeNameCheck=V.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),V.CUSTOM_ELEMENT_HANDLING&&typeof V.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(K.allowCustomizedBuiltInElements=V.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ht&&(we=!1),St&&($e=!0),ot&&(he=Vt({},f2),q=[],ot.html===!0&&(Vt(he,d2),Vt(q,h2)),ot.svg===!0&&(Vt(he,Rx),Vt(q,Ix),Vt(q,Yf)),ot.svgFilters===!0&&(Vt(he,Mx),Vt(q,Ix),Vt(q,Yf)),ot.mathMl===!0&&(Vt(he,Fx),Vt(q,m2),Vt(q,Yf))),V.ADD_TAGS&&(typeof V.ADD_TAGS=="function"?Ae.tagCheck=V.ADD_TAGS:(he===P&&(he=pn(he)),Vt(he,V.ADD_TAGS,ja))),V.ADD_ATTR&&(typeof V.ADD_ATTR=="function"?Ae.attributeCheck=V.ADD_ATTR:(q===J&&(q=pn(q)),Vt(q,V.ADD_ATTR,ja))),V.ADD_URI_SAFE_ATTR&&Vt(qt,V.ADD_URI_SAFE_ATTR,ja),V.FORBID_CONTENTS&&(bt===Ut&&(bt=pn(bt)),Vt(bt,V.FORBID_CONTENTS,ja)),V.ADD_FORBID_CONTENTS&&(bt===Ut&&(bt=pn(bt)),Vt(bt,V.ADD_FORBID_CONTENTS,ja)),tt&&(he["#text"]=!0),Je&&Vt(he,["html","head","body"]),he.table&&(Vt(he,["tbody"]),delete xe.tbody),V.TRUSTED_TYPES_POLICY){if(typeof V.TRUSTED_TYPES_POLICY.createHTML!="function")throw su('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof V.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw su('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');R=V.TRUSTED_TYPES_POLICY,z=R.createHTML("")}else R===void 0&&(R=FH(N,i)),R!==null&&typeof z=="string"&&(z=R.createHTML(""));zr&&zr(V),as=V}},il=Vt({},[...Rx,...Mx,...SH]),Rn=Vt({},[...Fx,..._H]),Yl=function(V){let le=_(V);(!le||!le.tagName)&&(le={namespaceURI:_a,tagName:"template"});const Ne=e0(V.tagName),Oe=e0(le.tagName);return ln[V.namespaceURI]?V.namespaceURI===ia?le.namespaceURI===Ca?Ne==="svg":le.namespaceURI===zt?Ne==="svg"&&(Oe==="annotation-xml"||Dt[Oe]):!!il[Ne]:V.namespaceURI===zt?le.namespaceURI===Ca?Ne==="math":le.namespaceURI===ia?Ne==="math"&&ut[Oe]:!!Rn[Ne]:V.namespaceURI===Ca?le.namespaceURI===ia&&!ut[Oe]||le.namespaceURI===zt&&!Dt[Oe]?!1:!Rn[Ne]&&(Bt[Ne]||!il[Ne]):!!(aa==="application/xhtml+xml"&&ln[V.namespaceURI]):!1},xr=function(V){au(r.removed,{element:V});try{_(V).removeChild(V)}catch{w(V)}},rs=function(V,le){try{au(r.removed,{attribute:le.getAttributeNode(V),from:le})}catch{au(r.removed,{attribute:null,from:le})}if(le.removeAttribute(V),V==="is")if($e||St)try{xr(le)}catch{}else try{le.setAttribute(V,"")}catch{}},M=function(V){let le=null,Ne=null;if(Be)V="<remove></remove>"+V;else{const We=Ox(V,/^[\r\n\t ]+/);Ne=We&&We[0]}aa==="application/xhtml+xml"&&_a===Ca&&(V='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+V+"</body></html>");const Oe=R?R.createHTML(V):V;if(_a===Ca)try{le=new y().parseFromString(Oe,aa)}catch{}if(!le||!le.documentElement){le=O.createDocument(_a,"template",null);try{le.documentElement.innerHTML=nn?z:Oe}catch{}}const Ue=le.body||le.documentElement;return V&&Ne&&Ue.insertBefore(a.createTextNode(Ne),Ue.childNodes[0]||null),_a===Ca?E.call(le,Je?"html":"body")[0]:Je?le.documentElement:Ue},Y=function(V){return A.call(V.ownerDocument||V,V,m.SHOW_ELEMENT|m.SHOW_COMMENT|m.SHOW_TEXT|m.SHOW_PROCESSING_INSTRUCTION|m.SHOW_CDATA_SECTION,null)},B=function(V){return V instanceof v&&(typeof V.nodeName!="string"||typeof V.textContent!="string"||typeof V.removeChild!="function"||!(V.attributes instanceof p)||typeof V.removeAttribute!="function"||typeof V.setAttribute!="function"||typeof V.namespaceURI!="string"||typeof V.insertBefore!="function"||typeof V.hasChildNodes!="function")},U=function(V){return typeof d=="function"&&V instanceof d};function G(ae,V,le){Wf(ae,Ne=>{Ne.call(r,V,le,as)})}const Q=function(V){let le=null;if(G(H.beforeSanitizeElements,V,null),B(V))return xr(V),!0;const Ne=ja(V.nodeName);if(G(H.uponSanitizeElement,V,{tagName:Ne,allowedTags:he}),Ye&&V.hasChildNodes()&&!U(V.firstElementChild)&&kr(/<[/\w!]/g,V.innerHTML)&&kr(/<[/\w!]/g,V.textContent)||V.nodeType===iu.progressingInstruction||Ye&&V.nodeType===iu.comment&&kr(/<[/\w]/g,V.data))return xr(V),!0;if(!(Ae.tagCheck instanceof Function&&Ae.tagCheck(Ne))&&(!he[Ne]||xe[Ne])){if(!xe[Ne]&&Se(Ne)&&(K.tagNameCheck instanceof RegExp&&kr(K.tagNameCheck,Ne)||K.tagNameCheck instanceof Function&&K.tagNameCheck(Ne)))return!1;if(tt&&!bt[Ne]){const Oe=_(V)||V.parentNode,Ue=D(V)||V.childNodes;if(Ue&&Oe){const We=Ue.length;for(let Lt=We-1;Lt>=0;--Lt){const Wt=b(Ue[Lt],!0);Wt.__removalCount=(V.__removalCount||0)+1,Oe.insertBefore(Wt,T(V))}}}return xr(V),!0}return V instanceof h&&!Yl(V)||(Ne==="noscript"||Ne==="noembed"||Ne==="noframes")&&kr(/<\/no(script|embed|frames)/i,V.innerHTML)?(xr(V),!0):(ht&&V.nodeType===iu.text&&(le=V.textContent,Wf([I,re,ne],Oe=>{le=ru(le,Oe," ")}),V.textContent!==le&&(au(r.removed,{element:V.cloneNode()}),V.textContent=le)),G(H.afterSanitizeElements,V,null),!1)},ue=function(V,le,Ne){if(fa&&(le==="id"||le==="name")&&(Ne in a||Ne in Us))return!1;if(!(we&&!Fe[le]&&kr(ge,le))){if(!(Ee&&kr(W,le))){if(!(Ae.attributeCheck instanceof Function&&Ae.attributeCheck(le,V))){if(!q[le]||Fe[le]){if(!(Se(V)&&(K.tagNameCheck instanceof RegExp&&kr(K.tagNameCheck,V)||K.tagNameCheck instanceof Function&&K.tagNameCheck(V))&&(K.attributeNameCheck instanceof RegExp&&kr(K.attributeNameCheck,le)||K.attributeNameCheck instanceof Function&&K.attributeNameCheck(le,V))||le==="is"&&K.allowCustomizedBuiltInElements&&(K.tagNameCheck instanceof RegExp&&kr(K.tagNameCheck,Ne)||K.tagNameCheck instanceof Function&&K.tagNameCheck(Ne))))return!1}else if(!qt[le]){if(!kr(De,ru(Ne,je,""))){if(!((le==="src"||le==="xlink:href"||le==="href")&&V!=="script"&&jH(Ne,"data:")===0&&Ma[V])){if(!(Ge&&!kr(ee,ru(Ne,je,"")))){if(Ne)return!1}}}}}}}return!0},Se=function(V){return V!=="annotation-xml"&&Ox(V,Z)},de=function(V){G(H.beforeSanitizeAttributes,V,null);const{attributes:le}=V;if(!le||B(V))return;const Ne={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:q,forceKeepAttr:void 0};let Oe=le.length;for(;Oe--;){const Ue=le[Oe],{name:We,namespaceURI:Lt,value:Wt}=Ue,la=ja(We),pr=Wt;let ba=We==="value"?pr:bH(pr);if(Ne.attrName=la,Ne.attrValue=ba,Ne.keepAttr=!0,Ne.forceKeepAttr=void 0,G(H.uponSanitizeAttribute,V,Ne),ba=Ne.attrValue,ze&&(la==="id"||la==="name")&&(rs(We,V),ba=vt+ba),Ye&&kr(/((--!?|])>)|<\/(style|title|textarea)/i,ba)){rs(We,V);continue}if(la==="attributename"&&Ox(ba,"href")){rs(We,V);continue}if(Ne.forceKeepAttr)continue;if(!Ne.keepAttr){rs(We,V);continue}if(!X&&kr(/\/>/i,ba)){rs(We,V);continue}ht&&Wf([I,re,ne],ss=>{ba=ru(ba,ss," ")});const zs=ja(V.nodeName);if(!ue(zs,la,ba)){rs(We,V);continue}if(R&&typeof N=="object"&&typeof N.getAttributeType=="function"&&!Lt)switch(N.getAttributeType(zs,la)){case"TrustedHTML":{ba=R.createHTML(ba);break}case"TrustedScriptURL":{ba=R.createScriptURL(ba);break}}if(ba!==pr)try{Lt?V.setAttributeNS(Lt,We,ba):V.setAttribute(We,ba),B(V)?xr(V):u2(r.removed)}catch{rs(We,V)}}G(H.afterSanitizeAttributes,V,null)},pe=function ae(V){let le=null;const Ne=Y(V);for(G(H.beforeSanitizeShadowDOM,V,null);le=Ne.nextNode();)G(H.uponSanitizeShadowNode,le,null),Q(le),de(le),le.content instanceof o&&ae(le.content);G(H.afterSanitizeShadowDOM,V,null)};return r.sanitize=function(ae){let V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},le=null,Ne=null,Oe=null,Ue=null;if(nn=!ae,nn&&(ae="<!-->"),typeof ae!="string"&&!U(ae))if(typeof ae.toString=="function"){if(ae=ae.toString(),typeof ae!="string")throw su("dirty is not a string, aborting")}else throw su("toString is not a function");if(!r.isSupported)return ae;if(qe||nl(V),r.removed=[],typeof ae=="string"&&(Qe=!1),Qe){if(ae.nodeName){const Wt=ja(ae.nodeName);if(!he[Wt]||xe[Wt])throw su("root node is forbidden and cannot be sanitized in-place")}}else if(ae instanceof d)le=M("<!---->"),Ne=le.ownerDocument.importNode(ae,!0),Ne.nodeType===iu.element&&Ne.nodeName==="BODY"||Ne.nodeName==="HTML"?le=Ne:le.appendChild(Ne);else{if(!$e&&!ht&&!Je&&ae.indexOf("<")===-1)return R&&Jt?R.createHTML(ae):ae;if(le=M(ae),!le)return $e?null:Jt?z:""}le&&Be&&xr(le.firstChild);const We=Y(Qe?ae:le);for(;Oe=We.nextNode();)Q(Oe),de(Oe),Oe.content instanceof o&&pe(Oe.content);if(Qe)return ae;if($e){if(St)for(Ue=k.call(le.ownerDocument);le.firstChild;)Ue.appendChild(le.firstChild);else Ue=le;return(q.shadowroot||q.shadowrootmode)&&(Ue=L.call(n,Ue,!0)),Ue}let Lt=Je?le.outerHTML:le.innerHTML;return Je&&he["!doctype"]&&le.ownerDocument&&le.ownerDocument.doctype&&le.ownerDocument.doctype.name&&kr(LE,le.ownerDocument.doctype.name)&&(Lt="<!DOCTYPE "+le.ownerDocument.doctype.name+`>
`+Lt),ht&&Wf([I,re,ne],Wt=>{Lt=ru(Lt,Wt," ")}),R&&Jt?R.createHTML(Lt):Lt},r.setConfig=function(){let ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};nl(ae),qe=!0},r.clearConfig=function(){as=null,qe=!1},r.isValidAttribute=function(ae,V,le){as||nl({});const Ne=ja(ae),Oe=ja(V);return ue(Ne,Oe,le)},r.addHook=function(ae,V){typeof V=="function"&&au(H[ae],V)},r.removeHook=function(ae,V){if(V!==void 0){const le=vH(H[ae],V);return le===-1?void 0:yH(H[ae],le,1)[0]}return u2(H[ae])},r.removeHooks=function(ae){H[ae]=[]},r.removeAllHooks=function(){H=p2()},r}var IH=PE();const pp=jt("/_authenticated/marketing/$campaignId")({component:GH}),Lx={draft:{label:"Rascunho",variant:"secondary",icon:SN},scheduled:{label:"Agendada",variant:"outline",icon:rn},sending:{label:"Enviando",variant:"default",icon:pt},sent:{label:"Enviada",variant:"default",icon:ci},failed:{label:"Falhou",variant:"destructive",icon:el}};function mu(e){return e?new Intl.DateTimeFormat("pt-BR",{dateStyle:"medium",timeStyle:"short"}).format(new Date(e)):"-"}function Xf(e,r){return!(e&&r)||r===0?"0%":`${(e/r*100).toFixed(1)}%`}function LH(e){return t.jsxs("div",{className:"space-y-6",children:[t.jsx(gt,{className:"h-10 w-48"}),t.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[t.jsxs("div",{className:"space-y-6 lg:col-span-2",children:[t.jsx(gt,{className:"h-64"}),t.jsx(gt,{className:"h-48"})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsx(gt,{className:"h-48"}),t.jsx(gt,{className:"h-32"})]})]})]})}function PH({onBack:e}){return t.jsxs("div",{className:"space-y-6",children:[t.jsxs(oe,{onClick:e,variant:"ghost",children:[t.jsx(mi,{className:"mr-2 h-4 w-4"}),"Voltar para campanhas"]}),t.jsx(Te,{children:t.jsxs(Ce,{className:"flex flex-col items-center justify-center py-12",children:[t.jsx(el,{className:"mb-4 h-12 w-12 text-muted-foreground"}),t.jsx("h2",{className:"font-semibold text-lg",children:"Campanha no encontrada"}),t.jsx("p",{className:"mt-2 text-muted-foreground text-sm",children:"A campanha que voc procura no existe ou foi removida."}),t.jsx(oe,{className:"mt-6",onClick:e,children:"Voltar para campanhas"})]})})]})}function BH({stats:e}){return t.jsxs(Te,{children:[t.jsxs(Me,{children:[t.jsxs(Le,{className:"flex items-center gap-2",children:[t.jsx(tn,{className:"h-5 w-5"}),"Estatsticas da Campanha"]}),t.jsx(ta,{children:"Mtricas de desempenho aps o envio"})]}),t.jsx(Ce,{children:t.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-5",children:[t.jsxs("div",{className:"rounded-lg border p-4 text-center",children:[t.jsxs("div",{className:"flex items-center justify-center gap-2 text-muted-foreground",children:[t.jsx(Nn,{className:"h-4 w-4"}),t.jsx("span",{className:"text-sm",children:"Enviados"})]}),t.jsx("p",{className:"mt-2 font-bold text-2xl",children:e.sent??0})]}),t.jsxs("div",{className:"rounded-lg border p-4 text-center",children:[t.jsxs("div",{className:"flex items-center justify-center gap-2 text-muted-foreground",children:[t.jsx(ci,{className:"h-4 w-4"}),t.jsx("span",{className:"text-sm",children:"Entregues"})]}),t.jsx("p",{className:"mt-2 font-bold text-2xl",children:e.delivered??0}),t.jsx("p",{className:"text-muted-foreground text-xs",children:Xf(e.delivered,e.sent)})]}),t.jsxs("div",{className:"rounded-lg border p-4 text-center",children:[t.jsxs("div",{className:"flex items-center justify-center gap-2 text-muted-foreground",children:[t.jsx($c,{className:"h-4 w-4"}),t.jsx("span",{className:"text-sm",children:"Abertos"})]}),t.jsx("p",{className:"mt-2 font-bold text-2xl",children:e.opened??0}),t.jsx("p",{className:"text-muted-foreground text-xs",children:Xf(e.opened,e.delivered)})]}),t.jsxs("div",{className:"rounded-lg border p-4 text-center",children:[t.jsxs("div",{className:"flex items-center justify-center gap-2 text-muted-foreground",children:[t.jsx(_0,{className:"h-4 w-4"}),t.jsx("span",{className:"text-sm",children:"Cliques"})]}),t.jsx("p",{className:"mt-2 font-bold text-2xl",children:e.clicked??0}),t.jsx("p",{className:"text-muted-foreground text-xs",children:Xf(e.clicked,e.opened)})]}),t.jsxs("div",{className:"rounded-lg border p-4 text-center",children:[t.jsxs("div",{className:"flex items-center justify-center gap-2 text-muted-foreground",children:[t.jsx(el,{className:"h-4 w-4"}),t.jsx("span",{className:"text-sm",children:"Bounces"})]}),t.jsx("p",{className:"mt-2 font-bold text-2xl",children:e.bounced??0}),t.jsx("p",{className:"text-muted-foreground text-xs",children:Xf(e.bounced,e.sent)})]})]})})]})}function UH({templateId:e,htmlContent:r}){let a;return e?a=t.jsxs("div",{className:"rounded-lg border border-dashed p-6 text-center",children:[t.jsx(zc,{className:"mx-auto mb-2 h-8 w-8 text-muted-foreground"}),t.jsx("p",{className:"font-medium",children:"Template vinculado"}),t.jsx("p",{className:"mt-1 text-muted-foreground text-sm",children:"Esta campanha usa um template. O contedo ser carregado do template no momento do envio."})]}):r?a=t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"rounded-lg border bg-muted/50 p-4",children:[t.jsx("p",{className:"mb-2 font-medium text-muted-foreground text-xs",children:"PRVIA DO HTML:"}),t.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none",dangerouslySetInnerHTML:{__html:IH.sanitize(r)}})]}),t.jsxs("details",{className:"group",children:[t.jsx("summary",{className:"cursor-pointer text-muted-foreground text-sm hover:text-foreground",children:"Ver cdigo fonte"}),t.jsx("pre",{className:"mt-2 max-h-48 overflow-auto rounded-lg bg-muted p-4 text-xs",children:t.jsx("code",{children:r})})]})]}):a=t.jsxs("div",{className:"rounded-lg border border-dashed p-6 text-center text-muted-foreground",children:[t.jsx(rr,{className:"mx-auto mb-2 h-8 w-8"}),t.jsx("p",{children:"Nenhum contedo definido"}),t.jsx("p",{className:"mt-1 text-sm",children:"Adicione contedo HTML ou selecione um template para esta campanha."})]}),t.jsxs(Te,{children:[t.jsxs(Me,{children:[t.jsxs(Le,{className:"flex items-center gap-2",children:[t.jsx(zc,{className:"h-5 w-5"}),"Contedo"]}),t.jsx(ta,{children:"Prvia do contedo da campanha"})]}),t.jsx(Ce,{children:a})]})}function zH({listNames:e}){return t.jsxs(Te,{children:[t.jsxs(Me,{children:[t.jsxs(Le,{className:"flex items-center gap-2",children:[t.jsx(Cp,{className:"h-5 w-5"}),"Listas Destinatrias"]}),t.jsx(ta,{children:"Listas que recebero esta campanha"})]}),t.jsx(Ce,{children:e.length>0?t.jsxs("div",{className:"space-y-2",children:[e.map((r,a)=>t.jsxs("div",{className:"flex items-center gap-2 rounded-md border p-2",children:[t.jsx(ya,{className:"h-4 w-4 text-muted-foreground"}),t.jsx("span",{className:"text-sm",children:r})]},`${r}-${a}`)),t.jsx(Sa,{className:"my-3"}),t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsx("span",{className:"text-muted-foreground",children:"Total de listas"}),t.jsx(Ve,{variant:"secondary",children:e.length})]})]}):t.jsxs("div",{className:"rounded-lg border border-dashed p-4 text-center text-muted-foreground",children:[t.jsx(ya,{className:"mx-auto mb-2 h-6 w-6"}),t.jsx("p",{className:"text-sm",children:"Nenhuma lista selecionada"})]})})]})}function VH({isDraft:e,isSending:r,isDeleting:a,campaignName:n,campaignStatus:i,onEdit:o,onSend:u,onDelete:d,onBack:h}){let m;i==="sent"?m="Esta campanha j foi enviada e no pode ser modificada.":i==="sending"?m="Esta campanha est sendo enviada.":i==="scheduled"?m="Esta campanha est agendada para envio.":m="Esta campanha falhou no envio.";const p=r?t.jsxs(t.Fragment,{children:[t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}),"Enviando..."]}):t.jsxs(t.Fragment,{children:[t.jsx(Nn,{className:"mr-2 h-4 w-4"}),"Enviar Agora"]});return t.jsxs(Te,{children:[t.jsx(Me,{children:t.jsx(Le,{children:"Aes"})}),t.jsxs(Ce,{className:"space-y-3",children:[e?t.jsxs(t.Fragment,{children:[t.jsxs(oe,{className:"w-full",onClick:o,variant:"outline",children:[t.jsx(ed,{className:"mr-2 h-4 w-4"}),"Editar Campanha"]}),t.jsx(oe,{className:"w-full",disabled:r,onClick:u,children:p}),t.jsx(Sa,{}),t.jsxs(md,{children:[t.jsx(xd,{asChild:!0,children:t.jsx(oe,{className:"w-full",disabled:a,variant:"destructive",children:a?t.jsxs(t.Fragment,{children:[t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}),"Excluindo..."]}):t.jsxs(t.Fragment,{children:[t.jsx(al,{className:"mr-2 h-4 w-4"}),"Excluir Campanha"]})})}),t.jsxs(eo,{children:[t.jsxs(to,{children:[t.jsx(ro,{children:"Excluir campanha?"}),t.jsxs(so,{children:['Voc est prestes a excluir a campanha "',n,'". Esta ao no pode ser desfeita.']})]}),t.jsxs(ao,{children:[t.jsx(io,{children:"Cancelar"}),t.jsx(no,{className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",onClick:d,children:"Excluir"})]})]})]})]}):t.jsx("div",{className:"rounded-lg border border-dashed p-4 text-center text-muted-foreground",children:t.jsx("p",{className:"text-sm",children:m})}),t.jsxs(oe,{className:"w-full",onClick:h,variant:"outline",children:[t.jsx(mi,{className:"mr-2 h-4 w-4"}),"Voltar para Campanhas"]})]})]})}function HH({campaignId:e}){const{data:r}=et.emailMarketing.events.list.useQuery({campaignId:e});return r===void 0?t.jsx(gt,{className:"h-[200px] w-full"}):t.jsxs(Te,{children:[t.jsxs(Me,{children:[t.jsxs(Le,{className:"flex items-center gap-2",children:[t.jsx(Cp,{className:"h-5 w-5"}),"Logs de Eventos Recentes"]}),t.jsx(ta,{children:"ltimas atividades registradas para esta campanha"})]}),t.jsx(Ce,{children:r.length>0?t.jsx("div",{className:"space-y-4",children:r.map(a=>t.jsxs("div",{className:"flex items-center justify-between border-b pb-4 last:border-0 last:pb-0",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Ve,{className:a.eventType==="delivered"?"border-green-500 text-green-500":a.eventType==="opened"?"border-blue-500 text-blue-500":a.eventType==="clicked"?"border-yellow-500 text-yellow-500":a.eventType==="bounced"||a.eventType==="spam"?"border-red-500 text-red-500":"border-gray-500 text-gray-500",variant:"outline",children:a.eventType}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"font-medium text-sm",children:a.email}),t.jsx("span",{className:"text-muted-foreground text-xs",children:mu(a.timestamp instanceof Date?a.timestamp.getTime():Number(a.timestamp))})]})]}),a.link&&t.jsx("a",{className:"text-blue-500 text-xs hover:underline",href:a.link,rel:"noreferrer",target:"_blank",children:"Link clicado"})]},a.id))}):t.jsx("div",{className:"py-8 text-center text-muted-foreground",children:t.jsx("p",{children:"Nenhum evento registrado ainda."})})})]})}function GH(){const{campaignId:e}=pp.useParams(),r=pp.useNavigate(),[a,n]=C.useState(!1),[i,o]=C.useState(!1),{data:u}=et.emailMarketing.campaigns.get.useQuery({id:Number(e)}),{data:d}=et.emailMarketing.lists.list.useQuery(),h=_=>{Ie.info(`[TODO] ${_} no implementado no backend`)},m=()=>u?.listIds&&d?u.listIds.map(_=>d.find(R=>R.id===_)?.name).filter(_=>!!_):[],p=()=>{r({to:"/marketing",search:{search:"",status:"all",view:"grid",page:1}})},v=()=>{Ie.info("Edio de campanha",{description:"Funcionalidade de edio ser implementada em breve."})},y=()=>{if(u){n(!0);try{h("sendCampaign"),Ie.success("Campanha enviada!",{description:"Sua campanha foi enviada com sucesso."})}catch(_){Ie.error("Erro ao enviar campanha",{description:_ instanceof Error?_.message:"Ocorreu um erro inesperado. Tente novamente."})}finally{n(!1)}}},N=()=>{if(u){o(!0);try{h("deleteCampaign"),Ie.success("Campanha excluda",{description:"A campanha foi excluda com sucesso."}),p()}catch(_){Ie.error("Erro ao excluir campanha",{description:_ instanceof Error?_.message:"Ocorreu um erro inesperado. Tente novamente."})}finally{o(!1)}}};if(u===void 0)return t.jsx(LH,{});if(u===null)return t.jsx(PH,{onBack:p});const j=u.status in Lx?Lx[u.status]:Lx.draft,b=j.icon,w=u.status==="draft",T=u.status==="sent",D=m();return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(oe,{onClick:p,size:"icon",variant:"ghost",children:t.jsx(mi,{className:"h-4 w-4"})}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("h1",{className:"font-bold text-2xl tracking-tight",children:u.name}),t.jsxs(Ve,{className:"flex items-center gap-1",variant:j.variant,children:[t.jsx(b,{className:`h-3 w-3 ${u.status==="sending"?"animate-spin":""}`}),j.label]})]}),t.jsx("p",{className:"text-muted-foreground",children:u.subject})]})]}),w&&t.jsxs("div",{className:"flex gap-2",children:[t.jsxs(oe,{onClick:v,variant:"outline",children:[t.jsx(ed,{className:"mr-2 h-4 w-4"}),"Editar"]}),t.jsx(oe,{disabled:a,onClick:y,children:a?t.jsxs(t.Fragment,{children:[t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}),"Enviando..."]}):t.jsxs(t.Fragment,{children:[t.jsx(Nn,{className:"mr-2 h-4 w-4"}),"Enviar Campanha"]})})]})]}),t.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[t.jsxs("div",{className:"space-y-6 lg:col-span-2",children:[T&&u.stats&&t.jsx(BH,{stats:u.stats}),t.jsxs(Te,{children:[t.jsx(Me,{children:t.jsxs(Le,{className:"flex items-center gap-2",children:[t.jsx(rr,{className:"h-5 w-5"}),"Informaes da Campanha"]})}),t.jsxs(Ce,{className:"space-y-4",children:[t.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-muted-foreground text-sm",children:"Assunto"}),t.jsx("p",{className:"mt-1",children:u.subject})]}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-muted-foreground text-sm",children:"Status"}),t.jsxs(Ve,{className:"mt-1 flex w-fit items-center gap-1",variant:j.variant,children:[t.jsx(b,{className:`h-3 w-3 ${u.status==="sending"?"animate-spin":""}`}),j.label]})]})]}),t.jsx(Sa,{}),t.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-muted-foreground text-sm",children:"Criada em"}),t.jsxs("p",{className:"mt-1 flex items-center gap-2",children:[t.jsx(tk,{className:"h-4 w-4 text-muted-foreground"}),mu(u.createdAt instanceof Date?u.createdAt.getTime():Number(u.createdAt))]})]}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-muted-foreground text-sm",children:"Atualizada em"}),t.jsxs("p",{className:"mt-1 flex items-center gap-2",children:[t.jsx(rn,{className:"h-4 w-4 text-muted-foreground"}),mu(u.updatedAt instanceof Date?u.updatedAt.getTime():Number(u.updatedAt))]})]})]}),u.sentAt&&t.jsxs(t.Fragment,{children:[t.jsx(Sa,{}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-muted-foreground text-sm",children:"Enviada em"}),t.jsxs("p",{className:"mt-1 flex items-center gap-2",children:[t.jsx(Nn,{className:"h-4 w-4 text-muted-foreground"}),mu(u.sentAt instanceof Date?u.sentAt.getTime():Number(u.sentAt))]})]})]}),u.scheduledAt&&t.jsxs(t.Fragment,{children:[t.jsx(Sa,{}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-muted-foreground text-sm",children:"Agendada para"}),t.jsxs("p",{className:"mt-1 flex items-center gap-2",children:[t.jsx(rn,{className:"h-4 w-4 text-muted-foreground"}),mu(u.scheduledAt instanceof Date?u.scheduledAt.getTime():Number(u.scheduledAt))]})]})]}),u.brevoCampaignId&&t.jsxs(t.Fragment,{children:[t.jsx(Sa,{}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-muted-foreground text-sm",children:"ID Brevo"}),t.jsxs("p",{className:"mt-1 flex items-center gap-2",children:[t.jsx(Fc,{className:"h-4 w-4 text-muted-foreground"}),t.jsx("code",{className:"rounded bg-muted px-2 py-0.5 text-sm",children:u.brevoCampaignId})]})]})]})]})]}),t.jsx(UH,{htmlContent:u.htmlContent??void 0,templateId:u.templateId?String(u.templateId):void 0}),T&&t.jsx(HH,{campaignId:u.id})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsx(zH,{listNames:D}),t.jsx(VH,{campaignName:u.name,campaignStatus:u.status,isDeleting:i,isDraft:w,isSending:a,onBack:p,onDelete:N,onEdit:v,onSend:y}),w&&t.jsx(Te,{className:"border-primary/20 bg-primary/5",children:t.jsx(Ce,{className:"pt-6",children:t.jsxs("p",{className:"text-muted-foreground text-sm",children:[t.jsx("strong",{children:"Dica:"})," Revise o contedo e as listas de destinatrios antes de enviar. Aps o envio, a campanha no poder ser editada."]})})})]})]})]})}const qH=jt("/_authenticated/financial/reports")({component:WH});function WH(){const[e,r]=C.useState("all"),[a,n]=C.useState(""),[i,o]=C.useState(""),u=C.useId(),d=C.useId(),h=void 0,m=R=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(R),p=R=>R?new Date(R).toLocaleDateString("pt-BR"):"-",v=R=>R?new Date(R).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"-",y=R=>{const O={PENDING:{label:"Pendente",variant:"outline"},CONFIRMED:{label:"Confirmado",variant:"default"},RECEIVED:{label:"Recebido",variant:"default"},OVERDUE:{label:"Vencido",variant:"destructive"},REFUNDED:{label:"Estornado",variant:"secondary"},CANCELLED:{label:"Cancelado",variant:"secondary"}}[R]||{label:R,variant:"outline"};return t.jsx(Ve,{variant:O.variant,children:O.label})},N=R=>{switch(R){case"completed":return t.jsx(ci,{className:"h-4 w-4 text-green-500"});case"failed":return t.jsx(el,{className:"h-4 w-4 text-red-500"});case"running":return t.jsx(rn,{className:"h-4 w-4 animate-spin text-yellow-500"});default:return t.jsx(rn,{className:"h-4 w-4 text-muted-foreground"})}},j=[],b=j.reduce((R,z)=>R+z.value,0),w=j.filter(R=>R.status==="RECEIVED"||R.status==="CONFIRMED"),T=w.reduce((R,z)=>R+z.value,0),D=j.filter(R=>R.status==="OVERDUE"),_=D.reduce((R,z)=>R+z.value,0);return t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"font-bold text-2xl",children:"Relatrios Financeiros"}),t.jsx("p",{className:"text-muted-foreground",children:"Anlise detalhada e histrico de sincronizaes"})]}),t.jsxs(Kc,{defaultValue:"payments",children:[t.jsxs(Ul,{children:[t.jsxs(Nr,{value:"payments",children:[t.jsx($i,{className:"mr-2 h-4 w-4"}),"Pagamentos"]}),t.jsxs(Nr,{value:"webhooks",children:[t.jsx(Xc,{className:"mr-2 h-4 w-4"}),"Logs de Sincronizao"]})]}),t.jsxs(ei,{className:"space-y-6",value:"payments",children:[t.jsxs(Te,{children:[t.jsx(Me,{children:t.jsx(Le,{className:"text-base",children:"Filtros"})}),t.jsx(Ce,{children:t.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(yt,{children:"Status"}),t.jsxs(Rt,{onValueChange:r,value:e,children:[t.jsx(At,{children:t.jsx(Mt,{placeholder:"Todos os status"})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"all",children:"Todos"}),t.jsx(ye,{value:"PENDING",children:"Pendente"}),t.jsx(ye,{value:"CONFIRMED",children:"Confirmado"}),t.jsx(ye,{value:"RECEIVED",children:"Recebido"}),t.jsx(ye,{value:"OVERDUE",children:"Vencido"}),t.jsx(ye,{value:"REFUNDED",children:"Estornado"})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(yt,{htmlFor:u,children:"Data Inicial"}),t.jsx(dt,{id:u,onChange:R=>n(R.target.value),type:"date",value:a})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(yt,{htmlFor:d,children:"Data Final"}),t.jsx(dt,{id:d,onChange:R=>o(R.target.value),type:"date",value:i})]}),t.jsx("div",{className:"flex items-end",children:t.jsx(oe,{onClick:()=>{r("all"),n(""),o("")},variant:"outline",children:"Limpar"})})]})})]}),t.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[t.jsxs(Te,{children:[t.jsx(Me,{className:"pb-2",children:t.jsxs(Le,{className:"flex items-center gap-2 font-medium text-sm",children:[t.jsx(t0,{className:"h-4 w-4"}),"Total Filtrado"]})}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl",children:m(b)}),t.jsxs("p",{className:"text-muted-foreground text-xs",children:[j.length," cobranas"]})]})]}),t.jsxs(Te,{children:[t.jsx(Me,{className:"pb-2",children:t.jsxs(Le,{className:"flex items-center gap-2 font-medium text-sm",children:[t.jsx(ci,{className:"h-4 w-4 text-green-500"}),"Recebido"]})}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl text-green-600",children:m(T)}),t.jsxs("p",{className:"text-muted-foreground text-xs",children:[w.length," pagamentos"]})]})]}),t.jsxs(Te,{children:[t.jsx(Me,{className:"pb-2",children:t.jsxs(Le,{className:"flex items-center gap-2 font-medium text-sm",children:[t.jsx(Ll,{className:"h-4 w-4 text-red-500"}),"Vencido"]})}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl text-red-600",children:m(_)}),t.jsxs("p",{className:"text-muted-foreground text-xs",children:[D.length," cobranas"]})]})]}),t.jsxs(Te,{children:[t.jsx(Me,{className:"pb-2",children:t.jsx(Le,{className:"font-medium text-sm",children:"Taxa Recebimento"})}),t.jsxs(Ce,{children:[t.jsxs("div",{className:"font-bold text-2xl",children:[j.length>0?(w.length/j.length*100).toFixed(1):0,"%"]}),t.jsx("p",{className:"text-muted-foreground text-xs",children:"do total filtrado"})]})]})]}),t.jsxs(Te,{children:[t.jsxs(Me,{children:[t.jsx(Le,{children:"Cobranas"}),t.jsxs(ta,{children:[0," registros encontrados"]})]}),t.jsx(Ce,{children:t.jsxs(Ya,{children:[t.jsx(Xa,{children:t.jsxs(Tt,{children:[t.jsx(He,{children:"Descrio"}),t.jsx(He,{children:"Vencimento"}),t.jsx(He,{children:"Valor"}),t.jsx(He,{children:"Status"}),t.jsx(He,{children:"Tipo"}),t.jsx(He,{children:"Pagamento"})]})}),t.jsxs($a,{children:[j.map(R=>t.jsxs(Tt,{children:[t.jsx(Pe,{className:"font-medium",children:R.description||"Sem descrio"}),t.jsx(Pe,{children:p(R.dueDate)}),t.jsx(Pe,{children:m(R.value)}),t.jsx(Pe,{children:y(R.status)}),t.jsx(Pe,{children:t.jsx(Ve,{variant:"outline",children:R.billingType})}),t.jsx(Pe,{children:p(R.confirmedDate)})]},String(R.id))),j.length===0&&t.jsx(Tt,{children:t.jsx(Pe,{className:"py-8 text-center text-muted-foreground",colSpan:6,children:"Nenhuma cobrana encontrada"})})]})]})})]})]}),t.jsx(ei,{className:"space-y-6",value:"webhooks",children:t.jsxs(Te,{children:[t.jsxs(Me,{children:[t.jsx(Le,{children:"Histrico de Sincronizaes"}),t.jsx(ta,{children:"ltimas sincronizaes automticas e manuais do Asaas"})]}),t.jsx(Ce,{children:t.jsxs(Ya,{children:[t.jsx(Xa,{children:t.jsxs(Tt,{children:[t.jsx(He,{children:"Status"}),t.jsx(He,{children:"Tipo"}),t.jsx(He,{children:"Iniciado por"}),t.jsx(He,{children:"Incio"}),t.jsx(He,{children:"Concluso"}),t.jsx(He,{children:"Registros"}),t.jsx(He,{children:"Mensagem"})]})}),t.jsxs($a,{children:[h?.map(R=>{let z="-";return R.errors&&R.errors.length>0?z=R.errors[0]??"-":R.status==="completed"&&(z="Concludo com sucesso"),t.jsxs(Tt,{children:[t.jsx(Pe,{children:N(R.status)}),t.jsx(Pe,{children:t.jsx(Ve,{className:"capitalize",variant:"outline",children:R.syncType})}),t.jsx(Pe,{className:"text-sm",children:R.initiatedBy}),t.jsx(Pe,{className:"text-sm",children:v(R.startedAt)}),t.jsx(Pe,{className:"text-sm",children:v(R.completedAt)}),t.jsx(Pe,{children:R.recordsProcessed!==void 0?t.jsxs(Ve,{variant:"secondary",children:[R.recordsCreated||0," / ",R.recordsProcessed||0]}):"-"}),t.jsx(Pe,{className:"max-w-xs truncate text-sm",children:z})]},String(R.id))}),t.jsx(Tt,{children:t.jsx(Pe,{className:"py-8 text-center text-muted-foreground",colSpan:7,children:"Nenhum log de sincronizao encontrado"})})]})]})})]})})]})]})}const YH=jt("/_authenticated/financial/payments")({component:KH}),g2={PENDING:{label:"Pendente",variant:"secondary"},RECEIVED:{label:"Recebido",variant:"default"},CONFIRMED:{label:"Confirmado",variant:"default"},OVERDUE:{label:"Vencido",variant:"destructive"},REFUNDED:{label:"Reembolsado",variant:"outline"},DELETED:{label:"Excludo",variant:"outline"},CANCELLED:{label:"Cancelado",variant:"outline"}};function XH({search:e,onSearchChange:r,statusFilter:a,onStatusFilterChange:n,billingTypeFilter:i,onBillingTypeFilterChange:o,startDate:u,onStartDateChange:d,endDate:h,onEndDateChange:m,onClearFilters:p,startDateId:v,endDateId:y}){const N=e||a!=="all"||i!=="all"||u||h;return t.jsxs(Te,{children:[t.jsx(Me,{children:t.jsx(Le,{children:"Filtros"})}),t.jsxs(Ce,{children:[t.jsxs("div",{className:"grid gap-4 md:grid-cols-3 lg:grid-cols-5",children:[t.jsxs("div",{className:"relative",children:[t.jsx(Ms,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 transform text-muted-foreground"}),t.jsx(dt,{className:"pl-10",onChange:j=>r(j.target.value),placeholder:"Buscar por descrio...",value:e})]}),t.jsxs(Rt,{onValueChange:n,value:a,children:[t.jsx(At,{children:t.jsx(Mt,{placeholder:"Status"})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"all",children:"Todos os Status"}),t.jsx(ye,{value:"PENDING",children:"Pendente"}),t.jsx(ye,{value:"RECEIVED",children:"Recebido"}),t.jsx(ye,{value:"CONFIRMED",children:"Confirmado"}),t.jsx(ye,{value:"OVERDUE",children:"Vencido"}),t.jsx(ye,{value:"REFUNDED",children:"Reembolsado"}),t.jsx(ye,{value:"CANCELLED",children:"Cancelado"})]})]}),t.jsxs(Rt,{onValueChange:o,value:i,children:[t.jsx(At,{children:t.jsx(Mt,{placeholder:"Tipo de Pagamento"})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"all",children:"Todos os Tipos"}),t.jsx(ye,{value:"BOLETO",children:"Boleto"}),t.jsx(ye,{value:"PIX",children:"PIX"}),t.jsx(ye,{value:"CREDIT_CARD",children:"Carto de Crdito"}),t.jsx(ye,{value:"DEBIT_CARD",children:"Carto de Dbito"})]})]}),t.jsxs("div",{children:[t.jsx(yt,{className:"sr-only",htmlFor:v,children:"Data Inicial"}),t.jsx(dt,{id:v,onChange:j=>d(j.target.value),placeholder:"Data Inicial",type:"date",value:u})]}),t.jsxs("div",{children:[t.jsx(yt,{className:"sr-only",htmlFor:y,children:"Data Final"}),t.jsx(dt,{id:y,onChange:j=>m(j.target.value),placeholder:"Data Final",type:"date",value:h})]})]}),N&&t.jsx("div",{className:"mt-4",children:t.jsx(oe,{onClick:p,size:"sm",variant:"outline",children:"Limpar Filtros"})})]})]})}function $H({payment:e,onCopy:r}){const a=i=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(i),n=i=>new Date(i).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"});return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx(yt,{className:"text-muted-foreground",children:"Valor"}),t.jsx("p",{className:"font-medium",children:a(e.value)})]}),t.jsxs("div",{children:[t.jsx(yt,{className:"text-muted-foreground",children:"Valor Lquido"}),t.jsx("p",{className:"font-medium",children:a(e.netValue||e.value)})]}),t.jsxs("div",{children:[t.jsx(yt,{className:"text-muted-foreground",children:"Vencimento"}),t.jsx("p",{className:"font-medium",children:n(e.dueDate)})]}),t.jsxs("div",{children:[t.jsx(yt,{className:"text-muted-foreground",children:"Status"}),t.jsx(Ve,{variant:g2[e.status]?.variant||"outline",children:g2[e.status]?.label||e.status})]}),t.jsxs("div",{children:[t.jsx(yt,{className:"text-muted-foreground",children:"Tipo"}),t.jsx("p",{className:"font-medium",children:e.billingType})]}),e.confirmedDate&&t.jsxs("div",{children:[t.jsx(yt,{className:"text-muted-foreground",children:"Confirmado em"}),t.jsx("p",{className:"font-medium",children:n(e.confirmedDate)})]})]}),e.description&&t.jsxs("div",{children:[t.jsx(yt,{className:"text-muted-foreground",children:"Descrio"}),t.jsx("p",{className:"font-medium",children:e.description})]}),t.jsxs("div",{className:"flex flex-wrap gap-2 border-t pt-4",children:[e.boletoUrl&&t.jsx(oe,{asChild:!0,size:"sm",variant:"outline",children:t.jsxs("a",{href:e.boletoUrl,rel:"noopener noreferrer",target:"_blank",children:[t.jsx(Xc,{className:"mr-2 h-4 w-4"}),"Ver Boleto"]})}),e.pixQrCode&&t.jsxs(oe,{onClick:()=>r(e.pixQrCode??""),size:"sm",variant:"outline",children:[t.jsx(wN,{className:"mr-2 h-4 w-4"}),"Copiar PIX"]}),t.jsx(oe,{asChild:!0,size:"sm",variant:"outline",children:t.jsxs("a",{href:`https://www.asaas.com/cobrancas/${e.asaasPaymentId}`,rel:"noopener noreferrer",target:"_blank",children:[t.jsx(Fc,{className:"mr-2 h-4 w-4"}),"Abrir no Asaas"]})})]})]})}function KH(){const[e,r]=C.useState(""),[a,n]=C.useState("all"),[i,o]=C.useState("all"),[u,d]=C.useState(""),[h,m]=C.useState(""),[p,v]=C.useState(0),[y,N]=C.useState(null),j=C.useId(),b=C.useId();u&&new Date(u).getTime(),h&&new Date(`${h}T23:59:59`).getTime();const w=[],T=0,D=e?w.filter(O=>O.description?.toLowerCase().includes(e.toLowerCase())):w,_=O=>{navigator.clipboard.writeText(O).then(()=>{Ie.success("Copiado para a rea de transferncia!")}).catch(()=>{Ie.error("Falha ao copiar")})},R=()=>{r(""),n("all"),o("all"),d(""),m(""),v(0)};let z;return z=t.jsx(gt,{className:"h-64"}),t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"font-bold text-3xl",children:"Cobranas"}),t.jsx("p",{className:"text-muted-foreground",children:"Gerencie todas as cobranas do sistema"})]}),t.jsx(XH,{billingTypeFilter:i,endDate:h,endDateId:b,onBillingTypeFilterChange:O=>{o(O),v(0)},onClearFilters:R,onEndDateChange:O=>{m(O),v(0)},onSearchChange:r,onStartDateChange:O=>{d(O),v(0)},onStatusFilterChange:O=>{n(O),v(0)},search:e,startDate:u,startDateId:j,statusFilter:a}),t.jsxs(Te,{children:[t.jsxs(Me,{children:[t.jsx(Le,{children:"Cobranas"}),t.jsxs(ta,{children:[D.length," de ",T," cobrana","s"," ","encontrada","s"]})]}),t.jsx(Ce,{children:z})]}),t.jsx(_r,{onOpenChange:O=>!O&&N(null),open:!!y,children:t.jsxs(fr,{className:"max-w-md",children:[t.jsxs(hr,{children:[t.jsx(mr,{children:"Detalhes da Cobrana"}),t.jsx(ts,{children:y?.asaasPaymentId??""})]}),y&&t.jsx($H,{onCopy:_,payment:y})]})})]})}const QH=jt("/_authenticated/financial/dashboard")({component:ZH});function ZH(){const[e,r]=C.useState(!1),a=void 0,n=()=>{r(!0);try{Ie.info("Sincronizando dados do Asaas..."),Ie.info("Sincronizao Asaas em implementao via tRPC"),Ie.success("Sincronizao concluda!")}catch(o){Ie.error("Erro na sincronizao",{description:o instanceof Error?o.message:"Erro desconhecido"})}finally{r(!1)}};return t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"font-bold text-2xl",children:"Dashboard Financeiro"}),t.jsx("p",{className:"text-muted-foreground",children:"Viso geral das finanas do negcio"})]}),t.jsx("div",{className:"flex gap-2",children:t.jsxs(oe,{disabled:e,onClick:n,children:[t.jsx(tl,{className:`mr-2 h-4 w-4 ${e?"animate-spin":""}`}),"Sincronizar Asaas"]})})]}),a,t.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Faturamento do Ms"}),t.jsx($i,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl",children:"-"}),t.jsxs("p",{className:"text-muted-foreground text-xs",children:[0," pagamentos confirmados"]})]})]}),t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"A Receber"}),t.jsx(rn,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl",children:"-"}),t.jsxs("p",{className:"text-muted-foreground text-xs",children:[0," cobranas pendentes"]})]})]}),t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Vencidos"}),t.jsx(Ll,{className:"h-4 w-4 text-red-500"})]}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl text-red-600",children:"-"}),t.jsxs("p",{className:"text-muted-foreground text-xs",children:[0," cobranas atrasadas"]})]})]}),t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Taxa de Inadimplncia"}),t.jsx(tn,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Ce,{children:[t.jsxs("div",{className:"font-bold text-2xl",children:["0","%"]}),t.jsx("p",{className:"text-muted-foreground text-xs",children:"Cobranas vencidas vs total"})]})]})]}),t.jsx(C_,{}),t.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[t.jsx(K_,{}),t.jsx($_,{})]}),t.jsxs(Te,{children:[t.jsx(Me,{children:t.jsx(Le,{children:"Cobranas"})}),t.jsx(Ce,{children:t.jsx(T_,{})})]})]})}function JH({department:e,statusFilter:r,search:a}){return t.jsx("div",{className:"space-y-2 p-4",children:[1,2,3,4,5].map(n=>t.jsx("div",{className:"h-16 animate-pulse rounded-lg bg-muted/20"},n))})}const BE=jt("/_authenticated/chat/$department")({component:eG});function eG(){const{department:e}=BE.useParams(),{search:r,statusFilter:a,portalTargetId:n}=Tg(),[i,o]=C.useState(null);return C.useEffect(()=>{const u=document.getElementById(n);u&&o(u)},[n]),t.jsxs(t.Fragment,{children:[i&&bC.createPortal(t.jsx(JH,{department:e,search:r,statusFilter:a==="all"?void 0:a}),i),t.jsx("div",{className:"flex h-full min-w-0 flex-1 flex-col",children:t.jsx(Yc,{})})]})}const tG=jt("/_authenticated/chat/$department/")({component:aG});function aG(){return t.jsxs("div",{className:"fade-in flex h-full animate-in flex-col items-center justify-center p-8 text-center text-muted-foreground duration-500",children:[t.jsx("div",{className:"mb-4 rounded-full bg-muted/50 p-4",children:t.jsx(an,{className:"h-12 w-12 opacity-50"})}),t.jsx("h2",{className:"mb-2 font-semibold text-foreground text-xl",children:"Selecione uma conversa"}),t.jsx("p",{className:"max-w-sm text-sm",children:"Escolha uma conversa da lista lateral para iniciar o atendimento ou visualizar o histrico."})]})}function rG(){return t.jsx(sG,{})}function sG(){return t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:"grid gap-4 md:grid-cols-3",children:[1,2,3].map(e=>t.jsxs(Te,{children:[t.jsx(Me,{children:t.jsx(gt,{className:"h-5 w-24"})}),t.jsxs(Ce,{children:[t.jsx(gt,{className:"mb-2 h-8 w-16"}),t.jsx(gt,{className:"h-4 w-32"})]})]},e))}),t.jsxs(Te,{children:[t.jsx(Me,{children:t.jsx(gt,{className:"h-6 w-48"})}),t.jsx(Ce,{children:t.jsx("div",{className:"grid gap-4 md:grid-cols-4",children:[1,2,3,4].map(e=>t.jsx(gt,{className:"h-16 w-full"},e))})})]})]})}const UE=C.forwardRef(({className:e,value:r,...a},n)=>t.jsx(CN,{className:me("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",e),ref:n,...a,children:t.jsx(ak,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(r||0)}%)`}})}));UE.displayName=CN.displayName;function nG(){const[e,r]=C.useState(!1),[a,n]=C.useState("students"),[i,o]=C.useState("newest_wins"),[u,d]=C.useState(!1),[h,m]=C.useState(0),[p,v]=C.useState(null),y=C.useId(),N=C.useId(),j=C.useId(),b=C.useId(),{data:w}=et.students.list.useQuery({}),{data:T}=et.settings.list.useQuery({}),D=T?.length||0,_=w?.length||0;let R=0;a==="students"?R=_:a==="payments"?R=D:R=_+D;const z=R===1?"registro":"registros";let O="";a==="students"?O=`${w?.length||0} estudantes para exportar`:a==="payments"?O=`${D} pagamentos pendentes`:O=`${(w?.length||0)+D} registros totais`;const A=()=>{d(!0),m(0),v(null);try{Ie.info(`Iniciando exportao de ${a}...`);const k=setInterval(()=>{m(E=>E>=95?(clearInterval(k),95):E+10)},500);setTimeout(()=>{clearInterval(k),m(100),v({success:Math.floor(Math.random()*R),failed:Math.floor(Math.random()*Math.max(1,R*.1)),skipped:Math.floor(Math.random()*Math.max(1,R*.2))}),d(!1),Ie.success("Exportao concluda!")},3e3)}catch(k){d(!1),Ie.error("Erro na exportao",{description:k instanceof Error?k.message:"Erro desconhecido"})}};return t.jsxs(_r,{onOpenChange:r,open:e,children:[t.jsx(Qi,{asChild:!0,children:t.jsxs(oe,{className:"w-full",size:"lg",children:[t.jsx(N0,{className:"mr-2 h-5 w-5"}),"Exportar Dados para Asaas"]})}),t.jsxs(fr,{className:"max-w-2xl",children:[t.jsxs(hr,{children:[t.jsxs(mr,{className:"flex items-center gap-2",children:[t.jsx(_p,{className:"h-5 w-5"}),"Exportar Dados para Asaas"]}),t.jsx(ts,{children:"Exporte estudantes e pagamentos para o Asaas com resoluo de conflitos"})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"space-y-3",children:[t.jsx(yt,{children:"Tipo de Exportao"}),t.jsxs(Rt,{disabled:u,onValueChange:k=>n(k),value:a,children:[t.jsx(At,{children:t.jsx(Mt,{})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"students",children:"Estudantes"}),t.jsx(ye,{value:"payments",children:"Pagamentos"}),t.jsx(ye,{value:"all",children:"Todos os Dados"})]})]}),t.jsx("div",{className:"text-muted-foreground text-sm",children:O})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx(yt,{children:"Estratgia de Resoluo de Conflitos"}),t.jsx(z0,{disabled:u,onValueChange:k=>o(k),value:i,children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-start space-x-2 rounded-lg border p-3",children:[t.jsx(ai,{id:b,value:"manual"}),t.jsxs("div",{className:"flex-1",children:[t.jsx(yt,{className:"cursor-pointer font-medium",htmlFor:b,children:"Resoluo Manual"}),t.jsx("p",{className:"mt-1 text-muted-foreground text-xs",children:"Requerer aprovao para cada conflito"})]})]}),t.jsxs("div",{className:"flex items-start space-x-2 rounded-lg border p-3",children:[t.jsx(ai,{id:y,value:"local_wins"}),t.jsxs("div",{className:"flex-1",children:[t.jsx(yt,{className:"cursor-pointer font-medium",htmlFor:y,children:"Local Prevalece"}),t.jsx("p",{className:"mt-1 text-muted-foreground text-xs",children:"Dados locais sobrescrevem dados do Asaas em caso de conflito"})]})]}),t.jsxs("div",{className:"flex items-start space-x-2 rounded-lg border p-3",children:[t.jsx(ai,{id:N,value:"remote_wins"}),t.jsxs("div",{className:"flex-1",children:[t.jsx(yt,{className:"cursor-pointer font-medium",htmlFor:N,children:"Asaas Prevalece"}),t.jsx("p",{className:"mt-1 text-muted-foreground text-xs",children:"Dados do Asaas sobrescrevem dados locais em caso de conflito"})]})]}),t.jsxs("div",{className:"flex items-start space-x-2 rounded-lg border border-blue-200 bg-blue-50 p-3 dark:border-blue-800 dark:bg-blue-950/30",children:[t.jsx(ai,{id:j,value:"newest_wins"}),t.jsxs("div",{className:"flex-1",children:[t.jsx(yt,{className:"cursor-pointer font-medium",htmlFor:j,children:"Mais Recente Prevalece"}),t.jsx("p",{className:"mt-1 text-muted-foreground text-xs",children:"Dados mais recentes (baseado na data de atualizao) so mantidos"})]})]})]})})]}),u&&t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsx("span",{children:"Progresso da Exportao"}),t.jsxs("span",{className:"text-muted-foreground",children:[h,"%"]})]}),t.jsx(UE,{className:"h-2",value:h})]}),p&&t.jsxs(Te,{children:[t.jsx(Me,{className:"pb-3",children:t.jsx(Le,{className:"text-base",children:"Resultado da Exportao"})}),t.jsxs(Ce,{children:[t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"font-bold text-2xl text-green-600",children:p.success}),t.jsx("div",{className:"text-muted-foreground text-xs",children:"Sucesso"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"font-bold text-2xl text-yellow-600",children:p.skipped}),t.jsx("div",{className:"text-muted-foreground text-xs",children:"Ignorados"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"font-bold text-2xl text-red-600",children:p.failed}),t.jsx("div",{className:"text-muted-foreground text-xs",children:"Falharam"})]})]}),p.failed>0&&t.jsxs("div",{className:"mt-4 flex items-start gap-2 rounded bg-yellow-50 p-3 text-sm text-yellow-700 dark:bg-yellow-950/30 dark:text-yellow-300",children:[t.jsx(w0,{className:"mt-0.5 h-4 w-4 flex-shrink-0"}),t.jsx("span",{children:"Alguns registros falharam. Verifique o histrico de sincronizao para mais detalhes."})]})]})]}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx(oe,{disabled:u,onClick:()=>r(!1),variant:"outline",children:"Cancelar"}),t.jsx(oe,{disabled:u||R===0,onClick:A,children:u?t.jsxs(t.Fragment,{children:[t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}),"Exportando..."]}):t.jsxs(t.Fragment,{children:[t.jsx(xs,{className:"mr-2 h-4 w-4"}),"Exportar ",R," ",z]})})]})]})]})]})}function iG(){const[e,r]=C.useState({}),[a,n]=C.useState({enabled:!1,intervalHours:1,syncTypes:[]}),i=null,o=async p=>{r({...e,[p]:!0});try{Ie.info(`Iniciando sincronizao de ${p}...`),Ie.info("[TODO] Sync mutation not yet implemented")}catch(v){Ie.error("Erro na sincronizao",{description:v instanceof Error?v.message:"Erro desconhecido"})}finally{r({...e,[p]:!1})}},u=()=>{Ie.success("Configuraes de auto-sync salvas!")},d=i?.status==="running",h=C.useId(),m=C.useId();return t.jsxs("div",{className:"space-y-6",children:[t.jsxs(Te,{children:[t.jsx(Me,{children:t.jsxs(Le,{className:"flex items-center justify-between",children:[t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx(tl,{className:"h-5 w-5"}),"Status da Sincronizao"]}),t.jsx(lG,{status:i?.status})]})}),t.jsx(Ce,{className:"space-y-4",children:i})]}),t.jsxs(Te,{children:[t.jsxs(Me,{children:[t.jsxs(Le,{className:"flex items-center gap-2",children:[t.jsx(rk,{className:"h-5 w-5"}),"Sincronizao Manual"]}),t.jsx(ta,{children:"Importe dados do Asaas manualmente"})]}),t.jsxs(Ce,{children:[t.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[t.jsxs(oe,{className:"h-auto py-3",disabled:e.customers||d,onClick:()=>o("customers"),variant:"outline",children:[e.customers?t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}):t.jsx(xs,{className:"mr-2 h-4 w-4"}),t.jsxs("div",{className:"text-left",children:[t.jsx("div",{className:"font-medium",children:"Clientes"}),t.jsx("div",{className:"text-muted-foreground text-xs",children:"Import customers from Asaas"})]})]}),t.jsxs(oe,{className:"h-auto py-3",disabled:e.payments||d,onClick:()=>o("payments"),variant:"outline",children:[e.payments?t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}):t.jsx(xs,{className:"mr-2 h-4 w-4"}),t.jsxs("div",{className:"text-left",children:[t.jsx("div",{className:"font-medium",children:"Pagamentos"}),t.jsx("div",{className:"text-muted-foreground text-xs",children:"Import payments from Asaas"})]})]}),t.jsxs(oe,{className:"h-auto py-3",disabled:e.subscriptions||d,onClick:()=>o("subscriptions"),variant:"outline",children:[e.subscriptions?t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}):t.jsx(xs,{className:"mr-2 h-4 w-4"}),t.jsxs("div",{className:"text-left",children:[t.jsx("div",{className:"font-medium",children:"Assinaturas"}),t.jsx("div",{className:"text-muted-foreground text-xs",children:"Import subscriptions from Asaas"})]})]}),t.jsxs(oe,{className:"h-auto py-3",disabled:e.all||d,onClick:()=>o("all"),children:[e.all?t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}):t.jsx(xs,{className:"mr-2 h-4 w-4"}),t.jsxs("div",{className:"text-left",children:[t.jsx("div",{className:"font-medium",children:"Sincronizar Tudo"}),t.jsx("div",{className:"text-muted-foreground text-xs",children:"Import all data from Asaas"})]})]})]}),d]})]}),t.jsxs(Te,{children:[t.jsxs(Me,{children:[t.jsxs(Le,{className:"flex items-center gap-2",children:[t.jsx(Tu,{className:"h-5 w-5"}),"Configurao de Auto-Sync"]}),t.jsx(ta,{children:"Configure sincronizao automtica peridica"})]}),t.jsxs(Ce,{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"space-y-0.5",children:[t.jsx(yt,{htmlFor:m,children:"Ativar Auto-Sync"}),t.jsx("div",{className:"text-muted-foreground text-sm",children:"Sincronize automaticamente com o Asaas em intervalos regulares"})]}),t.jsx(Ks,{checked:a.enabled,id:m,onCheckedChange:p=>n({...a,enabled:p})})]}),a.enabled&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(yt,{htmlFor:h,children:"Intervalo de Sincronizao"}),t.jsxs(Rt,{onValueChange:p=>n({...a,intervalHours:Number.parseInt(p,10)}),value:a.intervalHours.toString(),children:[t.jsx(At,{id:h,children:t.jsx(Mt,{})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"1",children:"A cada 1 hora"}),t.jsx(ye,{value:"6",children:"A cada 6 horas"}),t.jsx(ye,{value:"12",children:"A cada 12 horas"}),t.jsx(ye,{value:"24",children:"Diariamente"})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(yt,{children:"Tipos de Sincronizao"}),t.jsx("div",{className:"grid gap-2",children:[{value:"customers",label:"Clientes"},{value:"payments",label:"Pagamentos"},{value:"subscriptions",label:"Assinaturas"}].map(p=>t.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[t.jsx(yt,{className:"cursor-pointer",htmlFor:`sync-${p.value}`,children:p.label}),t.jsx(Ks,{checked:a.syncTypes.includes(p.value),id:`sync-${p.value}`,onCheckedChange:v=>{n(v?{...a,syncTypes:[...a.syncTypes,p.value]}:{...a,syncTypes:a.syncTypes.filter(y=>y!==p.value)})}})]},p.value))})]}),t.jsx(oe,{className:"w-full",onClick:u,children:"Salvar Configuraes"})]})]})]})]})}function lG({status:e}){switch(e){case"completed":return t.jsxs(Ve,{className:"border-green-600 text-green-600",variant:"outline",children:[t.jsx(Np,{className:"mr-1 h-3 w-3"}),"Concludo"]});case"failed":return t.jsxs(Ve,{className:"border-red-600 text-red-600",variant:"outline",children:[t.jsx(w0,{className:"mr-1 h-3 w-3"}),"Falhou"]});case"running":return t.jsxs(Ve,{className:"border-blue-600 text-blue-600",variant:"outline",children:[t.jsx(pt,{className:"mr-1 h-3 w-3 animate-spin"}),"Em Andamento"]});default:return t.jsxs(Ve,{className:"border-yellow-600 text-yellow-600",variant:"outline",children:[t.jsx(rn,{className:"mr-1 h-3 w-3"}),"Aguardando"]})}}const Px={completed:{label:"Concludo",variant:"default"},failed:{label:"Falhou",variant:"destructive"},running:{label:"Em execuo",variant:"secondary"},pending:{label:"Pendente",variant:"outline"}},cG={customers:"Clientes",payments:"Pagamentos",subscriptions:"Assinaturas",all:"Tudo"};function oG({logs:e}){const[r,a]=C.useState(0),[n,i]=C.useState("all"),[o,u]=C.useState("all"),[d,h]=C.useState(null),[m,p]=C.useState(!1),v=10;if(!e)return t.jsx(Te,{children:t.jsx(Ce,{className:"p-6",children:t.jsx("div",{className:"text-center text-muted-foreground",children:"Carregando histrico..."})})});const y=e.filter(w=>!(n!=="all"&&w.status!==n||o!=="all"&&w.syncType!==o)),N=Math.ceil(y.length/v),j=y.slice(r*v,(r+1)*v),b=w=>{h(w),p(!0)};return t.jsxs(Te,{children:[t.jsx(Me,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx(Le,{children:"Histrico de Sincronizao"}),t.jsxs(ta,{children:[y.length," sincronizaes encontradas"]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs(Rt,{onValueChange:i,value:n,children:[t.jsxs(At,{className:"w-[140px]",children:[t.jsx(nN,{className:"mr-2 h-4 w-4"}),t.jsx(Mt,{placeholder:"Status"})]}),t.jsxs(kt,{children:[t.jsx(ye,{value:"all",children:"Todos Status"}),t.jsx(ye,{value:"completed",children:"Concludo"}),t.jsx(ye,{value:"failed",children:"Falhou"}),t.jsx(ye,{value:"running",children:"Em execuo"}),t.jsx(ye,{value:"pending",children:"Pendente"})]})]}),t.jsxs(Rt,{onValueChange:u,value:o,children:[t.jsx(At,{className:"w-[140px]",children:t.jsx(Mt,{placeholder:"Tipo"})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"all",children:"Todos Tipos"}),t.jsx(ye,{value:"customers",children:"Clientes"}),t.jsx(ye,{value:"payments",children:"Pagamentos"}),t.jsx(ye,{value:"subscriptions",children:"Assinaturas"})]})]})]})]})}),t.jsx(Ce,{children:j.length===0?t.jsx("div",{className:"py-8 text-center text-muted-foreground",children:"Nenhuma sincronizao encontrada"}):t.jsxs(t.Fragment,{children:[t.jsxs(Ya,{children:[t.jsx(Xa,{children:t.jsxs(Tt,{children:[t.jsx(He,{children:"Tipo"}),t.jsx(He,{children:"Status"}),t.jsx(He,{children:"Iniciado"}),t.jsx(He,{children:"Durao"}),t.jsx(He,{children:"Processados"}),t.jsx(He,{children:"Criados/Atualizados"}),t.jsx(He,{className:"text-right",children:"Aes"})]})}),t.jsx($a,{children:j.map(w=>{const T=w.completedAt?Math.round((new Date(w.completedAt).getTime()-new Date(w.startedAt).getTime())/1e3):null,D=w.status==="running";let _=null;D?_=t.jsx("span",{className:"text-blue-600",children:"Em andamento..."}):T?_=`${T}s`:_="-";const R=Px[w.status];return t.jsxs(Tt,{children:[t.jsx(Pe,{className:"capitalize",children:cG[w.syncType]||w.syncType}),t.jsx(Pe,{children:t.jsx(Ve,{variant:R?.variant??"outline",children:R?.label??w.status})}),t.jsx(Pe,{children:new Date(w.startedAt).toLocaleString("pt-BR")}),t.jsx(Pe,{children:_}),t.jsx(Pe,{children:w.recordsProcessed}),t.jsxs(Pe,{children:[t.jsx("span",{className:"text-green-600",children:w.recordsCreated})," /"," ",t.jsx("span",{className:"text-blue-600",children:w.recordsUpdated}),w.recordsFailed>0&&t.jsxs("span",{className:"ml-2 text-red-600",children:["(",w.recordsFailed," erros)"]})]}),t.jsx(Pe,{className:"text-right",children:t.jsx(oe,{onClick:()=>b(w),size:"sm",variant:"ghost",children:t.jsx($c,{className:"h-4 w-4"})})})]},w.id)})})]}),N>1&&t.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[t.jsxs("div",{className:"text-muted-foreground text-sm",children:["Pgina ",r+1," de ",N]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs(oe,{disabled:r===0,onClick:()=>a(w=>Math.max(0,w-1)),size:"sm",variant:"outline",children:[t.jsx(td,{className:"h-4 w-4"}),"Anterior"]}),t.jsxs(oe,{disabled:r>=N-1,onClick:()=>a(w=>Math.min(N-1,w+1)),size:"sm",variant:"outline",children:["Prxima",t.jsx(Sn,{className:"h-4 w-4"})]})]})]})]})}),t.jsx(_r,{onOpenChange:p,open:m,children:t.jsxs(fr,{className:"max-w-2xl",children:[t.jsxs(hr,{children:[t.jsx(mr,{children:"Detalhes da Sincronizao"}),t.jsx(ts,{children:"Informaes detalhadas sobre a execuo"})]}),d&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-muted-foreground text-sm",children:"Tipo"}),t.jsx("div",{className:"font-medium capitalize",children:d.syncType})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-muted-foreground text-sm",children:"Status"}),t.jsx(Ve,{variant:Px[d.status]?.variant??"outline",children:Px[d.status]?.label??d.status})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-muted-foreground text-sm",children:"Iniciado"}),t.jsx("div",{className:"font-medium",children:new Date(d.startedAt).toLocaleString("pt-BR")})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-muted-foreground text-sm",children:"Concludo"}),t.jsx("div",{className:"font-medium",children:d.completedAt?new Date(d.completedAt).toLocaleString("pt-BR"):"Em andamento"})]})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-4 rounded-lg bg-muted/50 p-4",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"font-bold text-2xl",children:d.recordsProcessed}),t.jsx("div",{className:"text-muted-foreground text-xs",children:"Processados"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"font-bold text-2xl text-green-600",children:d.recordsCreated}),t.jsx("div",{className:"text-muted-foreground text-xs",children:"Criados"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"font-bold text-2xl text-blue-600",children:d.recordsUpdated}),t.jsx("div",{className:"text-muted-foreground text-xs",children:"Atualizados"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"font-bold text-2xl text-red-600",children:d.recordsFailed}),t.jsx("div",{className:"text-muted-foreground text-xs",children:"Falharam"})]})]}),d.errors&&d.errors.length>0&&t.jsxs("div",{children:[t.jsx("div",{className:"mb-1 text-muted-foreground text-sm",children:"Erros"}),t.jsx("div",{className:"rounded bg-red-50 p-3 text-red-700 text-sm dark:bg-red-950/30 dark:text-red-300",children:t.jsx("ul",{className:"list-inside list-disc space-y-1",children:d.errors.map((w,T)=>t.jsx("li",{children:w},T))})})]}),d.filters&&t.jsxs("div",{children:[t.jsx("div",{className:"mb-1 text-muted-foreground text-sm",children:"Filtros"}),t.jsx("pre",{className:"max-h-40 overflow-auto rounded bg-muted p-3 text-xs",children:JSON.stringify(d.filters,null,2)})]})]})]})})]})}function uG(){const[e,r]=Xe.useState("dashboard"),{data:a}=et.financial.syncLogs.list.useQuery({limit:20}),n=a?.[0]??null,i=[{value:"dashboard",label:"Dashboard",icon:Eu},{value:"sync",label:"Sincronizao",icon:tl},{value:"export",label:"Exportar",icon:xs},{value:"history",label:"Histrico",icon:Xc}];return t.jsxs("div",{className:"mx-auto max-w-7xl space-y-6 p-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"font-bold text-3xl tracking-tight",children:"Administrao Asaas"}),t.jsx("p",{className:"mt-1 text-muted-foreground",children:"Gerencie sincronizao, exportao e monitoramento"})]}),n&&t.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm",children:[t.jsx(sk,{className:"h-4 w-4"}),t.jsxs("span",{children:["ltima sync: ",n.syncType," "," ",n.startedAt?new Date(n.startedAt).toLocaleString("pt-BR"):""]})]})]}),t.jsx("div",{className:"border-b",children:t.jsx("nav",{"aria-label":"Tabs",className:"flex gap-1",children:i.map(o=>{const u=o.icon;return t.jsxs("button",{className:`flex items-center gap-2 border-b-2 px-4 py-3 transition-colors ${e===o.value?"border-primary font-medium text-primary":"border-transparent text-muted-foreground hover:border-muted-foreground/50 hover:text-foreground"}`,onClick:()=>r(o.value),type:"button",children:[t.jsx(u,{className:"h-4 w-4"}),o.label]},o.value)})})}),t.jsxs("div",{className:"mt-6",children:[e==="dashboard"&&t.jsx(rG,{}),e==="sync"&&t.jsx(iG,{}),e==="export"&&t.jsx(nG,{}),e==="history"&&t.jsx(oG,{logs:a??null})]})]})}function dG(){return t.jsx(uG,{})}const fG=jt("/_authenticated/admin/asaas/")({component:hG});function hG(){return t.jsx(dG,{})}const mG=Pa({name:Ke().min(2,"Nome deve ter pelo menos 2 caracteres"),subject:Ke().min(2,"Assunto deve ter pelo menos 2 caracteres"),category:Ke().min(1,"Categoria  obrigatria"),htmlContent:Ke().min(10,"Contedo HTML deve ter pelo menos 10 caracteres"),isActive:oi()});function zE({initialData:e,onSubmit:r,isSubmitting:a=!1}){const n=Zr({resolver:Jr(mG),defaultValues:{name:e?.name??"",subject:e?.subject??"",category:e?.category??"newsletter",htmlContent:e?.htmlContent??`<html>
  <body>
    <h1>Ol {{contact.FIRSTNAME}}</h1>
    <p>Escreva seu contedo aqui...</p>
  </body>
</html>`,isActive:e?.isActive??!0}}),i=async o=>{await r(o)};return t.jsx(es,{...n,children:t.jsxs("form",{className:"space-y-6",onSubmit:n.handleSubmit(i),children:[t.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[t.jsx(Te,{children:t.jsxs(Ce,{className:"space-y-4 pt-6",children:[t.jsx(nt,{control:n.control,name:"name",render:({field:o})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Nome do Template"}),t.jsx(it,{children:t.jsx(dt,{placeholder:"Ex: Newsletter Mensal",...o})}),t.jsx(ps,{children:"Nome interno para identificar o template."}),t.jsx(xt,{})]})}),t.jsx(nt,{control:n.control,name:"subject",render:({field:o})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Assunto do Email"}),t.jsx(it,{children:t.jsx(dt,{placeholder:"Ex: Novidades da semana para voc",...o})}),t.jsx(ps,{children:"O assunto que aparecer na caixa de entrada."}),t.jsx(xt,{})]})}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsx(nt,{control:n.control,name:"category",render:({field:o})=>t.jsxs(st,{children:[t.jsx(ct,{children:"Categoria"}),t.jsxs(Rt,{defaultValue:o.value??"newsletter",onValueChange:o.onChange,children:[t.jsx(it,{children:t.jsx(At,{children:t.jsx(Mt,{placeholder:"Selecione..."})})}),t.jsxs(kt,{children:[t.jsx(ye,{value:"newsletter",children:"Newsletter"}),t.jsx(ye,{value:"promocional",children:"Promocional"}),t.jsx(ye,{value:"transacional",children:"Transacional"}),t.jsx(ye,{value:"boas_vindas",children:"Boas-vindas"}),t.jsx(ye,{value:"outro",children:"Outro"})]})]}),t.jsx(xt,{})]})}),t.jsx(nt,{control:n.control,name:"isActive",render:({field:o})=>t.jsxs(st,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[t.jsx(it,{children:t.jsx(jr,{checked:o.value??!0,onCheckedChange:o.onChange})}),t.jsxs("div",{className:"space-y-1 leading-none",children:[t.jsx(ct,{children:"Ativo"}),t.jsx(ps,{children:"Disponvel para uso"})]})]})})]})]})}),t.jsx(Te,{className:"flex h-full flex-col",children:t.jsx(Ce,{className:"flex h-full grow flex-col pt-6",children:t.jsx(nt,{control:n.control,name:"htmlContent",render:({field:o})=>t.jsxs(st,{className:"flex h-full grow flex-col",children:[t.jsx(ct,{children:"Contedo HTML"}),t.jsx(it,{children:t.jsx(xi,{className:"min-h-[250px] grow resize-none bg-muted/50 font-mono text-xs",placeholder:"<html>...</html>",...o})}),t.jsx(xt,{})]})})})})]}),t.jsxs("div",{className:"flex justify-end gap-4",children:[t.jsx(oe,{onClick:()=>window.history.back(),type:"button",variant:"outline",children:"Cancelar"}),t.jsx(oe,{disabled:a,type:"submit",children:a?t.jsxs(t.Fragment,{children:[t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}),"Salvando..."]}):t.jsxs(t.Fragment,{children:[t.jsx(_N,{className:"mr-2 h-4 w-4"}),"Salvar Template"]})})]})]})})}const xG=Pa({search:Ke().catch(""),category:Ke().catch("all")}),pG=jt("/_authenticated/marketing/templates/novo")({component:gG,validateSearch:xG});function gG(){const{handleCreateTemplate:e}=Ag();return t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"font-bold text-2xl tracking-tight",children:"Novo Template"}),t.jsx("p",{className:"text-muted-foreground",children:"Crie um novo template de email para suas campanhas."})]}),t.jsx(zE,{onSubmit:async r=>{await e(r)}})]})}const vG=Pa({search:Ke().catch(""),category:Ke().catch("all")}),VE=jt("/_authenticated/marketing/templates/$templateId")({component:yG,validateSearch:vG});function yG(){const e=hi(),{templateId:r}=VE.useParams(),{handleUpdateTemplate:a}=Ag(),{data:n}=et.emailMarketing.templates.list.useQuery(),i=Number(r),o=n?.find(u=>u.id===i);return n===void 0?t.jsx("div",{className:"flex h-64 items-center justify-center p-6",children:t.jsx(pt,{className:"h-8 w-8 animate-spin text-primary"})}):o?t.jsxs("div",{className:"space-y-6 p-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"font-bold text-2xl tracking-tight",children:"Editar Template"}),t.jsxs("p",{className:"text-muted-foreground",children:['Modifique o template "',o.name,'" conforme necessrio.']})]}),t.jsx(zE,{initialData:{name:o.name,subject:o.subject,category:o.category??void 0,htmlContent:o.htmlContent,isActive:o.isActive},onSubmit:async u=>{await a(o.id,u),e({to:"/marketing/templates",search:{search:"",category:"all"}})}})]}):t.jsxs("div",{className:"p-6",children:[t.jsx("h1",{className:"font-bold text-2xl text-destructive tracking-tight",children:"Template no encontrado"}),t.jsx("p",{className:"mt-2 text-muted-foreground",children:"O template solicitado no existe ou foi removido."})]})}const gp=jt("/_authenticated/marketing/listas/$listId")({component:_G}),jG={subscribed:{label:"Inscrito",variant:"default"},unsubscribed:{label:"Desinscrito",variant:"secondary"},pending:{label:"Pendente",variant:"outline"},bounced:{label:"Bounced",variant:"destructive"}};function bG(){return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(gt,{className:"h-10 w-10"}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(gt,{className:"h-8 w-48"}),t.jsx(gt,{className:"h-4 w-64"})]})]}),t.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[t.jsx(gt,{className:"h-24"}),t.jsx(gt,{className:"h-24"})]}),t.jsx(gt,{className:"h-[300px] w-full"})]})}function NG({onBack:e}){return t.jsxs("div",{className:"space-y-6",children:[t.jsxs(oe,{onClick:e,variant:"ghost",children:[t.jsx(mi,{className:"mr-2 h-4 w-4"}),"Voltar para listas"]}),t.jsx(Te,{children:t.jsxs(Ce,{className:"flex flex-col items-center justify-center py-12",children:[t.jsx(el,{className:"mb-4 h-12 w-12 text-muted-foreground"}),t.jsx("h2",{className:"font-semibold text-lg",children:"Lista no encontrada"}),t.jsx("p",{className:"mt-2 text-muted-foreground text-sm",children:"A lista que voc procura no existe ou foi removida."}),t.jsx(oe,{className:"mt-6",onClick:e,children:"Voltar para listas"})]})})]})}function wG({availableContacts:e,isOpen:r,onOpenChange:a,onAdd:n,isAdding:i}){const[o,u]=C.useState(""),d=async()=>{o&&(await n(Number(o)),u(""))};return t.jsxs(_r,{onOpenChange:a,open:r,children:[t.jsx(Qi,{asChild:!0,children:t.jsxs(oe,{children:[t.jsx(yp,{className:"mr-2 h-4 w-4"}),"Adicionar Contato"]})}),t.jsxs(fr,{children:[t.jsxs(hr,{children:[t.jsx(mr,{children:"Adicionar Contato  Lista"}),t.jsx(ts,{children:"Selecione um contato para adicionar a esta lista de distribuio."})]}),e.length===0?t.jsxs("div",{className:"py-6 text-center text-muted-foreground",children:[t.jsx(ya,{className:"mx-auto mb-2 h-8 w-8"}),t.jsx("p",{children:"Todos os contatos j esto nesta lista."})]}):t.jsx("div",{className:"py-4",children:t.jsxs(Rt,{onValueChange:u,value:o,children:[t.jsx(At,{children:t.jsx(Mt,{placeholder:"Selecione um contato..."})}),t.jsx(kt,{children:e.map(h=>t.jsx(ye,{value:String(h.id),children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{children:h.firstName||h.lastName?`${h.firstName??""} ${h.lastName??""}`.trim():h.email}),t.jsxs("span",{className:"text-muted-foreground",children:["(",h.email,")"]})]})},h.id))})]})}),t.jsxs(di,{children:[t.jsx(oe,{onClick:()=>a(!1),variant:"outline",children:"Cancelar"}),t.jsx(oe,{disabled:!o||i,onClick:d,children:i?t.jsxs(t.Fragment,{children:[t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}),"Adicionando..."]}):t.jsxs(t.Fragment,{children:[t.jsx(_n,{className:"mr-2 h-4 w-4"}),"Adicionar"]})})]})]})]})}function SG({contacts:e,onRemove:r,isRemoving:a}){return e.length===0?t.jsxs("div",{className:"rounded-lg border border-dashed p-8 text-center text-muted-foreground",children:[t.jsx(ya,{className:"mx-auto mb-2 h-8 w-8"}),t.jsx("p",{className:"font-medium",children:"Nenhum contato nesta lista"}),t.jsx("p",{className:"mt-1 text-sm",children:"Adicione contatos para comear a usar esta lista em suas campanhas."})]}):t.jsx("div",{className:"rounded-lg border",children:t.jsxs(Ya,{children:[t.jsx(Xa,{children:t.jsxs(Tt,{children:[t.jsx(He,{children:"Nome"}),t.jsx(He,{children:"E-mail"}),t.jsx(He,{children:"Status"}),t.jsx(He,{className:"w-[100px]",children:"Aes"})]})}),t.jsx($a,{children:e.map(n=>{const i=jG[n.subscriptionStatus],o=n.firstName||n.lastName?`${n.firstName??""} ${n.lastName??""}`.trim():"-";return t.jsxs(Tt,{children:[t.jsx(Pe,{className:"font-medium",children:o}),t.jsx(Pe,{children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(rr,{className:"h-4 w-4 text-muted-foreground"}),n.email]})}),t.jsx(Pe,{children:t.jsx(Ve,{variant:i.variant,children:i.label})}),t.jsx(Pe,{children:t.jsxs(md,{children:[t.jsx(xd,{asChild:!0,children:t.jsx(oe,{className:"text-destructive hover:bg-destructive/10 hover:text-destructive",disabled:a===n.id,size:"icon",variant:"ghost",children:a===n.id?t.jsx(pt,{className:"h-4 w-4 animate-spin"}):t.jsx(nk,{className:"h-4 w-4"})})}),t.jsxs(eo,{children:[t.jsxs(to,{children:[t.jsx(ro,{children:"Remover contato?"}),t.jsxs(so,{children:['Voc est prestes a remover "',n.email,'" desta lista. O contato no ser excludo, apenas removido desta lista.']})]}),t.jsxs(ao,{children:[t.jsx(io,{children:"Cancelar"}),t.jsx(no,{className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",onClick:()=>r(n.id),children:"Remover"})]})]})]})})]},n.id)})})]})})}function _G(){const{listId:e}=gp.useParams(),r=gp.useNavigate(),[a,n]=C.useState(!1),[i,o]=C.useState(!1),[u,d]=C.useState(null),[h,m]=C.useState(!1),[p,v]=C.useState(!1),[y,N]=C.useState(!1),{data:j}=et.emailMarketing.lists.list.useQuery(),b=j?.find(L=>L.id===Number(e))??null,{data:w}=et.emailMarketing.contacts.list.useQuery(),T=L=>{Ie.info(`[TODO] ${L} no implementado no backend`)},{contactsInList:D,contactsNotInList:_}=C.useMemo(()=>{if(!w)return{contactsInList:[],contactsNotInList:[]};const L=[],H=[];for(const I of w)I.listIds?.includes(Number(e))?L.push(I):H.push(I);return{contactsInList:L,contactsNotInList:H}},[w,e]),R=()=>{r({to:"/marketing/listas",search:{search:"",status:"all",view:"grid",page:1}})},z=()=>{if(b){N(!0);try{T("updateList"),Ie.success(b.isActive?"Lista desativada":"Lista ativada",{description:b.isActive?"A lista no ser mais usada para novas campanhas.":"A lista agora pode ser usada em campanhas."})}catch(L){Ie.error("Erro ao atualizar lista",{description:L instanceof Error?L.message:"Ocorreu um erro inesperado. Tente novamente."})}finally{N(!1)}}},O=()=>{if(b){m(!0);try{T("syncListToBrevo"),Ie.success("Sincronizao concluda",{description:"A lista foi sincronizada com o Brevo."})}catch(L){Ie.error("Erro ao sincronizar",{description:L instanceof Error?L.message:"No foi possvel sincronizar com o Brevo."})}finally{m(!1)}}},A=()=>{if(b){v(!0);try{T("deleteList"),Ie.success("Lista excluda",{description:"A lista foi excluda com sucesso."}),R()}catch(L){Ie.error("Erro ao excluir lista",{description:L instanceof Error?L.message:"Ocorreu um erro inesperado. Tente novamente."})}finally{v(!1)}}},k=async L=>{if(b){o(!0);try{T("addContactToList"),Ie.success("Contato adicionado",{description:"O contato foi adicionado  lista com sucesso."}),n(!1)}catch(H){Ie.error("Erro ao adicionar contato",{description:H instanceof Error?H.message:"Ocorreu um erro inesperado. Tente novamente."})}finally{o(!1)}}},E=async L=>{if(b){d(L);try{T("removeContactFromList"),Ie.success("Contato removido",{description:"O contato foi removido da lista."})}catch(H){Ie.error("Erro ao remover contato",{description:H instanceof Error?H.message:"Ocorreu um erro inesperado. Tente novamente."})}finally{d(null)}}};return b===void 0||w===void 0?t.jsx(bG,{}):b===null?t.jsx(NG,{onBack:R}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(oe,{onClick:R,size:"icon",variant:"ghost",children:t.jsx(mi,{className:"h-4 w-4"})}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("h1",{className:"font-bold text-2xl tracking-tight",children:b.name}),t.jsx(Ve,{variant:b.isActive?"default":"secondary",children:b.isActive?"Ativa":"Inativa"}),b.brevoListId?t.jsxs(Ve,{className:"gap-1",variant:"outline",children:[t.jsx(TN,{className:"h-3 w-3"}),"Brevo"]}):t.jsxs(Ve,{className:"gap-1 text-muted-foreground",variant:"outline",children:[t.jsx(EN,{className:"h-3 w-3"}),"No sincronizada"]})]}),b.description&&t.jsx("p",{className:"text-muted-foreground",children:b.description})]})]}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsx(oe,{disabled:h,onClick:O,variant:"outline",children:h?t.jsxs(t.Fragment,{children:[t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}),"Sincronizando..."]}):t.jsxs(t.Fragment,{children:[t.jsx(tl,{className:"mr-2 h-4 w-4"}),"Sincronizar Brevo"]})})})]}),t.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Contatos"}),t.jsx(ya,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsxs(Ce,{children:[t.jsx("div",{className:"font-bold text-2xl",children:D.length}),t.jsx("p",{className:"text-muted-foreground text-xs",children:"contatos nesta lista"})]})]}),t.jsxs(Te,{children:[t.jsxs(Me,{className:"flex flex-row items-center justify-between pb-2",children:[t.jsx(Le,{className:"font-medium text-sm",children:"Status"}),t.jsx(Cu,{className:"h-4 w-4 text-muted-foreground"})]}),t.jsx(Ce,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm",children:b.isActive?"Lista Ativa":"Lista Inativa"}),t.jsx(Ks,{checked:b.isActive,disabled:y,onCheckedChange:z})]})})]})]}),t.jsxs(Te,{children:[t.jsx(Me,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs(Le,{className:"flex items-center gap-2",children:[t.jsx(Cu,{className:"h-5 w-5"}),"Informaes da Lista"]}),t.jsx(ta,{children:"Detalhes e configuraes da lista de contatos"})]}),t.jsxs(oe,{disabled:!0,size:"sm",variant:"outline",children:[t.jsx(ed,{className:"mr-2 h-4 w-4"}),"Editar"]})]})}),t.jsxs(Ce,{className:"space-y-4",children:[t.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-muted-foreground text-sm",children:"Nome"}),t.jsx("p",{className:"mt-1",children:b.name})]}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-muted-foreground text-sm",children:"Descrio"}),t.jsx("p",{className:"mt-1",children:b.description||"-"})]})]}),b.brevoListId&&t.jsxs(t.Fragment,{children:[t.jsx(Sa,{}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-muted-foreground text-sm",children:"ID Brevo"}),t.jsxs("p",{className:"mt-1 flex items-center gap-2",children:[t.jsx(Fc,{className:"h-4 w-4 text-muted-foreground"}),t.jsx("code",{className:"rounded bg-muted px-2 py-0.5 text-sm",children:b.brevoListId})]})]})]}),t.jsx(Sa,{}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-destructive",children:"Zona de Perigo"}),t.jsx("p",{className:"text-muted-foreground text-sm",children:"Excluir esta lista permanentemente. Esta ao no pode ser desfeita."})]}),t.jsxs(md,{children:[t.jsx(xd,{asChild:!0,children:t.jsx(oe,{disabled:p,variant:"destructive",children:p?t.jsxs(t.Fragment,{children:[t.jsx(pt,{className:"mr-2 h-4 w-4 animate-spin"}),"Excluindo..."]}):t.jsxs(t.Fragment,{children:[t.jsx(al,{className:"mr-2 h-4 w-4"}),"Excluir Lista"]})})}),t.jsxs(eo,{children:[t.jsxs(to,{children:[t.jsx(ro,{children:"Excluir lista?"}),t.jsxs(so,{children:['Voc est prestes a excluir a lista "',b.name,'". Esta ao no pode ser desfeita. Os contatos no sero excludos, apenas removidos desta lista.']})]}),t.jsxs(ao,{children:[t.jsx(io,{children:"Cancelar"}),t.jsx(no,{className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",onClick:A,children:"Excluir"})]})]})]})]})]})]}),t.jsxs(Te,{children:[t.jsx(Me,{children:t.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[t.jsxs("div",{children:[t.jsxs(Le,{className:"flex items-center gap-2",children:[t.jsx(ya,{className:"h-5 w-5"}),"Contatos (",D.length,")"]}),t.jsx(ta,{children:"Gerencie os contatos que pertencem a esta lista"})]}),t.jsx(wG,{availableContacts:_,isAdding:i,isOpen:a,onAdd:k,onOpenChange:n})]})}),t.jsx(Ce,{children:t.jsx(SG,{contacts:D,isRemoving:u,onRemove:E})})]})]})}const HE=jt("/_authenticated/marketing/$campaignId/edit")({component:EG});function EG(){const e=C.useId(),[r,a]=C.useState(!1),n=hi(),{campaignId:i}=HE.useParams(),o=Number(i),{data:u}=et.emailMarketing.campaigns.get.useQuery({id:o}),d=u===void 0,{data:h}=et.emailMarketing.lists.list.useQuery(),m=et.emailMarketing.campaigns.create.useMutation(),[p,v]=C.useState({name:"",subject:"",listIds:[],status:"draft"});C.useEffect(()=>{u&&v({name:u.name,subject:u.subject||"",listIds:u.listIds||[],status:u.status})},[u]);const y=async j=>{if(j.preventDefault(),!!u){a(!0);try{const{status:b,...w}=p;await m.mutateAsync({...w}),Ie.success("Campanha atualizada com sucesso!",{description:"As alteraes foram salvas."}),n({to:"/marketing",search:{search:"",status:"all",view:"grid",page:1}})}catch(b){Ie.error("Erro ao atualizar campanha",{description:b instanceof Error?b.message:"Ocorreu um erro inesperado. Tente novamente."})}finally{a(!1)}}},N=j=>{v(b=>{const T=b.listIds.includes(j)?b.listIds.filter(D=>D!==j):[...b.listIds,j];return{...b,listIds:T}})};return d?t.jsx("div",{className:"flex min-h-[calc(100vh-64px)] items-center justify-center",children:t.jsx(pt,{className:"h-8 w-8 animate-spin"})}):u?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(oe,{onClick:()=>n({to:"/marketing"}),size:"icon",variant:"ghost",children:t.jsx(mi,{className:"mr-2 h-4 w-4"})}),t.jsx("h1",{className:"font-bold text-xl",children:"Editar Campanha"})]}),t.jsxs(Te,{children:[t.jsx(Me,{children:t.jsx(Le,{children:"Informaes da Campanha"})}),t.jsx(Ce,{children:t.jsxs("form",{className:"space-y-6",onSubmit:y,children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(yt,{htmlFor:`${e}-name`,children:"Nome da Campanha"}),t.jsx(dt,{id:`${e}-name`,onChange:j=>v({...p,name:j.target.value}),placeholder:"Ex: Black Friday 2025",required:!0,type:"text",value:p.name})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(yt,{htmlFor:`${e}-subject`,children:"Assunto"}),t.jsx(dt,{id:`${e}-subject`,onChange:j=>v({...p,subject:j.target.value}),placeholder:"Ofertas exclusivas para VIPs",required:!0,type:"text",value:p.subject})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(yt,{htmlFor:`${e}-status`,children:"Status"}),t.jsxs("select",{className:"w-full",id:`${e}-status`,onChange:j=>v({...p,status:j.target.value}),value:p.status,children:[t.jsx("option",{value:"draft",children:"Rascunho"}),t.jsx("option",{value:"scheduled",children:"Agendada"}),t.jsx("option",{value:"sending",children:"Enviando"}),t.jsx("option",{value:"sent",children:"Enviada"}),t.jsx("option",{value:"failed",children:"Falhou"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(yt,{children:"Selecione as Listas de E-mail"}),d?t.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm",children:[t.jsx(pt,{className:"h-4 w-4 animate-spin"}),"Carregando listas..."]}):t.jsx("div",{className:"space-y-2",children:h?.map(j=>t.jsxs("div",{className:"flex items-center gap-3 rounded-lg border p-3",children:[t.jsx("input",{checked:p.listIds.includes(j.id),className:"h-5 w-5",id:`list-${j.id}`,onChange:()=>N(j.id),type:"checkbox"}),t.jsx(yt,{className:"flex-1 cursor-pointer",htmlFor:`list-${j.id}`,children:j.name})]},j.id))})]}),t.jsx(Sa,{}),t.jsxs("div",{className:"flex items-center justify-end gap-3",children:[t.jsx(oe,{onClick:()=>n({to:"/marketing"}),type:"button",variant:"outline",children:"Cancelar"}),t.jsx(oe,{disabled:r,type:"submit",children:r?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(pt,{className:"h-4 w-4 animate-spin"}),"Salvando..."]}):"Salvar Alteraes"})]})]})})]})]}):t.jsx("div",{className:"flex min-h-[calc(100vh-64px)] items-center justify-center",children:t.jsx(Te,{className:"w-full max-w-md",children:t.jsxs(Ce,{className:"flex flex-col items-center justify-center py-12",children:[t.jsx(ci,{className:"mb-4 h-12 w-12 text-muted-foreground"}),t.jsx("h2",{className:"font-semibold text-lg",children:"Campanha no encontrada"}),t.jsx("p",{className:"mt-2 text-muted-foreground text-sm",children:"A campanha que voc procura no existe ou foi removida."}),t.jsx(oe,{onClick:()=>n({to:"/marketing"}),children:"Voltar para campanhas"})]})})})}function TG({onSend:e,disabled:r,placeholder:a="Digite sua mensagem..."}){const[n,i]=C.useState(""),[o,u]=C.useState(!1),[d,h]=C.useState(""),{pendingMessage:m,setPendingMessage:p}=Tg();C.useEffect(()=>{m&&(i(_=>_?`${_}
${m}`:m),p(""))},[m,p]);const v=[],y=async _=>{if(_?.preventDefault(),!(!n.trim()||o||r)){u(!0);try{await e(n.trim()),i("")}finally{u(!1)}}},N=_=>{_.key==="Enter"&&!_.shiftKey&&(_.preventDefault(),y())},j=_=>{i(R=>R?`${R}
${_}`:_),w(!1)},[b,w]=C.useState(!1),T=v?.filter(_=>_.name.toLowerCase().includes(d.toLowerCase())||_.content.toLowerCase().includes(d.toLowerCase()));let D=null;return v===void 0?D=t.jsx("div",{className:"p-4 text-center text-muted-foreground text-xs",children:"Carregando..."}):T?.length===0?D=t.jsx("div",{className:"p-4 text-center text-muted-foreground text-xs",children:"Nenhum modelo encontrado"}):D=t.jsx("div",{className:"p-1",children:T?.map(_=>t.jsxs("button",{className:"group w-full rounded-md p-2 text-left text-sm transition-colors hover:bg-muted",onClick:()=>{j(_.content),w(!1)},type:"button",children:[t.jsxs("div",{className:"mb-1 flex items-center justify-between",children:[t.jsx("span",{className:"font-medium text-xs",children:_.name}),t.jsx(Ve,{className:"px-1 py-0 text-[10px]",variant:"outline",children:_.category})]}),t.jsx("p",{className:"line-clamp-2 text-muted-foreground text-xs",children:_.content})]},_.id))}),t.jsxs("form",{className:"border-t bg-background/95 p-4 backdrop-blur supports-backdrop-filter:bg-background/60",onSubmit:y,children:[t.jsxs("div",{className:"flex items-end gap-2",children:[t.jsx(oe,{className:"shrink-0",disabled:r,size:"icon",type:"button",variant:"ghost",children:t.jsx(ik,{className:"h-5 w-5 text-muted-foreground"})}),t.jsxs("div",{className:"relative flex-1",children:[t.jsx(xi,{className:me("max-h-[120px] min-h-[44px] resize-none pr-10","focus-visible:ring-purple-500"),disabled:r||o,onChange:_=>i(_.target.value),onKeyDown:N,placeholder:a,rows:1,value:n}),t.jsxs(_g,{onOpenChange:w,open:b,children:[t.jsx(Eg,{asChild:!0,children:t.jsx(oe,{className:"absolute top-1/2 right-1 h-8 w-8 -translate-y-1/2",disabled:r,size:"icon",type:"button",variant:"ghost",children:t.jsx(lk,{className:"h-5 w-5 text-muted-foreground"})})}),t.jsxs(G0,{align:"end",className:"w-80 p-0",children:[t.jsx("div",{className:"border-b p-3",children:t.jsxs("div",{className:"relative",children:[t.jsx(Ms,{className:"absolute top-1/2 left-2 h-3 w-3 -translate-y-1/2 text-muted-foreground"}),t.jsx(dt,{className:"h-8 pl-8 text-xs",onChange:_=>h(_.target.value),placeholder:"Buscar modelos...",value:d})]})}),t.jsx(sd,{className:"h-64",children:D})]})]})]}),t.jsx(oe,{className:"shrink-0 bg-linear-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700",disabled:!n.trim()||o||r,size:"icon",type:"submit",children:o?t.jsx(pt,{className:"h-5 w-5 animate-spin"}):t.jsx(Nn,{className:"h-5 w-5"})})]}),t.jsx("p",{className:"mt-2 text-center text-muted-foreground text-xs",children:"Pressione Enter para enviar, Shift + Enter para nova linha"})]})}const CG={enviando:t.jsx(rn,{className:"h-3 w-3 text-muted-foreground"}),enviado:t.jsx(Xu,{className:"h-3 w-3 text-muted-foreground"}),entregue:t.jsx(bj,{className:"h-3 w-3 text-muted-foreground"}),lido:t.jsx(bj,{className:"h-3 w-3 text-primary"}),falhou:t.jsx(el,{className:"h-3 w-3 text-destructive"})};function AG({message:e,isOwn:r}){const a=e.sender==="system",n=e.sender==="bot";if(a)return t.jsx("div",{className:"my-2 flex justify-center",children:t.jsx("span",{className:"rounded-full bg-muted/50 px-3 py-1 text-muted-foreground text-xs",children:e.content})});let i="rounded-bl-md bg-muted";return r?i="rounded-br-md bg-linear-to-r from-purple-600 to-indigo-600 text-white":n&&(i="rounded-bl-md border border-amber-200 bg-amber-100 text-amber-900"),t.jsx("div",{className:me("mb-3 flex",r?"justify-end":"justify-start"),children:t.jsxs("div",{className:me("max-w-[75%] rounded-2xl px-4 py-2 shadow-sm",i),children:[n&&t.jsx("span",{className:"mb-1 block font-medium text-xs opacity-75",children:" Bot"}),e.contentType==="image"&&e.mediaUrl&&t.jsx("img",{alt:"Imagem",className:"mb-2 h-auto w-auto max-w-full rounded-lg",height:"300",src:e.mediaUrl,width:"400"}),e.contentType==="audio"&&e.mediaUrl&&t.jsxs("audio",{className:"mb-2 max-w-full",controls:!0,children:[t.jsx("source",{src:e.mediaUrl}),t.jsx("track",{kind:"captions"})]}),t.jsx("p",{className:"wrap-break-word text-sm",children:e.content}),t.jsxs("div",{className:me("mt-1 flex items-center gap-1",r?"justify-end":"justify-start"),children:[t.jsx("span",{className:me("text-xs",r?"text-white/70":"text-muted-foreground"),children:bn(e.createdAt??e.createdAt,{addSuffix:!0,locale:Ir})}),r&&e.status&&CG[e.status]]})]})})}function kG({conversation:e,messages:r,onBack:a,onSendMessage:n}){const i=C.useRef(null);C.useEffect(()=>{if(i.current){const m=i.current.querySelector("[data-radix-scroll-area-viewport]")||i.current;(m.scrollHeight-m.scrollTop-m.clientHeight<100||!r||r.length===0)&&(m.scrollTop=m.scrollHeight)}},[r]);const o=async m=>{e!=null&&await n(m)};if(e===void 0)return t.jsx("div",{className:"flex h-full items-center justify-center",children:t.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent"})});if(e===null)return t.jsx("div",{className:"flex h-full items-center justify-center text-muted-foreground",children:"Conversa no encontrada"});const d=e.contactName||e.channel;let h=null;return r===void 0?h=t.jsx("div",{className:"space-y-4",children:[1,2,3].map(m=>t.jsx("div",{className:"flex gap-3",children:t.jsx("div",{className:"h-12 w-48 animate-pulse rounded-lg bg-muted/20"})},m))}):r.length===0?h=t.jsxs("div",{className:"flex h-full flex-col items-center justify-center text-muted-foreground",children:[t.jsx("p",{children:"Nenhuma mensagem ainda"}),t.jsx("p",{className:"text-sm",children:"Envie uma mensagem para comear"})]}):h=t.jsx("div",{className:"space-y-1 pb-4",children:r.map(m=>t.jsx(AG,{isOwn:m.sender==="agent",message:m},m.id))}),t.jsxs("div",{className:"flex h-full flex-col bg-background",children:[t.jsx("div",{className:"sticky top-0 z-10 border-b bg-background/95 px-4 py-3 backdrop-blur supports-backdrop-filter:bg-background/60",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[a&&t.jsx(oe,{className:"md:hidden",onClick:a,size:"icon",variant:"ghost",children:t.jsx(mi,{className:"h-5 w-5"})}),t.jsx("div",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-linear-to-br from-purple-500 to-indigo-500 text-white",children:t.jsx(li,{className:"h-5 w-5"})}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("h3",{className:"font-semibold text-sm",children:d}),t.jsx(Ve,{className:"h-5 px-1 text-[10px] capitalize",variant:"secondary",children:e.department})]}),t.jsx("p",{className:"text-muted-foreground text-xs capitalize",children:e.status.replace(/_/g," ")})]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(oe,{className:"hidden sm:inline-flex",size:"icon",variant:"ghost",children:t.jsx(Yu,{className:"h-4 w-4"})}),t.jsx(oe,{className:"hidden sm:inline-flex",size:"icon",variant:"ghost",children:t.jsx(ck,{className:"h-4 w-4"})}),t.jsxs(q0,{children:[t.jsx(W0,{asChild:!0,children:t.jsx(oe,{size:"icon",variant:"ghost",children:t.jsx(Ep,{className:"h-4 w-4"})})}),t.jsxs(pd,{align:"end",children:[t.jsx(gs,{children:"Ver perfil"}),t.jsx(gs,{children:"Transferir conversa"}),t.jsx(gs,{children:"Resolver conversa"}),t.jsx(gs,{className:"text-destructive",children:"Arquivar"})]})]})]})]})}),t.jsx(sd,{className:"flex-1 p-4",ref:i,children:h}),t.jsx(TG,{disabled:e==null,onSend:o})]})}const GE=jt("/_authenticated/chat/$department/$id")({component:DG});function DG(){const{department:e,id:r}=GE.useParams(),a=hi(),{data:n}=et.conversations.get.useQuery({id:Number(r)}),{data:i}=et.messages.listByConversation.useQuery({conversationId:Number(r)}),o=et.messages.send.useMutation(),u=async d=>{await o.mutateAsync({conversationId:r,content:d,contentType:"text"})};return t.jsx("div",{className:"h-full w-full",children:t.jsx(kG,{conversation:n,messages:i,onBack:()=>{a({to:"/chat/$department",params:{department:e}})},onSendMessage:u})})}const Dn=zD.update({id:"/_authenticated",getParentRoute:()=>Tn}),OG=rO.update({id:"/",path:"/",getParentRoute:()=>Tn}),RG=nO.update({id:"/sign-up/",path:"/sign-up/",getParentRoute:()=>Tn}),MG=lO.update({id:"/sign-in/",path:"/sign-in/",getParentRoute:()=>Tn}),FG=Tw.update({id:"/captura/",path:"/captura/",getParentRoute:()=>Tn}),IG=SO.update({id:"/sign-up/sso-callback",path:"/sign-up/sso-callback",getParentRoute:()=>Tn}),LG=EO.update({id:"/sign-up/$",path:"/sign-up/$",getParentRoute:()=>Tn}),PG=CO.update({id:"/sign-in/sso-callback",path:"/sign-in/sso-callback",getParentRoute:()=>Tn}),BG=kO.update({id:"/sign-in/$",path:"/sign-in/$",getParentRoute:()=>Tn}),qE=cp.update({id:"/students",path:"/students",getParentRoute:()=>Dn}),Ps=BB.update({id:"/settings",path:"/settings",getParentRoute:()=>Dn}),Dg=HB.update({id:"/reports",path:"/reports",getParentRoute:()=>Dn}),On=qB.update({id:"/marketing",path:"/marketing",getParentRoute:()=>Dn}),X0=SU.update({id:"/financial",path:"/financial",getParentRoute:()=>Dn}),UG=RU.update({id:"/dashboard",path:"/dashboard",getParentRoute:()=>Dn}),zG=up.update({id:"/crm",path:"/crm",getParentRoute:()=>Dn}),Og=WU.update({id:"/chat",path:"/chat",getParentRoute:()=>Dn}),VG=$U.update({id:"/",path:"/",getParentRoute:()=>Ps}),HG=ZU.update({id:"/",path:"/",getParentRoute:()=>On}),GG=JU.update({id:"/",path:"/",getParentRoute:()=>Og}),qG=dp.update({id:"/$studentId",path:"/$studentId",getParentRoute:()=>qE}),WG=bz.update({id:"/templates",path:"/templates",getParentRoute:()=>Ps}),YG=Lz.update({id:"/team",path:"/team",getParentRoute:()=>Ps}),XG=Bz.update({id:"/tags",path:"/tags",getParentRoute:()=>Ps}),$G=zz.update({id:"/security",path:"/security",getParentRoute:()=>Ps}),KG=Hz.update({id:"/roles",path:"/roles",getParentRoute:()=>Ps}),QG=Wz.update({id:"/profile",path:"/profile",getParentRoute:()=>Ps}),ZG=eV.update({id:"/notifications",path:"/notifications",getParentRoute:()=>Ps}),JG=CE.update({id:"/integrations",path:"/integrations",getParentRoute:()=>Ps}),eq=pV.update({id:"/custom-fields",path:"/custom-fields",getParentRoute:()=>Ps}),tq=gV.update({id:"/appearance",path:"/appearance",getParentRoute:()=>Ps}),aq=yV.update({id:"/team",path:"/team",getParentRoute:()=>Dg}),rq=bV.update({id:"/sales",path:"/sales",getParentRoute:()=>Dg}),Rg=AE.update({id:"/templates",path:"/templates",getParentRoute:()=>On}),sq=kE.update({id:"/nova",path:"/nova",getParentRoute:()=>On}),WE=DE.update({id:"/listas",path:"/listas",getParentRoute:()=>On}),nq=OE.update({id:"/leads",path:"/leads",getParentRoute:()=>On}),iq=WV.update({id:"/dashboard",path:"/dashboard",getParentRoute:()=>On}),lq=RE.update({id:"/contatos",path:"/contatos",getParentRoute:()=>On}),cq=ME.update({id:"/campanhas",path:"/campanhas",getParentRoute:()=>On}),YE=pp.update({id:"/$campaignId",path:"/$campaignId",getParentRoute:()=>On}),oq=qH.update({id:"/reports",path:"/reports",getParentRoute:()=>X0}),uq=YH.update({id:"/payments",path:"/payments",getParentRoute:()=>X0}),dq=QH.update({id:"/dashboard",path:"/dashboard",getParentRoute:()=>X0}),Mg=BE.update({id:"/$department",path:"/$department",getParentRoute:()=>Og}),fq=tG.update({id:"/",path:"/",getParentRoute:()=>Mg}),hq=fG.update({id:"/admin/asaas/",path:"/admin/asaas/",getParentRoute:()=>Dn}),mq=pG.update({id:"/novo",path:"/novo",getParentRoute:()=>Rg}),xq=VE.update({id:"/$templateId",path:"/$templateId",getParentRoute:()=>Rg}),pq=gp.update({id:"/$listId",path:"/$listId",getParentRoute:()=>WE}),gq=HE.update({id:"/edit",path:"/edit",getParentRoute:()=>YE}),vq=GE.update({id:"/$id",path:"/$id",getParentRoute:()=>Mg}),yq={AuthenticatedChatDepartmentIdRoute:vq,AuthenticatedChatDepartmentIndexRoute:fq},jq=Mg._addFileChildren(yq),bq={AuthenticatedChatDepartmentRoute:jq,AuthenticatedChatIndexRoute:GG},Nq=Og._addFileChildren(bq),wq={AuthenticatedFinancialDashboardRoute:dq,AuthenticatedFinancialPaymentsRoute:uq,AuthenticatedFinancialReportsRoute:oq},Sq=X0._addFileChildren(wq),_q={AuthenticatedMarketingCampaignIdEditRoute:gq},Eq=YE._addFileChildren(_q),Tq={AuthenticatedMarketingListasListIdRoute:pq},Cq=WE._addFileChildren(Tq),Aq={AuthenticatedMarketingTemplatesTemplateIdRoute:xq,AuthenticatedMarketingTemplatesNovoRoute:mq},kq=Rg._addFileChildren(Aq),Dq={AuthenticatedMarketingCampaignIdRoute:Eq,AuthenticatedMarketingCampanhasRoute:cq,AuthenticatedMarketingContatosRoute:lq,AuthenticatedMarketingDashboardRoute:iq,AuthenticatedMarketingLeadsRoute:nq,AuthenticatedMarketingListasRoute:Cq,AuthenticatedMarketingNovaRoute:sq,AuthenticatedMarketingTemplatesRoute:kq,AuthenticatedMarketingIndexRoute:HG},Oq=On._addFileChildren(Dq),Rq={AuthenticatedReportsSalesRoute:rq,AuthenticatedReportsTeamRoute:aq},Mq=Dg._addFileChildren(Rq),Fq={AuthenticatedSettingsAppearanceRoute:tq,AuthenticatedSettingsCustomFieldsRoute:eq,AuthenticatedSettingsIntegrationsRoute:JG,AuthenticatedSettingsNotificationsRoute:ZG,AuthenticatedSettingsProfileRoute:QG,AuthenticatedSettingsRolesRoute:KG,AuthenticatedSettingsSecurityRoute:$G,AuthenticatedSettingsTagsRoute:XG,AuthenticatedSettingsTeamRoute:YG,AuthenticatedSettingsTemplatesRoute:WG,AuthenticatedSettingsIndexRoute:VG},Iq=Ps._addFileChildren(Fq),Lq={AuthenticatedStudentsStudentIdRoute:qG},Pq=qE._addFileChildren(Lq),Bq={AuthenticatedChatRoute:Nq,AuthenticatedCrmRoute:zG,AuthenticatedDashboardRoute:UG,AuthenticatedFinancialRoute:Sq,AuthenticatedMarketingRoute:Oq,AuthenticatedReportsRoute:Mq,AuthenticatedSettingsRoute:Iq,AuthenticatedStudentsRoute:Pq,AuthenticatedAdminAsaasIndexRoute:hq},Uq=Dn._addFileChildren(Bq),zq={IndexRoute:OG,AuthenticatedRoute:Uq,SignInSplatRoute:BG,SignInSsoCallbackRoute:PG,SignUpSplatRoute:LG,SignUpSsoCallbackRoute:IG,CapturaIndexRoute:FG,SignInIndexRoute:MG,SignUpIndexRoute:RG},Vq=Tn._addFileChildren(zq)._addFileTypes();NC({routeTree:Vq,context:{auth:void 0},defaultPreload:"intent"});throw new Error("Missing VITE_CLERK_PUBLISHABLE_KEY");export{I0 as $,qc as A,Ve as B,Te as C,_r as D,Mt as E,es as F,kt as G,ye as H,dt as I,q0 as J,W0 as K,pd as L,gs as M,yE as N,yt as O,_g as P,Eg as Q,G0 as R,gt as S,xi as T,X_ as U,xd as V,ts as W,di as X,Vp as Y,M0 as Z,F0 as _,Me as a,Hp as a0,Kc as a1,Ul as a2,Nr as a3,sd as a4,ei as a5,jr as a6,Ez as a7,Qi as a8,tO as a9,z0 as aa,ai as ab,k0 as ac,lp as ad,Kq as ae,Ya as af,Xa as ag,Tt as ah,He as ai,$a as aj,Pe as ak,UE as al,Sa as am,$q as an,Le as b,Ce as c,Wc as d,me as e,oe as f,md as g,eo as h,to as i,ro as j,so as k,ao as l,io as m,no as n,fr as o,Ir as p,hr as q,mr as r,nt as s,et as t,st as u,ct as v,it as w,xt as x,Rt as y,At as z};
