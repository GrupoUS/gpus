import{j as e,b as v,R as F}from"./vendor-C0IzTJ68.js";import{A as ee,d as ae,B as E,C as q,t as R,p as G,s as x,u as c,w as d,I as C,x as f,a6 as _,P as H,Q as z,f as $,e as A,R as W,U as se,y as k,z as S,E as P,G as I,H as o,v as j,S as B,a7 as ne,D as re,a8 as ie,a9 as O,o as te,q as oe,r as le,W as ce,F as de,T as ue,aa as xe,ab as L,a as me,b as he,c as pe,a4 as je}from"./index-C8YxpUQT.js";import{cG as fe,cF as X,cE as ge,cQ as ve,A as be,aG as U,an as ye,b2 as Ne,co as Ce,cM as we,N as ke,ac as Se,ab as Pe,p as V}from"./ui-eQKuYNMj.js";import{m as b,L as Ie,R as Te,A as Re,g as Ae}from"./animation-oFsG5JPT.js";import{a as Fe,c as De,o as Ee,r as Be,s as N,_ as w,b as Le,l as Ve,g as _e}from"./forms-CH1lNzbM.js";import{C as $e,a as Oe,b as Me,c as Qe,d as qe,e as Ge}from"./command-CoeuBcqE.js";import"./auth-CS6YH2iJ.js";import"./charts-CKNPyqfB.js";const D={type:"spring",stiffness:300,damping:30},He={type:"spring",stiffness:600,damping:35},ze={type:"spring",stiffness:300,damping:30,mass:.8},We={bounceStiffness:500,bounceDamping:30,power:.3,timeConstant:200},Xe={initial:{opacity:0,y:-20,scale:.95},animate:{opacity:1,y:0,scale:1,transition:D},exit:{opacity:0,scale:.8,transition:{duration:.2}},hover:{scale:1.02,boxShadow:"0 20px 40px -12px hsl(var(--primary) / 0.3)",transition:D},tap:{scale:.98,transition:He}},Ue={idle:{rotate:0,scale:1},hot:{rotate:[0,10,-10,0],scale:[1,1.1,1],transition:{repeat:Number.POSITIVE_INFINITY,duration:1,ease:"easeInOut"}}},M={frio:{icon:ge,color:"text-primary"},morno:{icon:X,color:"text-yellow-500"},quente:{icon:fe,color:"text-red-500"}},Ke={trintae3:"TRINTAE3",otb:"OTB MBA",black_neon:"Black NEON",comunidade:"Comunidade",auriculo:"AurÃ­culo",na_mesa_certa:"Na Mesa Certa"},Je=b.create(q);function Ye({lead:s}){const i=M[s.temperature]?.icon||X,l=s.temperature==="quente";return e.jsx(Je,{className:"lead-card cursor-grab p-3 will-change-transform active:cursor-grabbing",transition:D,variant:"glass",whileHover:{scale:1.02,boxShadow:"0 20px 40px -12px hsl(var(--primary) / 0.3)"},whileTap:{scale:.98},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ee,{className:"lead-avatar h-9 w-9",children:e.jsx(ae,{className:"bg-primary/10 font-display text-primary text-xs",children:s.name.split(" ").map(t=>t[0]).join("").slice(0,2)})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"truncate font-medium font-sans text-sm",children:s.name}),e.jsx(b.span,{animate:l?"hot":"idle",className:"shrink-0",initial:"idle",variants:Ue,children:e.jsx(i,{className:`temperature-icon h-3.5 w-3.5 ${l?"hot":""} ${M[s.temperature]?.color||"text-muted-foreground"}`})})]}),s.profession&&e.jsx("p",{className:"truncate text-muted-foreground text-xs",children:s.profession}),s.clinicName&&e.jsxs("p",{className:"flex items-center gap-1 truncate text-muted-foreground text-xs",children:[e.jsx(ve,{className:"h-3 w-3"}),s.clinicName]}),e.jsx("div",{className:"mt-2 flex items-center gap-2",children:s.interestedProduct&&e.jsx(E,{className:"px-1.5 py-0 text-[10px]",variant:"outline",children:Ke[s.interestedProduct]||s.interestedProduct})}),e.jsxs("div",{className:"mt-2 flex items-center gap-3 text-muted-foreground",children:[e.jsx("button",{"aria-label":"Ligar",className:"action-button relative z-10 flex min-h-[44px] min-w-[44px] cursor-pointer appearance-none items-center justify-center border-none bg-transparent transition-colors hover:text-primary",onClick:t=>{t.stopPropagation()},type:"button",children:e.jsx(be,{className:"h-4 w-4"})}),e.jsx("button",{"aria-label":"Mensagem",className:"action-button relative z-10 flex min-h-[44px] min-w-[44px] cursor-pointer appearance-none items-center justify-center border-none bg-transparent transition-colors hover:text-primary",onClick:t=>{t.stopPropagation()},type:"button",children:e.jsx(U,{className:"h-4 w-4"})}),s.lastContactAt&&e.jsx(b.span,{animate:{opacity:1,y:0},className:"ml-auto font-sans text-[10px]",initial:{opacity:0,y:5},transition:{delay:.1},children:ye(s.lastContactAt,{addSuffix:!0,locale:G})})]}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-1",children:e.jsx(Ze,{leadId:s.id})})]})]})})}function Ze({leadId:s}){const{data:i}=R.tags.getLeadTags.useQuery({leadId:s});if(!i)return null;const l=i.slice(0,3).filter(u=>u!==null),t=i.length-3;return e.jsxs(e.Fragment,{children:[l.map(u=>e.jsx(E,{className:"h-5 px-1.5 text-[10px]",style:{backgroundColor:u.color?`${u.color}15`:void 0,color:u.color,borderColor:u.color?`${u.color}30`:void 0,borderWidth:"1px"},variant:"secondary",children:u.name},u.id)),t>0&&e.jsxs(E,{className:"h-5 px-1.5 text-[10px] text-muted-foreground",variant:"outline",children:["+",t]})]})}function ea({field:s,control:i,name:l,disabled:t}){const u=s.label??s.name,r=s.isRequired,m=()=>e.jsxs(j,{children:[u," ",r&&e.jsx("span",{className:"text-destructive",children:"*"})]});return s.fieldType==="text"?e.jsx(x,{control:i,name:l,render:({field:a})=>e.jsxs(c,{children:[e.jsx(m,{}),e.jsx(d,{children:e.jsx(C,{...a,disabled:t,value:a.value||""})}),e.jsx(f,{})]})}):s.fieldType==="number"?e.jsx(x,{control:i,name:l,render:({field:a})=>e.jsxs(c,{children:[e.jsx(m,{}),e.jsx(d,{children:e.jsx(C,{type:"number",...a,disabled:t,onChange:n=>{const g=n.target.value===""?void 0:Number(n.target.value);a.onChange(g)},value:a.value??""})}),e.jsx(f,{})]})}):s.fieldType==="boolean"?e.jsx(x,{control:i,name:l,render:({field:a})=>e.jsxs(c,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4",children:[e.jsx(d,{children:e.jsx(_,{checked:a.value,disabled:t,onCheckedChange:a.onChange})}),e.jsx("div",{className:"space-y-1 leading-none",children:e.jsx(m,{})}),e.jsx(f,{})]})}):s.fieldType==="date"?e.jsx(x,{control:i,name:l,render:({field:a})=>e.jsxs(c,{className:"flex flex-col",children:[e.jsx(m,{}),e.jsxs(H,{children:[e.jsx(z,{asChild:!0,children:e.jsx(d,{children:e.jsxs($,{className:A("w-full pl-3 text-left font-normal",!a.value&&"text-muted-foreground"),disabled:t,variant:"outline",children:[a.value?Ne(new Date(a.value),"PPP",{locale:G}):e.jsx("span",{children:"Selecione uma data"}),e.jsx(Ce,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),e.jsx(W,{align:"start",className:"w-auto p-0",children:e.jsx(se,{disabled:n=>n<new Date("1900-01-01"),initialFocus:!0,mode:"single",onSelect:n=>a.onChange(n?n.getTime():void 0),selected:a.value?new Date(a.value):void 0})})]}),e.jsx(f,{})]})}):s.fieldType==="select"?e.jsx(x,{control:i,name:l,render:({field:a})=>e.jsxs(c,{children:[e.jsx(m,{}),e.jsxs(k,{defaultValue:a.value,disabled:t,onValueChange:a.onChange,children:[e.jsx(d,{children:e.jsx(S,{children:e.jsx(P,{placeholder:"Selecione..."})})}),e.jsx(I,{children:s.options?.map(n=>e.jsx(o,{value:n,children:n},n))})]}),e.jsx(f,{})]})}):s.fieldType==="multiselect"?e.jsx(x,{control:i,name:l,render:()=>e.jsxs(c,{children:[e.jsx(m,{}),e.jsx("div",{className:"grid grid-cols-2 gap-2 rounded-md border p-2",children:s.options?.map(a=>e.jsx(x,{control:i,name:l,render:({field:n})=>{const g=n.value||[];return e.jsxs(c,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(d,{children:e.jsx(_,{checked:g.includes(a),disabled:t,onCheckedChange:y=>{const h=y?[...g,a]:g.filter(p=>p!==a);n.onChange(h)}})}),e.jsx(j,{className:"font-normal",children:a})]},a)}},a))}),e.jsx(f,{})]})}):null}function aa({entityType:s,control:i}){const{data:l}=R.customFields.list.useQuery({entityType:s});return l===void 0?e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(B,{className:"h-4 w-1/4"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(B,{className:"h-10 w-full"}),e.jsx(B,{className:"h-10 w-full"})]})]}):l.length===0?null:e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx("h3",{className:"font-medium text-lg",children:"Campos Personalizados"}),e.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:l.map(t=>e.jsx(ea,{control:i,field:t,name:`customFields.${t.id}`},t.id))})]})}function sa({value:s,onChange:i,disabled:l}){const[t,u]=v.useState(!1),[r,m]=v.useState(""),[a]=ne(r,300),{data:n}=R.leads.get.useQuery({id:Number(s)},{enabled:!!s}),{data:g}=R.leads.list.useQuery({},{enabled:t&&a.length>=2}),y=g?.data;let h="Selecione quem indicou (opcional)";return s&&!n?h="Carregando...":n&&(h=`${n.name} (${n.phone})`),e.jsxs(H,{onOpenChange:u,open:t,children:[e.jsx(z,{asChild:!0,children:e.jsxs($,{"aria-expanded":t,className:"w-full justify-between font-normal",disabled:l,role:"combobox",variant:"outline",children:[e.jsx("span",{className:A("truncate",!s&&"text-muted-foreground"),children:h}),e.jsx(we,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(W,{align:"start",className:"w-[300px] p-0",children:e.jsxs($e,{shouldFilter:!1,children:[e.jsx(Oe,{onValueChange:m,placeholder:"Buscar por nome ou telefone...",value:r}),e.jsxs(Me,{children:[e.jsx(Qe,{children:a.length<2?"Digite para buscar...":"Nenhum lead encontrado."}),e.jsx(qe,{children:y?.map(p=>e.jsxs(Ge,{onSelect:T=>{i(T===s?"":T),u(!1)},value:p.id,children:[e.jsx(ke,{className:A("mr-2 h-4 w-4",s===p.id?"opacity-100":"opacity-0")}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:p.name}),e.jsx("span",{className:"text-muted-foreground text-xs",children:p.phone})]})]},p.id))})]})]})})]})}const na=v.createContext({isFlipped:!1}),K=F.forwardRef(({children:s,className:i,...l},t)=>{const[u,r]=v.useState(!1),m=v.useCallback(a=>{r(a)},[]);return e.jsx(na.Provider,{value:{isFlipped:u},children:e.jsx(b.button,{className:A("group relative w-32 cursor-pointer border-none bg-transparent p-0","preserve-3d perspective-1000",i),initial:"initial",onBlur:()=>m(!1),onFocus:()=>m(!0),onHoverEnd:()=>m(!1),onHoverStart:()=>m(!0),ref:t,whileHover:"flipped",whileTap:"flipped",...l,children:e.jsxs("div",{className:"preserve-3d relative h-full w-full transition-transform duration-500",children:[e.jsx(b.div,{className:"backface-hidden absolute inset-0 h-full w-full",transition:{type:"spring",stiffness:260,damping:20},variants:{initial:{rotateX:0,opacity:1},flipped:{rotateX:180,opacity:0}},children:F.Children.map(s,a=>F.isValidElement(a)&&a.type===J?a:null)}),e.jsx(b.div,{className:"backface-hidden absolute inset-0 h-full w-full",style:{rotateX:180},transition:{type:"spring",stiffness:260,damping:20},variants:{initial:{rotateX:180,opacity:0},flipped:{rotateX:0,opacity:1}},children:F.Children.map(s,a=>F.isValidElement(a)&&a.type===Y?a:null)})]})})})});K.displayName="FlipButton";const J=({children:s,className:i,...l})=>e.jsx(b.div,{className:A("backface-hidden flex h-full w-full items-center justify-center rounded-md bg-white text-black",i),...l,children:s}),Y=({children:s,className:i,...l})=>e.jsx(b.div,{className:A("backface-hidden flex h-full w-full items-center justify-center rounded-md bg-black text-white",i),...l,children:s}),ra=Ee({name:N().min(2,{message:"Nome deve ter pelo menos 2 caracteres"}),phone:N().min(10,{message:"Telefone invÃ¡lido"}),email:N().email({message:"Email invÃ¡lido"}).optional().or(Ve("")),source:w(["whatsapp","instagram","landing_page","indicacao","evento","organico","trafego_pago","outro"]),profession:w(["enfermeiro","dentista","biomedico","farmaceutico","medico","esteticista","outro"]).optional(),interestedProduct:w(["trintae3","otb","black_neon","comunidade","auriculo","na_mesa_certa","indefinido"]).optional(),temperature:w(["frio","morno","quente"]),stage:w(["novo","primeiro_contato","qualificado","proposta","negociacao","fechado_ganho","fechado_perdido"]),hasClinic:Le().optional(),clinicName:N().optional(),clinicCity:N().optional(),yearsInAesthetics:N().optional(),currentRevenue:w(["0-5k","5k-10k","10k-20k","20k-50k","50k+"]).optional(),mainPain:w(["tecnica","vendas","gestao","posicionamento","escala","certificacao","outro"]).optional(),mainDesire:N().max(500).optional(),referredById:N().optional(),assignedTo:N().optional(),customFields:Be(N(),_e()).optional()}).refine(s=>!(s.hasClinic&&!s.clinicName),{message:"Nome da clÃ­nica Ã© obrigatÃ³rio",path:["clinicName"]});function ia(){const[s,i]=v.useState(!1),t=R.leads.create.useMutation().mutateAsync,{data:u}=R.users.listSystemUsers.useQuery(),r=Fe({resolver:De(ra),defaultValues:{name:"",phone:"",email:"",source:"instagram",profession:void 0,interestedProduct:void 0,temperature:"frio",stage:"novo",hasClinic:!1,clinicName:"",clinicCity:"",yearsInAesthetics:"",currentRevenue:void 0,mainPain:void 0,mainDesire:"",referredById:""}}),m=async a=>{try{const n={name:a.name,phone:a.phone,source:a.source,temperature:a.temperature,stage:a.stage,...a.email&&{email:a.email},...a.profession&&{profession:a.profession},...a.interestedProduct&&{interestedProduct:a.interestedProduct},...a.hasClinic!==void 0&&{hasClinic:a.hasClinic},...a.clinicName&&{clinicName:a.clinicName},...a.clinicCity&&{clinicCity:a.clinicCity},...a.yearsInAesthetics&&!Number.isNaN(Number(a.yearsInAesthetics))&&{yearsInAesthetics:Number(a.yearsInAesthetics)},...a.currentRevenue&&{currentRevenue:a.currentRevenue},...a.mainPain&&{mainPain:a.mainPain},...a.mainDesire&&{mainDesire:a.mainDesire},...a.referredById&&{referredById:a.referredById},...a.assignedTo&&{assignedTo:a.assignedTo},customFieldValues:a.customFields?Object.entries(a.customFields).map(([g,y])=>({customFieldId:g,value:y})):void 0,lgpdConsent:!0,whatsappConsent:!0};await t(n),V.success("Lead criado com sucesso!"),i(!1),r.reset()}catch(n){const g=n instanceof Error?n.message:"Erro desconhecido";g.includes("Unauthenticated")?V.error("SessÃ£o expirada. Por favor, faÃ§a login novamente."):V.error(`Erro ao criar lead: ${g}`)}};return e.jsxs(re,{onOpenChange:i,open:s,children:[e.jsx("div",{className:"mb-4 w-full px-1",children:e.jsx(ie,{asChild:!0,children:e.jsxs(K,{className:"h-12 w-full",initial:!1,children:[e.jsx(J,{className:"h-full w-full overflow-hidden rounded-full bg-transparent p-0",children:e.jsxs(O,{as:"div",className:"flex h-full w-full items-center justify-center bg-background font-medium text-foreground",containerClassName:"rounded-full w-full h-full",children:[e.jsx(Se,{className:"mr-2 h-4 w-4"}),"Novo Lead"]})}),e.jsx(Y,{className:"h-full w-full overflow-hidden rounded-full bg-transparent p-0",children:e.jsx(O,{as:"div",className:"flex h-full w-full items-center justify-center bg-[#004b5a] font-bold text-[#d4af37] tracking-wide",clockwise:!1,containerClassName:"rounded-full w-full h-full border-none",children:"Cadastrar"})})]})})}),e.jsxs(te,{className:"border-border/50 bg-card/95 backdrop-blur-xl sm:max-w-[600px]",children:[e.jsxs(oe,{children:[e.jsx(le,{children:"Novo Lead"}),e.jsx(ce,{children:"Preencha os dados para criar um novo lead no sistema."})]}),e.jsx(de,{...r,children:e.jsxs("form",{className:"space-y-6",onSubmit:r.handleSubmit(m),children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(x,{control:r.control,name:"name",render:({field:a})=>e.jsxs(c,{children:[e.jsx(j,{children:"Nome Completo"}),e.jsx(d,{children:e.jsx(C,{placeholder:"Ex: JoÃ£o Silva",...a})}),e.jsx(f,{})]})}),e.jsx(x,{control:r.control,name:"phone",render:({field:a})=>e.jsxs(c,{children:[e.jsx(j,{children:"Telefone (WhatsApp)"}),e.jsx(d,{children:e.jsx(C,{placeholder:"Ex: 11999999999",...a})}),e.jsx(f,{})]})}),e.jsx(x,{control:r.control,name:"email",render:({field:a})=>e.jsxs(c,{children:[e.jsx(j,{children:"Email (Opcional)"}),e.jsx(d,{children:e.jsx(C,{placeholder:"Ex: joao@email.com",...a})}),e.jsx(f,{})]})}),e.jsx(x,{control:r.control,name:"referredById",render:({field:a})=>e.jsxs(c,{className:"flex flex-col",children:[e.jsx(j,{children:"Indicado por (Opcional)"}),e.jsx(d,{children:e.jsx(sa,{onChange:a.onChange,value:a.value})}),e.jsx(f,{})]})}),e.jsx(x,{control:r.control,name:"assignedTo",render:({field:a})=>e.jsxs(c,{children:[e.jsx(j,{children:"ResponsÃ¡vel (Opcional)"}),e.jsxs(k,{onValueChange:a.onChange,value:a.value||"",children:[e.jsx(d,{children:e.jsx(S,{children:e.jsx(P,{placeholder:"Selecione o responsÃ¡vel"})})}),e.jsx(I,{children:u?.map(n=>e.jsx(o,{value:n.id,children:n.name},n.id))})]}),e.jsx(f,{})]})}),e.jsx(x,{control:r.control,name:"source",render:({field:a})=>e.jsxs(c,{children:[e.jsx(j,{children:"Fonte de AquisiÃ§Ã£o"}),e.jsxs(k,{defaultValue:a.value,onValueChange:a.onChange,children:[e.jsx(d,{children:e.jsx(S,{children:e.jsx(P,{placeholder:"Selecione a fonte"})})}),e.jsxs(I,{children:[e.jsx(o,{value:"whatsapp",children:"WhatsApp"}),e.jsx(o,{value:"instagram",children:"Instagram"}),e.jsx(o,{value:"landing_page",children:"Landing Page"}),e.jsx(o,{value:"trafego_pago",children:"TrÃ¡fego Pago"}),e.jsx(o,{value:"indicacao",children:"IndicaÃ§Ã£o"}),e.jsx(o,{value:"evento",children:"Evento"}),e.jsx(o,{value:"organico",children:"OrgÃ¢nico"}),e.jsx(o,{value:"outro",children:"Outro"})]})]}),e.jsx(f,{})]})}),e.jsx(x,{control:r.control,name:"profession",render:({field:a})=>e.jsxs(c,{children:[e.jsx(j,{children:"ProfissÃ£o"}),e.jsxs(k,{defaultValue:a.value,onValueChange:a.onChange,children:[e.jsx(d,{children:e.jsx(S,{children:e.jsx(P,{placeholder:"Selecione..."})})}),e.jsxs(I,{children:[e.jsx(o,{value:"enfermeiro",children:"Enfermeiro(a)"}),e.jsx(o,{value:"dentista",children:"Dentista"}),e.jsx(o,{value:"biomedico",children:"BiomÃ©dico(a)"}),e.jsx(o,{value:"farmaceutico",children:"FarmacÃªutico(a)"}),e.jsx(o,{value:"medico",children:"MÃ©dico(a)"}),e.jsx(o,{value:"esteticista",children:"Esteticista"}),e.jsx(o,{value:"outro",children:"Outro"})]})]}),e.jsx(f,{})]})}),e.jsx(x,{control:r.control,name:"interestedProduct",render:({field:a})=>e.jsxs(c,{children:[e.jsx(j,{children:"Produto de Interesse"}),e.jsxs(k,{defaultValue:a.value,onValueChange:a.onChange,children:[e.jsx(d,{children:e.jsx(S,{children:e.jsx(P,{placeholder:"Selecione..."})})}),e.jsxs(I,{children:[e.jsx(o,{value:"trintae3",children:"TrintaE3 (33)"}),e.jsx(o,{value:"otb",children:"OTB"}),e.jsx(o,{value:"black_neon",children:"Black Neon"}),e.jsx(o,{value:"comunidade",children:"Comunidade"}),e.jsx(o,{value:"auriculo",children:"AurÃ­culo"}),e.jsx(o,{value:"na_mesa_certa",children:"Na Mesa Certa"}),e.jsx(o,{value:"indefinido",children:"Ainda nÃ£o sabe"})]})]}),e.jsx(f,{})]})})]}),e.jsxs("div",{className:"space-y-4 rounded-lg border border-border/50 bg-muted/30 p-4",children:[e.jsx(x,{control:r.control,name:"hasClinic",render:({field:a})=>e.jsxs(c,{className:"flex flex-row items-start space-x-3 space-y-0",children:[e.jsx(d,{children:e.jsx(_,{checked:a.value,onCheckedChange:a.onChange})}),e.jsx("div",{className:"space-y-1 leading-none",children:e.jsx(j,{children:"Possui clÃ­nica ou consultÃ³rio prÃ³prio?"})})]})}),r.watch("hasClinic")&&e.jsxs("div",{className:"grid grid-cols-1 gap-4 pt-2 md:grid-cols-2",children:[e.jsx(x,{control:r.control,name:"clinicName",render:({field:a})=>e.jsxs(c,{children:[e.jsx(j,{children:"Nome da ClÃ­nica"}),e.jsx(d,{children:e.jsx(C,{placeholder:"Ex: ClÃ­nica EstÃ©tica Bella",...a})}),e.jsx(f,{})]})}),e.jsx(x,{control:r.control,name:"clinicCity",render:({field:a})=>e.jsxs(c,{children:[e.jsx(j,{children:"Cidade"}),e.jsx(d,{children:e.jsx(C,{placeholder:"Ex: SÃ£o Paulo",...a})}),e.jsx(f,{})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsx(x,{control:r.control,name:"yearsInAesthetics",render:({field:a})=>e.jsxs(c,{children:[e.jsx(j,{children:"Anos na EstÃ©tica"}),e.jsx(d,{children:e.jsx(C,{placeholder:"Ex: 3",type:"number",...a})}),e.jsx(f,{})]})}),e.jsx(x,{control:r.control,name:"currentRevenue",render:({field:a})=>e.jsxs(c,{children:[e.jsx(j,{children:"Faturamento Mensal"}),e.jsxs(k,{defaultValue:a.value,onValueChange:a.onChange,children:[e.jsx(d,{children:e.jsx(S,{children:e.jsx(P,{placeholder:"Selecione..."})})}),e.jsxs(I,{children:[e.jsx(o,{value:"0-5k",children:"AtÃ© R$ 5.000"}),e.jsx(o,{value:"5k-10k",children:"R$ 5.000 - R$ 10.000"}),e.jsx(o,{value:"10k-20k",children:"R$ 10.000 - R$ 20.000"}),e.jsx(o,{value:"20k-50k",children:"R$ 20.000 - R$ 50.000"}),e.jsx(o,{value:"50k+",children:"Acima de R$ 50.000"})]})]}),e.jsx(f,{})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(x,{control:r.control,name:"mainPain",render:({field:a})=>e.jsxs(c,{children:[e.jsx(j,{children:"Dor Principal"}),e.jsxs(k,{defaultValue:a.value,onValueChange:a.onChange,children:[e.jsx(d,{children:e.jsx(S,{children:e.jsx(P,{placeholder:"Qual a maior dificuldade?"})})}),e.jsxs(I,{children:[e.jsx(o,{value:"tecnica",children:"TÃ©cnica / Conhecimento"}),e.jsx(o,{value:"vendas",children:"Vendas / CaptaÃ§Ã£o"}),e.jsx(o,{value:"gestao",children:"GestÃ£o / Processos"}),e.jsx(o,{value:"posicionamento",children:"Posicionamento / Marketing"}),e.jsx(o,{value:"escala",children:"Escala / Crescimento"}),e.jsx(o,{value:"certificacao",children:"CertificaÃ§Ã£o / RegularizaÃ§Ã£o"}),e.jsx(o,{value:"outro",children:"Outro"})]})]}),e.jsx(f,{})]})}),e.jsx(x,{control:r.control,name:"mainDesire",render:({field:a})=>e.jsxs(c,{children:[e.jsx(j,{children:"Principal Desejo / Objetivo"}),e.jsx(d,{children:e.jsx(ue,{className:"resize-none",placeholder:"Ex: Quero faturar R$ 30k/mÃªs com procedimentos estÃ©ticos...",...a})}),e.jsx(f,{})]})})]}),e.jsx(x,{control:r.control,name:"temperature",render:({field:a})=>e.jsxs(c,{className:"space-y-3",children:[e.jsx(j,{children:"Temperatura Inicial"}),e.jsx(d,{children:e.jsxs(xe,{className:"flex space-x-4",defaultValue:a.value,onValueChange:a.onChange,children:[e.jsxs(c,{className:"flex items-center space-x-2 space-y-0",children:[e.jsx(d,{children:e.jsx(L,{value:"frio"})}),e.jsx(j,{className:"cursor-pointer font-normal text-primary",children:"â„ï¸ Frio"})]}),e.jsxs(c,{className:"flex items-center space-x-2 space-y-0",children:[e.jsx(d,{children:e.jsx(L,{value:"morno"})}),e.jsx(j,{className:"cursor-pointer font-normal text-yellow-400",children:"ðŸŒ¤ï¸ Morno"})]}),e.jsxs(c,{className:"flex items-center space-x-2 space-y-0",children:[e.jsx(d,{children:e.jsx(L,{value:"quente"})}),e.jsx(j,{className:"cursor-pointer font-normal text-red-500",children:"ðŸ”¥ Quente"})]})]})}),e.jsx(f,{})]})}),e.jsx("div",{className:"rounded-lg border border-border/50 bg-muted/30 p-4",children:e.jsx(aa,{control:r.control,entityType:"lead"})}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx($,{className:"w-full bg-primary hover:bg-primary/90 sm:w-auto",disabled:r.formState.isSubmitting,type:"submit",children:r.formState.isSubmitting?e.jsxs(e.Fragment,{children:[e.jsx(Pe,{className:"mr-2 h-4 w-4 animate-spin"}),"Criando..."]}):"Criar Lead"})})]})})]})]})}const Q=[{id:"novo",label:"Novo",color:"bg-primary"},{id:"primeiro_contato",label:"Primeiro Contato",color:"bg-yellow-500"},{id:"qualificado",label:"Qualificado",color:"bg-purple-500"},{id:"proposta",label:"Proposta",color:"bg-orange-500"},{id:"negociacao",label:"NegociaÃ§Ã£o",color:"bg-pink-500"},{id:"fechado_ganho",label:"Fechado âœ“",color:"bg-green-500"}];function ta({lead:s,onLeadClick:i,onDragToColumn:l,columnRefs:t}){const[u,r]=v.useState(!1),m=v.useCallback((a,n)=>{r(!1);const g=t.current;if(g)for(const[y,h]of g.entries()){const p=h.getBoundingClientRect();if(n.point.x>=p.left&&n.point.x<=p.right&&n.point.y>=p.top&&n.point.y<=p.bottom){y!==s.stage&&l(s.id,y);break}}},[t,s.id,s.stage,l]);return e.jsxs(Ae,{animate:"animate",className:"relative touch-none rounded-lg will-change-transform",drag:!0,dragElastic:.1,dragTransition:We,exit:"exit",id:s.id,initial:"initial",layout:"position",layoutId:s.id,onDragEnd:m,onDragStart:()=>r(!0),transition:ze,value:s,variants:Xe,whileDrag:{scale:1.05,boxShadow:"0 25px 50px -12px hsl(var(--primary) / 0.4)",zIndex:50,cursor:"grabbing"},children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx(Ye,{lead:{...s,id:Number(s.id)}}),e.jsx("button",{"aria-label":"Abrir lead",className:"absolute inset-0 h-full w-full cursor-pointer rounded-lg border-none bg-transparent p-0 opacity-0 focus:opacity-100 focus:ring-2 focus:ring-primary focus:ring-offset-2",onClick:()=>{u||i?.(s.id)},type:"button"})]}),s.phone&&e.jsxs(b.button,{className:"mt-2 flex w-full cursor-pointer items-center justify-center gap-1.5 rounded-md bg-green-50 px-3 py-1.5 font-medium text-green-700 text-xs transition-colors hover:bg-green-100",onClick:a=>{a.stopPropagation(),s.phone&&window.open(`https://wa.me/${s.phone}`,"_blank")},onPointerDown:a=>a.stopPropagation(),type:"button",whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsx(U,{className:"h-3.5 w-3.5"}),"WhatsApp"]})]})}function oa({stage:s,leads:i,onLeadClick:l,onReorder:t,onDragToColumn:u,columnRefs:r,headerAction:m,registerColumn:a}){return e.jsx(b.div,{className:"w-[300px] shrink-0 snap-start",layout:!0,ref:n=>a(s.id,n),transition:D,children:e.jsxs(q,{className:"kanban-column flex h-[calc(100vh-200px)] min-h-[400px] flex-col",variant:"glass",children:[e.jsx(me,{className:"kanban-column-header shrink-0 pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(he,{className:"flex items-center gap-2 font-display font-medium text-sm",children:[e.jsx(b.div,{className:`h-2 w-2 rounded-full ${s.color}`,layoutId:`stage-dot-${s.id}`}),s.label]}),e.jsx(E,{className:"font-display tabular-nums",variant:"secondary",children:e.jsx(b.span,{animate:{scale:1},initial:{scale:1.2},transition:D,children:i.length},i.length)})]})}),e.jsxs(pe,{className:"flex min-h-0 flex-1 flex-col",children:[m,e.jsx(je,{className:"h-full",children:e.jsxs(Te,{axis:"y",className:"space-y-3 pr-4 pb-4",layoutScroll:!0,onReorder:n=>t(s.id,n),values:i,children:[e.jsx(Re,{initial:!1,mode:"popLayout",children:i.map(n=>e.jsx(ta,{columnRefs:r,lead:n,onDragToColumn:u,onLeadClick:l},n.id))}),i.length===0&&e.jsx(b.div,{animate:{opacity:1},className:"flex h-20 items-center justify-center rounded-lg border-2 border-muted border-dashed text-muted-foreground text-xs",initial:{opacity:0},transition:{delay:.2},children:"Arraste para cÃ¡"})]})})]})]})})}function ga({leads:s,onDragEnd:i,onLeadClick:l}){const t=v.useRef(new Map),[u,r]=v.useState(null),m=u??s,a=v.useMemo(()=>{const h={};for(const p of Q)h[p.id]=m.filter(T=>T.stage===p.id);return h},[m]),n=v.useCallback((h,p)=>{p?t.current.set(h,p):t.current.delete(h)},[]),g=v.useCallback((h,p)=>{r(T=>[...(T??s).filter(Z=>Z.stage!==h),...p])},[s]),y=v.useCallback((h,p)=>{r(null),i(h,p)},[i]);return v.useEffect(()=>{r(null)},[]),e.jsx(Ie,{children:e.jsx("div",{className:"flex h-full snap-x snap-mandatory gap-4 overflow-x-auto scroll-smooth pb-4",children:Q.map(h=>e.jsx(oa,{columnRefs:t,headerAction:h.id==="novo"?e.jsx(ia,{}):null,leads:a[h.id]||[],onDragToColumn:y,onLeadClick:l,onReorder:g,registerColumn:n,stage:h},h.id))})})}export{ga as PipelineKanban};
