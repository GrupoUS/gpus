# src/ - Frontend Application

## Package Identity

**Purpose:** Main React application with UI components, routing, and business logic  
**Tech:** React 19 + TypeScript + TanStack Router + shadcn/ui + Tailwind CSS v4

---

## Setup & Run

```bash
# Development server (from root)
bun run dev

# Type checking
bun run build  # Includes tsc --noEmit

# Linting
bun run lint

# Testing
bun run test
bun run test:watch
```

---

## Patterns & Conventions

### File Organization

```
src/
├── components/
│   ├── ui/              # shadcn/ui base components
│   ├── crm/             # CRM-specific components
│   ├── dashboard/       # Dashboard widgets
│   └── layout/          # Layout components (sidebar, header)
├── routes/
│   ├── __root.tsx       # Root layout
│   ├── index.tsx        # Dashboard page
│   └── crm/             # CRM routes
├── hooks/               # Custom React hooks
├── lib/
│   ├── utils.ts         # Utility functions (cn, etc.)
│   └── constants.ts     # App constants
└── styles/              # Global CSS
```

### Naming Conventions

- **Components:** PascalCase (`LeadCard.tsx`)
- **Hooks:** camelCase with `use` prefix (`useLeads.ts`)
- **Utils:** camelCase (`formatDate.ts`)
- **Types:** PascalCase (`LeadStatus`)

### Component Patterns

✅ **DO:** Use functional components with hooks
```tsx
// Example: src/components/crm/lead-card.tsx
export function LeadCard({ lead }: LeadCardProps) {
  const [isOpen, setIsOpen] = useState(false)
  return <Card>...</Card>
}
```

❌ **DON'T:** Use class components
```tsx
// AVOID
class LeadCard extends React.Component { ... }
```

✅ **DO:** Use shadcn/ui components from `src/components/ui/`
```tsx
import { Button } from '@/components/ui/button'
import { Card } from '@/components/ui/card'
```

✅ **DO:** Use Tailwind CSS classes (no inline styles)
```tsx
<div className="flex items-center gap-4 p-6">
```

❌ **DON'T:** Hardcode colors
```tsx
// AVOID
<div style={{ color: '#8b5cf6' }}>
// USE
<div className="text-primary">
```

### Routing Patterns

✅ **DO:** Use file-based routing with TanStack Router
```tsx
// src/routes/crm/index.tsx
import { createFileRoute } from '@tanstack/react-router'

export const Route = createFileRoute('/crm/')({
  component: CRMPage,
})

function CRMPage() {
  return <div>CRM Dashboard</div>
}
```

✅ **DO:** Use dynamic routes with `$` prefix
```tsx
// src/routes/crm/$leadId.tsx
export const Route = createFileRoute('/crm/$leadId')({
  component: LeadDetail,
})
```

### State Management

✅ **DO:** Use Convex hooks for server state
```tsx
import { useQuery, useMutation } from 'convex/react'
import { api } from '../../convex/_generated/api'

const leads = useQuery(api.leads.getAll)
const createLead = useMutation(api.leads.create)
```

✅ **DO:** Use React hooks for local state
```tsx
const [isOpen, setIsOpen] = useState(false)
const [filter, setFilter] = useState('')
```

### Forms

✅ **DO:** Use react-hook-form + Zod validation
```tsx
import { useForm } from 'react-hook-form'
import { zodResolver } from '@hookform/resolvers/zod'
import { z } from 'zod'

const schema = z.object({
  name: z.string().min(1),
  email: z.string().email(),
})

const form = useForm({
  resolver: zodResolver(schema),
})
```

---

## Touch Points / Key Files

| File | Purpose |
|------|---------|
| `src/main.tsx` | App entry point, providers setup |
| `src/routes/__root.tsx` | Root layout with sidebar |
| `src/components/layout/app-sidebar.tsx` | Main navigation sidebar |
| `src/components/ui/` | shadcn/ui base components |
| `src/lib/utils.ts` | Utility functions (cn, formatters) |
| `src/index.css` | Global styles, Tailwind config |

---

## JIT Index Hints

```bash
# Find a component
rg -n "export.*function.*" src/components

# Find a route
rg -n "createFileRoute" src/routes

# Find a hook
rg -n "export.*use[A-Z]" src/hooks

# Find imports of a component
rg -n "from.*LeadCard" src/

# Find Tailwind classes
rg -n "className=" src/
```

---

## Common Gotchas

- **Imports:** Always use `@/` alias for absolute imports (configured in `tsconfig.json`)
- **Clerk:** Use `VITE_` prefix for env vars to expose to client
- **Convex:** Real-time updates automatic with `useQuery` (no manual refetch needed)
- **Biome:** Auto-formats on save; run `bun run lint` before commit
- **Route types:** Auto-generated by TanStack Router plugin (don't edit `routeTree.gen.ts`)

---

## Pre-PR Checks

```bash
# Run all checks
bun run lint && bun run build && bun run test
```

